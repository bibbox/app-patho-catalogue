(window.webpackJsonp=window.webpackJsonp||[]).push([[4,35],{"0TMo":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("HENg"),a=n("lJxs");class r extends i.a{getFeatureIDs(e,t){return this.getFeatureID(e,t).pipe(Object(a.a)(e=>[e]))}}},"5FsK":function(e,t,n){"use strict";n.d(t,"a",(function(){return ie}));var i=n("LvDl"),a=n("SxV6"),r=n("eIep"),s=n("1QIV"),o=n("cBt8"),c=n("d/jG"),l=n("J3qs"),d=n("ac5F"),p=n("X8f1");class u{constructor(e,t){this.op=e,this.field=t}}let m=(()=>{class e extends u{constructor(t,n){super(e.operationType,t),this.value=n}toOperation(){return{op:this.op,path:`/metadata/${this.field}/-`,value:this.value}}}return e.operationType="add",e})(),b=(()=>{class e extends u{constructor(t,n){super(e.operationType,t),this.place=n}toOperation(){return{op:this.op,path:`/metadata/${this.field}/${this.place}`}}}return e.operationType="remove",e})(),h=(()=>{class e extends u{constructor(t,n,i){super(e.operationType,t),this.place=n,this.value=i}toOperation(){return{op:this.op,path:`/metadata/${this.field}/${this.place}`,value:this.value}}}return e.operationType="replace",e})();var f=n("8Y7J");let v=(()=>{class e{fieldUpdatesToPatchOperations(e){const t=this.fieldUpdatesToMetadataPatchOperations(e),n=new Map,i=[];return t.forEach(e=>{e.op!==b.operationType&&e.op!==h.operationType||!Object(l.b)(e.place)||n.has(e.field)&&n.get(e.field).forEach(t=>{t<e.place&&e.place--}),e.op===b.operationType&&Object(l.b)(e.place)&&(n.has(e.field)||n.set(e.field,[]),n.get(e.field).push(e.place)),i.push(e.toOperation())}),i}fieldUpdatesToMetadataPatchOperations(e){const t=[];return Object.keys(e).forEach(n=>{const i=e[n],a=i.field,r={value:a.value,language:a.language};let s;switch(i.changeType){case p.c.ADD:s=new m(a.key,[r]);break;case p.c.REMOVE:s=new b(a.key,a.place);break;case p.c.UPDATE:s=new h(a.key,a.place,r)}t.push(s)}),t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=f["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=n("iqTE"),x=n("loKC"),y=n("iInd"),j=n("lI3o"),S=n("TSSN"),O=n("SVse"),I=n("2Vo4"),C=n("LRne"),w=n("lJxs"),E=n("84Zn"),k=n("Y6Ni"),M=n("8pnQ"),B=n("aojn"),V=n("s7LF"),R=n("awfb"),U=n("jOLk");const $=["ds-edit-in-place-field",""];function F(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"div"),f["\u0275\u0275text"](1,"\n            "),f["\u0275\u0275elementStart"](2,"span"),f["\u0275\u0275text"](3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](4,"\n        "),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](3),f["\u0275\u0275textInterpolate"](null==e.metadata||null==e.metadata.key?null:e.metadata.key.split(".").join(".\u200b"))}}const T=function(){return{standalone:!0}};function D(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"div",15),f["\u0275\u0275text"](1,"\n            "),f["\u0275\u0275elementStart"](2,"ds-validation-suggestions",16,17),f["\u0275\u0275listener"]("ngModelChange",(function(t){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().metadata.key=t}))("submitSuggestion",(function(){f["\u0275\u0275restoreView"](e);const t=f["\u0275\u0275reference"](3);return f["\u0275\u0275nextContext"]().update(t)}))("clickSuggestion",(function(){f["\u0275\u0275restoreView"](e);const t=f["\u0275\u0275reference"](3);return f["\u0275\u0275nextContext"]().update(t)}))("typeSuggestion",(function(){f["\u0275\u0275restoreView"](e);const t=f["\u0275\u0275reference"](3);return f["\u0275\u0275nextContext"]().update(t)}))("dsClickOutside",(function(){f["\u0275\u0275restoreView"](e);const t=f["\u0275\u0275reference"](3);return f["\u0275\u0275nextContext"]().checkValidity(t)}))("findSuggestions",(function(t){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().findMetadataFieldSuggestions(t)})),f["\u0275\u0275pipe"](4,"async"),f["\u0275\u0275pipe"](5,"async"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](6,"\n        "),f["\u0275\u0275elementEnd"]()}if(2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("suggestions",f["\u0275\u0275pipeBind1"](4,6,e.metadataFieldSuggestions))("ngModel",e.metadata.key)("url",e.url)("metadata",e.metadata)("valid",!1!==f["\u0275\u0275pipeBind1"](5,8,e.valid))("ngModelOptions",f["\u0275\u0275pureFunction0"](10,T))}}function P(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"small",18),f["\u0275\u0275text"](1),f["\u0275\u0275pipe"](2,"translate"),f["\u0275\u0275elementEnd"]()),2&e&&(f["\u0275\u0275advance"](1),f["\u0275\u0275textInterpolate"](f["\u0275\u0275pipeBind1"](2,1,"item.edit.metadata.metadatafield.invalid")))}function z(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"div"),f["\u0275\u0275text"](1,"\n            "),f["\u0275\u0275elementStart"](2,"span"),f["\u0275\u0275text"](3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](4,"\n        "),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](3),f["\u0275\u0275textInterpolate"](null==e.metadata?null:e.metadata.value)}}function L(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"div",15),f["\u0275\u0275text"](1,"\n            "),f["\u0275\u0275elementStart"](2,"textarea",19),f["\u0275\u0275listener"]("ngModelChange",(function(t){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().metadata.value=t}))("onDebounce",(function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().update()})),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](3,"\n        "),f["\u0275\u0275elementEnd"]()}if(2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("ngModel",e.metadata.value)}}function N(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"div"),f["\u0275\u0275text"](1,"\n            "),f["\u0275\u0275elementStart"](2,"span"),f["\u0275\u0275text"](3),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](4,"\n        "),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](3),f["\u0275\u0275textInterpolate"](null==e.metadata?null:e.metadata.language)}}function _(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"div",15),f["\u0275\u0275text"](1,"\n            "),f["\u0275\u0275elementStart"](2,"input",20),f["\u0275\u0275listener"]("ngModelChange",(function(t){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().metadata.language=t}))("onDebounce",(function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().update()})),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](3,"\n        "),f["\u0275\u0275elementEnd"]()}if(2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("ngModel",e.metadata.language)}}function A(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"button",21),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().setEditable(!0)})),f["\u0275\u0275pipe"](1,"async"),f["\u0275\u0275pipe"](2,"translate"),f["\u0275\u0275text"](3,"\n            "),f["\u0275\u0275element"](4,"i",22),f["\u0275\u0275text"](5,"\n        "),f["\u0275\u0275elementEnd"]()}if(2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275propertyInterpolate"]("title",f["\u0275\u0275pipeBind1"](2,4,"item.edit.metadata.edit.buttons.edit")),f["\u0275\u0275property"]("disabled",!f["\u0275\u0275pipeBind1"](1,2,e.canSetEditable()))}}function q(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"button",23),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().setEditable(!1)})),f["\u0275\u0275pipe"](1,"async"),f["\u0275\u0275pipe"](2,"async"),f["\u0275\u0275pipe"](3,"translate"),f["\u0275\u0275text"](4,"\n            "),f["\u0275\u0275element"](5,"i",24),f["\u0275\u0275text"](6,"\n        "),f["\u0275\u0275elementEnd"]()}if(2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275propertyInterpolate"]("title",f["\u0275\u0275pipeBind1"](3,6,"item.edit.metadata.edit.buttons.unedit")),f["\u0275\u0275property"]("disabled",!f["\u0275\u0275pipeBind1"](1,2,e.canSetUneditable())||!1===f["\u0275\u0275pipeBind1"](2,4,e.valid))}}let J=(()=>{class e{constructor(e,t){this.registryService=e,this.objectUpdatesService=t,this.metadataFieldSuggestions=new I.a([])}ngOnInit(){this.editable=this.objectUpdatesService.isEditable(this.url,this.metadata.uuid),this.valid=this.objectUpdatesService.isValid(this.url,this.metadata.uuid)}update(e){this.objectUpdatesService.saveChangeFieldUpdate(this.url,Object(i.cloneDeep)(this.metadata)),Object(l.b)(e)&&this.checkValidity(e)}checkValidity(e){e.control.setValue(e.viewModel),e.control.updateValueAndValidity(),this.objectUpdatesService.setValidFieldUpdate(this.url,this.metadata.uuid,e.control.valid)}setEditable(e){this.objectUpdatesService.setEditableFieldUpdate(this.url,this.metadata.uuid,e)}remove(){this.objectUpdatesService.saveRemoveFieldUpdate(this.url,Object(i.cloneDeep)(this.metadata))}removeChangesFromField(){this.objectUpdatesService.removeSingleFieldUpdate(this.url,this.metadata.uuid)}ngOnChanges(){this.metadata=Object(i.cloneDeep)(this.fieldUpdate.field)}findMetadataFieldSuggestions(e){if(Object(l.e)(e))return this.registryService.queryMetadataFields(e,null,!0,!1,Object(E.a)("schema")).pipe(Object(s.i)(),Object(s.r)()).subscribe(e=>{this.setInputSuggestions(e)});this.metadataFieldSuggestions.next([])}setInputSuggestions(e){this.metadataFieldSuggestions.next(e.map(e=>({displayValue:e.split(".").join(".&#8203;"),value:e})))}canSetEditable(){return this.editable.pipe(Object(w.a)(e=>!e&&this.fieldUpdate.changeType!==p.c.REMOVE))}canSetUneditable(){return this.editable}canRemove(){return Object(C.a)(this.fieldUpdate.changeType!==p.c.REMOVE&&this.fieldUpdate.changeType!==p.c.ADD)}canUndo(){return this.editable.pipe(Object(w.a)(e=>this.fieldUpdate.changeType>=0||e))}isNotEmpty(e){return Object(l.e)(e)}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](k.a),f["\u0275\u0275directiveInject"](x.a))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["","ds-edit-in-place-field",""]],inputs:{fieldUpdate:"fieldUpdate",url:"url",metadata:"metadata"},features:[f["\u0275\u0275NgOnChangesFeature"]],attrs:$,decls:65,vars:39,consts:[[1,"metadata-field"],[4,"ngIf"],["class","field-container",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"w-100"],[1,"value-field"],[1,"text-center"],[1,"language-field"],[1,"btn-group","edit-field"],["class","btn btn-outline-primary btn-sm",3,"disabled","title","click",4,"ngIf"],["class","btn btn-outline-success btn-sm",3,"disabled","title","click",4,"ngIf"],[1,"btn","btn-outline-danger","btn-sm",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"disabled","title","click"],[1,"fas","fa-undo-alt","fa-fw"],[1,"field-container"],["dsAutoFocus","","autoFocusSelector",".suggestion_input",3,"suggestions","ngModel","url","metadata","valid","ngModelOptions","ngModelChange","submitSuggestion","clickSuggestion","typeSuggestion","dsClickOutside","findSuggestions"],["suggestionControl","ngModel"],[1,"text-danger"],["type","textarea",1,"form-control",3,"ngModel","dsDebounce","ngModelChange","onDebounce"],["type","text",1,"form-control",3,"ngModel","dsDebounce","ngModelChange","onDebounce"],[1,"btn","btn-outline-primary","btn-sm",3,"disabled","title","click"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-success","btn-sm",3,"disabled","title","click"],[1,"fas","fa-check","fa-fw"]],template:function(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"td"),f["\u0275\u0275text"](1,"\n    "),f["\u0275\u0275elementStart"](2,"div",0),f["\u0275\u0275text"](3,"\n        "),f["\u0275\u0275template"](4,F,5,1,"div",1),f["\u0275\u0275pipe"](5,"async"),f["\u0275\u0275text"](6,"\n        "),f["\u0275\u0275template"](7,D,7,11,"div",2),f["\u0275\u0275pipe"](8,"async"),f["\u0275\u0275text"](9,"\n        "),f["\u0275\u0275template"](10,P,3,3,"small",3),f["\u0275\u0275pipe"](11,"async"),f["\u0275\u0275text"](12,"\n    "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](13,"\n"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](14,"\n"),f["\u0275\u0275elementStart"](15,"td",4),f["\u0275\u0275text"](16,"\n    "),f["\u0275\u0275elementStart"](17,"div",5),f["\u0275\u0275text"](18,"\n        "),f["\u0275\u0275template"](19,z,5,1,"div",1),f["\u0275\u0275pipe"](20,"async"),f["\u0275\u0275text"](21,"\n        "),f["\u0275\u0275template"](22,L,4,1,"div",2),f["\u0275\u0275pipe"](23,"async"),f["\u0275\u0275text"](24,"\n    "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](25,"\n"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](26,"\n"),f["\u0275\u0275elementStart"](27,"td",6),f["\u0275\u0275text"](28,"\n    "),f["\u0275\u0275elementStart"](29,"div",7),f["\u0275\u0275text"](30,"\n        "),f["\u0275\u0275template"](31,N,5,1,"div",1),f["\u0275\u0275pipe"](32,"async"),f["\u0275\u0275text"](33,"\n        "),f["\u0275\u0275template"](34,_,4,1,"div",2),f["\u0275\u0275pipe"](35,"async"),f["\u0275\u0275text"](36,"\n    "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](37,"\n"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](38,"\n"),f["\u0275\u0275elementStart"](39,"td",6),f["\u0275\u0275text"](40,"\n    "),f["\u0275\u0275elementStart"](41,"div",8),f["\u0275\u0275text"](42,"\n        "),f["\u0275\u0275template"](43,A,6,6,"button",9),f["\u0275\u0275pipe"](44,"async"),f["\u0275\u0275text"](45,"\n        "),f["\u0275\u0275template"](46,q,7,8,"button",10),f["\u0275\u0275pipe"](47,"async"),f["\u0275\u0275text"](48,"\n        "),f["\u0275\u0275elementStart"](49,"button",11),f["\u0275\u0275listener"]("click",(function(){return t.remove()})),f["\u0275\u0275pipe"](50,"async"),f["\u0275\u0275pipe"](51,"translate"),f["\u0275\u0275text"](52,"\n            "),f["\u0275\u0275element"](53,"i",12),f["\u0275\u0275text"](54,"\n        "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](55,"\n        "),f["\u0275\u0275elementStart"](56,"button",13),f["\u0275\u0275listener"]("click",(function(){return t.removeChangesFromField()})),f["\u0275\u0275pipe"](57,"async"),f["\u0275\u0275pipe"](58,"translate"),f["\u0275\u0275text"](59,"\n            "),f["\u0275\u0275element"](60,"i",14),f["\u0275\u0275text"](61,"\n        "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](62,"\n    "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](63,"\n"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](64,"\n")),2&e&&(f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("ngIf",!f["\u0275\u0275pipeBind1"](5,13,t.editable)),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngIf",f["\u0275\u0275pipeBind1"](8,15,t.editable)),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngIf",!1===f["\u0275\u0275pipeBind1"](11,17,t.valid)),f["\u0275\u0275advance"](9),f["\u0275\u0275property"]("ngIf",!f["\u0275\u0275pipeBind1"](20,19,t.editable)),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngIf",f["\u0275\u0275pipeBind1"](23,21,t.editable)),f["\u0275\u0275advance"](9),f["\u0275\u0275property"]("ngIf",!f["\u0275\u0275pipeBind1"](32,23,t.editable)),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngIf",f["\u0275\u0275pipeBind1"](35,25,t.editable)),f["\u0275\u0275advance"](9),f["\u0275\u0275property"]("ngIf",!f["\u0275\u0275pipeBind1"](44,27,t.editable)),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngIf",f["\u0275\u0275pipeBind1"](47,29,t.editable)),f["\u0275\u0275advance"](3),f["\u0275\u0275propertyInterpolate"]("title",f["\u0275\u0275pipeBind1"](51,33,"item.edit.metadata.edit.buttons.remove")),f["\u0275\u0275property"]("disabled",!f["\u0275\u0275pipeBind1"](50,31,t.canRemove())),f["\u0275\u0275advance"](7),f["\u0275\u0275propertyInterpolate"]("title",f["\u0275\u0275pipeBind1"](58,37,"item.edit.metadata.edit.buttons.undo")),f["\u0275\u0275property"]("disabled",!f["\u0275\u0275pipeBind1"](57,35,t.canUndo())))},directives:[O.u,M.a,B.a,V.NgControlStatus,V.NgModel,R.a,V.DefaultValueAccessor,U.a],pipes:[O.b,S.e],styles:[".btn[disabled][_ngcontent-%COMP%]{color:var(--bs-gray-600);border-color:var(--bs-gray-600);z-index:0}.metadata-field[_ngcontent-%COMP%]{width:var(--ds-edit-item-metadata-field-width)}.language-field[_ngcontent-%COMP%]{width:var(--ds-edit-item-language-field-width)}"]}),e})();var K=n("VYMa"),Q=n("snSO");function Y(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"button",14),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().reinstate()})),f["\u0275\u0275element"](1,"i",15),f["\u0275\u0275text"](2,"\n            "),f["\u0275\u0275elementStart"](3,"span",4),f["\u0275\u0275text"](4),f["\u0275\u0275pipe"](5,"translate"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](6,"\n        "),f["\u0275\u0275elementEnd"]()}2&e&&(f["\u0275\u0275advance"](4),f["\u0275\u0275textInterpolate1"]("\xa0",f["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function W(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"button",16),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().discard()})),f["\u0275\u0275pipe"](1,"async"),f["\u0275\u0275element"](2,"i",17),f["\u0275\u0275text"](3,"\n            "),f["\u0275\u0275elementStart"](4,"span",4),f["\u0275\u0275text"](5),f["\u0275\u0275pipe"](6,"translate"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](7,"\n        "),f["\u0275\u0275elementEnd"]()}if(2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275property"]("disabled",!f["\u0275\u0275pipeBind1"](1,2,e.hasChanges())),f["\u0275\u0275advance"](5),f["\u0275\u0275textInterpolate1"]("\xa0",f["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}const H=function(){return{}},G=function(e,t,n){return{"table-warning":e,"table-danger":t,"table-success":n}};function X(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"tr",21),f["\u0275\u0275text"](1,"\n\n        "),f["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=f["\u0275\u0275nextContext"](2);f["\u0275\u0275property"]("fieldUpdate",e||f["\u0275\u0275pureFunction0"](3,H))("url",n.url)("ngClass",f["\u0275\u0275pureFunction3"](4,G,0===e.changeType,2===e.changeType,1===e.changeType))}}function Z(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"table",18),f["\u0275\u0275text"](1,"\n        "),f["\u0275\u0275elementStart"](2,"tbody"),f["\u0275\u0275text"](3,"\n        "),f["\u0275\u0275elementStart"](4,"tr"),f["\u0275\u0275text"](5,"\n            "),f["\u0275\u0275elementStart"](6,"th"),f["\u0275\u0275text"](7),f["\u0275\u0275pipe"](8,"translate"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](9,"\n            "),f["\u0275\u0275elementStart"](10,"th"),f["\u0275\u0275text"](11),f["\u0275\u0275pipe"](12,"translate"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](13,"\n            "),f["\u0275\u0275elementStart"](14,"th",19),f["\u0275\u0275text"](15),f["\u0275\u0275pipe"](16,"translate"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](17,"\n            "),f["\u0275\u0275elementStart"](18,"th",19),f["\u0275\u0275text"](19),f["\u0275\u0275pipe"](20,"translate"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](21,"\n        "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](22,"\n        "),f["\u0275\u0275template"](23,X,2,8,"tr",20),f["\u0275\u0275pipe"](24,"dsObjectValues"),f["\u0275\u0275pipe"](25,"async"),f["\u0275\u0275text"](26,"\n        "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](27,"\n    "),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](7),f["\u0275\u0275textInterpolate"](f["\u0275\u0275pipeBind1"](8,6,"item.edit.metadata.headers.field")),f["\u0275\u0275advance"](4),f["\u0275\u0275textInterpolate"](f["\u0275\u0275pipeBind1"](12,8,"item.edit.metadata.headers.value")),f["\u0275\u0275advance"](4),f["\u0275\u0275textInterpolate"](f["\u0275\u0275pipeBind1"](16,10,"item.edit.metadata.headers.language")),f["\u0275\u0275advance"](4),f["\u0275\u0275textInterpolate"](f["\u0275\u0275pipeBind1"](20,12,"item.edit.metadata.headers.edit")),f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("ngForOf",f["\u0275\u0275pipeBind1"](24,14,f["\u0275\u0275pipeBind1"](25,16,e.updates$)))("ngForTrackBy",e.trackUpdate)}}function ee(e,t){if(1&e&&(f["\u0275\u0275elementStart"](0,"div"),f["\u0275\u0275text"](1,"\n      "),f["\u0275\u0275element"](2,"ds-alert",22),f["\u0275\u0275text"](3,"\n    "),f["\u0275\u0275elementEnd"]()),2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275advance"](2),f["\u0275\u0275property"]("content","item.edit.metadata.empty")("type",e.AlertTypeEnum.Info)}}function te(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"button",14),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().reinstate()})),f["\u0275\u0275element"](1,"i",15),f["\u0275\u0275text"](2),f["\u0275\u0275pipe"](3,"translate"),f["\u0275\u0275elementEnd"]()}2&e&&(f["\u0275\u0275advance"](2),f["\u0275\u0275textInterpolate1"](" ",f["\u0275\u0275pipeBind1"](3,1,"item.edit.metadata.reinstate-button"),"\n              "))}function ne(e,t){if(1&e){const e=f["\u0275\u0275getCurrentView"]();f["\u0275\u0275elementStart"](0,"button",16),f["\u0275\u0275listener"]("click",(function(){return f["\u0275\u0275restoreView"](e),f["\u0275\u0275nextContext"]().discard()})),f["\u0275\u0275pipe"](1,"async"),f["\u0275\u0275element"](2,"i",17),f["\u0275\u0275text"](3),f["\u0275\u0275pipe"](4,"translate"),f["\u0275\u0275elementEnd"]()}if(2&e){const e=f["\u0275\u0275nextContext"]();f["\u0275\u0275property"]("disabled",!f["\u0275\u0275pipeBind1"](1,2,e.hasChanges())),f["\u0275\u0275advance"](3),f["\u0275\u0275textInterpolate1"](" ",f["\u0275\u0275pipeBind1"](4,4,"item.edit.metadata.discard-button"),"\n              ")}}let ie=(()=>{class e extends c.a{constructor(e,t,n,i,a,r){super(e,t,n,i,a,r),this.itemService=e,this.objectUpdatesService=t,this.router=n,this.notificationsService=i,this.translateService=a,this.route=r,this.AlertTypeEnum=d.a}ngOnInit(){super.ngOnInit(),Object(l.a)(this.updateService)&&(this.updateService=this.itemService)}initializeUpdates(){this.updates$=this.objectUpdatesService.getFieldUpdates(this.url,this.item.metadataAsList)}initializeNotificationsPrefix(){this.notificationsPrefix="item.edit.metadata.notifications."}add(e=new o.d){this.objectUpdatesService.saveAddFieldUpdate(this.url,e)}initializeOriginalFields(){this.objectUpdatesService.initialize(this.url,this.item.metadataAsList,this.item.lastModified,v)}submit(){this.isValid().pipe(Object(a.a)()).subscribe(e=>{e?this.objectUpdatesService.createPatch(this.url).pipe(Object(a.a)(),Object(r.a)(e=>this.updateService.patch(this.item,e).pipe(Object(s.g)()))).subscribe(e=>{e.hasFailed?this.notificationsService.error(this.getNotificationTitle("error"),e.errorMessage):(this.item=e.payload,this.checkAndFixMetadataUUIDs(),this.initializeOriginalFields(),this.updates$=this.objectUpdatesService.getFieldUpdates(this.url,this.item.metadataAsList),this.notificationsService.success(this.getNotificationTitle("saved"),this.getNotificationContent("saved")))}):this.notificationsService.error(this.getNotificationTitle("invalid"),this.getNotificationContent("invalid"))})}checkAndFixMetadataUUIDs(){const e=Object(i.cloneDeep)(this.item.metadata);Object.keys(this.item.metadata).forEach(t=>{e[t]=this.item.metadata[t].map(e=>Object(l.b)(e.uuid)?e:Object.assign(new o.c,e))}),this.item.metadata=e}}return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275directiveInject"](g.a),f["\u0275\u0275directiveInject"](x.a),f["\u0275\u0275directiveInject"](y.g),f["\u0275\u0275directiveInject"](j.a),f["\u0275\u0275directiveInject"](S.f),f["\u0275\u0275directiveInject"](y.a))},e.\u0275cmp=f["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-metadata"]],inputs:{updateService:"updateService"},features:[f["\u0275\u0275InheritDefinitionFeature"]],decls:56,vars:39,consts:[[1,"item-metadata"],[1,"button-row","top","d-flex","mb-2"],[1,"mr-auto","btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-save"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","table table-responsive table-striped table-bordered",4,"ngIf"],[4,"ngIf"],[1,"button-row","bottom"],[1,"mt-2","float-right"],[1,"btn","btn-primary","mr-0",3,"disabled","click"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-undo-alt"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"table","table-responsive","table-striped","table-bordered"],[1,"text-center"],["ds-edit-in-place-field","",3,"fieldUpdate","url","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["ds-edit-in-place-field","",3,"fieldUpdate","url","ngClass"],[3,"content","type"]],template:function(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"div",0),f["\u0275\u0275text"](1,"\n    "),f["\u0275\u0275elementStart"](2,"div",1),f["\u0275\u0275text"](3,"\n        "),f["\u0275\u0275elementStart"](4,"button",2),f["\u0275\u0275listener"]("click",(function(){return t.add()})),f["\u0275\u0275element"](5,"i",3),f["\u0275\u0275text"](6,"\n            "),f["\u0275\u0275elementStart"](7,"span",4),f["\u0275\u0275text"](8),f["\u0275\u0275pipe"](9,"translate"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](10,"\n        "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](11,"\n        "),f["\u0275\u0275template"](12,Y,7,3,"button",5),f["\u0275\u0275pipe"](13,"async"),f["\u0275\u0275text"](14,"\n        "),f["\u0275\u0275elementStart"](15,"button",6),f["\u0275\u0275listener"]("click",(function(){return t.submit()})),f["\u0275\u0275pipe"](16,"async"),f["\u0275\u0275pipe"](17,"async"),f["\u0275\u0275element"](18,"i",7),f["\u0275\u0275text"](19,"\n            "),f["\u0275\u0275elementStart"](20,"span",4),f["\u0275\u0275text"](21),f["\u0275\u0275pipe"](22,"translate"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](23,"\n        "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](24,"\n        "),f["\u0275\u0275template"](25,W,8,6,"button",8),f["\u0275\u0275pipe"](26,"async"),f["\u0275\u0275text"](27,"\n    "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](28,"\n    "),f["\u0275\u0275template"](29,Z,28,18,"table",9),f["\u0275\u0275pipe"](30,"dsObjectValues"),f["\u0275\u0275pipe"](31,"async"),f["\u0275\u0275text"](32,"\n    "),f["\u0275\u0275template"](33,ee,4,2,"div",10),f["\u0275\u0275pipe"](34,"dsObjectValues"),f["\u0275\u0275pipe"](35,"async"),f["\u0275\u0275text"](36,"\n    "),f["\u0275\u0275elementStart"](37,"div",11),f["\u0275\u0275text"](38,"\n      "),f["\u0275\u0275elementStart"](39,"div",12),f["\u0275\u0275text"](40,"\n              "),f["\u0275\u0275template"](41,te,4,3,"button",5),f["\u0275\u0275pipe"](42,"async"),f["\u0275\u0275text"](43,"\n              "),f["\u0275\u0275elementStart"](44,"button",13),f["\u0275\u0275listener"]("click",(function(){return t.submit()})),f["\u0275\u0275pipe"](45,"async"),f["\u0275\u0275element"](46,"i",7),f["\u0275\u0275text"](47),f["\u0275\u0275pipe"](48,"translate"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](49,"\n              "),f["\u0275\u0275template"](50,ne,5,6,"button",8),f["\u0275\u0275pipe"](51,"async"),f["\u0275\u0275text"](52,"\n          "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](53,"\n      "),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](54,"\n"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275text"](55,"\n")),2&e&&(f["\u0275\u0275advance"](8),f["\u0275\u0275textInterpolate1"]("\xa0",f["\u0275\u0275pipeBind1"](9,11,"item.edit.metadata.add-button"),""),f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("ngIf",f["\u0275\u0275pipeBind1"](13,13,t.isReinstatable())),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("disabled",!f["\u0275\u0275pipeBind1"](16,15,t.hasChanges())||!f["\u0275\u0275pipeBind1"](17,17,t.isValid())),f["\u0275\u0275advance"](6),f["\u0275\u0275textInterpolate1"]("\xa0",f["\u0275\u0275pipeBind1"](22,19,"item.edit.metadata.save-button"),""),f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("ngIf",!f["\u0275\u0275pipeBind1"](26,21,t.isReinstatable())),f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("ngIf",f["\u0275\u0275pipeBind1"](30,23,f["\u0275\u0275pipeBind1"](31,25,t.updates$)).length>0),f["\u0275\u0275advance"](4),f["\u0275\u0275property"]("ngIf",0==f["\u0275\u0275pipeBind1"](34,27,f["\u0275\u0275pipeBind1"](35,29,t.updates$)).length),f["\u0275\u0275advance"](8),f["\u0275\u0275property"]("ngIf",f["\u0275\u0275pipeBind1"](42,31,t.isReinstatable())),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("disabled",!f["\u0275\u0275pipeBind1"](45,33,t.hasChanges())),f["\u0275\u0275advance"](3),f["\u0275\u0275textInterpolate1"](" ",f["\u0275\u0275pipeBind1"](48,35,"item.edit.metadata.save-button"),"\n              "),f["\u0275\u0275advance"](3),f["\u0275\u0275property"]("ngIf",!f["\u0275\u0275pipeBind1"](51,37,t.isReinstatable())))},directives:[O.u,O.t,J,O.r,K.a],pipes:[S.e,O.b,Q.a],styles:[".button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:calc(.5 * var(--bs-spacer))}.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}@media screen and (min-width:576px){.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:var(--ds-edit-item-button-min-width)}}.button-row.top[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-top:calc(var(--bs-spacer) / 2);margin-bottom:calc(var(--bs-spacer) / 2)}"]}),e})()},"8kTG":function(e,t,n){var i={"./custom/app/+search-page/search-page.component":["o4x0",54]};function a(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(i)},a.id="8kTG",e.exports=a},A0IO:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("J3qs"),a=n("q5u1"),r=n("8Y7J"),s=n("tv3Y");let o=(()=>{class e{constructor(e){this.breadcrumbService=e}resolve(e,t){const n=e.data.breadcrumbKey;if(Object(i.a)(n))throw new Error('You provided an i18nBreadcrumbResolver for url "'+e.url+"\" but no breadcrumbKey in the route's data");const r=Object(a.b)(e);return{provider:this.breadcrumbService,key:n,url:r}}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275inject"](s.a))},e.\u0275prov=r["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},GCaJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("zr/d"),a=n("LRne"),r=n("84Zn"),s=n("cBqT"),o=n("eIep"),c=n("lJxs"),l=n("J3qs"),d=n("TVZh"),p=n("8Y7J"),u=n("sfEo"),m=n("C765");let b=(()=>{class e{constructor(e,t){this.linkService=e,this.dsoNameService=t}getBreadcrumbs(e,t){const n=this.dsoNameService.getName(e),p=new i.a(n,t),u=e.getParentLinkKey();return this.linkService.resolveLink(e,Object(r.a)(u))[u].pipe(Object(s.a)(e=>e.hasSucceeded||204===e.statusCode),Object(o.a)(e=>{if(Object(l.b)(e.payload)){const t=e.payload;return this.getBreadcrumbs(t,Object(d.n)(t))}return Object(a.a)([])}),Object(c.a)(e=>[...e,p]))}}return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275inject"](u.a),p["\u0275\u0275inject"](m.a))},e.\u0275prov=p["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},HENg:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("1QIV"),a=n("lJxs"),r=n("J3qs"),s=n("a8lL");class o extends s.a{constructor(e,t,n,i){super(t,n,i),this.resolver=e,this.authorizationService=t,this.router=n,this.authService=i}getObjectUrl(e,t){const n=this.getRouteWithDSOId(e);return this.resolver.resolve(n,t).pipe(Object(i.d)(),Object(a.a)(e=>e.self))}getRouteWithDSOId(e){let t=e;for(;Object(r.a)(t.params.id)&&Object(r.b)(t.parent);)t=t.parent;return t}}},HQAL:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("SVse"),a=n("pKmL"),r=n("PCNd"),s=(n("FZ4K"),n("7LZ0")),o=n("mjBp"),c=(n("tVEM"),n("9i+i")),l=(n("ofZh"),n("2XvB")),d=n("kesd"),p=n("joI/"),u=n("N0eT"),m=n("udvk"),b=(n("TIQJ"),n("8Y7J"));let h=(()=>{class e{}return e.\u0275mod=b["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=b["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[s.a,l.a,d.c,o.a,p.a],imports:[[i.c,r.a.withEntryComponents(),a.a.forRoot(),c.a.forRoot(),u.a.withEntryComponents(),m.a.withEntryComponents()]]}),e})()},TIQJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("JTKQ"),a=n("8Y7J");function r(e,t){}let s=(()=>{class e extends i.a{getComponentName(){return"SearchPageComponent"}importThemedComponent(e){return n("8kTG")(`./${e}/app/+search-page/search-page.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(null,"ofZh"))}}return e.\u0275fac=function(t){return o(t||e)},e.\u0275cmp=a["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-themed-search-page"]],features:[a["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:0,consts:[["vcr",""]],template:function(e,t){1&e&&(a["\u0275\u0275template"](0,r,0,0,"ng-template",null,0,a["\u0275\u0275templateRefExtractor"]),a["\u0275\u0275text"](2,"\n"))},encapsulation:2}),e})();const o=a["\u0275\u0275getInheritedFactory"](s)},TtSl:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("0TMo"),a=n("LRne"),r=n("FU+A"),s=n("8Y7J"),o=n("Y2Xq"),c=n("1mcE"),l=n("iInd"),d=n("Vurf");let p=(()=>{class e extends i.a{constructor(e,t,n,i){super(e,t,n,i),this.resolver=e,this.authorizationService=t,this.router=n,this.authService=i}getFeatureID(e,t){return Object(a.a)(r.a.AdministratorOf)}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275inject"](o.a),s["\u0275\u0275inject"](c.a),s["\u0275\u0275inject"](l.g),s["\u0275\u0275inject"](d.a))},e.\u0275prov=s["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},Y2Xq:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("lJxs"),a=n("J3qs"),r=n("MEmd"),s=n("u0Hx"),o=n("8Y7J"),c=n("iqTE"),l=n("tqRt"),d=n("iInd");let p=(()=>{class e extends s.b{constructor(e,t,n){super(e,t,n),this.itemService=e,this.store=t,this.router=n}resolve(e,t){return super.resolve(e,t).pipe(Object(i.a)(e=>{if(e.hasSucceeded&&Object(a.b)(e.payload)){const n=Object(r.f)(e.payload),i=t.url;if(!i.startsWith(n)){const t=e.payload.uuid,a=i.substring(i.indexOf(t)+t.length,i.length);this.router.navigateByUrl(n+a)}}return e}))}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](c.a),o["\u0275\u0275inject"](l.h),o["\u0275\u0275inject"](d.g))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})()},bG9Y:function(e,t,n){"use strict";n.r(t),n.d(t,"EditItemPageModule",(function(){return mi}));var i=n("SVse"),a=n("PCNd"),r=n("iInd"),s=n("mEo1"),o=n("LRne"),c=n("itXk"),l=n("lJxs"),d=n("J3qs"),p=n("MEmd"),u=n("8Y7J"),m=n("G0yt"),b=n("TSSN");const h=function(e){return{active:e}},f=function(e){return[e]};function v(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"a",17),u["\u0275\u0275text"](1),u["\u0275\u0275pipe"](2,"translate"),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]().$implicit,t=u["\u0275\u0275nextContext"]();u["\u0275\u0275property"]("ngClass",u["\u0275\u0275pureFunction1"](5,h,e.page===t.currentPage))("routerLink",u["\u0275\u0275pureFunction1"](7,f,"./"+e.page)),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n                            ",u["\u0275\u0275pipeBind1"](2,3,"item.edit.tabs."+e.page+".head"),"\n                        ")}}function g(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"button",18),u["\u0275\u0275text"](1),u["\u0275\u0275pipe"](2,"translate"),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]().$implicit;u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n                                ",u["\u0275\u0275pipeBind1"](2,1,"item.edit.tabs."+e.page+".head"),"\n                            ")}}function x(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"li",13),u["\u0275\u0275text"](1,"\n                        "),u["\u0275\u0275template"](2,v,3,9,"a",14),u["\u0275\u0275pipe"](3,"async"),u["\u0275\u0275text"](4,"\n                        "),u["\u0275\u0275elementStart"](5,"span",15),u["\u0275\u0275pipe"](6,"translate"),u["\u0275\u0275text"](7,"\n                            "),u["\u0275\u0275template"](8,g,3,3,"button",16),u["\u0275\u0275pipe"](9,"async"),u["\u0275\u0275text"](10,"\n                        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](11,"\n                    "),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](3,3,e.enabled)),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngbTooltip",u["\u0275\u0275pipeBind1"](6,5,"item.edit.tabs.disabled.tooltip")),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngIf",!u["\u0275\u0275pipeBind1"](9,7,e.enabled))}}let y=(()=>{class e{constructor(e,t,n){this.route=e,this.router=t,this.injector=n,this.router.events.subscribe(()=>this.initPageParamsByRoute())}ngOnInit(){this.initPageParamsByRoute(),this.pages=this.route.routeConfig.children.filter(e=>Object(d.e)(e.path)).map(e=>{let t=Object(o.a)(!0);return Object(d.e)(e.canActivate)&&(t=Object(c.a)(e.canActivate.map(e=>this.injector.get(e).canActivate(this.route.snapshot,this.router.routerState.snapshot))).pipe(Object(l.a)(e=>e.every(e=>!0===e)))),{page:e.path,enabled:t}}),this.itemRD$=this.route.data.pipe(Object(l.a)(e=>e.dso))}getItemPage(e){return Object(p.f)(e)}initPageParamsByRoute(){this.currentPage=this.route.snapshot.firstChild.routeConfig.path}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](u.Injector))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-edit-item-page"]],decls:41,vars:10,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"border-bottom"],[1,"pt-2"],[1,"nav","nav-tabs","justify-content-start"],["class","nav-item",4,"ngFor","ngForOf"],[1,"tab-pane","active"],[1,"mb-4"],[1,"button-row","bottom"],[1,"text-right"],["role","button",1,"btn","btn-outline-secondary","mr-1",3,"routerLink"],[1,"fas","fa-arrow-left"],[1,"nav-item"],["class","nav-link",3,"ngClass","routerLink",4,"ngIf"],[3,"ngbTooltip"],["class","nav-link disabled",4,"ngIf"],[1,"nav-link",3,"ngClass","routerLink"],[1,"nav-link","disabled"]],template:function(e,t){var n;1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",1),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275elementStart"](4,"div",2),u["\u0275\u0275text"](5,"\n            "),u["\u0275\u0275elementStart"](6,"h2",3),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n            "),u["\u0275\u0275elementStart"](10,"div",4),u["\u0275\u0275text"](11,"\n                "),u["\u0275\u0275elementStart"](12,"ul",5),u["\u0275\u0275text"](13,"\n                    "),u["\u0275\u0275template"](14,x,12,9,"li",6),u["\u0275\u0275text"](15,"\n                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](16,"\n                "),u["\u0275\u0275elementStart"](17,"div",7),u["\u0275\u0275text"](18,"\n                    "),u["\u0275\u0275elementStart"](19,"div",8),u["\u0275\u0275text"](20,"\n                        "),u["\u0275\u0275element"](21,"router-outlet"),u["\u0275\u0275text"](22,"\n                    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n                    "),u["\u0275\u0275elementStart"](24,"div",9),u["\u0275\u0275text"](25,"\n                      "),u["\u0275\u0275elementStart"](26,"div",10),u["\u0275\u0275text"](27,"\n                        "),u["\u0275\u0275elementStart"](28,"a",11),u["\u0275\u0275pipe"](29,"async"),u["\u0275\u0275element"](30,"i",12),u["\u0275\u0275text"](31),u["\u0275\u0275pipe"](32,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](33,"\n                      "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](34,"\n                    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](35,"\n                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](36,"\n            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](37,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](38,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](39,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](40,"\n")),2&e&&(u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](8,4,"item.edit.head")),u["\u0275\u0275advance"](7),u["\u0275\u0275property"]("ngForOf",t.pages),u["\u0275\u0275advance"](14),u["\u0275\u0275property"]("routerLink",t.getItemPage(null==(n=u["\u0275\u0275pipeBind1"](29,6,t.itemRD$))?null:n.payload)),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"](" ",u["\u0275\u0275pipeBind1"](32,8,"item.edit.return"),""))},directives:[i.t,r.l,r.j,i.u,m.gb,i.r],pipes:[b.e,i.b],encapsulation:2,data:{animation:[s.a,s.c]},changeDetection:0}),e})();var j=n("1QIV"),S=n("SxV6"),O=n("lI3o"),I=n("iqTE"),C=n("3pMV");const w=function(e){return{id:e}},E=function(e){return[e,"edit"]};let k=(()=>{class e{constructor(e,t,n,i,a){this.route=e,this.router=t,this.notificationsService=n,this.itemDataService=i,this.translateService=a}ngOnInit(){this.itemRD$=this.route.data.pipe(Object(l.a)(e=>e.dso),Object(j.i)()),this.itemRD$.pipe(Object(S.a)()).subscribe(e=>{this.item=e.payload,this.itemPageRoute=Object(p.f)(this.item)}),this.confirmMessage="item.edit."+this.messageKey+".confirm",this.cancelMessage="item.edit."+this.messageKey+".cancel",this.headerMessage="item.edit."+this.messageKey+".header",this.descriptionMessage="item.edit."+this.messageKey+".description"}performAction(){}processRestResponse(e){var t;e.hasSucceeded?this.itemDataService.findById(this.item.id).pipe((t=this.predicate,e=>e.pipe(Object(j.c)(),Object(S.a)(t)))).subscribe(()=>{this.notificationsService.success(this.translateService.get("item.edit."+this.messageKey+".success")),this.router.navigate([Object(p.e)(this.item)])}):(this.notificationsService.error(this.translateService.get("item.edit."+this.messageKey+".error")),this.router.navigate([Object(p.e)(this.item)]))}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](O.a),u["\u0275\u0275directiveInject"](I.a),u["\u0275\u0275directiveInject"](b.f))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-simple-action"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",1),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275elementStart"](4,"div",2),u["\u0275\u0275text"](5,"\n            "),u["\u0275\u0275elementStart"](6,"h2"),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n            "),u["\u0275\u0275elementStart"](10,"p"),u["\u0275\u0275text"](11),u["\u0275\u0275pipe"](12,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n            "),u["\u0275\u0275element"](14,"ds-modify-item-overview",3),u["\u0275\u0275text"](15,"\n            "),u["\u0275\u0275elementStart"](16,"button",4),u["\u0275\u0275listener"]("click",(function(){return t.performAction()})),u["\u0275\u0275text"](17),u["\u0275\u0275pipe"](18,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](19,"\n            "),u["\u0275\u0275elementStart"](20,"button",5),u["\u0275\u0275text"](21),u["\u0275\u0275pipe"](22,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](25,"\n\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n")),2&e&&(u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind2"](8,6,t.headerMessage,u["\u0275\u0275pureFunction1"](15,w,t.item.handle))),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("item",t.item),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",u["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](17,E,t.itemPageRoute)),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n                ",u["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[C.a,r.h],pipes:[b.e],encapsulation:2}),e})();const M=function(e){return{id:e}},B=function(e){return[e,"edit"]};let V=(()=>{class e extends k{constructor(e,t,n,i,a){super(e,t,n,i,a),this.route=e,this.router=t,this.notificationsService=n,this.itemDataService=i,this.translateService=a,this.messageKey="withdraw",this.predicate=e=>e.payload.isWithdrawn}performAction(){this.itemDataService.setWithDrawn(this.item,!0).pipe(Object(j.g)()).subscribe(e=>{this.processRestResponse(e)})}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](O.a),u["\u0275\u0275directiveInject"](I.a),u["\u0275\u0275directiveInject"](b.f))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-withdraw"]],features:[u["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",1),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275elementStart"](4,"div",2),u["\u0275\u0275text"](5,"\n            "),u["\u0275\u0275elementStart"](6,"h2"),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n            "),u["\u0275\u0275elementStart"](10,"p"),u["\u0275\u0275text"](11),u["\u0275\u0275pipe"](12,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n            "),u["\u0275\u0275element"](14,"ds-modify-item-overview",3),u["\u0275\u0275text"](15,"\n            "),u["\u0275\u0275elementStart"](16,"button",4),u["\u0275\u0275listener"]("click",(function(){return t.performAction()})),u["\u0275\u0275text"](17),u["\u0275\u0275pipe"](18,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](19,"\n            "),u["\u0275\u0275elementStart"](20,"button",5),u["\u0275\u0275text"](21),u["\u0275\u0275pipe"](22,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](25,"\n\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n")),2&e&&(u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind2"](8,6,t.headerMessage,u["\u0275\u0275pureFunction1"](15,M,t.item.handle))),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("item",t.item),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",u["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](17,B,t.itemPageRoute)),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n                ",u["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[C.a,r.h],pipes:[b.e],encapsulation:2}),e})();const R=function(e){return{id:e}},U=function(e){return[e,"edit"]};let $=(()=>{class e extends k{constructor(e,t,n,i,a){super(e,t,n,i,a),this.route=e,this.router=t,this.notificationsService=n,this.itemDataService=i,this.translateService=a,this.messageKey="reinstate",this.predicate=e=>!e.payload.isWithdrawn}performAction(){this.itemDataService.setWithDrawn(this.item,!1).pipe(Object(j.g)()).subscribe(e=>{this.processRestResponse(e)})}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](O.a),u["\u0275\u0275directiveInject"](I.a),u["\u0275\u0275directiveInject"](b.f))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-reinstate"]],features:[u["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",1),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275elementStart"](4,"div",2),u["\u0275\u0275text"](5,"\n            "),u["\u0275\u0275elementStart"](6,"h2"),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n            "),u["\u0275\u0275elementStart"](10,"p"),u["\u0275\u0275text"](11),u["\u0275\u0275pipe"](12,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n            "),u["\u0275\u0275element"](14,"ds-modify-item-overview",3),u["\u0275\u0275text"](15,"\n            "),u["\u0275\u0275elementStart"](16,"button",4),u["\u0275\u0275listener"]("click",(function(){return t.performAction()})),u["\u0275\u0275text"](17),u["\u0275\u0275pipe"](18,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](19,"\n            "),u["\u0275\u0275elementStart"](20,"button",5),u["\u0275\u0275text"](21),u["\u0275\u0275pipe"](22,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](25,"\n\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n")),2&e&&(u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind2"](8,6,t.headerMessage,u["\u0275\u0275pureFunction1"](15,R,t.item.handle))),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("item",t.item),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",u["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](17,U,t.itemPageRoute)),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n                ",u["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[C.a,r.h],pipes:[b.e],encapsulation:2}),e})();const F=function(e){return{id:e}},T=function(e){return[e,"edit"]};let D=(()=>{class e extends k{constructor(e,t,n,i,a){super(e,t,n,i,a),this.route=e,this.router=t,this.notificationsService=n,this.itemDataService=i,this.translateService=a,this.messageKey="private",this.predicate=e=>!e.payload.isDiscoverable}performAction(){this.itemDataService.setDiscoverable(this.item,!1).pipe(Object(j.g)()).subscribe(e=>{this.processRestResponse(e)})}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](O.a),u["\u0275\u0275directiveInject"](I.a),u["\u0275\u0275directiveInject"](b.f))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-private"]],features:[u["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",1),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275elementStart"](4,"div",2),u["\u0275\u0275text"](5,"\n            "),u["\u0275\u0275elementStart"](6,"h2"),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n            "),u["\u0275\u0275elementStart"](10,"p"),u["\u0275\u0275text"](11),u["\u0275\u0275pipe"](12,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n            "),u["\u0275\u0275element"](14,"ds-modify-item-overview",3),u["\u0275\u0275text"](15,"\n            "),u["\u0275\u0275elementStart"](16,"button",4),u["\u0275\u0275listener"]("click",(function(){return t.performAction()})),u["\u0275\u0275text"](17),u["\u0275\u0275pipe"](18,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](19,"\n            "),u["\u0275\u0275elementStart"](20,"button",5),u["\u0275\u0275text"](21),u["\u0275\u0275pipe"](22,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](25,"\n\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n")),2&e&&(u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind2"](8,6,t.headerMessage,u["\u0275\u0275pureFunction1"](15,F,t.item.handle))),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("item",t.item),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",u["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](17,T,t.itemPageRoute)),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n                ",u["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[C.a,r.h],pipes:[b.e],encapsulation:2}),e})();const P=function(e){return{id:e}},z=function(e){return[e,"edit"]};let L=(()=>{class e extends k{constructor(e,t,n,i,a){super(e,t,n,i,a),this.route=e,this.router=t,this.notificationsService=n,this.itemDataService=i,this.translateService=a,this.messageKey="public",this.predicate=e=>e.payload.isDiscoverable}performAction(){this.itemDataService.setDiscoverable(this.item,!0).pipe(Object(j.g)()).subscribe(e=>{this.processRestResponse(e)})}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](O.a),u["\u0275\u0275directiveInject"](I.a),u["\u0275\u0275directiveInject"](b.f))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-public"]],features:[u["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",1),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275elementStart"](4,"div",2),u["\u0275\u0275text"](5,"\n            "),u["\u0275\u0275elementStart"](6,"h2"),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n            "),u["\u0275\u0275elementStart"](10,"p"),u["\u0275\u0275text"](11),u["\u0275\u0275pipe"](12,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n            "),u["\u0275\u0275element"](14,"ds-modify-item-overview",3),u["\u0275\u0275text"](15,"\n            "),u["\u0275\u0275elementStart"](16,"button",4),u["\u0275\u0275listener"]("click",(function(){return t.performAction()})),u["\u0275\u0275text"](17),u["\u0275\u0275pipe"](18,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](19,"\n            "),u["\u0275\u0275elementStart"](20,"button",5),u["\u0275\u0275text"](21),u["\u0275\u0275pipe"](22,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](25,"\n\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n")),2&e&&(u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind2"](8,6,t.headerMessage,u["\u0275\u0275pureFunction1"](15,P,t.item.handle))),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("item",t.item),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",u["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](17,z,t.itemPageRoute)),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n                ",u["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[C.a,r.h],pipes:[b.e],encapsulation:2}),e})();var N=n("eIep"),_=n("IzEk"),A=n("xbPD"),q=n("pLZG"),J=n("3jCq"),K=n("84Zn"),Q=n("loKC"),Y=n("kN8A"),W=n("bxbP"),H=n("sfEo"),G=n("O/5o"),X=n("1aCu");function Z(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"ds-listable-object-component-loader",23),u["\u0275\u0275text"](1,"\n                                        "),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]().ngVar,t=u["\u0275\u0275nextContext"](6);u["\u0275\u0275property"]("object",e)("viewMode",t.viewMode)}}function ee(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"ds-listable-object-component-loader",23),u["\u0275\u0275text"](1,"\n                                                    "),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"](2).ngVar,t=u["\u0275\u0275nextContext"](6);u["\u0275\u0275property"]("object",e)("viewMode",t.viewMode)}}function te(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275text"](1,"\n                                                        "),u["\u0275\u0275elementStart"](2,"div"),u["\u0275\u0275text"](3,"\n                                                            "),u["\u0275\u0275elementStart"](4,"div",29),u["\u0275\u0275text"](5),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n                                                            "),u["\u0275\u0275elementStart"](7,"div"),u["\u0275\u0275text"](8),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n                                                        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](10,"\n                                                    "),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\n                                                                ",e.metadataField,"\n                                                            "),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("\n                                                                ",e.metadataValue.value,"\n                                                            ")}}function ne(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275text"](0,"\n                                            "),u["\u0275\u0275elementStart"](1,"div"),u["\u0275\u0275text"](2,"\n                                                "),u["\u0275\u0275elementStart"](3,"div",24),u["\u0275\u0275text"](4),u["\u0275\u0275pipe"](5,"translate"),u["\u0275\u0275elementStart"](6,"button",25),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](7).closeVirtualMetadataModal()})),u["\u0275\u0275text"](7,"\n                                                        "),u["\u0275\u0275elementStart"](8,"span",26),u["\u0275\u0275text"](9,"\xd7"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](10,"\n                                                    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](11,"\n                                                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](12,"\n                                                "),u["\u0275\u0275elementStart"](13,"div",27),u["\u0275\u0275text"](14,"\n                                                    "),u["\u0275\u0275template"](15,ee,2,2,"ds-listable-object-component-loader",17),u["\u0275\u0275text"](16,"\n                                                    "),u["\u0275\u0275template"](17,te,11,2,"div",28),u["\u0275\u0275pipe"](18,"async"),u["\u0275\u0275text"](19,"\n                                                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](20,"\n                                            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](21,"\n                                        ")}if(2&e){const e=u["\u0275\u0275nextContext"]().ngVar,t=u["\u0275\u0275nextContext"]().$implicit,n=u["\u0275\u0275nextContext"](5);u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("\n                                                    ",u["\u0275\u0275pipeBind1"](5,3,"virtual-metadata.delete-item.modal-head"),"\n                                                    "),u["\u0275\u0275advance"](11),u["\u0275\u0275property"]("ngIf",e),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngForOf",u["\u0275\u0275pipeBind1"](18,5,n.getVirtualMetadata(t)))}}function ie(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n\n                                        "),u["\u0275\u0275template"](2,Z,2,2,"ds-listable-object-component-loader",17),u["\u0275\u0275text"](3,"\n                                        "),u["\u0275\u0275elementStart"](4,"div",18),u["\u0275\u0275text"](5,"\n                                            "),u["\u0275\u0275elementStart"](6,"div",19),u["\u0275\u0275text"](7,"\n                                                "),u["\u0275\u0275elementStart"](8,"button",20),u["\u0275\u0275listener"]("click",(function(){u["\u0275\u0275restoreView"](e);const t=u["\u0275\u0275reference"](16);return u["\u0275\u0275nextContext"](6).openVirtualMetadataModal(t)})),u["\u0275\u0275text"](9,"\n                                                    "),u["\u0275\u0275element"](10,"i",21),u["\u0275\u0275text"](11,"\n                                                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](12,"\n                                            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n                                        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](14,"\n\n                                        "),u["\u0275\u0275template"](15,ne,22,7,"ng-template",null,22,u["\u0275\u0275templateRefExtractor"]),u["\u0275\u0275text"](17,"\n\n                                    "),u["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=t.ngVar;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",e)}}function ae(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",11),u["\u0275\u0275text"](1,"\n                                    "),u["\u0275\u0275template"](2,ie,18,1,"ng-container",4),u["\u0275\u0275pipe"](3,"async"),u["\u0275\u0275text"](4,"\n                                "),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=u["\u0275\u0275nextContext"](5);u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngVar",u["\u0275\u0275pipeBind1"](3,1,n.getRelatedItem(e)))}}function re(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div",11),u["\u0275\u0275text"](1,"\n\n                            "),u["\u0275\u0275elementStart"](2,"div",12),u["\u0275\u0275listener"]("click",(function(){u["\u0275\u0275restoreView"](e);const n=t.ngVar,i=u["\u0275\u0275nextContext"]().$implicit;return u["\u0275\u0275nextContext"](3).setSelected(i,!n)})),u["\u0275\u0275text"](3,"\n                                "),u["\u0275\u0275elementStart"](4,"label"),u["\u0275\u0275text"](5,"\n                                    "),u["\u0275\u0275element"](6,"input",13),u["\u0275\u0275text"](7,"\n                                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](8,"\n                            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n\n                            "),u["\u0275\u0275elementStart"](10,"div",14),u["\u0275\u0275text"](11,"\n                                "),u["\u0275\u0275elementStart"](12,"h5",15),u["\u0275\u0275listener"]("click",(function(){u["\u0275\u0275restoreView"](e);const n=t.ngVar,i=u["\u0275\u0275nextContext"]().$implicit;return u["\u0275\u0275nextContext"](3).setSelected(i,!n)})),u["\u0275\u0275text"](13),u["\u0275\u0275pipe"](14,"translate"),u["\u0275\u0275pipe"](15,"async"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](16,"\n                                "),u["\u0275\u0275template"](17,ae,5,3,"div",16),u["\u0275\u0275pipe"](18,"async"),u["\u0275\u0275text"](19,"\n                            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](20,"\n\n                        "),u["\u0275\u0275elementEnd"]()}if(2&e){const e=t.ngVar,n=u["\u0275\u0275nextContext"]().$implicit,i=u["\u0275\u0275nextContext"](3);u["\u0275\u0275advance"](6),u["\u0275\u0275property"]("checked",e),u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate1"]("\n                                    ",u["\u0275\u0275pipeBind1"](14,3,i.getRelationshipMessageKey(u["\u0275\u0275pipeBind1"](15,5,i.getLabel(n)))),"\n                                "),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngForOf",u["\u0275\u0275pipeBind1"](18,7,i.getRelationships(n)))}}function se(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",8),u["\u0275\u0275text"](1,"\n\n                        "),u["\u0275\u0275template"](2,re,21,9,"div",10),u["\u0275\u0275pipe"](3,"async"),u["\u0275\u0275text"](4,"\n\n                    "),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=u["\u0275\u0275nextContext"](3);u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngVar",u["\u0275\u0275pipeBind1"](3,1,n.isSelected(e)))}}function oe(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",8),u["\u0275\u0275text"](1),u["\u0275\u0275pipe"](2,"translate"),u["\u0275\u0275template"](3,se,5,3,"div",9),u["\u0275\u0275text"](4,"\n\n                "),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]().ngVar;u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n\n                    ",u["\u0275\u0275pipeBind1"](2,2,"virtual-metadata.delete-item.info"),"\n\n                    "),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngForOf",e)}}function ce(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n\n                "),u["\u0275\u0275template"](2,oe,5,4,"div",7),u["\u0275\u0275text"](3,"\n\n            "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngVar;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",e&&e.length>0)}}const le=function(e){return{id:e}},de=function(e){return[e,"edit"]};let pe=(()=>{class e extends k{constructor(e,t,n,i,a,r,s,o,c,l){super(e,t,n,i,a),this.route=e,this.router=t,this.notificationsService=n,this.itemDataService=i,this.translateService=a,this.modalService=r,this.objectUpdatesService=s,this.relationshipService=o,this.entityTypeService=c,this.linkService=l,this.messageKey="delete",this.viewMode=J.a.ListElement,this.relationships$=new Map,this.relatedItems$=new Map,this.virtualMetadata$=new Map}ngOnInit(){super.ngOnInit(),this.url=this.router.url;const e=this.item.firstMetadataValue("dspace.entity.type");this.types$=void 0!==e?this.entityTypeService.getEntityTypeByLabel(e).pipe(Object(j.i)(),Object(j.o)(),Object(N.a)(e=>this.entityTypeService.getEntityTypeRelationships(e.id)),Object(j.i)(),Object(j.o)(),Object(l.a)(e=>e.page),Object(N.a)(e=>0===e.length?Object(o.a)(e):Object(c.a)(e.map(e=>this.getRelationships(e))).pipe(Object(l.a)(t=>e.reduce((e,n,i)=>e.some(e=>e.id===n.id)||0===t[i].length?e:[...e,n],[]))))):Object(o.a)([]),this.types$.pipe(Object(_.a)(1)).subscribe(e=>this.objectUpdatesService.initialize(this.url,e,this.item.lastModified))}openVirtualMetadataModal(e){this.modalRef=this.modalService.open(e)}closeVirtualMetadataModal(){this.modalRef.close()}getRelationshipMessageKey(e){return Object(d.b)(e)&&e.indexOf("Of")>-1?`relationships.${e.substring(0,e.indexOf("Of")+2)}`:e}getLabel(e){return this.getRelationships(e).pipe(Object(N.a)(t=>this.isLeftItem(t[0]).pipe(Object(l.a)(t=>t?e.leftwardType:e.rightwardType))))}getRelationships(e){return this.relationships$.has(e)||this.relationships$.set(e,this.relationshipService.getItemRelationshipsArray(this.item).pipe(Object(N.a)(t=>Object(c.a)(t.map(e=>this.getRelationshipType(e))).pipe(Object(A.a)([]),Object(l.a)(n=>t.filter((t,i)=>e.id===n[i].id)))))),this.relationships$.get(e)}getRelationshipType(e){return this.linkService.resolveLinks(e,Object(K.a)("relationshipType"),Object(K.a)("leftItem"),Object(K.a)("rightItem")),e.relationshipType.pipe(Object(j.i)(),Object(j.o)(),Object(q.a)(e=>Object(d.b)(e)&&Object(d.e)(e.uuid)))}getRelatedItem(e){return this.relatedItems$.has(e)||this.relatedItems$.set(e,this.isLeftItem(e).pipe(Object(N.a)(t=>t?e.rightItem:e.leftItem),Object(j.i)(),Object(j.o)())),this.relatedItems$.get(e)}getVirtualMetadata(e){return this.virtualMetadata$.has(e)||this.virtualMetadata$.set(e,this.getRelatedItem(e).pipe(Object(l.a)(t=>Object.entries(t.metadata).map(([t,n])=>n.filter(t=>t.authority&&t.authority.endsWith(e.id)).map(e=>({metadataField:t,metadataValue:e}))).reduce((e,t)=>e.concat(t))))),this.virtualMetadata$.get(e)}isLeftItem(e){return e.leftItem.pipe(Object(j.i)(),Object(j.o)(),Object(q.a)(e=>Object(d.b)(e)&&Object(d.e)(e.uuid)),Object(l.a)(e=>e.uuid===this.item.uuid))}isSelected(e){return this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.item.uuid,e.uuid)}setSelected(e,t){this.objectUpdatesService.setSelectedVirtualMetadata(this.url,this.item.uuid,e.uuid,t)}performAction(){this.types$.pipe(Object(N.a)(e=>Object(c.a)(e.map(e=>this.isSelected(e))).pipe(Object(A.a)([]),Object(l.a)(t=>e.filter((e,n)=>t[n])),Object(l.a)(e=>e.map(e=>e.id))))).subscribe(e=>{this.itemDataService.delete(this.item.id,e).pipe(Object(j.g)()).subscribe(e=>{this.notify(e.hasSucceeded)})})}notify(e){e?(this.notificationsService.success(this.translateService.get("item.edit."+this.messageKey+".success")),this.router.navigate([""])):(this.notificationsService.error(this.translateService.get("item.edit."+this.messageKey+".error")),this.router.navigate([Object(p.e)(this.item)]))}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](O.a),u["\u0275\u0275directiveInject"](I.a),u["\u0275\u0275directiveInject"](b.f),u["\u0275\u0275directiveInject"](m.u),u["\u0275\u0275directiveInject"](Q.a),u["\u0275\u0275directiveInject"](Y.a),u["\u0275\u0275directiveInject"](W.a),u["\u0275\u0275directiveInject"](H.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-delete"]],inputs:{url:"url"},features:[u["\u0275\u0275InheritDefinitionFeature"]],decls:30,vars:22,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[4,"ngVar"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"],["class","mb-4",4,"ngIf"],[1,"mb-4"],["class","mb-4",4,"ngFor","ngForOf"],["class","d-flex flex-row",4,"ngVar"],[1,"d-flex","flex-row"],[1,"m-2",3,"click"],["type","checkbox",3,"checked"],[1,"flex-column","flex-grow-1"],[3,"click"],["class","d-flex flex-row",4,"ngFor","ngForOf"],[3,"object","viewMode",4,"ngIf"],[1,"ml-auto"],[1,"btn-group"],[1,"btn","btn-outline-info","btn-sm",3,"click"],[1,"fas","fa-info","fa-fw"],["virtualMetadataModal",""],[3,"object","viewMode"],[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",1),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275elementStart"](4,"div",2),u["\u0275\u0275text"](5,"\n\n            "),u["\u0275\u0275elementStart"](6,"h2"),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n            "),u["\u0275\u0275elementStart"](10,"p"),u["\u0275\u0275text"](11),u["\u0275\u0275pipe"](12,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n            "),u["\u0275\u0275element"](14,"ds-modify-item-overview",3),u["\u0275\u0275text"](15,"\n\n            "),u["\u0275\u0275template"](16,ce,4,1,"ng-container",4),u["\u0275\u0275pipe"](17,"async"),u["\u0275\u0275text"](18,"\n\n            "),u["\u0275\u0275elementStart"](19,"button",5),u["\u0275\u0275listener"]("click",(function(){return t.performAction()})),u["\u0275\u0275text"](20),u["\u0275\u0275pipe"](21,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](22,"\n            "),u["\u0275\u0275elementStart"](23,"button",6),u["\u0275\u0275text"](24),u["\u0275\u0275pipe"](25,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](27,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](28,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](29,"\n")),2&e&&(u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind2"](8,7,t.headerMessage,u["\u0275\u0275pureFunction1"](18,le,t.item.handle))),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](12,10,t.descriptionMessage)),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("item",t.item),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngVar",u["\u0275\u0275pipeBind1"](17,12,t.types$)),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("",u["\u0275\u0275pipeBind1"](21,14,t.confirmMessage),"\n            "),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](20,de,t.itemPageRoute)),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n                ",u["\u0275\u0275pipeBind1"](25,16,t.cancelMessage),"\n            "))},directives:[C.a,G.a,r.h,i.u,i.t,X.a],pipes:[b.e,i.b],encapsulation:2}),e})();class ue{constructor(e,t,n,i=!1,a=!0){this.operationKey=e,this.operationUrl=t,this.featureID=n,this.authorized=a,this.setDisabled(i)}setDisabled(e){this.disabled=e}}var me=n("5+tZ"),be=n("/uUt"),he=n("IAdc"),fe=n("2Vo4"),ve=n("Cfvw"),ge=n("FU+A"),xe=n("1mcE");function ye(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"button",5),u["\u0275\u0275text"](3),u["\u0275\u0275pipe"](4,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](5,"\n  "),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("disabled",e.operation.disabled)("routerLink",e.operation.operationUrl),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n      ",u["\u0275\u0275pipeBind1"](4,3,"item.edit.tabs.status.buttons."+e.operation.operationKey+".button"),"\n    ")}}function je(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"span",6),u["\u0275\u0275pipe"](1,"translate"),u["\u0275\u0275text"](2,"\n    "),u["\u0275\u0275elementStart"](3,"button",7),u["\u0275\u0275text"](4),u["\u0275\u0275pipe"](5,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n  "),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275property"]("ngbTooltip",u["\u0275\u0275pipeBind1"](1,3,"item.edit.tabs.status.buttons.unauthorized")),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("disabled",!0),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n      ",u["\u0275\u0275pipeBind1"](5,5,"item.edit.tabs.status.buttons."+e.operation.operationKey+".button"),"\n    ")}}let Se=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-operation"]],inputs:{operation:"operation"},decls:14,vars:5,consts:[[1,"col-3","float-left","d-flex","h-100","action-label"],[1,"justify-content-center","align-self-center"],[1,"col-9","float-left","action-button"],[4,"ngIf"],[3,"ngbTooltip",4,"ngIf"],[1,"btn","btn-outline-primary",3,"disabled","routerLink"],[3,"ngbTooltip"],[1,"btn","btn-outline-primary",3,"disabled"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n      "),u["\u0275\u0275elementStart"](2,"span",1),u["\u0275\u0275text"](3),u["\u0275\u0275pipe"](4,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](5,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n"),u["\u0275\u0275elementStart"](7,"div",2),u["\u0275\u0275text"](8,"\n  "),u["\u0275\u0275template"](9,ye,6,5,"span",3),u["\u0275\u0275text"](10,"\n  "),u["\u0275\u0275template"](11,je,7,7,"span",4),u["\u0275\u0275text"](12,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n")),2&e&&(u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("\n        ",u["\u0275\u0275pipeBind1"](4,3,"item.edit.tabs.status.buttons."+t.operation.operationKey+".label"),"\n      "),u["\u0275\u0275advance"](6),u["\u0275\u0275property"]("ngIf",t.operation.authorized),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!t.operation.authorized))},directives:[i.u,r.h,m.gb],pipes:[b.e],encapsulation:2}),e})();function Oe(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",7),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",3),u["\u0275\u0275text"](3),u["\u0275\u0275pipe"](4,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](5,"\n    "),u["\u0275\u0275elementStart"](6,"div",8),u["\u0275\u0275text"](7),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](8,"\n  "),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("\n      ",u["\u0275\u0275pipeBind1"](4,3,"item.edit.tabs.status.labels."+e),":\n    "),u["\u0275\u0275advance"](3),u["\u0275\u0275propertyInterpolate1"]("id","status-",e,""),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n      ",n.statusData[e],"\n    ")}}function Ie(e,t){if(1&e&&u["\u0275\u0275element"](0,"ds-item-operation",11),2&e){const e=u["\u0275\u0275nextContext"]().$implicit;u["\u0275\u0275property"]("operation",e)}}const Ce=function(e){return{"pt-3":e}};function we(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",9),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275template"](2,Ie,1,1,"ds-item-operation",10),u["\u0275\u0275text"](3,"\n  "),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;u["\u0275\u0275property"]("ngClass",u["\u0275\u0275pureFunction1"](2,Ce,e)),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",e)}}let Ee=(()=>{class e{constructor(e,t){this.route=e,this.authorizationService=t,this.operations$=new fe.a([])}ngOnInit(){this.itemRD$=this.route.parent.data.pipe(Object(l.a)(e=>e.dso)),this.itemRD$.pipe(Object(S.a)(),Object(l.a)(e=>e.payload)).subscribe(e=>{this.statusData=Object.assign({id:e.id,handle:e.handle,lastModified:e.lastModified}),this.statusDataKeys=Object.keys(this.statusData);const t=[];t.push(new ue("authorizations",this.getCurrentUrl(e)+"/authorizations",ge.a.CanManagePolicies,!0)),t.push(new ue("mappedCollections",this.getCurrentUrl(e)+"/mapper",ge.a.CanManageMappings,!0)),t.push(e.isWithdrawn?new ue("reinstate",this.getCurrentUrl(e)+"/reinstate",ge.a.ReinstateItem,!0):new ue("withdraw",this.getCurrentUrl(e)+"/withdraw",ge.a.WithdrawItem,!0)),t.push(e.isDiscoverable?new ue("private",this.getCurrentUrl(e)+"/private",ge.a.CanMakePrivate,!0):new ue("public",this.getCurrentUrl(e)+"/public",ge.a.CanMakePrivate,!0)),t.push(new ue("delete",this.getCurrentUrl(e)+"/delete",ge.a.CanDelete,!0)),t.push(new ue("move",this.getCurrentUrl(e)+"/move",ge.a.CanMove,!0)),this.operations$.next(t),Object(ve.a)(t).pipe(Object(me.a)(t=>Object(d.b)(t.featureID)?this.authorizationService.isAuthorized(t.featureID,e.self).pipe(Object(be.a)(),Object(l.a)(e=>new ue(t.operationKey,t.operationUrl,t.featureID,!e,e))):[t]),Object(he.a)()).subscribe(e=>this.operations$.next(e))}),this.itemPageRoute$=this.itemRD$.pipe(Object(j.d)(),Object(l.a)(e=>Object(p.f)(e)))}getCurrentUrl(e){return Object(p.e)(e)}trackOperation(e,t){return Object(d.b)(t)?t.operationKey:void 0}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](xe.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-status"]],decls:24,vars:16,consts:[[1,"mt-2"],[1,"row"],["class","w-100",4,"ngFor","ngForOf"],[1,"col-3","float-left","status-label"],["id","status-itemPage",1,"col-9","float-left","status-data"],[3,"routerLink"],["class","w-100",3,"ngClass",4,"ngFor","ngForOf"],[1,"w-100"],[1,"col-9","float-left","status-data",3,"id"],[1,"w-100",3,"ngClass"],[3,"operation",4,"ngIf"],[3,"operation"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"p",0),u["\u0275\u0275text"](1),u["\u0275\u0275pipe"](2,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](3,"\n"),u["\u0275\u0275elementStart"](4,"div",1),u["\u0275\u0275text"](5,"\n  "),u["\u0275\u0275template"](6,Oe,9,5,"div",2),u["\u0275\u0275text"](7,"\n  "),u["\u0275\u0275elementStart"](8,"div",3),u["\u0275\u0275text"](9),u["\u0275\u0275pipe"](10,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](11,"\n  "),u["\u0275\u0275elementStart"](12,"div",4),u["\u0275\u0275text"](13,"\n    "),u["\u0275\u0275elementStart"](14,"a",5),u["\u0275\u0275pipe"](15,"async"),u["\u0275\u0275text"](16),u["\u0275\u0275pipe"](17,"async"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](18,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](19,"\n\n  "),u["\u0275\u0275template"](20,we,4,4,"div",6),u["\u0275\u0275pipe"](21,"async"),u["\u0275\u0275text"](22,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n")),2&e&&(u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](2,6,"item.edit.tabs.status.description")),u["\u0275\u0275advance"](5),u["\u0275\u0275property"]("ngForOf",t.statusDataKeys),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("\n    ",u["\u0275\u0275pipeBind1"](10,8,"item.edit.tabs.status.labels.itemPage"),":\n  "),u["\u0275\u0275advance"](5),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pipeBind1"](15,10,t.itemPageRoute$)),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](17,12,t.itemPageRoute$)),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngForOf",u["\u0275\u0275pipeBind1"](21,14,t.operations$)))},directives:[i.t,r.j,i.r,i.u,Se],pipes:[b.e,i.b],encapsulation:2,data:{animation:[s.a,s.c]}}),e})();var ke=n("5FsK"),Me=n("d/jG"),Be=n("1uah"),Ve=n("X8f1"),Re=n("g7AC");class Ue{constructor(e,t,n,i,a){this.xs=e,this.sm=t,this.md=n,this.lg=i,this.xl=a}buildClasses(){return`col-${this.xs} col-sm-${this.sm} col-md-${this.md} col-lg-${this.lg} col-xl-${this.xl}`}}class $e{constructor(e){this.columns=e}combineColumns(e,t){if(e<t&&Object(d.b)(this.columns[e])&&Object(d.b)(this.columns[t])){let n=this.columns[e].xs,i=this.columns[e].sm,a=this.columns[e].md,r=this.columns[e].lg,s=this.columns[e].xl;for(let o=e+1;o<t+1;o++)n+=this.columns[o].xs,i+=this.columns[o].sm,a+=this.columns[o].md,r+=this.columns[o].lg,s+=this.columns[o].xl;return new Ue(n,i,a,r,s)}}}var Fe=n("PCBh"),Te=n("mycY"),De=n("X/78"),Pe=n("yhw/");const ze=["handleView"];function Le(e,t){1&e&&(u["\u0275\u0275text"](0,"\n  "),u["\u0275\u0275elementStart"](1,"div",1),u["\u0275\u0275text"](2,"\n    "),u["\u0275\u0275element"](3,"i",2),u["\u0275\u0275pipe"](4,"translate"),u["\u0275\u0275text"](5,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n")),2&e&&(u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("title",u["\u0275\u0275pipeBind1"](4,1,"item.edit.bitstreams.edit.buttons.drag")))}let Ne=(()=>{class e{constructor(e){this.viewContainerRef=e}ngOnInit(){this.viewContainerRef.createEmbeddedView(this.handleView)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](u.ViewContainerRef))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-edit-bitstream-drag-handle"]],viewQuery:function(e,t){var n;1&e&&u["\u0275\u0275staticViewQuery"](ze,!0),2&e&&u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.handleView=n.first)},decls:3,vars:0,consts:[["handleView",""],[1,"drag-handle","text-muted","float-left","p-1","mr-2"],[1,"fas","fa-grip-vertical","fa-fw",3,"title"]],template:function(e,t){1&e&&(u["\u0275\u0275template"](0,Le,7,3,"ng-template",null,0,u["\u0275\u0275templateRefExtractor"]),u["\u0275\u0275text"](2,"\n"))},pipes:[b.e],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}"]}),e})();var _e=n("7DXY"),Ae=n("ltgo"),qe=n("Exvd"),Je=n("eReX"),Ke=n("snSO"),Qe=n("MFUF");let Ye=(()=>{class e{constructor(e,t,n,i){this.objectUpdatesService=e,this.elRef=t,this.objectValuesPipe=n,this.paginationService=i,this.dropObject=new u.EventEmitter,this.pageSize=10,this.options=Object.assign(new _e.a,{id:"dad",currentPage:1,pageSize:this.pageSize}),this.currentPage$=new fe.a(this.options),this.loading$=new fe.a(!1),this.subs=[]}ngOnInit(){this.initializeObjectsRD(),this.initializeURL(),this.initializeUpdates(),this.initializePagination()}initializePagination(){this.paginationService.getCurrentPagination(this.options.id,this.options).subscribe(e=>{this.currentPage$.next(e)})}initializeUpdates(){this.objectsRD$.pipe(Object(j.i)(),Object(j.s)()).subscribe(e=>{this.objectUpdatesService.initialize(this.url,e,new Date)}),this.updates$=this.objectsRD$.pipe(Object(j.c)(),Object(j.s)(),Object(N.a)(e=>this.objectUpdatesService.getFieldUpdatesExclusive(this.url,e))),this.subs.push(this.updates$.pipe(Object(l.a)(e=>this.objectValuesPipe.transform(e)),Object(be.a)(Object(Je.b)(e=>Object(d.b)(e)&&Object(d.b)(e.field)?e.field.uuid:void 0))).subscribe(e=>{this.customOrder=e.map(e=>e.field.uuid),this.loading$.next(!1)}),this.loading$.subscribe(e=>this.options.disabled=e))}drop(e){const t=e.previousIndex;let n=e.currentIndex;const i=this.currentPage$.value.currentPage-1;let a=this.currentPage$.value.currentPage-1;const r=this.elRef.nativeElement.querySelector(".page-item:hover");if(Object(d.b)(r)&&Object(d.b)(r.textContent)){const e=Number(r.textContent);Object(d.b)(e)&&!Number.isNaN(e)&&(a=e-1,n=0)}const s=i!==a;s||t===n||Object(Ae.h)(this.customOrder,t,n);const o=a+1,c=i*this.pageSize+t,l=a*this.pageSize+n;c!==l&&(s&&this.loading$.next(!0),this.dropObject.emit(Object.assign({fromIndex:c,toIndex:l,finish:()=>{s&&this.paginationComponent.doPageChange(o)}})))}ngOnDestroy(){this.subs.filter(e=>Object(d.b)(e)).forEach(e=>e.unsubscribe()),this.paginationService.clearPagination(this.options.id)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](Q.a),u["\u0275\u0275directiveInject"](u.ElementRef),u["\u0275\u0275directiveInject"](Ke.a),u["\u0275\u0275directiveInject"](Qe.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-paginated-drag-drop-abstract"]],viewQuery:function(e,t){var n;1&e&&u["\u0275\u0275viewQuery"](qe.a,!0),2&e&&u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.paginationComponent=n.first)},outputs:{dropObject:"dropObject"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();var We=n("LvDl"),He=n("C765");const Ge=["bitstreamView"],Xe=function(e){return["/bitstreams/",e,"edit"]};function Ze(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275text"](0,"\n  "),u["\u0275\u0275elementStart"](1,"div"),u["\u0275\u0275text"](2,"\n    "),u["\u0275\u0275projection"](3),u["\u0275\u0275text"](4,"\n    "),u["\u0275\u0275elementStart"](5,"div",1),u["\u0275\u0275text"](6),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](7,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](8,"\n  "),u["\u0275\u0275elementStart"](9,"div"),u["\u0275\u0275text"](10,"\n    "),u["\u0275\u0275elementStart"](11,"div",2),u["\u0275\u0275text"](12),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](14,"\n  "),u["\u0275\u0275elementStart"](15,"div"),u["\u0275\u0275text"](16,"\n    "),u["\u0275\u0275elementStart"](17,"div",3),u["\u0275\u0275text"](18),u["\u0275\u0275pipe"](19,"async"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](20,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](21,"\n  "),u["\u0275\u0275elementStart"](22,"div"),u["\u0275\u0275text"](23,"\n    "),u["\u0275\u0275elementStart"](24,"div",3),u["\u0275\u0275text"](25,"\n      "),u["\u0275\u0275elementStart"](26,"div",4),u["\u0275\u0275text"](27,"\n        "),u["\u0275\u0275elementStart"](28,"a",5),u["\u0275\u0275pipe"](29,"translate"),u["\u0275\u0275text"](30,"\n          "),u["\u0275\u0275element"](31,"i",6),u["\u0275\u0275text"](32,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](33,"\n        "),u["\u0275\u0275elementStart"](34,"button",7),u["\u0275\u0275pipe"](35,"translate"),u["\u0275\u0275text"](36,"\n          "),u["\u0275\u0275element"](37,"i",8),u["\u0275\u0275text"](38,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](39,"\n        "),u["\u0275\u0275elementStart"](40,"button",9),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().remove()})),u["\u0275\u0275pipe"](41,"translate"),u["\u0275\u0275text"](42,"\n          "),u["\u0275\u0275element"](43,"i",10),u["\u0275\u0275text"](44,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](45,"\n        "),u["\u0275\u0275elementStart"](46,"button",11),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().undo()})),u["\u0275\u0275pipe"](47,"translate"),u["\u0275\u0275text"](48,"\n          "),u["\u0275\u0275element"](49,"i",12),u["\u0275\u0275text"](50,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](51,"\n      "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](52,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](53,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](54,"\n")}if(2&e){const e=u["\u0275\u0275nextContext"]();var n;u["\u0275\u0275advance"](1),u["\u0275\u0275classMapInterpolate1"]("",e.columnSizes.columns[0].buildClasses()," row-element d-flex"),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\n      ",e.bitstreamName,"\n    "),u["\u0275\u0275advance"](3),u["\u0275\u0275classMapInterpolate1"]("",e.columnSizes.columns[1].buildClasses()," row-element d-flex align-items-center"),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("\n      ",null==e.bitstream?null:e.bitstream.firstMetadataValue("dc.description"),"\n    "),u["\u0275\u0275advance"](3),u["\u0275\u0275classMapInterpolate1"]("",e.columnSizes.columns[2].buildClasses()," row-element d-flex align-items-center"),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("\n      ",null==(n=u["\u0275\u0275pipeBind1"](19,23,e.format$))?null:n.shortDescription,"\n    "),u["\u0275\u0275advance"](4),u["\u0275\u0275classMapInterpolate1"]("",e.columnSizes.columns[3].buildClasses()," row-element d-flex align-items-center"),u["\u0275\u0275advance"](6),u["\u0275\u0275propertyInterpolate"]("title",u["\u0275\u0275pipeBind1"](29,25,"item.edit.bitstreams.edit.buttons.download")),u["\u0275\u0275property"]("href",null==e.bitstream||null==e.bitstream._links||null==e.bitstream._links.content?null:e.bitstream._links.content.href,u["\u0275\u0275sanitizeUrl"]),u["\u0275\u0275advance"](6),u["\u0275\u0275propertyInterpolate"]("title",u["\u0275\u0275pipeBind1"](35,27,"item.edit.bitstreams.edit.buttons.edit")),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](33,Xe,e.bitstream.id)),u["\u0275\u0275advance"](6),u["\u0275\u0275propertyInterpolate"]("title",u["\u0275\u0275pipeBind1"](41,29,"item.edit.bitstreams.edit.buttons.remove")),u["\u0275\u0275property"]("disabled",!e.canRemove()),u["\u0275\u0275advance"](6),u["\u0275\u0275propertyInterpolate"]("title",u["\u0275\u0275pipeBind1"](47,31,"item.edit.bitstreams.edit.buttons.undo")),u["\u0275\u0275property"]("disabled",!e.canUndo())}}const et=[[["","slot","drag-handle"]]],tt=["[slot=drag-handle]"];let nt=(()=>{class e{constructor(e,t,n){this.objectUpdatesService=e,this.dsoNameService=t,this.viewContainerRef=n}ngOnInit(){this.viewContainerRef.createEmbeddedView(this.bitstreamView)}ngOnChanges(e){this.bitstream=Object(We.cloneDeep)(this.fieldUpdate.field),this.bitstreamName=this.dsoNameService.getName(this.bitstream),this.format$=this.bitstream.format.pipe(Object(j.i)(),Object(j.o)())}remove(){this.objectUpdatesService.saveRemoveFieldUpdate(this.bundleUrl,this.bitstream)}undo(){this.objectUpdatesService.removeSingleFieldUpdate(this.bundleUrl,this.bitstream.uuid)}canRemove(){return this.fieldUpdate.changeType!==Ve.c.REMOVE}canUndo(){return this.fieldUpdate.changeType>=0}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](Q.a),u["\u0275\u0275directiveInject"](He.a),u["\u0275\u0275directiveInject"](u.ViewContainerRef))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-edit-bitstream"]],viewQuery:function(e,t){var n;1&e&&u["\u0275\u0275staticViewQuery"](Ge,!0),2&e&&u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.bitstreamView=n.first)},inputs:{fieldUpdate:"fieldUpdate",bundleUrl:"bundleUrl",columnSizes:"columnSizes"},features:[u["\u0275\u0275NgOnChangesFeature"]],ngContentSelectors:tt,decls:3,vars:0,consts:[["bitstreamView",""],[1,"float-left","d-flex","align-items-center"],[1,"w-100"],[1,"text-center","w-100"],[1,"btn-group","relationship-action-buttons"],[1,"btn","btn-outline-primary","btn-sm",3,"href","title"],[1,"fas","fa-download","fa-fw"],[1,"btn","btn-outline-primary","btn-sm",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"disabled","title","click"],[1,"fas","fa-undo-alt","fa-fw"]],template:function(e,t){1&e&&(u["\u0275\u0275projectionDef"](et),u["\u0275\u0275template"](0,Ze,55,35,"ng-template",null,0,u["\u0275\u0275templateRefExtractor"]),u["\u0275\u0275text"](2,"\n"))},directives:[r.h],pipes:[i.b,b.e],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}"]}),e})();var it=n("Frqi");const at=function(e,t,n,i){return{"table-warning":e,"table-danger":t,"table-success":n,"bg-white":i}};function rt(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",7),u["\u0275\u0275text"](1,"\n          "),u["\u0275\u0275elementStart"](2,"ds-item-edit-bitstream",8),u["\u0275\u0275text"](3,"\n            "),u["\u0275\u0275elementStart"](4,"div",9),u["\u0275\u0275text"](5,"\n              "),u["\u0275\u0275element"](6,"ds-item-edit-bitstream-drag-handle"),u["\u0275\u0275text"](7,"\n            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](8,"\n          "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n        "),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=u["\u0275\u0275nextContext"](2).ngVar,i=u["\u0275\u0275nextContext"](3);u["\u0275\u0275property"]("id",e)("ngClass",u["\u0275\u0275pureFunction4"](5,at,0===n[e].changeType,2===n[e].changeType,1===n[e].changeType,void 0===n[e].changeType)),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("fieldUpdate",n[e])("bundleUrl",i.bundle.self)("columnSizes",i.columnSizes)}}function st(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n        "),u["\u0275\u0275template"](2,rt,10,10,"div",6),u["\u0275\u0275text"](3,"\n      "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=u["\u0275\u0275nextContext"](4);u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngForOf",e.customOrder)}}const ot=function(e){return{"mb-3":e}};function ct(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div",5),u["\u0275\u0275listener"]("cdkDropListDropped",(function(t){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](3).drop(t)})),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275text"](2,"\n      "),u["\u0275\u0275template"](3,st,4,1,"ng-container",2),u["\u0275\u0275text"](4,"\n    "),u["\u0275\u0275elementEnd"]()}if(2&e){const e=t.ngVar,i=u["\u0275\u0275nextContext"](3);var n;u["\u0275\u0275property"]("id",i.bundle.id)("ngClass",u["\u0275\u0275pureFunction1"](5,ot,(null==(n=u["\u0275\u0275pipeBind1"](1,3,i.objectsRD$))||null==n.payload?null:n.payload.totalElements)>i.pageSize)),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngIf",e)}}function lt(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275template"](2,ct,5,7,"div",4),u["\u0275\u0275pipe"](3,"async"),u["\u0275\u0275text"](4,"\n  "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=u["\u0275\u0275nextContext"](2);u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngVar",u["\u0275\u0275pipeBind1"](3,1,e.updates$))}}function dt(e,t){1&e&&(u["\u0275\u0275element"](0,"ds-loading",10),u["\u0275\u0275pipe"](1,"translate")),2&e&&u["\u0275\u0275property"]("message",u["\u0275\u0275pipeBind1"](1,1,"loading.bitstreams"))}function pt(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"ds-pagination",1),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275pipe"](2,"async"),u["\u0275\u0275text"](3,"\n  "),u["\u0275\u0275template"](4,lt,5,3,"ng-container",2),u["\u0275\u0275pipe"](5,"async"),u["\u0275\u0275text"](6,"\n  "),u["\u0275\u0275template"](7,dt,2,3,"ds-loading",3),u["\u0275\u0275pipe"](8,"async"),u["\u0275\u0275text"](9,"\n"),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]();var n,i;u["\u0275\u0275property"]("hideGear",!0)("hidePagerWhenSinglePage",!0)("hidePaginationDetail",!0)("paginationOptions",e.options)("pageInfoState",null==(n=u["\u0275\u0275pipeBind1"](1,8,e.objectsRD$))?null:n.payload)("collectionSize",null==(i=u["\u0275\u0275pipeBind1"](2,10,e.objectsRD$))||null==i.payload?null:i.payload.totalElements),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngIf",!u["\u0275\u0275pipeBind1"](5,12,e.loading$)),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](8,14,e.loading$))}}let ut=(()=>{class e extends Ye{constructor(e,t,n,i,a,r){super(e,t,n,a),this.objectUpdatesService=e,this.elRef=t,this.objectValuesPipe=n,this.bundleService=i,this.paginationService=a,this.requestService=r}ngOnInit(){super.ngOnInit()}initializeObjectsRD(){this.objectsRD$=this.currentPage$.pipe(Object(N.a)(e=>{const t=new Re.a({pagination:Object.assign({},e)});return this.bundleService.getBitstreamsEndpoint(this.bundle.id,t).pipe(Object(N.a)(e=>this.requestService.hasByHref$(e)),Object(N.a)(()=>this.bundleService.getBitstreams(this.bundle.id,t,Object(K.a)("format"))))}))}initializeURL(){this.url=this.bundle.self}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](Q.a),u["\u0275\u0275directiveInject"](u.ElementRef),u["\u0275\u0275directiveInject"](Ke.a),u["\u0275\u0275directiveInject"](Pe.a),u["\u0275\u0275directiveInject"](Qe.a),u["\u0275\u0275directiveInject"](De.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-paginated-drag-and-drop-bitstream-list"]],inputs:{bundle:"bundle",columnSizes:"columnSizes"},features:[u["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:3,consts:[[3,"hideGear","hidePagerWhenSinglePage","hidePaginationDetail","paginationOptions","pageInfoState","collectionSize",4,"ngIf"],[3,"hideGear","hidePagerWhenSinglePage","hidePaginationDetail","paginationOptions","pageInfoState","collectionSize"],[4,"ngIf"],[3,"message",4,"ngIf"],["class","bundle-bitstreams-list","cdkDropList","",3,"id","ngClass","cdkDropListDropped",4,"ngVar"],["cdkDropList","",1,"bundle-bitstreams-list",3,"id","ngClass","cdkDropListDropped"],["class","row bitstream-row","cdkDrag","",3,"id","ngClass",4,"ngFor","ngForOf"],["cdkDrag","",1,"row","bitstream-row",3,"id","ngClass"],[3,"fieldUpdate","bundleUrl","columnSizes"],["slot","drag-handle","cdkDragHandle","",1,"d-flex","align-items-center"],[3,"message"]],template:function(e,t){var n;1&e&&(u["\u0275\u0275template"](0,pt,10,16,"ds-pagination",0),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275text"](2,"\n")),2&e&&u["\u0275\u0275property"]("ngIf",null==(n=u["\u0275\u0275pipeBind1"](1,1,t.objectsRD$))?null:n.payload)},directives:[i.u,qe.a,G.a,Ae.e,i.r,i.t,Ae.a,nt,Ae.b,Ne,it.a],pipes:[i.b,b.e],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}"]}),e})();const mt=["bundleView"],bt=function(e){return{name:e}},ht=function(e){return[e,"bitstreams","new"]},ft=function(e){return{bundle:e}};function vt(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275text"](0,"\n  "),u["\u0275\u0275elementStart"](1,"div",1),u["\u0275\u0275text"](2,"\n    "),u["\u0275\u0275elementStart"](3,"div"),u["\u0275\u0275text"](4,"\n      "),u["\u0275\u0275element"](5,"ds-item-edit-bitstream-drag-handle"),u["\u0275\u0275text"](6,"\n      "),u["\u0275\u0275elementStart"](7,"div",2),u["\u0275\u0275text"](8),u["\u0275\u0275pipe"](9,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](10,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](11,"\n    "),u["\u0275\u0275elementStart"](12,"div"),u["\u0275\u0275text"](13,"\n      "),u["\u0275\u0275elementStart"](14,"div",3),u["\u0275\u0275text"](15,"\n        "),u["\u0275\u0275elementStart"](16,"button",4),u["\u0275\u0275pipe"](17,"translate"),u["\u0275\u0275text"](18,"\n          "),u["\u0275\u0275element"](19,"i",5),u["\u0275\u0275text"](20,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](21,"\n      "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](22,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n  "),u["\u0275\u0275elementStart"](25,"ds-paginated-drag-and-drop-bitstream-list",6),u["\u0275\u0275listener"]("dropObject",(function(t){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().dropObject.emit(t)})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n")}if(2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](3),u["\u0275\u0275classMapInterpolate1"]("",e.bundleNameColumn.buildClasses()," font-weight-bold row-element d-flex"),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\n        ",u["\u0275\u0275pipeBind2"](9,12,"item.edit.bitstreams.bundle.name",u["\u0275\u0275pureFunction1"](17,bt,e.bundle.name)),"\n      "),u["\u0275\u0275advance"](4),u["\u0275\u0275classMapInterpolate1"]("",e.columnSizes.columns[3].buildClasses()," text-center row-element"),u["\u0275\u0275advance"](4),u["\u0275\u0275propertyInterpolate"]("title",u["\u0275\u0275pipeBind1"](17,15,"item.edit.bitstreams.bundle.edit.buttons.upload")),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](19,ht,e.itemPageRoute))("queryParams",u["\u0275\u0275pureFunction1"](21,ft,e.bundle.id)),u["\u0275\u0275advance"](9),u["\u0275\u0275property"]("bundle",e.bundle)("columnSizes",e.columnSizes)}}let gt=(()=>{class e{constructor(e){this.viewContainerRef=e,this.dropObject=new u.EventEmitter}ngOnInit(){this.bundleNameColumn=this.columnSizes.combineColumns(0,2),this.viewContainerRef.createEmbeddedView(this.bundleView),this.itemPageRoute=Object(p.f)(this.item)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](u.ViewContainerRef))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-edit-bitstream-bundle"]],viewQuery:function(e,t){var n;1&e&&u["\u0275\u0275staticViewQuery"](mt,!0),2&e&&u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.bundleView=n.first)},inputs:{bundle:"bundle",item:"item",columnSizes:"columnSizes"},outputs:{dropObject:"dropObject"},decls:3,vars:0,consts:[["bundleView",""],[1,"row","bundle-row"],[1,"float-left","d-flex","align-items-center"],[1,"btn-group","bundle-action-buttons"],[1,"btn","btn-outline-success","btn-sm",3,"routerLink","queryParams","title"],[1,"fas","fa-upload","fa-fw"],[3,"bundle","columnSizes","dropObject"]],template:function(e,t){1&e&&(u["\u0275\u0275template"](0,vt,27,23,"ng-template",null,0,u["\u0275\u0275templateRefExtractor"]),u["\u0275\u0275text"](2,"\n"))},directives:[Ne,r.h,ut],pipes:[b.e],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}"]}),e})();function xt(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",17),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](2).reinstate()})),u["\u0275\u0275element"](1,"i",18),u["\u0275\u0275text"](2,"\n      "),u["\u0275\u0275elementStart"](3,"span",5),u["\u0275\u0275text"](4),u["\u0275\u0275pipe"](5,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n    "),u["\u0275\u0275elementEnd"]()}2&e&&(u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](5,1,"item.edit.bitstreams.reinstate-button"),""))}function yt(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",19),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](2).discard()})),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275element"](2,"i",20),u["\u0275\u0275text"](3,"\n      "),u["\u0275\u0275elementStart"](4,"span",5),u["\u0275\u0275text"](5),u["\u0275\u0275pipe"](6,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](7,"\n    "),u["\u0275\u0275elementEnd"]()}if(2&e){const e=u["\u0275\u0275nextContext"](2);u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](1,2,e.hasChanges())||e.submitting),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](6,4,"item.edit.bitstreams.discard-button"),"")}}function jt(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"ds-item-edit-bitstream-bundle",24),u["\u0275\u0275listener"]("dropObject",(function(n){u["\u0275\u0275restoreView"](e);const i=t.$implicit;return u["\u0275\u0275nextContext"](3).dropBitstream(i,n)})),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=u["\u0275\u0275nextContext"](3);u["\u0275\u0275property"]("bundle",e)("item",n.item)("columnSizes",n.columnSizes)}}function St(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",21),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",22),u["\u0275\u0275text"](3,"\n      "),u["\u0275\u0275elementStart"](4,"div"),u["\u0275\u0275text"](5,"\n        "),u["\u0275\u0275element"](6,"ds-item-edit-bitstream-drag-handle"),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n      "),u["\u0275\u0275elementStart"](10,"div"),u["\u0275\u0275text"](11),u["\u0275\u0275pipe"](12,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n      "),u["\u0275\u0275elementStart"](14,"div"),u["\u0275\u0275text"](15),u["\u0275\u0275pipe"](16,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](17,"\n      "),u["\u0275\u0275elementStart"](18,"div"),u["\u0275\u0275text"](19),u["\u0275\u0275pipe"](20,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](21,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](22,"\n    "),u["\u0275\u0275template"](23,jt,2,3,"ds-item-edit-bitstream-bundle",23),u["\u0275\u0275text"](24,"\n  "),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]().ngVar,t=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](4),u["\u0275\u0275classMapInterpolate1"]("",t.columnSizes.columns[0].buildClasses()," row-element"),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("\n        ",u["\u0275\u0275pipeBind1"](8,17,"item.edit.bitstreams.headers.name"),"\n      "),u["\u0275\u0275advance"](3),u["\u0275\u0275classMapInterpolate1"]("",t.columnSizes.columns[1].buildClasses()," row-element"),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](12,19,"item.edit.bitstreams.headers.description")),u["\u0275\u0275advance"](3),u["\u0275\u0275classMapInterpolate1"]("",t.columnSizes.columns[2].buildClasses()," text-center row-element"),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](16,21,"item.edit.bitstreams.headers.format")),u["\u0275\u0275advance"](3),u["\u0275\u0275classMapInterpolate1"]("",t.columnSizes.columns[3].buildClasses()," text-center row-element"),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](20,23,"item.edit.bitstreams.headers.actions")),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngForOf",e)}}function Ot(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",25),u["\u0275\u0275text"](1),u["\u0275\u0275pipe"](2,"translate"),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n    ",u["\u0275\u0275pipeBind1"](2,1,"item.edit.bitstreams.empty"),"\n  "))}function It(e,t){1&e&&(u["\u0275\u0275element"](0,"ds-loading",26),u["\u0275\u0275pipe"](1,"translate")),2&e&&u["\u0275\u0275propertyInterpolate"]("message",u["\u0275\u0275pipeBind1"](1,1,"loading.bitstreams"))}function Ct(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",27),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](2).reinstate()})),u["\u0275\u0275element"](1,"i",18),u["\u0275\u0275text"](2,"\n        "),u["\u0275\u0275elementStart"](3,"span",5),u["\u0275\u0275text"](4),u["\u0275\u0275pipe"](5,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n      "),u["\u0275\u0275elementEnd"]()}2&e&&(u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](5,1,"item.edit.bitstreams.reinstate-button"),""))}function wt(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",19),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](2).discard()})),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275element"](2,"i",20),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275elementStart"](4,"span",5),u["\u0275\u0275text"](5),u["\u0275\u0275pipe"](6,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](7,"\n      "),u["\u0275\u0275elementEnd"]()}if(2&e){const e=u["\u0275\u0275nextContext"](2);u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](1,2,e.hasChanges())||e.submitting),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](6,4,"item.edit.bitstreams.discard-button"),"")}}const Et=function(e){return[e,"bitstreams","new"]};function kt(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div",1),u["\u0275\u0275text"](1,"\n  "),u["\u0275\u0275elementStart"](2,"div",2),u["\u0275\u0275text"](3,"\n    "),u["\u0275\u0275elementStart"](4,"button",3),u["\u0275\u0275element"](5,"i",4),u["\u0275\u0275text"](6,"\n      "),u["\u0275\u0275elementStart"](7,"span",5),u["\u0275\u0275text"](8),u["\u0275\u0275pipe"](9,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](10,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](11,"\n    "),u["\u0275\u0275template"](12,xt,7,3,"button",6),u["\u0275\u0275pipe"](13,"async"),u["\u0275\u0275text"](14,"\n    "),u["\u0275\u0275elementStart"](15,"button",7),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().submit()})),u["\u0275\u0275pipe"](16,"async"),u["\u0275\u0275element"](17,"i",8),u["\u0275\u0275text"](18,"\n      "),u["\u0275\u0275elementStart"](19,"span",5),u["\u0275\u0275text"](20),u["\u0275\u0275pipe"](21,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](22,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n    "),u["\u0275\u0275template"](24,yt,8,6,"button",9),u["\u0275\u0275pipe"](25,"async"),u["\u0275\u0275text"](26,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](27,"\n\n  "),u["\u0275\u0275template"](28,St,25,25,"div",10),u["\u0275\u0275text"](29,"\n  "),u["\u0275\u0275template"](30,Ot,3,3,"div",11),u["\u0275\u0275text"](31,"\n  "),u["\u0275\u0275template"](32,It,2,3,"ds-loading",12),u["\u0275\u0275text"](33,"\n\n  "),u["\u0275\u0275elementStart"](34,"div",13),u["\u0275\u0275text"](35,"\n    "),u["\u0275\u0275elementStart"](36,"div",14),u["\u0275\u0275text"](37,"\n      "),u["\u0275\u0275template"](38,Ct,7,3,"button",15),u["\u0275\u0275pipe"](39,"async"),u["\u0275\u0275text"](40,"\n      "),u["\u0275\u0275elementStart"](41,"button",16),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().submit()})),u["\u0275\u0275pipe"](42,"async"),u["\u0275\u0275element"](43,"i",8),u["\u0275\u0275text"](44,"\n        "),u["\u0275\u0275elementStart"](45,"span",5),u["\u0275\u0275text"](46),u["\u0275\u0275pipe"](47,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](48,"\n      "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](49,"\n      "),u["\u0275\u0275template"](50,wt,8,6,"button",9),u["\u0275\u0275pipe"](51,"async"),u["\u0275\u0275text"](52,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](53,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](54,"\n"),u["\u0275\u0275elementEnd"]()}if(2&e){const e=t.ngVar,n=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](31,Et,n.itemPageRoute)),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](9,13,"item.edit.bitstreams.upload-button"),""),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](13,15,n.isReinstatable())),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](16,17,n.hasChanges())||n.submitting),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](21,19,"item.edit.bitstreams.save-button"),""),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngIf",!u["\u0275\u0275pipeBind1"](25,21,n.isReinstatable())),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngIf",n.item&&(null==e?null:e.length)>0),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",0===(null==e?null:e.length)),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!e),u["\u0275\u0275advance"](6),u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](39,23,n.isReinstatable())),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](42,25,n.hasChanges())||n.submitting),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](47,27,"item.edit.bitstreams.save-button"),""),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngIf",!u["\u0275\u0275pipeBind1"](51,29,n.isReinstatable()))}}let Mt=(()=>{class e extends Me.a{constructor(e,t,n,i,a,r,s,o,c,l,d,p){super(e,t,n,i,a,r),this.itemService=e,this.objectUpdatesService=t,this.router=n,this.notificationsService=i,this.translateService=a,this.route=r,this.bitstreamService=s,this.objectCache=o,this.requestService=c,this.cdRef=l,this.bundleService=d,this.zone=p,this.bundlesOptions={id:"bundles-pagination-options",currentPage:1,pageSize:9999},this.columnSizes=new $e([new Ue(2,2,3,4,4),new Ue(2,3,3,3,3),new Ue(2,2,2,2,2),new Ue(6,5,4,3,3)]),this.submitting=!1}postItemInit(){this.bundles$=this.itemService.getBundles(this.item.id,new Re.a({pagination:this.bundlesOptions})).pipe(Object(j.i)(),Object(j.o)(),Object(l.a)(e=>e.page))}initializeNotificationsPrefix(){this.notificationsPrefix="item.edit.bitstreams.notifications."}submit(){this.submitting=!0,this.bundles$.pipe(Object(_.a)(1)).pipe(Object(N.a)(e=>Object(Be.a)(...e.map(e=>this.objectUpdatesService.getFieldUpdates(e.self,[],!0)))),Object(l.a)(e=>[].concat(...e.map(e=>Object.values(e).filter(e=>e.changeType===Ve.c.REMOVE)))),Object(l.a)(e=>e.map(e=>e.field))).pipe(Object(_.a)(1),Object(N.a)(e=>Object(d.e)(e)?Object(Be.a)(...e.map(e=>this.bitstreamService.delete(e.id))):Object(o.a)(void 0))).pipe(Object(_.a)(1)).subscribe(e=>{this.displayNotifications("item.edit.bitstreams.notifications.remove",e),this.reset(),this.submitting=!1})}dropBitstream(e,t){this.zone.runOutsideAngular(()=>{Object(d.b)(t)&&Object(d.b)(t.fromIndex)&&Object(d.b)(t.toIndex)&&Object(d.b)(t.finish)&&this.bundleService.patch(e,[{op:"move",from:`/_links/bitstreams/${t.fromIndex}/href`,path:`/_links/bitstreams/${t.toIndex}/href`}]).pipe(Object(_.a)(1)).subscribe(n=>{this.zone.run(()=>{this.displayNotifications("item.edit.bitstreams.notifications.move",[n]),this.requestService.removeByHrefSubstring(e.self).pipe(Object(q.a)(e=>e),Object(_.a)(1)).subscribe(()=>t.finish())})})})}displayNotifications(e,t){if(Object(d.e)(t)){const n=t.filter(e=>Object(d.b)(e)&&e.hasFailed),i=t.filter(e=>Object(d.b)(e)&&e.hasSucceeded);n.forEach(t=>{this.notificationsService.error(this.translateService.instant(`${e}.failed.title`),t.errorMessage)}),i.length>0&&this.notificationsService.success(this.translateService.instant(`${e}.saved.title`),this.translateService.instant(`${e}.saved.content`))}}discard(){const e=this.notificationsService.info(this.getNotificationTitle("discarded"),this.getNotificationContent("discarded"),{timeOut:this.discardTimeOut});this.objectUpdatesService.discardAllFieldUpdates(this.url,e)}reinstate(){this.bundles$.pipe(Object(_.a)(1)).subscribe(e=>{e.forEach(e=>{this.objectUpdatesService.reinstateFieldUpdates(e.self)})})}isReinstatable(){return this.bundles$.pipe(Object(N.a)(e=>Object(Be.a)(...e.map(e=>this.objectUpdatesService.isReinstatable(e.self)))),Object(l.a)(e=>e.includes(!0)))}hasChanges(){return this.bundles$.pipe(Object(N.a)(e=>Object(Be.a)(...e.map(e=>this.objectUpdatesService.hasUpdates(e.self)))),Object(l.a)(e=>e.includes(!0)))}reset(){this.refreshItemCache()}refreshItemCache(){this.bundles$.pipe(Object(_.a)(1)).subscribe(e=>{e.forEach(e=>{this.objectCache.remove(e.self),this.requestService.removeByHrefSubstring(e.self)}),this.objectCache.remove(this.item.self),this.requestService.removeByHrefSubstring(this.item.self)})}ngOnDestroy(){this.itemUpdateSubscription&&this.itemUpdateSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](I.a),u["\u0275\u0275directiveInject"](Q.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](O.a),u["\u0275\u0275directiveInject"](b.f),u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](Fe.a),u["\u0275\u0275directiveInject"](Te.a),u["\u0275\u0275directiveInject"](De.a),u["\u0275\u0275directiveInject"](u.ChangeDetectorRef),u["\u0275\u0275directiveInject"](Pe.a),u["\u0275\u0275directiveInject"](u.NgZone))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-bitstreams"]],features:[u["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:3,consts:[["class","item-bitstreams",4,"ngVar"],[1,"item-bitstreams"],[1,"button-row","top","d-flex","mt-2"],[1,"mr-auto","btn","btn-success",3,"routerLink"],[1,"fas","fa-upload"],[1,"d-none","d-sm-inline"],["class","btn btn-warning mr-1",3,"click",4,"ngIf"],[1,"btn","btn-primary","mr-1",3,"disabled","click"],[1,"fas","fa-save"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","container table-bordered mt-4",4,"ngIf"],["class","alert alert-info w-100 d-inline-block mt-4","role","alert",4,"ngIf"],[3,"message",4,"ngIf"],[1,"button-row","bottom"],[1,"mt-4","float-right"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-warning","mr-1",3,"click"],[1,"fas","fa-undo-alt"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"container","table-bordered","mt-4"],[1,"row","header-row","font-weight-bold"],[3,"bundle","item","columnSizes","dropObject",4,"ngFor","ngForOf"],[3,"bundle","item","columnSizes","dropObject"],["role","alert",1,"alert","alert-info","w-100","d-inline-block","mt-4"],[3,"message"],[1,"btn","btn-warning",3,"click"]],template:function(e,t){1&e&&(u["\u0275\u0275template"](0,kt,55,33,"div",0),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275text"](2,"\n")),2&e&&u["\u0275\u0275property"]("ngVar",u["\u0275\u0275pipeBind1"](1,1,t.bundles$))},directives:[G.a,r.h,i.u,Ne,i.t,gt,it.a],pipes:[i.b,b.e],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}"]}),e})();var Bt=n("JX91"),Vt=n("QhmN"),Rt=n("joI/"),Ut=n("gWc+"),$t=n("DNva"),Ft=n("f7iX"),Tt=n("DdXh");const Dt=["tabs"];function Pt(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275text"](0,"\n            "),u["\u0275\u0275elementStart"](1,"div",9),u["\u0275\u0275text"](2,"\n              "),u["\u0275\u0275elementStart"](3,"ds-collection-select",10),u["\u0275\u0275listener"]("confirm",(function(t){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().removeMappings(t)}))("cancel",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().onCancel()})),u["\u0275\u0275pipe"](4,"async"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](5,"\n            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n          ")}if(2&e){const e=u["\u0275\u0275nextContext"]();var n;u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("key","browse")("dsoRD$",e.itemCollectionsRD$)("paginationOptions",null==(n=u["\u0275\u0275pipeBind1"](4,6,e.searchOptions$))?null:n.pagination)("confirmButton","item.edit.item-mapper.buttons.remove")("cancelButton","item.edit.item-mapper.cancel")("dangerConfirm",!0)}}function zt(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275text"](1,"\n              "),u["\u0275\u0275elementStart"](2,"ds-collection-select",16),u["\u0275\u0275listener"]("confirm",(function(t){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](2).mapCollections(t)}))("cancel",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](2).onCancel()})),u["\u0275\u0275pipe"](3,"async"),u["\u0275\u0275pipe"](4,"async"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](5,"\n            "),u["\u0275\u0275elementEnd"]()}if(2&e){const e=u["\u0275\u0275nextContext"](2);var n,i;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("key","map")("dsoRD$",e.mappedCollectionsRD$)("paginationOptions",null==(n=u["\u0275\u0275pipeBind1"](3,6,e.searchOptions$))?null:n.pagination)("sortOptions",null==(i=u["\u0275\u0275pipeBind1"](4,8,e.searchOptions$))?null:i.sort)("confirmButton","item.edit.item-mapper.buttons.add")("cancelButton","item.edit.item-mapper.cancel")}}function Lt(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",17),u["\u0275\u0275text"](1),u["\u0275\u0275pipe"](2,"translate"),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n              ",u["\u0275\u0275pipeBind1"](2,1,"item.edit.item-mapper.no-search"),"\n            "))}function Nt(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275text"](0,"\n            "),u["\u0275\u0275elementStart"](1,"div",11),u["\u0275\u0275text"](2,"\n              "),u["\u0275\u0275elementStart"](3,"div",12),u["\u0275\u0275text"](4,"\n                "),u["\u0275\u0275elementStart"](5,"ds-search-form",13),u["\u0275\u0275listener"]("submitSearch",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().performedSearch=!0})),u["\u0275\u0275pipe"](6,"async"),u["\u0275\u0275pipe"](7,"translate"),u["\u0275\u0275text"](8,"\n                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n              "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](10,"\n            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](11,"\n\n            "),u["\u0275\u0275template"](12,zt,6,10,"div",14),u["\u0275\u0275text"](13,"\n            "),u["\u0275\u0275template"](14,Lt,3,3,"div",15),u["\u0275\u0275text"](15,"\n          ")}if(2&e){const e=u["\u0275\u0275nextContext"]();var n;u["\u0275\u0275advance"](5),u["\u0275\u0275property"]("query",null==(n=u["\u0275\u0275pipeBind1"](6,6,e.searchOptions$))?null:n.query)("currentUrl","./")("inPlaceSearch",!0)("searchPlaceholder",u["\u0275\u0275pipeBind1"](7,8,"item.edit.item-mapper.search-form.placeholder")),u["\u0275\u0275advance"](7),u["\u0275\u0275property"]("ngIf",e.performedSearch),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!e.performedSearch)}}const _t=function(e){return{name:e}};let At=(()=>{class e{constructor(e,t,n,i,a,r,s,o,c){this.route=e,this.router=t,this.searchConfigService=n,this.searchService=i,this.notificationsService=a,this.itemDataService=r,this.collectionDataService=s,this.translateService=o,this.dsoNameService=c,this.performedSearch=!1}ngOnInit(){this.itemRD$=this.route.parent.data.pipe(Object(_.a)(1),Object(l.a)(e=>e.dso)),this.itemName$=this.itemRD$.pipe(Object(q.a)(e=>Object(d.b)(e)),Object(l.a)(e=>this.dsoNameService.getName(e.payload))),this.searchOptions$=this.searchConfigService.paginatedSearchOptions,this.loadCollectionLists()}loadCollectionLists(){console.log("loadCollectionLists"),this.shouldUpdate$=new fe.a(!0),this.itemCollectionsRD$=Object(c.a)(this.itemRD$.pipe(Object(j.j)()),this.shouldUpdate$).pipe(Object(N.a)(([e,t])=>(!0===t&&this.shouldUpdate$.next(!1),this.collectionDataService.findAllByHref(this.itemDataService.getMappedCollectionsEndpoint(e.id),void 0,!t,!1).pipe(Object(j.c)()))));const e=this.itemRD$.pipe(Object(j.j)(),Object(N.a)(e=>this.collectionDataService.findOwningCollectionFor(e)),Object(j.c)()),t=Object(c.a)(this.itemCollectionsRD$,e,this.searchOptions$);this.mappedCollectionsRD$=t.pipe(Object(N.a)(([e,t,n])=>this.searchService.search(Object.assign(new Re.a(n),{query:this.buildQuery([...e.payload.page,t.payload],n.query),dsoTypes:[Vt.a.COLLECTION]}),1e4).pipe(Object(j.y)(),Object(Bt.a)(void 0))))}mapCollections(e){const t=Object(c.a)([this.itemRD$.pipe(Object(j.i)(),Object(l.a)(e=>e.payload),Object(l.a)(e=>e.id)),this.itemCollectionsRD$.pipe(Object(j.i)(),Object(l.a)(e=>e.payload.page),Object(l.a)(e=>e.map(e=>e.id)))]).pipe(Object(N.a)(([t,n])=>Object(c.a)(this.filterIds(e,n).map(e=>this.itemDataService.mapToCollection(t,e).pipe(Object(j.g)())))));this.showNotifications(t,"item.edit.item-mapper.notifications.add")}removeMappings(e){const t=this.itemRD$.pipe(Object(j.i)(),Object(l.a)(e=>e.payload.id),Object(N.a)(t=>Object(c.a)(e.map(e=>this.itemDataService.removeMappingFromCollection(t,e).pipe(Object(j.g)())))));this.showNotifications(t,"item.edit.item-mapper.notifications.remove")}filterIds(e,t){return e.filter(e=>t.indexOf(e)<0)}showNotifications(e,t){e.subscribe(e=>{const n=e.filter(e=>e.hasSucceeded),i=e.filter(e=>e.hasFailed);n.length>0&&(Object(c.a)([this.translateService.get(`${t}.success.head`),this.translateService.get(`${t}.success.content`,{amount:n.length})]).subscribe(([e,t])=>{this.notificationsService.success(e,t)}),this.shouldUpdate$.next(!0)),i.length>0&&Object(c.a)([this.translateService.get(`${t}.error.head`),this.translateService.get(`${t}.error.content`,{amount:i.length})]).subscribe(([e,t])=>{this.notificationsService.error(e,t)}),this.switchToFirstTab()})}tabChange(e){this.performedSearch=!1,this.router.navigateByUrl(this.getCurrentUrl())}getCurrentUrl(){return this.router.url.indexOf("?")>-1?this.router.url.substring(0,this.router.url.indexOf("?")):this.router.url}buildQuery(e,t){let n=t;for(const i of e)n=this.addExcludeCollection(i.id,n);return n}addExcludeCollection(e,t){const n=`-search.resourceid:${e}`;return Object(d.e)(t)?`${t} AND ${n}`:n}switchToFirstTab(){this.tabs.select("browseTab")}onCancel(){this.itemRD$.pipe(Object(j.i)(),Object(j.o)(),Object(_.a)(1)).subscribe(e=>{this.router.navigate([Object(p.f)(e)])})}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](Rt.a),u["\u0275\u0275directiveInject"](Ut.a),u["\u0275\u0275directiveInject"](O.a),u["\u0275\u0275directiveInject"](I.a),u["\u0275\u0275directiveInject"]($t.a),u["\u0275\u0275directiveInject"](b.f),u["\u0275\u0275directiveInject"](He.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-collection-mapper"]],viewQuery:function(e,t){var n;1&e&&u["\u0275\u0275viewQuery"](Dt,!0),2&e&&u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.tabs=n.first)},decls:37,vars:21,consts:[[1,"container"],[1,"row"],[1,"col-12"],["id","item-name",3,"innerHTML"],[3,"destroyOnHide","tabChange"],["tabs","ngbTabset"],["id","browseTab",3,"title"],["ngbTabContent",""],["id","mapTab",3,"title"],[1,"mt-2"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","confirmButton","cancelButton","dangerConfirm","confirm","cancel"],[1,"row","mt-2"],[1,"col-12","col-lg-6"],["id","search-form",3,"query","currentUrl","inPlaceSearch","searchPlaceholder","submitSearch"],[4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","sortOptions","confirmButton","cancelButton","confirm","cancel"],["role","alert",1,"alert","alert-info","w-100"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n  "),u["\u0275\u0275elementStart"](2,"div",1),u["\u0275\u0275text"](3,"\n    "),u["\u0275\u0275elementStart"](4,"div",2),u["\u0275\u0275text"](5,"\n      "),u["\u0275\u0275elementStart"](6,"h2"),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n      "),u["\u0275\u0275element"](10,"p",3),u["\u0275\u0275pipe"](11,"translate"),u["\u0275\u0275pipe"](12,"async"),u["\u0275\u0275text"](13,"\n      "),u["\u0275\u0275elementStart"](14,"p"),u["\u0275\u0275text"](15),u["\u0275\u0275pipe"](16,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](17,"\n\n      "),u["\u0275\u0275elementStart"](18,"ngb-tabset",4,5),u["\u0275\u0275listener"]("tabChange",(function(e){return t.tabChange(e)})),u["\u0275\u0275text"](20,"\n        "),u["\u0275\u0275elementStart"](21,"ngb-tab",6),u["\u0275\u0275pipe"](22,"translate"),u["\u0275\u0275text"](23,"\n          "),u["\u0275\u0275template"](24,Pt,7,8,"ng-template",7),u["\u0275\u0275text"](25,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n        "),u["\u0275\u0275elementStart"](27,"ngb-tab",8),u["\u0275\u0275pipe"](28,"translate"),u["\u0275\u0275text"](29,"\n          "),u["\u0275\u0275template"](30,Nt,16,10,"ng-template",7),u["\u0275\u0275text"](31,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](32,"\n      "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](33,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](34,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](35,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](36,"\n")),2&e&&(u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](8,6,"item.edit.item-mapper.head")),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("innerHTML",u["\u0275\u0275pipeBind2"](11,8,"item.edit.item-mapper.item",u["\u0275\u0275pureFunction1"](19,_t,u["\u0275\u0275pipeBind1"](12,11,t.itemName$))),u["\u0275\u0275sanitizeHtml"]),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](16,13,"item.edit.item-mapper.description")),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("destroyOnHide",!0),u["\u0275\u0275advance"](3),u["\u0275\u0275propertyInterpolate"]("title",u["\u0275\u0275pipeBind1"](22,15,"item.edit.item-mapper.tabs.browse")),u["\u0275\u0275advance"](6),u["\u0275\u0275propertyInterpolate"]("title",u["\u0275\u0275pipeBind1"](28,17,"item.edit.item-mapper.tabs.map")))},directives:[m.ab,m.X,m.Y,Ft.a,Tt.a,i.u],pipes:[b.e,i.b],styles:[""],data:{animation:[s.a,s.c]},changeDetection:0}),e})();var qt=n("Kr+g"),Jt=n("s7LF");function Kt(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1),u["\u0275\u0275pipe"](2,"translate"),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"](" ",u["\u0275\u0275pipeBind1"](2,1,"item.edit.move.move"),""))}function Qt(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275element"](1,"i",10),u["\u0275\u0275text"](2),u["\u0275\u0275pipe"](3,"translate"),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate1"]("\n                    ",u["\u0275\u0275pipeBind1"](3,1,"item.edit.move.processing"),"\n                "))}const Yt=function(e){return{id:e}},Wt=function(e){return[e,"edit"]};let Ht=(()=>{class e{constructor(e,t,n,i,a,r){this.route=e,this.router=t,this.notificationsService=n,this.itemDataService=i,this.searchService=a,this.translateService=r,this.selectorType=Vt.a.COLLECTION,this.inheritPolicies=!1,this.collectionSearchResults=Object(o.a)([]),this.canSubmit=!1,this.processing=!1,this.pagination=new _e.a}ngOnInit(){this.itemRD$=this.route.data.pipe(Object(l.a)(e=>e.dso),Object(j.i)()),this.itemPageRoute$=this.itemRD$.pipe(Object(j.d)(),Object(l.a)(e=>Object(p.f)(e))),this.itemRD$.subscribe(e=>{this.item=e.payload}),this.pagination.pageSize=5,this.loadSuggestions("")}findSuggestions(e){this.loadSuggestions(e)}loadSuggestions(e){this.collectionSearchResults=this.searchService.search(new Re.a({pagination:this.pagination,dsoTypes:[Vt.a.COLLECTION],query:e})).pipe(Object(S.a)(),Object(l.a)(e=>e.payload.page.map(e=>e.indexableObject)))}onClick(e){this.selectedCollection=e,this.selectedCollectionName=e.name,this.canSubmit=!0}getCurrentUrl(){return this.router.url}moveCollection(){this.processing=!0,this.itemDataService.moveToCollection(this.item.id,this.selectedCollection).pipe(Object(j.g)()).subscribe(e=>{this.router.navigate([Object(p.e)(this.item)]),e.hasSucceeded?this.notificationsService.success(this.translateService.get("item.edit.move.success")):this.notificationsService.error(this.translateService.get("item.edit.move.error")),this.processing=!1})}resetCollection(e){this.canSubmit=!1}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](O.a),u["\u0275\u0275directiveInject"](I.a),u["\u0275\u0275directiveInject"](Ut.a),u["\u0275\u0275directiveInject"](b.f))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-move"]],decls:61,vars:38,consts:[[1,"container"],[1,"row"],[1,"col-12"],["id","search-form","ngDefaultControl","",3,"suggestions","placeholder","action","name","ngModel","ngModelChange","clickSuggestion","typeSuggestion","findSuggestions","click"],["f",""],["type","checkbox","name","tc","id","inheritPoliciesCheckbox",3,"ngModel","ngModelChange"],["for","inheritPoliciesCheckbox"],[1,"btn","btn-primary",3,"disabled","click"],[4,"ngIf"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-circle-notch","fa-spin"]],template:function(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",1),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275elementStart"](4,"div",2),u["\u0275\u0275text"](5,"\n            "),u["\u0275\u0275elementStart"](6,"h2"),u["\u0275\u0275text"](7),u["\u0275\u0275pipe"](8,"translate"),u["\u0275\u0275pipe"](9,"async"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](10,"\n            "),u["\u0275\u0275elementStart"](11,"p"),u["\u0275\u0275text"](12),u["\u0275\u0275pipe"](13,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](14,"\n            "),u["\u0275\u0275elementStart"](15,"div",1),u["\u0275\u0275text"](16,"\n                "),u["\u0275\u0275elementStart"](17,"div",2),u["\u0275\u0275text"](18,"\n                    "),u["\u0275\u0275elementStart"](19,"ds-dso-input-suggestions",3,4),u["\u0275\u0275listener"]("ngModelChange",(function(e){return t.selectedCollectionName=e}))("clickSuggestion",(function(e){return t.onClick(e)}))("typeSuggestion",(function(e){return t.resetCollection(e)}))("findSuggestions",(function(e){return t.findSuggestions(e)}))("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275reference"](20).open()})),u["\u0275\u0275pipe"](21,"async"),u["\u0275\u0275pipe"](22,"translate"),u["\u0275\u0275text"](23,"\n                    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n\n                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](25,"\n            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n            "),u["\u0275\u0275elementStart"](27,"div",1),u["\u0275\u0275text"](28,"\n                "),u["\u0275\u0275elementStart"](29,"div",2),u["\u0275\u0275text"](30,"\n                    "),u["\u0275\u0275elementStart"](31,"p"),u["\u0275\u0275text"](32,"\n                        "),u["\u0275\u0275elementStart"](33,"input",5),u["\u0275\u0275listener"]("ngModelChange",(function(e){return t.inheritPolicies=e})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](34,"\n                        "),u["\u0275\u0275elementStart"](35,"label",6),u["\u0275\u0275text"](36),u["\u0275\u0275pipe"](37,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](38,"\n                    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](39,"\n                    "),u["\u0275\u0275elementStart"](40,"p"),u["\u0275\u0275text"](41),u["\u0275\u0275pipe"](42,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](43,"\n                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](44,"\n            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](45,"\n\n            "),u["\u0275\u0275elementStart"](46,"button",7),u["\u0275\u0275listener"]("click",(function(){return t.moveCollection()})),u["\u0275\u0275text"](47,"\n                "),u["\u0275\u0275template"](48,Kt,3,3,"span",8),u["\u0275\u0275text"](49,"\n                "),u["\u0275\u0275template"](50,Qt,4,3,"span",8),u["\u0275\u0275text"](51,"\n            "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](52,"\n            "),u["\u0275\u0275elementStart"](53,"button",9),u["\u0275\u0275pipe"](54,"async"),u["\u0275\u0275text"](55),u["\u0275\u0275pipe"](56,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](57,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](58,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](59,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](60,"\n")}var n;2&e&&(u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind2"](8,15,"item.edit.move.head",u["\u0275\u0275pureFunction1"](34,Yt,null==(n=u["\u0275\u0275pipeBind1"](9,18,t.itemRD$))||null==n.payload?null:n.payload.handle))),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](13,20,"item.edit.move.description")),u["\u0275\u0275advance"](7),u["\u0275\u0275property"]("suggestions",u["\u0275\u0275pipeBind1"](21,22,t.collectionSearchResults))("placeholder",u["\u0275\u0275pipeBind1"](22,24,"item.edit.move.search.placeholder"))("action",t.getCurrentUrl())("name","item-move")("ngModel",t.selectedCollectionName),u["\u0275\u0275advance"](14),u["\u0275\u0275property"]("ngModel",t.inheritPolicies),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](37,26,"item.edit.move.inheritpolicies.checkbox")),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\n                        ",u["\u0275\u0275pipeBind1"](42,28,"item.edit.move.inheritpolicies.description"),"\n                    "),u["\u0275\u0275advance"](5),u["\u0275\u0275property"]("disabled",!t.canSubmit),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!t.processing),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",t.processing),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](36,Wt,u["\u0275\u0275pipeBind1"](54,30,t.itemPageRoute$))),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate1"]("\n                ",u["\u0275\u0275pipeBind1"](56,32,"item.edit.move.cancel"),"\n            "))},directives:[qt.a,Jt.DefaultValueAccessor,Jt.NgControlStatus,Jt.NgModel,Jt.CheckboxControlValueAccessor,i.u,r.h],pipes:[b.e,i.b],encapsulation:2}),e})();var Gt=n("aFKe"),Xt=n("1Pbu"),Zt=n("kcku"),en=n("4SI6"),tn=n("EGek");function nn(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275text"](1,"\n                        "),u["\u0275\u0275elementStart"](2,"div",15),u["\u0275\u0275text"](3),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](4,"\n                        "),u["\u0275\u0275elementStart"](5,"div"),u["\u0275\u0275text"](6),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](7,"\n                    "),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("\n                            ",e.metadataField,"\n                        "),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("\n                            ",e.metadataValue.value,"\n                        ")}}function an(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div",9),u["\u0275\u0275listener"]("click",(function(){u["\u0275\u0275restoreView"](e);const n=t.ngVar,i=u["\u0275\u0275nextContext"]().$implicit;return u["\u0275\u0275nextContext"]().setSelectedVirtualMetadataItem(i,!n)})),u["\u0275\u0275text"](1,"\n                "),u["\u0275\u0275elementStart"](2,"div",10),u["\u0275\u0275text"](3,"\n                    "),u["\u0275\u0275elementStart"](4,"label"),u["\u0275\u0275text"](5,"\n                        "),u["\u0275\u0275element"](6,"input",11),u["\u0275\u0275text"](7,"\n                    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](8,"\n                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n                "),u["\u0275\u0275elementStart"](10,"div",12),u["\u0275\u0275text"](11,"\n                    "),u["\u0275\u0275elementStart"](12,"ds-listable-object-component-loader",13),u["\u0275\u0275text"](13,"\n                    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](14,"\n                    "),u["\u0275\u0275template"](15,nn,8,2,"div",14),u["\u0275\u0275text"](16,"\n                "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](17,"\n            "),u["\u0275\u0275elementEnd"]()}if(2&e){const e=t.ngVar,n=u["\u0275\u0275nextContext"]().$implicit,i=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](6),u["\u0275\u0275property"]("checked",e),u["\u0275\u0275advance"](6),u["\u0275\u0275property"]("object",n),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngForOf",i.virtualMetadata.get(n.uuid))}}function rn(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n            "),u["\u0275\u0275template"](2,an,18,3,"div",8),u["\u0275\u0275pipe"](3,"async"),u["\u0275\u0275text"](4,"\n        "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit,n=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngVar",u["\u0275\u0275pipeBind1"](3,1,n.isSelectedVirtualMetadataItem(e)))}}let sn=(()=>{class e{constructor(e){this.objectUpdatesService=e,this.close=new u.EventEmitter,this.save=new u.EventEmitter,this.virtualMetadata=new Map}get items(){return[this.leftItem,this.rightItem]}getVirtualMetadata(e){return Object.entries(e.metadata).map(([e,t])=>t.filter(t=>!e.startsWith("relation")&&t.authority&&t.authority.endsWith(this.relationshipId)).map(t=>({metadataField:e,metadataValue:t}))).reduce((e,t)=>e.concat(t),[])}setSelectedVirtualMetadataItem(e,t){this.objectUpdatesService.setSelectedVirtualMetadata(this.url,this.relationshipId,e.uuid,t)}isSelectedVirtualMetadataItem(e){return this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.relationshipId,e.uuid)}trackItem(e,t){return t&&t.uuid}ngOnInit(){this.items.forEach(e=>{this.virtualMetadata.set(e.uuid,this.getVirtualMetadata(e))})}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](Q.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-virtual-metadata"]],inputs:{url:"url",relationshipId:"relationshipId",leftItem:"leftItem",rightItem:"rightItem"},outputs:{close:"close",save:"save"},decls:27,vars:8,consts:[[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","flex-row-reverse","m-2"],[1,"btn","btn-primary","save",3,"click"],[1,"fas","fa-save"],["class","item d-flex flex-row",3,"click",4,"ngVar"],[1,"item","d-flex","flex-row",3,"click"],[1,"m-2"],["type","checkbox",1,"select",3,"checked"],[1,"flex-column"],[3,"object"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275elementStart"](2,"div",0),u["\u0275\u0275text"](3),u["\u0275\u0275pipe"](4,"translate"),u["\u0275\u0275elementStart"](5,"button",1),u["\u0275\u0275listener"]("click",(function(){return t.close.emit()})),u["\u0275\u0275text"](6,"\n            "),u["\u0275\u0275elementStart"](7,"span",2),u["\u0275\u0275text"](8,"\xd7"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](9,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](10,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](11,"\n    "),u["\u0275\u0275elementStart"](12,"div",3),u["\u0275\u0275text"](13,"\n        "),u["\u0275\u0275template"](14,rn,5,3,"ng-container",4),u["\u0275\u0275text"](15,"\n        "),u["\u0275\u0275elementStart"](16,"div",5),u["\u0275\u0275text"](17,"\n            "),u["\u0275\u0275elementStart"](18,"button",6),u["\u0275\u0275listener"]("click",(function(){return t.save.emit()})),u["\u0275\u0275text"](19,"\n                "),u["\u0275\u0275element"](20,"i",7),u["\u0275\u0275text"](21),u["\u0275\u0275pipe"](22,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](23,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](25,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n")),2&e&&(u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate1"]("",u["\u0275\u0275pipeBind1"](4,4,"virtual-metadata.delete-relationship.modal-head"),"\n        "),u["\u0275\u0275advance"](11),u["\u0275\u0275property"]("ngForOf",t.items)("ngForTrackBy",t.trackItem),u["\u0275\u0275advance"](7),u["\u0275\u0275textInterpolate1"](" ",u["\u0275\u0275pipeBind1"](22,6,"item.edit.metadata.save-button"),"\n            "))},directives:[i.t,G.a,X.a],pipes:[b.e,i.b],encapsulation:2}),e})();function on(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div",2),u["\u0275\u0275text"](1,"\n  "),u["\u0275\u0275elementStart"](2,"div",3),u["\u0275\u0275text"](3,"\n    "),u["\u0275\u0275elementStart"](4,"ds-listable-object-component-loader",4),u["\u0275\u0275pipe"](5,"async"),u["\u0275\u0275text"](6,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](7,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](8,"\n  "),u["\u0275\u0275elementStart"](9,"div",5),u["\u0275\u0275text"](10,"\n    "),u["\u0275\u0275elementStart"](11,"div",6),u["\u0275\u0275text"](12,"\n      "),u["\u0275\u0275elementStart"](13,"button",7),u["\u0275\u0275listener"]("click",(function(){u["\u0275\u0275restoreView"](e);const t=u["\u0275\u0275nextContext"](),n=u["\u0275\u0275reference"](4);return t.openVirtualMetadataModal(n)})),u["\u0275\u0275pipe"](14,"translate"),u["\u0275\u0275text"](15,"\n        "),u["\u0275\u0275element"](16,"i",8),u["\u0275\u0275text"](17,"\n      "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](18,"\n      "),u["\u0275\u0275elementStart"](19,"button",9),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().undo()})),u["\u0275\u0275pipe"](20,"translate"),u["\u0275\u0275text"](21,"\n        "),u["\u0275\u0275element"](22,"i",10),u["\u0275\u0275text"](23,"\n      "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](24,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](25,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](26,"\n"),u["\u0275\u0275elementEnd"]()}if(2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("object",u["\u0275\u0275pipeBind1"](5,7,e.relatedItem$))("viewMode",e.viewMode)("value",e.nameVariant),u["\u0275\u0275advance"](9),u["\u0275\u0275propertyInterpolate"]("title",u["\u0275\u0275pipeBind1"](14,9,"item.edit.metadata.edit.buttons.remove")),u["\u0275\u0275property"]("disabled",!e.canRemove()),u["\u0275\u0275advance"](6),u["\u0275\u0275propertyInterpolate"]("title",u["\u0275\u0275pipeBind1"](20,11,"item.edit.metadata.edit.buttons.undo")),u["\u0275\u0275property"]("disabled",!e.canUndo())}}function cn(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275text"](0,"\n  "),u["\u0275\u0275elementStart"](1,"ds-virtual-metadata",11),u["\u0275\u0275listener"]("close",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().closeVirtualMetadataModal()}))("save",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().remove()})),u["\u0275\u0275pipe"](2,"async"),u["\u0275\u0275pipe"](3,"async"),u["\u0275\u0275text"](4,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](5,"\n")}if(2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("relationshipId",e.relationship.id)("leftItem",u["\u0275\u0275pipeBind1"](2,4,e.leftItem$))("rightItem",u["\u0275\u0275pipeBind1"](3,6,e.rightItem$))("url",e.url)}}let ln=(()=>{class e{constructor(e,t){this.objectUpdatesService=e,this.modalService=t,this.viewMode=J.a.ListElement}get relationship(){return this.update.relationship}get update(){return this.fieldUpdate.field}get nameVariant(){return this.update.nameVariant}ngOnChanges(){this.relationship?(this.leftItem$=this.relationship.leftItem.pipe(Object(j.i)(),Object(j.o)(),Object(q.a)(e=>Object(d.b)(e)&&Object(d.e)(e.uuid))),this.rightItem$=this.relationship.rightItem.pipe(Object(j.i)(),Object(j.o)(),Object(q.a)(e=>Object(d.b)(e)&&Object(d.e)(e.uuid))),this.relatedItem$=Object(c.a)(this.leftItem$,this.rightItem$).pipe(Object(l.a)(e=>e.find(e=>e.uuid!==this.editItem.uuid)))):this.relatedItem$=Object(o.a)(this.update.relatedItem)}remove(){this.closeVirtualMetadataModal(),Object(c.a)(this.leftItem$,this.rightItem$).pipe(Object(l.a)(e=>e.map(e=>this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.relationship.id,e.uuid))),Object(N.a)(e=>Object(c.a)(e)),Object(l.a)(e=>Object.assign({},this.fieldUpdate.field,{keepLeftVirtualMetadata:!0===e[0],keepRightVirtualMetadata:!0===e[1]})),Object(_.a)(1)).subscribe(e=>this.objectUpdatesService.saveRemoveFieldUpdate(this.url,e))}openVirtualMetadataModal(e){this.modalRef=this.modalService.open(e)}closeVirtualMetadataModal(){this.modalRef.close()}undo(){this.objectUpdatesService.removeSingleFieldUpdate(this.url,this.fieldUpdate.field.uuid)}canRemove(){return this.fieldUpdate.changeType!==Ve.c.REMOVE&&this.fieldUpdate.changeType!==Ve.c.ADD}canUndo(){return this.fieldUpdate.changeType>=0}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](Q.a),u["\u0275\u0275directiveInject"](m.u))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-edit-relationship"]],inputs:{fieldUpdate:"fieldUpdate",url:"url",editItem:"editItem"},features:[u["\u0275\u0275NgOnChangesFeature"]],decls:6,vars:3,consts:[["class","row",4,"ngIf"],["virtualMetadataModal",""],[1,"row"],[1,"col-10","relationship"],[3,"object","viewMode","value"],[1,"col-2"],[1,"btn-group","relationship-action-buttons"],[1,"btn","btn-outline-danger","btn-sm",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"disabled","title","click"],[1,"fas","fa-undo-alt","fa-fw"],[3,"relationshipId","leftItem","rightItem","url","close","save"]],template:function(e,t){1&e&&(u["\u0275\u0275template"](0,on,27,13,"div",0),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275text"](2,"\n"),u["\u0275\u0275template"](3,cn,6,8,"ng-template",null,1,u["\u0275\u0275templateRefExtractor"]),u["\u0275\u0275text"](5,"\n")),2&e&&u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](1,1,t.relatedItem$))},directives:[i.u,X.a,sn],pipes:[i.b,b.e],styles:[".btn[disabled][_ngcontent-%COMP%]{color:var(--bs-gray-600);border-color:var(--bs-gray-600);z-index:0}.relationship-action-buttons[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}"]}),e})();const dn=function(){return{}},pn=function(e,t,n){return{"alert-success":e,"alert-warning":t,"alert-danger":n}};function un(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"ds-edit-relationship",6),u["\u0275\u0275text"](1,"\n            "),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=u["\u0275\u0275nextContext"](4);u["\u0275\u0275property"]("fieldUpdate",e||u["\u0275\u0275pureFunction0"](4,dn))("url",n.url)("editItem",n.item)("ngClass",u["\u0275\u0275pureFunction3"](5,pn,1===e.changeType,0===e.changeType,2===e.changeType))}}function mn(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275text"](1),u["\u0275\u0275pipe"](2,"translate"),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate"](u["\u0275\u0275pipeBind1"](2,1,"item.edit.relationships.no-relationships")))}function bn(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n            "),u["\u0275\u0275template"](2,un,2,9,"ds-edit-relationship",5),u["\u0275\u0275text"](3,"\n            "),u["\u0275\u0275template"](4,mn,3,3,"div",4),u["\u0275\u0275text"](5,"\n        "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngVar,n=u["\u0275\u0275nextContext"](3);u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngForOf",e)("ngForTrackBy",n.trackUpdate),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",0===e.length)}}function hn(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n        "),u["\u0275\u0275template"](2,bn,6,3,"ng-container",3),u["\u0275\u0275pipe"](3,"dsObjectValues"),u["\u0275\u0275text"](4,"\n    "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]().ngVar;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngVar",u["\u0275\u0275pipeBind1"](3,1,e))}}function fn(e,t){1&e&&u["\u0275\u0275element"](0,"ds-loading")}function vn(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275template"](2,hn,5,3,"ng-container",4),u["\u0275\u0275text"](3,"\n    "),u["\u0275\u0275template"](4,fn,1,0,"ds-loading",4),u["\u0275\u0275text"](5,"\n"),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngVar;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",e),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!e)}}let gn=(()=>{class e{constructor(e,t,n,i,a){this.objectUpdatesService=e,this.linkService=t,this.relationshipService=n,this.modalService=i,this.selectableListService=a}getRelationshipMessageKey(){return Object(c.a)(this.getLabel(),this.relatedEntityType$).pipe(Object(l.a)(([e,t])=>{if(Object(d.b)(e)&&e.indexOf("is")>-1&&e.indexOf("Of")>-1){const n=`${e.substring(2,e.indexOf("Of"))}`;return n!==t.label?`relationships.is${n}Of.${t.label}`:`relationships.is${n}Of`}return e}))}getLabel(){return Object(c.a)([this.relationshipType.leftType,this.relationshipType.rightType].map(e=>e.pipe(Object(j.i)(),Object(j.o)()))).pipe(Object(l.a)(e=>[this.relationshipType.leftwardType,this.relationshipType.rightwardType][e.findIndex(e=>e.id===this.itemType.id)]))}trackUpdate(e,t){return t&&t.field?t.field.uuid:void 0}openLookup(){this.modalRef=this.modalService.open(Xt.a,{size:"lg"});const e=this.modalRef.componentInstance;e.repeatable=!0,e.listId=this.listId,e.item=this.item,this.item.owningCollection.pipe(Object(j.j)()).subscribe(t=>{e.collection=t}),e.select=(...e)=>{e.forEach(e=>{const t=e.indexableObject;this.getFieldUpdatesForRelatedItem(t).subscribe(e=>{e.forEach(e=>this.objectUpdatesService.removeSingleFieldUpdate(this.url,e.uuid)),0===e.length&&this.relationshipService.getNameVariant(this.listId,t.uuid).subscribe(e=>{this.objectUpdatesService.saveAddFieldUpdate(this.url,{uuid:this.relationshipType.id+"-"+t.uuid,nameVariant:e,type:this.relationshipType,relatedItem:t})})})})},e.deselect=(...e)=>{e.forEach(e=>{const t=e.indexableObject;this.objectUpdatesService.removeSingleFieldUpdate(this.url,this.relationshipType.id+"-"+t.uuid),this.getFieldUpdatesForRelatedItem(t).subscribe(e=>e.forEach(e=>this.objectUpdatesService.saveRemoveFieldUpdate(this.url,e)))})},this.relatedEntityType$.pipe(Object(_.a)(1)).subscribe(t=>{e.relationshipOptions=Object.assign(new Zt.a,{relationshipType:t.label,searchConfiguration:t.label.toLowerCase(),nameVariants:!0})}),this.selectableListService.deselectAll(this.listId),this.updates$.pipe(Object(N.a)(e=>Object.values(e).length>0?Object(c.a)(Object.values(e).filter(e=>e.changeType!==Ve.c.REMOVE).map(e=>{const t=e.field;return t.relationship?this.getRelatedItem(t.relationship):Object(o.a)(t.relatedItem)})):Object(o.a)([])),Object(_.a)(1),Object(l.a)(e=>e.map(e=>{const t=new en.a;return t.indexableObject=e,t.hitHighlights={},t}))).subscribe(e=>{this.selectableListService.select(this.listId,e)})}getFieldUpdatesForRelatedItem(e){return this.updates$.pipe(Object(_.a)(1),Object(l.a)(e=>Object.values(e).map(e=>e.field).filter(e=>e.relationship)),Object(me.a)(t=>Object(c.a)(t.map(e=>this.getRelatedItem(e.relationship))).pipe(Object(A.a)([]),Object(l.a)(n=>t.filter((t,i)=>n[i].uuid===e.uuid)))))}getRelatedItem(e){return this.relationshipService.isLeftItem(e,this.item).pipe(Object(N.a)(t=>t?e.rightItem:e.leftItem),Object(j.i)(),Object(j.o)())}ngOnInit(){this.relatedEntityType$=Object(c.a)([this.relationshipType.leftType,this.relationshipType.rightType].map(e=>e.pipe(Object(j.i)(),Object(j.o)()))).pipe(Object(l.a)(e=>e.find(e=>e.uuid!==this.itemType.uuid)),Object(d.c)()),this.relatedEntityType$.pipe(Object(_.a)(1)).subscribe(e=>this.listId=`edit-relationship-${this.itemType.id}-${e.id}`),this.updates$=this.getItemRelationships().pipe(Object(N.a)(e=>Object(c.a)(e.map(e=>this.relationshipService.isLeftItem(e,this.item))).pipe(Object(A.a)([]),Object(l.a)(t=>t.map((t,n)=>{const i=e[n];return{uuid:i.id,type:this.relationshipType,relationship:i,nameVariant:t?i.rightwardValue:i.leftwardValue}})))),Object(N.a)(e=>this.objectUpdatesService.getFieldUpdates(this.url,e).pipe(Object(l.a)(e=>{const t={};return Object.keys(e).forEach(n=>{Object(d.b)(e[n])&&e[n].field.type.id===this.relationshipType.id&&(t[n]=e[n])}),t}))),Object(Bt.a)({}))}getItemRelationships(){return this.linkService.resolveLink(this.item,Object(K.a)("relationships",void 0,!0,!0,!0,Object(K.a)("relationshipType"),Object(K.a)("leftItem"),Object(K.a)("rightItem"))),this.item.relationships.pipe(Object(j.c)(),Object(l.a)(e=>e.payload.page.filter(e=>Object(d.b)(e))),Object(N.a)(e=>Object(c.a)(e.map(e=>e.relationshipType.pipe(Object(j.i)(),Object(j.o)()))).pipe(Object(A.a)([]),Object(l.a)(t=>e.filter((e,n)=>t[n].id===this.relationshipType.id)))))}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](Q.a),u["\u0275\u0275directiveInject"](H.a),u["\u0275\u0275directiveInject"](Y.a),u["\u0275\u0275directiveInject"](m.u),u["\u0275\u0275directiveInject"](tn.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-edit-relationship-list"]],inputs:{item:"item",itemType:"itemType",url:"url",relationshipType:"relationshipType"},decls:17,vars:11,consts:[[1,"ml-2","btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[4,"ngVar"],[4,"ngIf"],["class","relationship-row d-block alert",3,"fieldUpdate","url","editItem","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"relationship-row","d-block","alert",3,"fieldUpdate","url","editItem","ngClass"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"h5"),u["\u0275\u0275text"](1),u["\u0275\u0275pipe"](2,"translate"),u["\u0275\u0275pipe"](3,"async"),u["\u0275\u0275elementStart"](4,"button",0),u["\u0275\u0275listener"]("click",(function(){return t.openLookup()})),u["\u0275\u0275text"](5,"\n        "),u["\u0275\u0275element"](6,"i",1),u["\u0275\u0275text"](7,"\n        "),u["\u0275\u0275elementStart"](8,"span",2),u["\u0275\u0275text"](9),u["\u0275\u0275pipe"](10,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](11,"\n    "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](12,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](13,"\n"),u["\u0275\u0275template"](14,vn,6,2,"ng-container",3),u["\u0275\u0275pipe"](15,"async"),u["\u0275\u0275text"](16,"\n")),2&e&&(u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n    ",u["\u0275\u0275pipeBind1"](2,3,u["\u0275\u0275pipeBind1"](3,5,t.getRelationshipMessageKey())),"\n    "),u["\u0275\u0275advance"](8),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](10,7,"item.edit.relationships.edit.buttons.add"),""),u["\u0275\u0275advance"](5),u["\u0275\u0275property"]("ngVar",u["\u0275\u0275pipeBind1"](15,9,t.updates$)))},directives:[G.a,i.u,i.t,ln,i.r,it.a],pipes:[b.e,i.b,Ke.a],styles:[".relationship-row[_ngcontent-%COMP%]:not(.alert){padding:var(--bs-alert-padding-y) 0}.relationship-row.alert[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-alert-padding-x));margin-right:calc(-1 * var(--bs-alert-padding-x));margin-top:-1px;margin-bottom:-1px}"]}),e})();function xn(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",14),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](3).discard()})),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275element"](2,"i",15),u["\u0275\u0275text"](3,"\n          "),u["\u0275\u0275elementStart"](4,"span",9),u["\u0275\u0275text"](5),u["\u0275\u0275pipe"](6,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](7,"\n        "),u["\u0275\u0275elementEnd"]()}if(2&e){const e=u["\u0275\u0275nextContext"](3);u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](1,2,e.hasChanges())),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function yn(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",16),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](3).reinstate()})),u["\u0275\u0275element"](1,"i",17),u["\u0275\u0275text"](2,"\n          "),u["\u0275\u0275elementStart"](3,"span",9),u["\u0275\u0275text"](4),u["\u0275\u0275pipe"](5,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n        "),u["\u0275\u0275elementEnd"]()}2&e&&(u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function jn(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",19),u["\u0275\u0275text"](1,"\n            "),u["\u0275\u0275element"](2,"ds-edit-relationship-list",20),u["\u0275\u0275pipe"](3,"async"),u["\u0275\u0275text"](4,"\n          "),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=u["\u0275\u0275nextContext"](5);u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("url",n.url)("item",n.item)("itemType",u["\u0275\u0275pipeBind1"](3,4,n.entityType$))("relationshipType",e)}}function Sn(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n          "),u["\u0275\u0275template"](2,jn,5,6,"div",18),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]().ngVar;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngForOf",e)}}function On(e,t){1&e&&u["\u0275\u0275element"](0,"ds-loading")}function In(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n        "),u["\u0275\u0275template"](2,Sn,4,1,"ng-container",2),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275template"](4,On,1,0,"ds-loading",2),u["\u0275\u0275text"](5,"\n      "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngVar;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",e),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!e)}}function Cn(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",21),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](3).discard()})),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275element"](2,"i",15),u["\u0275\u0275text"](3,"\n            "),u["\u0275\u0275elementStart"](4,"span",9),u["\u0275\u0275text"](5),u["\u0275\u0275pipe"](6,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](7,"\n          "),u["\u0275\u0275elementEnd"]()}if(2&e){const e=u["\u0275\u0275nextContext"](3);u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](1,2,e.hasChanges())),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function wn(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",22),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](3).reinstate()})),u["\u0275\u0275element"](1,"i",17),u["\u0275\u0275text"](2,"\n            "),u["\u0275\u0275elementStart"](3,"span",9),u["\u0275\u0275text"](4),u["\u0275\u0275pipe"](5,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n          "),u["\u0275\u0275elementEnd"]()}2&e&&(u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function En(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n      "),u["\u0275\u0275elementStart"](2,"div",4),u["\u0275\u0275text"](3,"\n        "),u["\u0275\u0275template"](4,xn,8,6,"button",5),u["\u0275\u0275pipe"](5,"async"),u["\u0275\u0275text"](6,"\n        "),u["\u0275\u0275template"](7,yn,7,3,"button",6),u["\u0275\u0275pipe"](8,"async"),u["\u0275\u0275text"](9,"\n        "),u["\u0275\u0275elementStart"](10,"button",7),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](2).submit()})),u["\u0275\u0275pipe"](11,"async"),u["\u0275\u0275element"](12,"i",8),u["\u0275\u0275text"](13,"\n          "),u["\u0275\u0275elementStart"](14,"span",9),u["\u0275\u0275text"](15),u["\u0275\u0275pipe"](16,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](17,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](18,"\n      "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](19,"\n      "),u["\u0275\u0275template"](20,In,6,2,"ng-container",1),u["\u0275\u0275pipe"](21,"async"),u["\u0275\u0275text"](22,"\n      "),u["\u0275\u0275elementStart"](23,"div",10),u["\u0275\u0275text"](24,"\n        "),u["\u0275\u0275elementStart"](25,"div",11),u["\u0275\u0275text"](26,"\n          "),u["\u0275\u0275template"](27,Cn,8,6,"button",12),u["\u0275\u0275pipe"](28,"async"),u["\u0275\u0275text"](29,"\n          "),u["\u0275\u0275template"](30,wn,7,3,"button",13),u["\u0275\u0275pipe"](31,"async"),u["\u0275\u0275text"](32,"\n          "),u["\u0275\u0275elementStart"](33,"button",7),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"](2).submit()})),u["\u0275\u0275pipe"](34,"async"),u["\u0275\u0275element"](35,"i",8),u["\u0275\u0275text"](36,"\n            "),u["\u0275\u0275elementStart"](37,"span",9),u["\u0275\u0275text"](38),u["\u0275\u0275pipe"](39,"translate"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](40,"\n          "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](41,"\n        "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](42,"\n      "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](43,"\n    "),u["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=u["\u0275\u0275nextContext"](2);u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("ngIf",!u["\u0275\u0275pipeBind1"](5,9,e.isReinstatable())),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](8,11,e.isReinstatable())),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](11,13,e.hasChanges())),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](16,15,"item.edit.metadata.save-button"),""),u["\u0275\u0275advance"](5),u["\u0275\u0275property"]("ngVar",u["\u0275\u0275pipeBind1"](21,17,e.relationshipTypes$)),u["\u0275\u0275advance"](7),u["\u0275\u0275property"]("ngIf",!u["\u0275\u0275pipeBind1"](28,19,e.isReinstatable())),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](31,21,e.isReinstatable())),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("disabled",!u["\u0275\u0275pipeBind1"](34,23,e.hasChanges())),u["\u0275\u0275advance"](5),u["\u0275\u0275textInterpolate1"]("\xa0",u["\u0275\u0275pipeBind1"](39,25,"item.edit.metadata.save-button"),"")}}function kn(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",23),u["\u0275\u0275text"](1),u["\u0275\u0275pipe"](2,"translate"),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"]("\n      ",u["\u0275\u0275pipeBind1"](2,1,"item.edit.relationships.no-entity-type"),"\n    "))}function Mn(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275template"](2,En,44,27,"ng-container",2),u["\u0275\u0275text"](3,"\n    "),u["\u0275\u0275template"](4,kn,3,3,"div",3),u["\u0275\u0275text"](5,"\n  "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngVar;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",e),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",!e)}}let Bn=(()=>{class e extends Me.a{constructor(e,t,n,i,a,r,s,o,c,l,d){super(e,t,n,i,a,r),this.itemService=e,this.objectUpdatesService=t,this.router=n,this.notificationsService=i,this.translateService=a,this.route=r,this.relationshipService=s,this.objectCache=o,this.requestService=c,this.entityTypeService=l,this.cdr=d}initializeUpdates(){const e=this.item.firstMetadataValue("dspace.entity.type");void 0!==e?(this.entityType$=this.entityTypeService.getEntityTypeByLabel(e).pipe(Object(j.i)(),Object(j.o)()),this.relationshipTypes$=this.entityType$.pipe(Object(N.a)(e=>this.entityTypeService.getEntityTypeRelationships(e.id,!0,!0,Object(K.a)("leftType"),Object(K.a)("rightType")).pipe(Object(j.i)(),Object(j.o)(),Object(l.a)(e=>e.page))))):this.entityType$=Object(o.a)(void 0)}initializeNotificationsPrefix(){this.notificationsPrefix="item.edit.relationships.notifications."}submit(){const e=this.relationshipService.getItemRelationshipsArray(this.item).pipe(Object(Bt.a)([]),Object(l.a)(e=>e.map(e=>Object.assign(new Gt.a,e,{uuid:e.id}))),Object(N.a)(e=>this.objectUpdatesService.getFieldUpdatesExclusive(this.url,e)),Object(l.a)(e=>Object.values(e).filter(e=>e.changeType===Ve.c.REMOVE).map(e=>e.field))),t=this.objectUpdatesService.getFieldUpdates(this.url,[]).pipe(Object(l.a)(e=>Object.values(e).filter(e=>Object(d.b)(e)).filter(e=>e.changeType===Ve.c.ADD).map(e=>e.field)));Object(c.a)(e,t).pipe(Object(_.a)(1)).subscribe(([e,t])=>{[this.deleteRelationships(e),this.addRelationships(t)].forEach(e=>e.subscribe(e=>{e.length>0&&(this.initializeOriginalFields(),this.cdr.detectChanges(),this.displayNotifications(e))}))})}deleteRelationships(e){return Object(Be.a)(...e.map(e=>{let t;return t=e.keepLeftVirtualMetadata&&e.keepRightVirtualMetadata?"all":e.keepLeftVirtualMetadata?"left":e.keepRightVirtualMetadata?"right":"none",this.relationshipService.deleteRelationship(e.uuid,t)}))}addRelationships(e){return Object(Be.a)(...e.map(e=>this.entityType$.pipe(Object(N.a)(t=>this.entityTypeService.isLeftType(e.type,t)),Object(N.a)(t=>{let n,i,a,r;return t?(n=this.item,i=e.relatedItem,a=null,r=e.nameVariant):(n=e.relatedItem,i=this.item,a=e.nameVariant,r=null),this.relationshipService.addRelationship(e.type.id,n,i,a,r)}))))}displayNotifications(e){const t=e.filter(e=>e.hasFailed),n=e.filter(e=>e.hasSucceeded);t.forEach(e=>{this.notificationsService.error(this.getNotificationTitle("failed"),e.errorMessage)}),n.length>0&&this.notificationsService.success(this.getNotificationTitle("saved"),this.getNotificationContent("saved"))}initializeOriginalFields(){return console.log("init"),this.relationshipService.getRelatedItems(this.item).pipe(Object(_.a)(1)).subscribe(e=>{this.objectUpdatesService.initialize(this.url,e,this.item.lastModified)})}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](I.a),u["\u0275\u0275directiveInject"](Q.a),u["\u0275\u0275directiveInject"](r.g),u["\u0275\u0275directiveInject"](O.a),u["\u0275\u0275directiveInject"](b.f),u["\u0275\u0275directiveInject"](r.a),u["\u0275\u0275directiveInject"](Y.a),u["\u0275\u0275directiveInject"](Te.a),u["\u0275\u0275directiveInject"](De.a),u["\u0275\u0275directiveInject"](W.a),u["\u0275\u0275directiveInject"](u.ChangeDetectorRef))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-relationships"]],features:[u["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:3,consts:[[1,"item-relationships"],[4,"ngVar"],[4,"ngIf"],["class","alert alert-info mt-2","role","alert",4,"ngIf"],[1,"button-row","top","d-flex"],["class","btn btn-danger ml-auto",3,"disabled","click",4,"ngIf"],["class","btn btn-warning ml-auto",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-save"],[1,"d-none","d-sm-inline"],[1,"button-row","bottom"],[1,"float-right"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-danger","ml-auto",3,"disabled","click"],[1,"fas","fa-times"],[1,"btn","btn-warning","ml-auto",3,"click"],[1,"fas","fa-undo-alt"],["class","mb-4",4,"ngFor","ngForOf"],[1,"mb-4"],[3,"url","item","itemType","relationshipType"],[1,"btn","btn-danger",3,"disabled","click"],[1,"btn","btn-warning",3,"click"],["role","alert",1,"alert","alert-info","mt-2"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n  "),u["\u0275\u0275template"](2,Mn,6,2,"ng-container",1),u["\u0275\u0275pipe"](3,"async"),u["\u0275\u0275text"](4,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](5,"\n")),2&e&&(u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngVar",u["\u0275\u0275pipeBind1"](3,1,t.entityType$)))},directives:[G.a,i.u,i.t,gn,it.a],pipes:[i.b,b.e],styles:[".button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:calc(.5 * var(--bs-spacer))}.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}@media screen and (min-width:576px){.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:var(--ds-edit-item-button-min-width)}}.button-row.top[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-top:calc(var(--bs-spacer) / 2);margin-bottom:calc(var(--bs-spacer) / 2)}"]}),e})();var Vn=n("A0IO"),Rn=n("ac5F"),Un=n("VYMa"),$n=n("Y9an");function Fn(e,t){if(1&e&&u["\u0275\u0275element"](0,"ds-item-versions",5),2&e){const e=u["\u0275\u0275nextContext"]().ngVar;u["\u0275\u0275property"]("item",e)("displayWhenEmpty",!0)("displayTitle",!1)}}function Tn(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",3),u["\u0275\u0275text"](1,"\n  "),u["\u0275\u0275template"](2,Fn,1,3,"ds-item-versions",4),u["\u0275\u0275text"](3,"\n"),u["\u0275\u0275elementEnd"]()),2&e){const e=t.ngVar;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",e)}}let Dn=(()=>{class e{constructor(e){this.route=e,this.AlertTypeEnum=Rn.a}ngOnInit(){this.itemRD$=this.route.parent.data.pipe(Object(l.a)(e=>e.dso)).pipe(Object(j.i)())}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](r.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-version-history"]],decls:8,vars:5,consts:[[1,"mt-4"],[3,"content","type"],["class","mt-2",4,"ngVar"],[1,"mt-2"],[3,"item","displayWhenEmpty","displayTitle",4,"ngIf"],[3,"item","displayWhenEmpty","displayTitle"]],template:function(e,t){var n;1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n  "),u["\u0275\u0275element"](2,"ds-alert",1),u["\u0275\u0275text"](3,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](4,"\n"),u["\u0275\u0275template"](5,Tn,4,1,"div",2),u["\u0275\u0275pipe"](6,"async"),u["\u0275\u0275text"](7,"\n")),2&e&&(u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("content","item.edit.tabs.versionhistory.under-construction")("type",t.AlertTypeEnum.Warning),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngVar",null==(n=u["\u0275\u0275pipeBind1"](6,3,t.itemRD$))?null:n.payload))},directives:[Un.a,G.a,i.u,$n.a],pipes:[i.b],encapsulation:2}),e})();var Pn=n("JIr8"),zn=n("f+Ev"),Ln=n("B/au"),Nn=n("+Bs4"),_n=n("xPuV");function An(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n      "),u["\u0275\u0275element"](2,"ds-resource-policies",2),u["\u0275\u0275text"](3,"\n    "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("resourceType","bitstream")("resourceUUID",e.id)}}function qn(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275text"](1,"\n    "),u["\u0275\u0275element"](2,"ds-resource-policies",2),u["\u0275\u0275text"](3,"\n    "),u["\u0275\u0275template"](4,An,4,2,"ng-container",3),u["\u0275\u0275pipe"](5,"async"),u["\u0275\u0275text"](6,"\n  "),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit,i=u["\u0275\u0275nextContext"]();var n;u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("resourceType","bundle")("resourceUUID",e.id),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngForOf",null==(n=u["\u0275\u0275pipeBind1"](5,3,i.bundleBitstreamsMap.get(e.id)))?null:n.page)}}let Jn=(()=>{class e{constructor(e,t){this.linkService=e,this.route=t,this.bundleBitstreamsMap=new Map,this.bundles$=new fe.a([]),this.subs=[]}ngOnInit(){this.item$=this.route.data.pipe(Object(l.a)(e=>e.dso),Object(j.k)(),Object(l.a)(e=>this.linkService.resolveLink(e,Object(K.a)("bundles",new Ln.f,!0,!0,!0,Object(K.a)("bitstreams")))));const e=this.item$.pipe(Object(q.a)(e=>Object(d.e)(e.bundles)),Object(me.a)(e=>e.bundles),Object(j.k)(),Object(Pn.a)(e=>(console.error(e),Object(o.a)(Object(zn.b)(null,[])))));this.subs.push(e.pipe(Object(_.a)(1),Object(l.a)(e=>e.page)).subscribe(e=>{this.bundles$.next(e)}),e.pipe(Object(_.a)(1),Object(me.a)(e=>e.page),Object(l.a)(e=>({id:e.id,bitstreams:this.getBundleBitstreams(e)}))).subscribe(e=>{this.bundleBitstreamsMap.set(e.id,e.bitstreams)}))}getItemUUID(){return this.item$.pipe(Object(l.a)(e=>e.id),Object(S.a)(e=>Object(d.e)(e)))}getItemBundles(){return this.bundles$.asObservable()}getBundleBitstreams(e){return e.bitstreams.pipe(Object(j.j)(),Object(Pn.a)(e=>(console.error(e),Object(o.a)(Object(zn.b)(null,[])))))}ngOnDestroy(){this.subs.filter(e=>Object(d.b)(e)).forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](H.a),u["\u0275\u0275directiveInject"](r.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-item-authorizations"]],decls:11,vars:9,consts:[[1,"container"],[3,"type","content"],[3,"resourceType","resourceUUID"],[4,"ngFor","ngForTrackById","ngForOf"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n  "),u["\u0275\u0275element"](2,"ds-alert",1),u["\u0275\u0275text"](3,"\n  "),u["\u0275\u0275element"](4,"ds-resource-policies",2),u["\u0275\u0275pipe"](5,"async"),u["\u0275\u0275text"](6,"\n  "),u["\u0275\u0275template"](7,qn,7,5,"ng-container",3),u["\u0275\u0275pipe"](8,"async"),u["\u0275\u0275text"](9,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](10,"\n\n")),2&e&&(u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("type","alert-info")("content","item.edit.authorizations.heading"),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("resourceType","item")("resourceUUID",u["\u0275\u0275pipeBind1"](5,5,t.getItemUUID())),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngForOf",u["\u0275\u0275pipeBind1"](8,7,t.getItemBundles())))},directives:[Un.a,Nn.a,i.t,_n.a],pipes:[i.b],encapsulation:2}),e})();var Kn=n("n1Qy"),Qn=n("G5zm"),Yn=n("EEUA"),Wn=n("ALMP"),Hn=n("tv3Y"),Gn=n("YqLK"),Xn=n("0TMo"),Zn=n("Y2Xq"),ei=n("Vurf");let ti=(()=>{class e extends Xn.a{constructor(e,t,n,i){super(e,t,n,i),this.resolver=e,this.authorizationService=t,this.router=n,this.authService=i}getFeatureID(e,t){return Object(o.a)(ge.a.ReinstateItem)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275inject"](Zn.a),u["\u0275\u0275inject"](xe.a),u["\u0275\u0275inject"](r.g),u["\u0275\u0275inject"](ei.a))},e.\u0275prov=u["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ni=(()=>{class e extends Xn.a{constructor(e,t,n,i){super(e,t,n,i),this.resolver=e,this.authorizationService=t,this.router=n,this.authService=i}getFeatureID(e,t){return Object(o.a)(ge.a.WithdrawItem)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275inject"](Zn.a),u["\u0275\u0275inject"](xe.a),u["\u0275\u0275inject"](r.g),u["\u0275\u0275inject"](ei.a))},e.\u0275prov=u["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ii=(()=>{class e extends Xn.a{constructor(e,t,n,i){super(e,t,n,i),this.resolver=e,this.authorizationService=t,this.router=n,this.authService=i}getFeatureID(e,t){return Object(o.a)(ge.a.CanEditMetadata)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275inject"](Zn.a),u["\u0275\u0275inject"](xe.a),u["\u0275\u0275inject"](r.g),u["\u0275\u0275inject"](ei.a))},e.\u0275prov=u["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ai=n("TtSl"),ri=n("HENg");let si=(()=>{class e extends ri.a{constructor(e,t,n,i){super(e,t,n,i),this.resolver=e,this.authorizationService=t,this.router=n,this.authService=i}getFeatureIDs(e,t){return Object(o.a)([ge.a.CanManageMappings,ge.a.WithdrawItem,ge.a.ReinstateItem,ge.a.CanManagePolicies,ge.a.CanMakePrivate,ge.a.CanDelete,ge.a.CanMove])}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275inject"](Zn.a),u["\u0275\u0275inject"](xe.a),u["\u0275\u0275inject"](r.g),u["\u0275\u0275inject"](ei.a))},e.\u0275prov=u["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),oi=(()=>{class e extends Xn.a{constructor(e,t,n,i){super(e,t,n,i),this.resolver=e,this.authorizationService=t,this.router=n,this.authService=i}getFeatureID(e,t){return Object(o.a)(ge.a.CanManageBitstreamBundles)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275inject"](Zn.a),u["\u0275\u0275inject"](xe.a),u["\u0275\u0275inject"](r.g),u["\u0275\u0275inject"](ei.a))},e.\u0275prov=u["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ci=(()=>{class e extends Xn.a{constructor(e,t,n,i){super(e,t,n,i),this.resolver=e,this.authorizationService=t,this.router=n,this.authService=i}getFeatureID(e,t){return Object(o.a)(ge.a.CanManageRelationships)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275inject"](Zn.a),u["\u0275\u0275inject"](xe.a),u["\u0275\u0275inject"](r.g),u["\u0275\u0275inject"](ei.a))},e.\u0275prov=u["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),li=(()=>{class e extends Xn.a{constructor(e,t,n,i){super(e,t,n,i),this.resolver=e,this.authorizationService=t,this.router=n,this.authService=i}getFeatureID(e,t){return Object(o.a)(ge.a.CanManageVersions)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275inject"](Zn.a),u["\u0275\u0275inject"](xe.a),u["\u0275\u0275inject"](r.g),u["\u0275\u0275inject"](ei.a))},e.\u0275prov=u["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),di=(()=>{class e extends Xn.a{constructor(e,t,n,i){super(e,t,n,i),this.resolver=e,this.authorizationService=t,this.router=n,this.authService=i}getFeatureID(e,t){return Object(o.a)(ge.a.CanManageMappings)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275inject"](Zn.a),u["\u0275\u0275inject"](xe.a),u["\u0275\u0275inject"](r.g),u["\u0275\u0275inject"](ei.a))},e.\u0275prov=u["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),pi=(()=>{class e{}return e.\u0275mod=u["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[Vn.a,Hn.a,Qn.a,Kn.a,ti,ni,ai.a,ii,si,oi,ci,li,di],imports:[[r.k.forChild([{path:"",resolve:{breadcrumb:Vn.a},data:{breadcrumbKey:"item.edit"},children:[{path:"",component:y,children:[{path:"",redirectTo:"status",pathMatch:"full"},{path:"status",component:Ee,data:{title:"item.edit.tabs.status.title",showBreadcrumbs:!0},canActivate:[si]},{path:"bitstreams",component:Mt,data:{title:"item.edit.tabs.bitstreams.title",showBreadcrumbs:!0},canActivate:[oi]},{path:"metadata",component:ke.a,data:{title:"item.edit.tabs.metadata.title",showBreadcrumbs:!0},canActivate:[ii]},{path:"relationships",component:Bn,data:{title:"item.edit.tabs.relationships.title",showBreadcrumbs:!0},canActivate:[ci]},{path:"versionhistory",component:Dn,data:{title:"item.edit.tabs.versionhistory.title",showBreadcrumbs:!0},canActivate:[li]},{path:"mapper",component:At,data:{title:"item.edit.tabs.item-mapper.title",showBreadcrumbs:!0},canActivate:[di]}]},{path:"mapper",component:At},{path:Gn.g,component:V,canActivate:[ni]},{path:Gn.f,component:$,canActivate:[ti]},{path:Gn.d,component:D},{path:Gn.e,component:L},{path:Gn.b,component:pe},{path:Gn.c,component:Ht,data:{title:"item.edit.move.title"}},{path:Gn.a,children:[{path:"create",resolve:{resourcePolicyTarget:Kn.a},component:Yn.a,data:{title:"resource-policies.create.page.title"}},{path:"edit",resolve:{resourcePolicy:Qn.a},component:Wn.a,data:{title:"resource-policies.edit.page.title"}},{path:"",component:Jn,data:{title:"item.edit.authorizations.title"}}]}]}])]]}),e})();var ui=n("HQAL");let mi=(()=>{class e{}return e.\u0275mod=u["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[Pe.a,Ke.a],imports:[[i.c,a.a,pi,ui.a,Ae.g]]}),e})()},"d/jG":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("itXk"),a=n("lJxs"),r=n("vkgz"),s=n("eIep"),o=n("SxV6"),c=n("daFX"),l=n("AytR"),d=n("MEmd"),p=n("1QIV"),u=n("J3qs"),m=n("u0Hx"),b=n("8Y7J"),h=n("iqTE"),f=n("loKC"),v=n("iInd"),g=n("lI3o"),x=n("TSSN");let y=(()=>{class e extends c.a{constructor(e,t,n,i,a,r){super(t,i,a),this.itemService=e,this.objectUpdatesService=t,this.router=n,this.notificationsService=i,this.translateService=a,this.route=r}ngOnInit(){Object(u.b)(this.item)?this.setItem(this.item):this.itemUpdateSubscription=Object(i.a)([this.route.data,this.route.parent.data]).pipe(Object(a.a)(([e,t])=>Object.assign({},e,t)),Object(a.a)(e=>e.dso),Object(r.a)(e=>{this.item=e.payload}),Object(s.a)(e=>this.itemService.findByHref(e.payload._links.self.href,!0,!0,...m.a)),Object(p.c)()).subscribe(e=>{this.setItem(e.payload)}),this.discardTimeOut=l.a.item.edit.undoTimeout,this.url=this.router.url,this.url.indexOf("?")>0&&(this.url=this.url.substr(0,this.url.indexOf("?"))),this.hasChanges().pipe(Object(o.a)()).subscribe(e=>{e?this.checkLastModified():this.initializeOriginalFields()}),this.initializeNotificationsPrefix(),this.initializeUpdates()}setItem(e){this.item=e,this.itemPageRoute=Object(d.f)(this.item),this.postItemInit(),this.initializeUpdates()}ngOnDestroy(){Object(u.b)(this.itemUpdateSubscription)&&this.itemUpdateSubscription.unsubscribe()}postItemInit(){}initializeUpdates(){}initializeNotificationsPrefix(){}initializeOriginalFields(){}submit(){}trackUpdate(e,t){return t&&t.field?t.field.uuid:void 0}isValid(){return this.objectUpdatesService.isValidPage(this.url)}checkLastModified(){const e=this.item.lastModified;this.objectUpdatesService.getLastModified(this.url).pipe(Object(o.a)()).subscribe(t=>{t.getDate()!==e.getDate()&&(this.notificationsService.warning(this.getNotificationTitle("outdated"),this.getNotificationContent("outdated")),this.initializeOriginalFields())})}}return e.\u0275fac=function(t){return new(t||e)(b["\u0275\u0275directiveInject"](h.a),b["\u0275\u0275directiveInject"](f.a),b["\u0275\u0275directiveInject"](v.g),b["\u0275\u0275directiveInject"](g.a),b["\u0275\u0275directiveInject"](x.f),b["\u0275\u0275directiveInject"](v.a))},e.\u0275cmp=b["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-abstract-item-update"]],inputs:{item:"item"},features:[b["\u0275\u0275InheritDefinitionFeature"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})()},hucJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("1QIV"),a=n("lJxs"),r=n("J3qs"),s=n("8Y7J"),o=n("GCaJ"),c=n("h5qW");let l=(()=>{class e{constructor(e,t){this.breadcrumbService=e,this.dataService=t}resolve(e,t){const n=e.params.id;return this.dataService.findById(n,!0,!1,...this.followLinks).pipe(Object(i.g)(),Object(i.o)(),Object(a.a)(e=>{if(Object(r.b)(e)){const i=t.url,a=i.substr(0,i.indexOf(n))+n;return{provider:this.breadcrumbService,key:e,url:a}}}))}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275inject"](o.a),s["\u0275\u0275inject"](c.a))},e.\u0275prov=s["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},mjBp:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("8Y7J");let a=(()=>{class e{canActivate(e,t){return e.data={title:e.params.configuration+".search.title"},!0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})()},ofZh:function(e,t,n){"use strict";n.r(t),n.d(t,"SearchPageComponent",(function(){return s}));var i=n("8Y7J"),a=n("FZ4K"),r=n("tVEM");let s=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-search-page"]],decls:4,vars:0,template:function(e,t){1&e&&(i["\u0275\u0275element"](0,"ds-search"),i["\u0275\u0275text"](1,"\n"),i["\u0275\u0275element"](2,"ds-search-tracker"),i["\u0275\u0275text"](3,"\n"))},directives:[a.a,r.a],encapsulation:2}),e})()},tVEM:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("eIep"),a=n("lJxs"),r=n("FZ4K"),s=n("ztnu"),o=n("joI/"),c=n("1QIV"),l=n("8Y7J"),d=n("gWc+"),p=n("7LZ0"),u=n("14tD"),m=n("ppE2"),b=n("srUL"),h=n("iInd");let f=(()=>{class e extends r.a{constructor(e,t,n,i,a,r,s){super(e,t,n,i,a,s),this.service=e,this.sidebarService=t,this.windowService=n,this.searchConfigService=i,this.routeService=a,this.angulartics2=r,this.router=s}ngOnInit(){this.getSearchOptions().pipe(Object(i.a)(e=>this.service.searchEntries(e).pipe(Object(c.i)(),Object(a.a)(t=>({config:e,searchQueryResponse:t.payload}))))).subscribe(({config:e,searchQueryResponse:t})=>{const n=[],i=t.appliedFilters||[];for(let a=0,r=i.length;a<r;a++)n.push(i[a]);this.angulartics2.eventTrack.next({action:"search",properties:{searchOptions:e,page:{size:e.pagination.size,totalElements:t.pageInfo.totalElements,totalPages:t.pageInfo.totalPages,number:e.pagination.currentPage},sort:{by:e.sort.field,order:e.sort.direction},filters:n}})})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](d.a),l["\u0275\u0275directiveInject"](p.a),l["\u0275\u0275directiveInject"](u.a),l["\u0275\u0275directiveInject"](s.SEARCH_CONFIG_SERVICE),l["\u0275\u0275directiveInject"](m.a),l["\u0275\u0275directiveInject"](b.b),l["\u0275\u0275directiveInject"](h.g))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-search-tracker"]],features:[l["\u0275\u0275ProvidersFeature"]([{provide:s.SEARCH_CONFIG_SERVICE,useClass:o.a}]),l["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:0,template:function(e,t){1&e&&l["\u0275\u0275text"](0,"\xa0\n")},styles:["[_nghost-%COMP%]{display:none}"]}),e})()},tv3Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("zr/d"),a=n("LRne"),r=n("8Y7J");let s=(()=>{class e{getBreadcrumbs(e,t){return Object(a.a)([new i.a(e+".breadcrumbs",t)])}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},u0Hx:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return u}));var i=n("84Zn"),a=n("B/au"),r=n("1QIV"),s=n("8jtY"),o=n("8Y7J"),c=n("iqTE"),l=n("tqRt"),d=n("iInd");const p=[Object(i.a)("owningCollection",void 0,!0,!0,!0,Object(i.a)("parentCommunity",void 0,!0,!0,!0,Object(i.a)("parentCommunity"))),Object(i.a)("bundles",new a.f,!0,!0,!0,Object(i.a)("bitstreams")),Object(i.a)("relationships"),Object(i.a)("version",void 0,!0,!0,!0,Object(i.a)("versionhistory"))];let u=(()=>{class e{constructor(e,t,n){this.itemService=e,this.store=t,this.router=n}resolve(e,t){const n=this.itemService.findById(e.params.id,!0,!1,...p).pipe(Object(r.g)());return n.subscribe(e=>{this.store.dispatch(new s.a(t.url,e.payload))}),n}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](c.a),o["\u0275\u0275inject"](l.h),o["\u0275\u0275inject"](d.g))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})()},"zr/d":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(e,t){this.text=e,this.url=t}}}}]);
//# sourceMappingURL=4-es2015.66989098c66eb3f71da9.js.map