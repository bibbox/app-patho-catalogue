!function(){function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,a=!1,r=void 0;try{for(var o,c=e[Symbol.iterator]();!(i=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(s){a=!0,r=s}finally{try{i||null==c.return||c.return()}finally{if(a)throw r}}return n}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p(e);if(t){var a=p(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[4,35],{"0TMo":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("HENg"),a=n("lJxs"),o=function(e){s(n,e);var t=d(n);function n(){return r(this,n),t.apply(this,arguments)}return c(n,[{key:"getFeatureIDs",value:function(e,t){return this.getFeatureID(e,t).pipe(Object(a.a)((function(e){return[e]})))}}]),n}(i.a)},"5FsK":function(e,t,n){"use strict";n.d(t,"a",(function(){return be}));var i,o,l,u,m=n("LvDl"),f=n("SxV6"),b=n("eIep"),v=n("1QIV"),h=n("cBt8"),g=n("d/jG"),x=n("J3qs"),y=n("ac5F"),j=n("X8f1"),S=function e(t,n){r(this,e),this.op=t,this.field=n},O=((l=function(e){s(n,e);var t=d(n);function n(e,i){var a;return r(this,n),(a=t.call(this,n.operationType,e)).value=i,a}return c(n,[{key:"toOperation",value:function(){return{op:this.op,path:"/metadata/".concat(this.field,"/-"),value:this.value}}}]),n}(S)).operationType="add",l),I=((o=function(e){s(n,e);var t=d(n);function n(e,i){var a;return r(this,n),(a=t.call(this,n.operationType,e)).place=i,a}return c(n,[{key:"toOperation",value:function(){return{op:this.op,path:"/metadata/".concat(this.field,"/").concat(this.place)}}}]),n}(S)).operationType="remove",o),k=((i=function(e){s(n,e);var t=d(n);function n(e,i,a){var o;return r(this,n),(o=t.call(this,n.operationType,e)).place=i,o.value=a,o}return c(n,[{key:"toOperation",value:function(){return{op:this.op,path:"/metadata/".concat(this.field,"/").concat(this.place),value:this.value}}}]),n}(S)).operationType="replace",i),w=n("8Y7J"),C=((u=function(){function e(){r(this,e)}return c(e,[{key:"fieldUpdatesToPatchOperations",value:function(e){var t=this.fieldUpdatesToMetadataPatchOperations(e),n=new Map,i=[];return t.forEach((function(e){e.op!==I.operationType&&e.op!==k.operationType||!Object(x.b)(e.place)||n.has(e.field)&&n.get(e.field).forEach((function(t){t<e.place&&e.place--})),e.op===I.operationType&&Object(x.b)(e.place)&&(n.has(e.field)||n.set(e.field,[]),n.get(e.field).push(e.place)),i.push(e.toOperation())})),i}},{key:"fieldUpdatesToMetadataPatchOperations",value:function(e){var t=[];return Object.keys(e).forEach((function(n){var i,a=e[n],r=a.field,o={value:r.value,language:r.language};switch(a.changeType){case j.c.ADD:i=new O(r.key,[o]);break;case j.c.REMOVE:i=new I(r.key,r.place);break;case j.c.UPDATE:i=new k(r.key,r.place,o)}t.push(i)})),t}}]),e}()).\u0275fac=function(e){return new(e||u)},u.\u0275prov=w["\u0275\u0275defineInjectable"]({token:u,factory:u.\u0275fac,providedIn:"root"}),u),E=n("iqTE"),M=n("loKC"),B=n("iInd"),V=n("lI3o"),R=n("TSSN"),U=n("SVse"),F=n("2Vo4"),T=n("LRne"),P=n("lJxs"),D=n("84Zn"),$=n("Y6Ni"),z=n("8pnQ"),L=n("aojn"),_=n("s7LF"),N=n("awfb"),A=n("jOLk"),q=["ds-edit-in-place-field",""];function J(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"div"),w["\u0275\u0275text"](1,"\n            "),w["\u0275\u0275elementStart"](2,"span"),w["\u0275\u0275text"](3),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](4,"\n        "),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate"](null==n.metadata||null==n.metadata.key?null:n.metadata.key.split(".").join(".\u200b"))}}var K=function(){return{standalone:!0}};function Q(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"div",15),w["\u0275\u0275text"](1,"\n            "),w["\u0275\u0275elementStart"](2,"ds-validation-suggestions",16,17),w["\u0275\u0275listener"]("ngModelChange",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().metadata.key=e}))("submitSuggestion",(function(){w["\u0275\u0275restoreView"](n);var e=w["\u0275\u0275reference"](3);return w["\u0275\u0275nextContext"]().update(e)}))("clickSuggestion",(function(){w["\u0275\u0275restoreView"](n);var e=w["\u0275\u0275reference"](3);return w["\u0275\u0275nextContext"]().update(e)}))("typeSuggestion",(function(){w["\u0275\u0275restoreView"](n);var e=w["\u0275\u0275reference"](3);return w["\u0275\u0275nextContext"]().update(e)}))("dsClickOutside",(function(){w["\u0275\u0275restoreView"](n);var e=w["\u0275\u0275reference"](3);return w["\u0275\u0275nextContext"]().checkValidity(e)}))("findSuggestions",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().findMetadataFieldSuggestions(e)})),w["\u0275\u0275pipe"](4,"async"),w["\u0275\u0275pipe"](5,"async"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](6,"\n        "),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("suggestions",w["\u0275\u0275pipeBind1"](4,6,i.metadataFieldSuggestions))("ngModel",i.metadata.key)("url",i.url)("metadata",i.metadata)("valid",!1!==w["\u0275\u0275pipeBind1"](5,8,i.valid))("ngModelOptions",w["\u0275\u0275pureFunction0"](10,K))}}function Y(e,t){1&e&&(w["\u0275\u0275elementStart"](0,"small",18),w["\u0275\u0275text"](1),w["\u0275\u0275pipe"](2,"translate"),w["\u0275\u0275elementEnd"]()),2&e&&(w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](2,1,"item.edit.metadata.metadatafield.invalid")))}function W(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"div"),w["\u0275\u0275text"](1,"\n            "),w["\u0275\u0275elementStart"](2,"span"),w["\u0275\u0275text"](3),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](4,"\n        "),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate"](null==n.metadata?null:n.metadata.value)}}function H(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"div",15),w["\u0275\u0275text"](1,"\n            "),w["\u0275\u0275elementStart"](2,"textarea",19),w["\u0275\u0275listener"]("ngModelChange",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().metadata.value=e}))("onDebounce",(function(){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().update()})),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](3,"\n        "),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngModel",i.metadata.value)}}function G(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"div"),w["\u0275\u0275text"](1,"\n            "),w["\u0275\u0275elementStart"](2,"span"),w["\u0275\u0275text"](3),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](4,"\n        "),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate"](null==n.metadata?null:n.metadata.language)}}function X(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"div",15),w["\u0275\u0275text"](1,"\n            "),w["\u0275\u0275elementStart"](2,"input",20),w["\u0275\u0275listener"]("ngModelChange",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().metadata.language=e}))("onDebounce",(function(){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().update()})),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](3,"\n        "),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngModel",i.metadata.language)}}function Z(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"button",21),w["\u0275\u0275listener"]("click",(function(){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().setEditable(!0)})),w["\u0275\u0275pipe"](1,"async"),w["\u0275\u0275pipe"](2,"translate"),w["\u0275\u0275text"](3,"\n            "),w["\u0275\u0275element"](4,"i",22),w["\u0275\u0275text"](5,"\n        "),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]();w["\u0275\u0275propertyInterpolate"]("title",w["\u0275\u0275pipeBind1"](2,4,"item.edit.metadata.edit.buttons.edit")),w["\u0275\u0275property"]("disabled",!w["\u0275\u0275pipeBind1"](1,2,i.canSetEditable()))}}function ee(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"button",23),w["\u0275\u0275listener"]("click",(function(){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().setEditable(!1)})),w["\u0275\u0275pipe"](1,"async"),w["\u0275\u0275pipe"](2,"async"),w["\u0275\u0275pipe"](3,"translate"),w["\u0275\u0275text"](4,"\n            "),w["\u0275\u0275element"](5,"i",24),w["\u0275\u0275text"](6,"\n        "),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]();w["\u0275\u0275propertyInterpolate"]("title",w["\u0275\u0275pipeBind1"](3,6,"item.edit.metadata.edit.buttons.unedit")),w["\u0275\u0275property"]("disabled",!w["\u0275\u0275pipeBind1"](1,2,i.canSetUneditable())||!1===w["\u0275\u0275pipeBind1"](2,4,i.valid))}}var te,ne=((te=function(){function e(t,n){r(this,e),this.registryService=t,this.objectUpdatesService=n,this.metadataFieldSuggestions=new F.a([])}return c(e,[{key:"ngOnInit",value:function(){this.editable=this.objectUpdatesService.isEditable(this.url,this.metadata.uuid),this.valid=this.objectUpdatesService.isValid(this.url,this.metadata.uuid)}},{key:"update",value:function(e){this.objectUpdatesService.saveChangeFieldUpdate(this.url,Object(m.cloneDeep)(this.metadata)),Object(x.b)(e)&&this.checkValidity(e)}},{key:"checkValidity",value:function(e){e.control.setValue(e.viewModel),e.control.updateValueAndValidity(),this.objectUpdatesService.setValidFieldUpdate(this.url,this.metadata.uuid,e.control.valid)}},{key:"setEditable",value:function(e){this.objectUpdatesService.setEditableFieldUpdate(this.url,this.metadata.uuid,e)}},{key:"remove",value:function(){this.objectUpdatesService.saveRemoveFieldUpdate(this.url,Object(m.cloneDeep)(this.metadata))}},{key:"removeChangesFromField",value:function(){this.objectUpdatesService.removeSingleFieldUpdate(this.url,this.metadata.uuid)}},{key:"ngOnChanges",value:function(){this.metadata=Object(m.cloneDeep)(this.fieldUpdate.field)}},{key:"findMetadataFieldSuggestions",value:function(e){var t=this;if(Object(x.e)(e))return this.registryService.queryMetadataFields(e,null,!0,!1,Object(D.a)("schema")).pipe(Object(v.i)(),Object(v.r)()).subscribe((function(e){t.setInputSuggestions(e)}));this.metadataFieldSuggestions.next([])}},{key:"setInputSuggestions",value:function(e){this.metadataFieldSuggestions.next(e.map((function(e){return{displayValue:e.split(".").join(".&#8203;"),value:e}})))}},{key:"canSetEditable",value:function(){var e=this;return this.editable.pipe(Object(P.a)((function(t){return!t&&e.fieldUpdate.changeType!==j.c.REMOVE})))}},{key:"canSetUneditable",value:function(){return this.editable}},{key:"canRemove",value:function(){return Object(T.a)(this.fieldUpdate.changeType!==j.c.REMOVE&&this.fieldUpdate.changeType!==j.c.ADD)}},{key:"canUndo",value:function(){var e=this;return this.editable.pipe(Object(P.a)((function(t){return e.fieldUpdate.changeType>=0||t})))}},{key:"isNotEmpty",value:function(e){return Object(x.e)(e)}}]),e}()).\u0275fac=function(e){return new(e||te)(w["\u0275\u0275directiveInject"]($.a),w["\u0275\u0275directiveInject"](M.a))},te.\u0275cmp=w["\u0275\u0275defineComponent"]({type:te,selectors:[["","ds-edit-in-place-field",""]],inputs:{fieldUpdate:"fieldUpdate",url:"url",metadata:"metadata"},features:[w["\u0275\u0275NgOnChangesFeature"]],attrs:q,decls:65,vars:39,consts:[[1,"metadata-field"],[4,"ngIf"],["class","field-container",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"w-100"],[1,"value-field"],[1,"text-center"],[1,"language-field"],[1,"btn-group","edit-field"],["class","btn btn-outline-primary btn-sm",3,"disabled","title","click",4,"ngIf"],["class","btn btn-outline-success btn-sm",3,"disabled","title","click",4,"ngIf"],[1,"btn","btn-outline-danger","btn-sm",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"disabled","title","click"],[1,"fas","fa-undo-alt","fa-fw"],[1,"field-container"],["dsAutoFocus","","autoFocusSelector",".suggestion_input",3,"suggestions","ngModel","url","metadata","valid","ngModelOptions","ngModelChange","submitSuggestion","clickSuggestion","typeSuggestion","dsClickOutside","findSuggestions"],["suggestionControl","ngModel"],[1,"text-danger"],["type","textarea",1,"form-control",3,"ngModel","dsDebounce","ngModelChange","onDebounce"],["type","text",1,"form-control",3,"ngModel","dsDebounce","ngModelChange","onDebounce"],[1,"btn","btn-outline-primary","btn-sm",3,"disabled","title","click"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-success","btn-sm",3,"disabled","title","click"],[1,"fas","fa-check","fa-fw"]],template:function(e,t){1&e&&(w["\u0275\u0275elementStart"](0,"td"),w["\u0275\u0275text"](1,"\n    "),w["\u0275\u0275elementStart"](2,"div",0),w["\u0275\u0275text"](3,"\n        "),w["\u0275\u0275template"](4,J,5,1,"div",1),w["\u0275\u0275pipe"](5,"async"),w["\u0275\u0275text"](6,"\n        "),w["\u0275\u0275template"](7,Q,7,11,"div",2),w["\u0275\u0275pipe"](8,"async"),w["\u0275\u0275text"](9,"\n        "),w["\u0275\u0275template"](10,Y,3,3,"small",3),w["\u0275\u0275pipe"](11,"async"),w["\u0275\u0275text"](12,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](13,"\n"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](14,"\n"),w["\u0275\u0275elementStart"](15,"td",4),w["\u0275\u0275text"](16,"\n    "),w["\u0275\u0275elementStart"](17,"div",5),w["\u0275\u0275text"](18,"\n        "),w["\u0275\u0275template"](19,W,5,1,"div",1),w["\u0275\u0275pipe"](20,"async"),w["\u0275\u0275text"](21,"\n        "),w["\u0275\u0275template"](22,H,4,1,"div",2),w["\u0275\u0275pipe"](23,"async"),w["\u0275\u0275text"](24,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](25,"\n"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](26,"\n"),w["\u0275\u0275elementStart"](27,"td",6),w["\u0275\u0275text"](28,"\n    "),w["\u0275\u0275elementStart"](29,"div",7),w["\u0275\u0275text"](30,"\n        "),w["\u0275\u0275template"](31,G,5,1,"div",1),w["\u0275\u0275pipe"](32,"async"),w["\u0275\u0275text"](33,"\n        "),w["\u0275\u0275template"](34,X,4,1,"div",2),w["\u0275\u0275pipe"](35,"async"),w["\u0275\u0275text"](36,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](37,"\n"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](38,"\n"),w["\u0275\u0275elementStart"](39,"td",6),w["\u0275\u0275text"](40,"\n    "),w["\u0275\u0275elementStart"](41,"div",8),w["\u0275\u0275text"](42,"\n        "),w["\u0275\u0275template"](43,Z,6,6,"button",9),w["\u0275\u0275pipe"](44,"async"),w["\u0275\u0275text"](45,"\n        "),w["\u0275\u0275template"](46,ee,7,8,"button",10),w["\u0275\u0275pipe"](47,"async"),w["\u0275\u0275text"](48,"\n        "),w["\u0275\u0275elementStart"](49,"button",11),w["\u0275\u0275listener"]("click",(function(){return t.remove()})),w["\u0275\u0275pipe"](50,"async"),w["\u0275\u0275pipe"](51,"translate"),w["\u0275\u0275text"](52,"\n            "),w["\u0275\u0275element"](53,"i",12),w["\u0275\u0275text"](54,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](55,"\n        "),w["\u0275\u0275elementStart"](56,"button",13),w["\u0275\u0275listener"]("click",(function(){return t.removeChangesFromField()})),w["\u0275\u0275pipe"](57,"async"),w["\u0275\u0275pipe"](58,"translate"),w["\u0275\u0275text"](59,"\n            "),w["\u0275\u0275element"](60,"i",14),w["\u0275\u0275text"](61,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](62,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](63,"\n"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](64,"\n")),2&e&&(w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("ngIf",!w["\u0275\u0275pipeBind1"](5,13,t.editable)),w["\u0275\u0275advance"](3),w["\u0275\u0275property"]("ngIf",w["\u0275\u0275pipeBind1"](8,15,t.editable)),w["\u0275\u0275advance"](3),w["\u0275\u0275property"]("ngIf",!1===w["\u0275\u0275pipeBind1"](11,17,t.valid)),w["\u0275\u0275advance"](9),w["\u0275\u0275property"]("ngIf",!w["\u0275\u0275pipeBind1"](20,19,t.editable)),w["\u0275\u0275advance"](3),w["\u0275\u0275property"]("ngIf",w["\u0275\u0275pipeBind1"](23,21,t.editable)),w["\u0275\u0275advance"](9),w["\u0275\u0275property"]("ngIf",!w["\u0275\u0275pipeBind1"](32,23,t.editable)),w["\u0275\u0275advance"](3),w["\u0275\u0275property"]("ngIf",w["\u0275\u0275pipeBind1"](35,25,t.editable)),w["\u0275\u0275advance"](9),w["\u0275\u0275property"]("ngIf",!w["\u0275\u0275pipeBind1"](44,27,t.editable)),w["\u0275\u0275advance"](3),w["\u0275\u0275property"]("ngIf",w["\u0275\u0275pipeBind1"](47,29,t.editable)),w["\u0275\u0275advance"](3),w["\u0275\u0275propertyInterpolate"]("title",w["\u0275\u0275pipeBind1"](51,33,"item.edit.metadata.edit.buttons.remove")),w["\u0275\u0275property"]("disabled",!w["\u0275\u0275pipeBind1"](50,31,t.canRemove())),w["\u0275\u0275advance"](7),w["\u0275\u0275propertyInterpolate"]("title",w["\u0275\u0275pipeBind1"](58,37,"item.edit.metadata.edit.buttons.undo")),w["\u0275\u0275property"]("disabled",!w["\u0275\u0275pipeBind1"](57,35,t.canUndo())))},directives:[U.u,z.a,L.a,_.NgControlStatus,_.NgModel,N.a,_.DefaultValueAccessor,A.a],pipes:[U.b,R.e],styles:[".btn[disabled][_ngcontent-%COMP%]{color:var(--bs-gray-600);border-color:var(--bs-gray-600);z-index:0}.metadata-field[_ngcontent-%COMP%]{width:var(--ds-edit-item-metadata-field-width)}.language-field[_ngcontent-%COMP%]{width:var(--ds-edit-item-language-field-width)}"]}),te),ie=n("VYMa"),ae=n("snSO");function re(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"button",14),w["\u0275\u0275listener"]("click",(function(){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().reinstate()})),w["\u0275\u0275element"](1,"i",15),w["\u0275\u0275text"](2,"\n            "),w["\u0275\u0275elementStart"](3,"span",4),w["\u0275\u0275text"](4),w["\u0275\u0275pipe"](5,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](6,"\n        "),w["\u0275\u0275elementEnd"]()}2&e&&(w["\u0275\u0275advance"](4),w["\u0275\u0275textInterpolate1"]("\xa0",w["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function oe(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"button",16),w["\u0275\u0275listener"]("click",(function(){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().discard()})),w["\u0275\u0275pipe"](1,"async"),w["\u0275\u0275element"](2,"i",17),w["\u0275\u0275text"](3,"\n            "),w["\u0275\u0275elementStart"](4,"span",4),w["\u0275\u0275text"](5),w["\u0275\u0275pipe"](6,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](7,"\n        "),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]();w["\u0275\u0275property"]("disabled",!w["\u0275\u0275pipeBind1"](1,2,i.hasChanges())),w["\u0275\u0275advance"](5),w["\u0275\u0275textInterpolate1"]("\xa0",w["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}var ce=function(){return{}},se=function(e,t,n){return{"table-warning":e,"table-danger":t,"table-success":n}};function le(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"tr",21),w["\u0275\u0275text"](1,"\n\n        "),w["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=w["\u0275\u0275nextContext"](2);w["\u0275\u0275property"]("fieldUpdate",n||w["\u0275\u0275pureFunction0"](3,ce))("url",i.url)("ngClass",w["\u0275\u0275pureFunction3"](4,se,0===n.changeType,2===n.changeType,1===n.changeType))}}function de(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"table",18),w["\u0275\u0275text"](1,"\n        "),w["\u0275\u0275elementStart"](2,"tbody"),w["\u0275\u0275text"](3,"\n        "),w["\u0275\u0275elementStart"](4,"tr"),w["\u0275\u0275text"](5,"\n            "),w["\u0275\u0275elementStart"](6,"th"),w["\u0275\u0275text"](7),w["\u0275\u0275pipe"](8,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](9,"\n            "),w["\u0275\u0275elementStart"](10,"th"),w["\u0275\u0275text"](11),w["\u0275\u0275pipe"](12,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](13,"\n            "),w["\u0275\u0275elementStart"](14,"th",19),w["\u0275\u0275text"](15),w["\u0275\u0275pipe"](16,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](17,"\n            "),w["\u0275\u0275elementStart"](18,"th",19),w["\u0275\u0275text"](19),w["\u0275\u0275pipe"](20,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](21,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](22,"\n        "),w["\u0275\u0275template"](23,le,2,8,"tr",20),w["\u0275\u0275pipe"](24,"dsObjectValues"),w["\u0275\u0275pipe"](25,"async"),w["\u0275\u0275text"](26,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](27,"\n    "),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](7),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](8,6,"item.edit.metadata.headers.field")),w["\u0275\u0275advance"](4),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](12,8,"item.edit.metadata.headers.value")),w["\u0275\u0275advance"](4),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](16,10,"item.edit.metadata.headers.language")),w["\u0275\u0275advance"](4),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](20,12,"item.edit.metadata.headers.edit")),w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("ngForOf",w["\u0275\u0275pipeBind1"](24,14,w["\u0275\u0275pipeBind1"](25,16,n.updates$)))("ngForTrackBy",n.trackUpdate)}}function ue(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"div"),w["\u0275\u0275text"](1,"\n      "),w["\u0275\u0275element"](2,"ds-alert",22),w["\u0275\u0275text"](3,"\n    "),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("content","item.edit.metadata.empty")("type",n.AlertTypeEnum.Info)}}function pe(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"button",14),w["\u0275\u0275listener"]("click",(function(){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().reinstate()})),w["\u0275\u0275element"](1,"i",15),w["\u0275\u0275text"](2),w["\u0275\u0275pipe"](3,"translate"),w["\u0275\u0275elementEnd"]()}2&e&&(w["\u0275\u0275advance"](2),w["\u0275\u0275textInterpolate1"](" ",w["\u0275\u0275pipeBind1"](3,1,"item.edit.metadata.reinstate-button"),"\n              "))}function me(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"button",16),w["\u0275\u0275listener"]("click",(function(){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().discard()})),w["\u0275\u0275pipe"](1,"async"),w["\u0275\u0275element"](2,"i",17),w["\u0275\u0275text"](3),w["\u0275\u0275pipe"](4,"translate"),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]();w["\u0275\u0275property"]("disabled",!w["\u0275\u0275pipeBind1"](1,2,i.hasChanges())),w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate1"](" ",w["\u0275\u0275pipeBind1"](4,4,"item.edit.metadata.discard-button"),"\n              ")}}var fe,be=((fe=function(e){s(n,e);var t=d(n);function n(e,i,a,o,c,s){var l;return r(this,n),(l=t.call(this,e,i,a,o,c,s)).itemService=e,l.objectUpdatesService=i,l.router=a,l.notificationsService=o,l.translateService=c,l.route=s,l.AlertTypeEnum=y.a,l}return c(n,[{key:"ngOnInit",value:function(){a(p(n.prototype),"ngOnInit",this).call(this),Object(x.a)(this.updateService)&&(this.updateService=this.itemService)}},{key:"initializeUpdates",value:function(){this.updates$=this.objectUpdatesService.getFieldUpdates(this.url,this.item.metadataAsList)}},{key:"initializeNotificationsPrefix",value:function(){this.notificationsPrefix="item.edit.metadata.notifications."}},{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new h.d;this.objectUpdatesService.saveAddFieldUpdate(this.url,e)}},{key:"initializeOriginalFields",value:function(){this.objectUpdatesService.initialize(this.url,this.item.metadataAsList,this.item.lastModified,C)}},{key:"submit",value:function(){var e=this;this.isValid().pipe(Object(f.a)()).subscribe((function(t){t?e.objectUpdatesService.createPatch(e.url).pipe(Object(f.a)(),Object(b.a)((function(t){return e.updateService.patch(e.item,t).pipe(Object(v.g)())}))).subscribe((function(t){t.hasFailed?e.notificationsService.error(e.getNotificationTitle("error"),t.errorMessage):(e.item=t.payload,e.checkAndFixMetadataUUIDs(),e.initializeOriginalFields(),e.updates$=e.objectUpdatesService.getFieldUpdates(e.url,e.item.metadataAsList),e.notificationsService.success(e.getNotificationTitle("saved"),e.getNotificationContent("saved")))})):e.notificationsService.error(e.getNotificationTitle("invalid"),e.getNotificationContent("invalid"))}))}},{key:"checkAndFixMetadataUUIDs",value:function(){var e=this,t=Object(m.cloneDeep)(this.item.metadata);Object.keys(this.item.metadata).forEach((function(n){t[n]=e.item.metadata[n].map((function(e){return Object(x.b)(e.uuid)?e:Object.assign(new h.c,e)}))})),this.item.metadata=t}}]),n}(g.a)).\u0275fac=function(e){return new(e||fe)(w["\u0275\u0275directiveInject"](E.a),w["\u0275\u0275directiveInject"](M.a),w["\u0275\u0275directiveInject"](B.g),w["\u0275\u0275directiveInject"](V.a),w["\u0275\u0275directiveInject"](R.f),w["\u0275\u0275directiveInject"](B.a))},fe.\u0275cmp=w["\u0275\u0275defineComponent"]({type:fe,selectors:[["ds-item-metadata"]],inputs:{updateService:"updateService"},features:[w["\u0275\u0275InheritDefinitionFeature"]],decls:56,vars:39,consts:[[1,"item-metadata"],[1,"button-row","top","d-flex","mb-2"],[1,"mr-auto","btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-save"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","table table-responsive table-striped table-bordered",4,"ngIf"],[4,"ngIf"],[1,"button-row","bottom"],[1,"mt-2","float-right"],[1,"btn","btn-primary","mr-0",3,"disabled","click"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-undo-alt"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"table","table-responsive","table-striped","table-bordered"],[1,"text-center"],["ds-edit-in-place-field","",3,"fieldUpdate","url","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["ds-edit-in-place-field","",3,"fieldUpdate","url","ngClass"],[3,"content","type"]],template:function(e,t){1&e&&(w["\u0275\u0275elementStart"](0,"div",0),w["\u0275\u0275text"](1,"\n    "),w["\u0275\u0275elementStart"](2,"div",1),w["\u0275\u0275text"](3,"\n        "),w["\u0275\u0275elementStart"](4,"button",2),w["\u0275\u0275listener"]("click",(function(){return t.add()})),w["\u0275\u0275element"](5,"i",3),w["\u0275\u0275text"](6,"\n            "),w["\u0275\u0275elementStart"](7,"span",4),w["\u0275\u0275text"](8),w["\u0275\u0275pipe"](9,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](10,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](11,"\n        "),w["\u0275\u0275template"](12,re,7,3,"button",5),w["\u0275\u0275pipe"](13,"async"),w["\u0275\u0275text"](14,"\n        "),w["\u0275\u0275elementStart"](15,"button",6),w["\u0275\u0275listener"]("click",(function(){return t.submit()})),w["\u0275\u0275pipe"](16,"async"),w["\u0275\u0275pipe"](17,"async"),w["\u0275\u0275element"](18,"i",7),w["\u0275\u0275text"](19,"\n            "),w["\u0275\u0275elementStart"](20,"span",4),w["\u0275\u0275text"](21),w["\u0275\u0275pipe"](22,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](23,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](24,"\n        "),w["\u0275\u0275template"](25,oe,8,6,"button",8),w["\u0275\u0275pipe"](26,"async"),w["\u0275\u0275text"](27,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](28,"\n    "),w["\u0275\u0275template"](29,de,28,18,"table",9),w["\u0275\u0275pipe"](30,"dsObjectValues"),w["\u0275\u0275pipe"](31,"async"),w["\u0275\u0275text"](32,"\n    "),w["\u0275\u0275template"](33,ue,4,2,"div",10),w["\u0275\u0275pipe"](34,"dsObjectValues"),w["\u0275\u0275pipe"](35,"async"),w["\u0275\u0275text"](36,"\n    "),w["\u0275\u0275elementStart"](37,"div",11),w["\u0275\u0275text"](38,"\n      "),w["\u0275\u0275elementStart"](39,"div",12),w["\u0275\u0275text"](40,"\n              "),w["\u0275\u0275template"](41,pe,4,3,"button",5),w["\u0275\u0275pipe"](42,"async"),w["\u0275\u0275text"](43,"\n              "),w["\u0275\u0275elementStart"](44,"button",13),w["\u0275\u0275listener"]("click",(function(){return t.submit()})),w["\u0275\u0275pipe"](45,"async"),w["\u0275\u0275element"](46,"i",7),w["\u0275\u0275text"](47),w["\u0275\u0275pipe"](48,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](49,"\n              "),w["\u0275\u0275template"](50,me,5,6,"button",8),w["\u0275\u0275pipe"](51,"async"),w["\u0275\u0275text"](52,"\n          "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](53,"\n      "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](54,"\n"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](55,"\n")),2&e&&(w["\u0275\u0275advance"](8),w["\u0275\u0275textInterpolate1"]("\xa0",w["\u0275\u0275pipeBind1"](9,11,"item.edit.metadata.add-button"),""),w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("ngIf",w["\u0275\u0275pipeBind1"](13,13,t.isReinstatable())),w["\u0275\u0275advance"](3),w["\u0275\u0275property"]("disabled",!w["\u0275\u0275pipeBind1"](16,15,t.hasChanges())||!w["\u0275\u0275pipeBind1"](17,17,t.isValid())),w["\u0275\u0275advance"](6),w["\u0275\u0275textInterpolate1"]("\xa0",w["\u0275\u0275pipeBind1"](22,19,"item.edit.metadata.save-button"),""),w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("ngIf",!w["\u0275\u0275pipeBind1"](26,21,t.isReinstatable())),w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("ngIf",w["\u0275\u0275pipeBind1"](30,23,w["\u0275\u0275pipeBind1"](31,25,t.updates$)).length>0),w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("ngIf",0==w["\u0275\u0275pipeBind1"](34,27,w["\u0275\u0275pipeBind1"](35,29,t.updates$)).length),w["\u0275\u0275advance"](8),w["\u0275\u0275property"]("ngIf",w["\u0275\u0275pipeBind1"](42,31,t.isReinstatable())),w["\u0275\u0275advance"](3),w["\u0275\u0275property"]("disabled",!w["\u0275\u0275pipeBind1"](45,33,t.hasChanges())),w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate1"](" ",w["\u0275\u0275pipeBind1"](48,35,"item.edit.metadata.save-button"),"\n              "),w["\u0275\u0275advance"](3),w["\u0275\u0275property"]("ngIf",!w["\u0275\u0275pipeBind1"](51,37,t.isReinstatable())))},directives:[U.u,U.t,ne,U.r,ie.a],pipes:[R.e,U.b,ae.a],styles:[".button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:calc(.5 * var(--bs-spacer))}.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}@media screen and (min-width:576px){.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:var(--ds-edit-item-button-min-width)}}.button-row.top[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-top:calc(var(--bs-spacer) / 2);margin-bottom:calc(var(--bs-spacer) / 2)}"]}),fe)},"8kTG":function(e,t,n){var i={"./custom/app/+search-page/search-page.component":["o4x0",54]};function a(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(i)},a.id="8kTG",e.exports=a},A0IO:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("J3qs"),a=n("q5u1"),o=n("8Y7J"),s=n("tv3Y"),l=function(){var e=function(){function e(t){r(this,e),this.breadcrumbService=t}return c(e,[{key:"resolve",value:function(e,t){var n=e.data.breadcrumbKey;if(Object(i.a)(n))throw new Error('You provided an i18nBreadcrumbResolver for url "'+e.url+"\" but no breadcrumbKey in the route's data");var r=Object(a.b)(e);return{provider:this.breadcrumbService,key:n,url:r}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](s.a))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},GCaJ:function(e,n,i){"use strict";i.d(n,"a",(function(){return h}));var a=i("zr/d"),o=i("LRne"),s=i("84Zn"),l=i("cBqT"),d=i("eIep"),u=i("lJxs"),p=i("J3qs"),m=i("TVZh"),f=i("8Y7J"),b=i("sfEo"),v=i("C765"),h=function(){var e=function(){function e(t,n){r(this,e),this.linkService=t,this.dsoNameService=n}return c(e,[{key:"getBreadcrumbs",value:function(e,n){var i=this,r=this.dsoNameService.getName(e),c=new a.a(r,n),f=e.getParentLinkKey();return this.linkService.resolveLink(e,Object(s.a)(f))[f].pipe(Object(l.a)((function(e){return e.hasSucceeded||204===e.statusCode})),Object(d.a)((function(e){if(Object(p.b)(e.payload)){var t=e.payload;return i.getBreadcrumbs(t,Object(m.n)(t))}return Object(o.a)([])})),Object(u.a)((function(e){return[].concat(t(e),[c])})))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(f["\u0275\u0275inject"](b.a),f["\u0275\u0275inject"](v.a))},e.\u0275prov=f["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},HENg:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("1QIV"),a=n("lJxs"),o=n("J3qs"),l=function(e){s(n,e);var t=d(n);function n(e,i,a,o){var c;return r(this,n),(c=t.call(this,i,a,o)).resolver=e,c.authorizationService=i,c.router=a,c.authService=o,c}return c(n,[{key:"getObjectUrl",value:function(e,t){var n=this.getRouteWithDSOId(e);return this.resolver.resolve(n,t).pipe(Object(i.d)(),Object(a.a)((function(e){return e.self})))}},{key:"getRouteWithDSOId",value:function(e){for(var t=e;Object(o.a)(t.params.id)&&Object(o.b)(t.parent);)t=t.parent;return t}}]),n}(n("a8lL").a)},HQAL:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("SVse"),a=n("pKmL"),o=n("PCNd"),c=(n("FZ4K"),n("7LZ0")),s=n("mjBp"),l=(n("tVEM"),n("9i+i")),d=(n("ofZh"),n("2XvB")),u=n("kesd"),p=n("joI/"),m=n("N0eT"),f=n("udvk"),b=(n("TIQJ"),n("8Y7J")),v=function(){var e=function e(){r(this,e)};return e.\u0275mod=b["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=b["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[c.a,d.a,u.c,s.a,p.a],imports:[[i.c,o.a.withEntryComponents(),a.a.forRoot(),l.a.forRoot(),m.a.withEntryComponents(),f.a.withEntryComponents()]]}),e}()},TIQJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("JTKQ"),a=n("8Y7J");function o(e,t){}var l=function(){var e=function(e){s(i,e);var t=d(i);function i(){return r(this,i),t.apply(this,arguments)}return c(i,[{key:"getComponentName",value:function(){return"SearchPageComponent"}},{key:"importThemedComponent",value:function(e){return n("8kTG")("./".concat(e,"/app/+search-page/search-page.component"))}},{key:"importUnthemedComponent",value:function(){return Promise.resolve().then(n.bind(null,"ofZh"))}}]),i}(i.a);return e.\u0275fac=function(t){return u(t||e)},e.\u0275cmp=a["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-themed-search-page"]],features:[a["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:0,consts:[["vcr",""]],template:function(e,t){1&e&&(a["\u0275\u0275template"](0,o,0,0,"ng-template",null,0,a["\u0275\u0275templateRefExtractor"]),a["\u0275\u0275text"](2,"\n"))},encapsulation:2}),e}(),u=a["\u0275\u0275getInheritedFactory"](l)},TtSl:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("0TMo"),a=n("LRne"),o=n("FU+A"),l=n("8Y7J"),u=n("Y2Xq"),p=n("1mcE"),m=n("iInd"),f=n("Vurf"),b=function(){var e=function(e){s(n,e);var t=d(n);function n(e,i,a,o){var c;return r(this,n),(c=t.call(this,e,i,a,o)).resolver=e,c.authorizationService=i,c.router=a,c.authService=o,c}return c(n,[{key:"getFeatureID",value:function(e,t){return Object(a.a)(o.a.AdministratorOf)}}]),n}(i.a);return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275inject"](u.a),l["\u0275\u0275inject"](p.a),l["\u0275\u0275inject"](m.g),l["\u0275\u0275inject"](f.a))},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},Y2Xq:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("lJxs"),o=n("J3qs"),l=n("MEmd"),u=n("u0Hx"),m=n("8Y7J"),f=n("iqTE"),b=n("tqRt"),v=n("iInd"),h=function(){var e=function(e){s(n,e);var t=d(n);function n(e,i,a){var o;return r(this,n),(o=t.call(this,e,i,a)).itemService=e,o.store=i,o.router=a,o}return c(n,[{key:"resolve",value:function(e,t){var r=this;return a(p(n.prototype),"resolve",this).call(this,e,t).pipe(Object(i.a)((function(e){if(e.hasSucceeded&&Object(o.b)(e.payload)){var n=Object(l.f)(e.payload),i=t.url;if(!i.startsWith(n)){var a=e.payload.uuid,c=i.substring(i.indexOf(a)+a.length,i.length);r.router.navigateByUrl(n+c)}}return e})))}}]),n}(u.b);return e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275inject"](f.a),m["\u0275\u0275inject"](b.h),m["\u0275\u0275inject"](v.g))},e.\u0275prov=m["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}()},bG9Y:function(i,o,l){"use strict";l.r(o),l.d(o,"EditItemPageModule",(function(){return ta}));var u=l("SVse"),m=l("PCNd"),f=l("iInd"),b=l("mEo1"),v=l("LRne"),h=l("itXk"),g=l("lJxs"),x=l("J3qs"),y=l("MEmd"),j=l("8Y7J"),S=l("G0yt"),O=l("TSSN"),I=function(e){return{active:e}},k=function(e){return[e]};function w(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"a",17),j["\u0275\u0275text"](1),j["\u0275\u0275pipe"](2,"translate"),j["\u0275\u0275elementEnd"]()),2&e){var n=j["\u0275\u0275nextContext"]().$implicit,i=j["\u0275\u0275nextContext"]();j["\u0275\u0275property"]("ngClass",j["\u0275\u0275pureFunction1"](5,I,n.page===i.currentPage))("routerLink",j["\u0275\u0275pureFunction1"](7,k,"./"+n.page)),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n                            ",j["\u0275\u0275pipeBind1"](2,3,"item.edit.tabs."+n.page+".head"),"\n                        ")}}function C(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"button",18),j["\u0275\u0275text"](1),j["\u0275\u0275pipe"](2,"translate"),j["\u0275\u0275elementEnd"]()),2&e){var n=j["\u0275\u0275nextContext"]().$implicit;j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n                                ",j["\u0275\u0275pipeBind1"](2,1,"item.edit.tabs."+n.page+".head"),"\n                            ")}}function E(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"li",13),j["\u0275\u0275text"](1,"\n                        "),j["\u0275\u0275template"](2,w,3,9,"a",14),j["\u0275\u0275pipe"](3,"async"),j["\u0275\u0275text"](4,"\n                        "),j["\u0275\u0275elementStart"](5,"span",15),j["\u0275\u0275pipe"](6,"translate"),j["\u0275\u0275text"](7,"\n                            "),j["\u0275\u0275template"](8,C,3,3,"button",16),j["\u0275\u0275pipe"](9,"async"),j["\u0275\u0275text"](10,"\n                        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](11,"\n                    "),j["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",j["\u0275\u0275pipeBind1"](3,3,n.enabled)),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("ngbTooltip",j["\u0275\u0275pipeBind1"](6,5,"item.edit.tabs.disabled.tooltip")),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("ngIf",!j["\u0275\u0275pipeBind1"](9,7,n.enabled))}}var M,B,V,R,U,F,T=((M=function(){function e(t,n,i){var a=this;r(this,e),this.route=t,this.router=n,this.injector=i,this.router.events.subscribe((function(){return a.initPageParamsByRoute()}))}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.initPageParamsByRoute(),this.pages=this.route.routeConfig.children.filter((function(e){return Object(x.e)(e.path)})).map((function(t){var n=Object(v.a)(!0);return Object(x.e)(t.canActivate)&&(n=Object(h.a)(t.canActivate.map((function(t){return e.injector.get(t).canActivate(e.route.snapshot,e.router.routerState.snapshot)}))).pipe(Object(g.a)((function(e){return e.every((function(e){return!0===e}))})))),{page:t.path,enabled:n}})),this.itemRD$=this.route.data.pipe(Object(g.a)((function(e){return e.dso})))}},{key:"getItemPage",value:function(e){return Object(y.f)(e)}},{key:"initPageParamsByRoute",value:function(){this.currentPage=this.route.snapshot.firstChild.routeConfig.path}}]),e}()).\u0275fac=function(e){return new(e||M)(j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"](j.Injector))},M.\u0275cmp=j["\u0275\u0275defineComponent"]({type:M,selectors:[["ds-edit-item-page"]],decls:41,vars:10,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"border-bottom"],[1,"pt-2"],[1,"nav","nav-tabs","justify-content-start"],["class","nav-item",4,"ngFor","ngForOf"],[1,"tab-pane","active"],[1,"mb-4"],[1,"button-row","bottom"],[1,"text-right"],["role","button",1,"btn","btn-outline-secondary","mr-1",3,"routerLink"],[1,"fas","fa-arrow-left"],[1,"nav-item"],["class","nav-link",3,"ngClass","routerLink",4,"ngIf"],[3,"ngbTooltip"],["class","nav-link disabled",4,"ngIf"],[1,"nav-link",3,"ngClass","routerLink"],[1,"nav-link","disabled"]],template:function(e,t){var n;1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",1),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275elementStart"](4,"div",2),j["\u0275\u0275text"](5,"\n            "),j["\u0275\u0275elementStart"](6,"h2",3),j["\u0275\u0275text"](7),j["\u0275\u0275pipe"](8,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n            "),j["\u0275\u0275elementStart"](10,"div",4),j["\u0275\u0275text"](11,"\n                "),j["\u0275\u0275elementStart"](12,"ul",5),j["\u0275\u0275text"](13,"\n                    "),j["\u0275\u0275template"](14,E,12,9,"li",6),j["\u0275\u0275text"](15,"\n                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](16,"\n                "),j["\u0275\u0275elementStart"](17,"div",7),j["\u0275\u0275text"](18,"\n                    "),j["\u0275\u0275elementStart"](19,"div",8),j["\u0275\u0275text"](20,"\n                        "),j["\u0275\u0275element"](21,"router-outlet"),j["\u0275\u0275text"](22,"\n                    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](23,"\n                    "),j["\u0275\u0275elementStart"](24,"div",9),j["\u0275\u0275text"](25,"\n                      "),j["\u0275\u0275elementStart"](26,"div",10),j["\u0275\u0275text"](27,"\n                        "),j["\u0275\u0275elementStart"](28,"a",11),j["\u0275\u0275pipe"](29,"async"),j["\u0275\u0275element"](30,"i",12),j["\u0275\u0275text"](31),j["\u0275\u0275pipe"](32,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](33,"\n                      "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](34,"\n                    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](35,"\n                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](36,"\n            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](37,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](38,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](39,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](40,"\n")),2&e&&(j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](8,4,"item.edit.head")),j["\u0275\u0275advance"](7),j["\u0275\u0275property"]("ngForOf",t.pages),j["\u0275\u0275advance"](14),j["\u0275\u0275property"]("routerLink",t.getItemPage(null==(n=j["\u0275\u0275pipeBind1"](29,6,t.itemRD$))?null:n.payload)),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"](" ",j["\u0275\u0275pipeBind1"](32,8,"item.edit.return"),""))},directives:[u.t,f.l,f.j,u.u,S.gb,u.r],pipes:[O.e,u.b],encapsulation:2,data:{animation:[b.a,b.c]},changeDetection:0}),M),P=l("1QIV"),D=l("SxV6"),$=l("lI3o"),z=l("iqTE"),L=l("3pMV"),_=function(e){return{id:e}},N=function(e){return[e,"edit"]},A=((B=function(){function e(t,n,i,a,o){r(this,e),this.route=t,this.router=n,this.notificationsService=i,this.itemDataService=a,this.translateService=o}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.itemRD$=this.route.data.pipe(Object(g.a)((function(e){return e.dso})),Object(P.i)()),this.itemRD$.pipe(Object(D.a)()).subscribe((function(t){e.item=t.payload,e.itemPageRoute=Object(y.f)(e.item)})),this.confirmMessage="item.edit."+this.messageKey+".confirm",this.cancelMessage="item.edit."+this.messageKey+".cancel",this.headerMessage="item.edit."+this.messageKey+".header",this.descriptionMessage="item.edit."+this.messageKey+".description"}},{key:"performAction",value:function(){}},{key:"processRestResponse",value:function(e){var t,n=this;e.hasSucceeded?this.itemDataService.findById(this.item.id).pipe((t=this.predicate,function(e){return e.pipe(Object(P.c)(),Object(D.a)(t))})).subscribe((function(){n.notificationsService.success(n.translateService.get("item.edit."+n.messageKey+".success")),n.router.navigate([Object(y.e)(n.item)])})):(this.notificationsService.error(this.translateService.get("item.edit."+this.messageKey+".error")),this.router.navigate([Object(y.e)(this.item)]))}}]),e}()).\u0275fac=function(e){return new(e||B)(j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"]($.a),j["\u0275\u0275directiveInject"](z.a),j["\u0275\u0275directiveInject"](O.f))},B.\u0275cmp=j["\u0275\u0275defineComponent"]({type:B,selectors:[["ds-simple-action"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",1),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275elementStart"](4,"div",2),j["\u0275\u0275text"](5,"\n            "),j["\u0275\u0275elementStart"](6,"h2"),j["\u0275\u0275text"](7),j["\u0275\u0275pipe"](8,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n            "),j["\u0275\u0275elementStart"](10,"p"),j["\u0275\u0275text"](11),j["\u0275\u0275pipe"](12,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n            "),j["\u0275\u0275element"](14,"ds-modify-item-overview",3),j["\u0275\u0275text"](15,"\n            "),j["\u0275\u0275elementStart"](16,"button",4),j["\u0275\u0275listener"]("click",(function(){return t.performAction()})),j["\u0275\u0275text"](17),j["\u0275\u0275pipe"](18,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](19,"\n            "),j["\u0275\u0275elementStart"](20,"button",5),j["\u0275\u0275text"](21),j["\u0275\u0275pipe"](22,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](23,"\n\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](24,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](25,"\n\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n")),2&e&&(j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind2"](8,6,t.headerMessage,j["\u0275\u0275pureFunction1"](15,_,t.item.handle))),j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("item",t.item),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("",j["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pureFunction1"](17,N,t.itemPageRoute)),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n                ",j["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[L.a,f.h],pipes:[O.e],encapsulation:2}),B),q=function(e){return{id:e}},J=function(e){return[e,"edit"]},K=((V=function(e){s(n,e);var t=d(n);function n(e,i,a,o,c){var s;return r(this,n),(s=t.call(this,e,i,a,o,c)).route=e,s.router=i,s.notificationsService=a,s.itemDataService=o,s.translateService=c,s.messageKey="withdraw",s.predicate=function(e){return e.payload.isWithdrawn},s}return c(n,[{key:"performAction",value:function(){var e=this;this.itemDataService.setWithDrawn(this.item,!0).pipe(Object(P.g)()).subscribe((function(t){e.processRestResponse(t)}))}}]),n}(A)).\u0275fac=function(e){return new(e||V)(j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"]($.a),j["\u0275\u0275directiveInject"](z.a),j["\u0275\u0275directiveInject"](O.f))},V.\u0275cmp=j["\u0275\u0275defineComponent"]({type:V,selectors:[["ds-item-withdraw"]],features:[j["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",1),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275elementStart"](4,"div",2),j["\u0275\u0275text"](5,"\n            "),j["\u0275\u0275elementStart"](6,"h2"),j["\u0275\u0275text"](7),j["\u0275\u0275pipe"](8,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n            "),j["\u0275\u0275elementStart"](10,"p"),j["\u0275\u0275text"](11),j["\u0275\u0275pipe"](12,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n            "),j["\u0275\u0275element"](14,"ds-modify-item-overview",3),j["\u0275\u0275text"](15,"\n            "),j["\u0275\u0275elementStart"](16,"button",4),j["\u0275\u0275listener"]("click",(function(){return t.performAction()})),j["\u0275\u0275text"](17),j["\u0275\u0275pipe"](18,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](19,"\n            "),j["\u0275\u0275elementStart"](20,"button",5),j["\u0275\u0275text"](21),j["\u0275\u0275pipe"](22,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](23,"\n\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](24,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](25,"\n\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n")),2&e&&(j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind2"](8,6,t.headerMessage,j["\u0275\u0275pureFunction1"](15,q,t.item.handle))),j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("item",t.item),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("",j["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pureFunction1"](17,J,t.itemPageRoute)),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n                ",j["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[L.a,f.h],pipes:[O.e],encapsulation:2}),V),Q=function(e){return{id:e}},Y=function(e){return[e,"edit"]},W=((R=function(e){s(n,e);var t=d(n);function n(e,i,a,o,c){var s;return r(this,n),(s=t.call(this,e,i,a,o,c)).route=e,s.router=i,s.notificationsService=a,s.itemDataService=o,s.translateService=c,s.messageKey="reinstate",s.predicate=function(e){return!e.payload.isWithdrawn},s}return c(n,[{key:"performAction",value:function(){var e=this;this.itemDataService.setWithDrawn(this.item,!1).pipe(Object(P.g)()).subscribe((function(t){e.processRestResponse(t)}))}}]),n}(A)).\u0275fac=function(e){return new(e||R)(j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"]($.a),j["\u0275\u0275directiveInject"](z.a),j["\u0275\u0275directiveInject"](O.f))},R.\u0275cmp=j["\u0275\u0275defineComponent"]({type:R,selectors:[["ds-item-reinstate"]],features:[j["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",1),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275elementStart"](4,"div",2),j["\u0275\u0275text"](5,"\n            "),j["\u0275\u0275elementStart"](6,"h2"),j["\u0275\u0275text"](7),j["\u0275\u0275pipe"](8,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n            "),j["\u0275\u0275elementStart"](10,"p"),j["\u0275\u0275text"](11),j["\u0275\u0275pipe"](12,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n            "),j["\u0275\u0275element"](14,"ds-modify-item-overview",3),j["\u0275\u0275text"](15,"\n            "),j["\u0275\u0275elementStart"](16,"button",4),j["\u0275\u0275listener"]("click",(function(){return t.performAction()})),j["\u0275\u0275text"](17),j["\u0275\u0275pipe"](18,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](19,"\n            "),j["\u0275\u0275elementStart"](20,"button",5),j["\u0275\u0275text"](21),j["\u0275\u0275pipe"](22,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](23,"\n\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](24,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](25,"\n\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n")),2&e&&(j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind2"](8,6,t.headerMessage,j["\u0275\u0275pureFunction1"](15,Q,t.item.handle))),j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("item",t.item),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("",j["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pureFunction1"](17,Y,t.itemPageRoute)),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n                ",j["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[L.a,f.h],pipes:[O.e],encapsulation:2}),R),H=function(e){return{id:e}},G=function(e){return[e,"edit"]},X=((U=function(e){s(n,e);var t=d(n);function n(e,i,a,o,c){var s;return r(this,n),(s=t.call(this,e,i,a,o,c)).route=e,s.router=i,s.notificationsService=a,s.itemDataService=o,s.translateService=c,s.messageKey="private",s.predicate=function(e){return!e.payload.isDiscoverable},s}return c(n,[{key:"performAction",value:function(){var e=this;this.itemDataService.setDiscoverable(this.item,!1).pipe(Object(P.g)()).subscribe((function(t){e.processRestResponse(t)}))}}]),n}(A)).\u0275fac=function(e){return new(e||U)(j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"]($.a),j["\u0275\u0275directiveInject"](z.a),j["\u0275\u0275directiveInject"](O.f))},U.\u0275cmp=j["\u0275\u0275defineComponent"]({type:U,selectors:[["ds-item-private"]],features:[j["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",1),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275elementStart"](4,"div",2),j["\u0275\u0275text"](5,"\n            "),j["\u0275\u0275elementStart"](6,"h2"),j["\u0275\u0275text"](7),j["\u0275\u0275pipe"](8,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n            "),j["\u0275\u0275elementStart"](10,"p"),j["\u0275\u0275text"](11),j["\u0275\u0275pipe"](12,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n            "),j["\u0275\u0275element"](14,"ds-modify-item-overview",3),j["\u0275\u0275text"](15,"\n            "),j["\u0275\u0275elementStart"](16,"button",4),j["\u0275\u0275listener"]("click",(function(){return t.performAction()})),j["\u0275\u0275text"](17),j["\u0275\u0275pipe"](18,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](19,"\n            "),j["\u0275\u0275elementStart"](20,"button",5),j["\u0275\u0275text"](21),j["\u0275\u0275pipe"](22,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](23,"\n\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](24,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](25,"\n\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n")),2&e&&(j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind2"](8,6,t.headerMessage,j["\u0275\u0275pureFunction1"](15,H,t.item.handle))),j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("item",t.item),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("",j["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pureFunction1"](17,G,t.itemPageRoute)),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n                ",j["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[L.a,f.h],pipes:[O.e],encapsulation:2}),U),Z=function(e){return{id:e}},ee=function(e){return[e,"edit"]},te=((F=function(e){s(n,e);var t=d(n);function n(e,i,a,o,c){var s;return r(this,n),(s=t.call(this,e,i,a,o,c)).route=e,s.router=i,s.notificationsService=a,s.itemDataService=o,s.translateService=c,s.messageKey="public",s.predicate=function(e){return e.payload.isDiscoverable},s}return c(n,[{key:"performAction",value:function(){var e=this;this.itemDataService.setDiscoverable(this.item,!0).pipe(Object(P.g)()).subscribe((function(t){e.processRestResponse(t)}))}}]),n}(A)).\u0275fac=function(e){return new(e||F)(j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"]($.a),j["\u0275\u0275directiveInject"](z.a),j["\u0275\u0275directiveInject"](O.f))},F.\u0275cmp=j["\u0275\u0275defineComponent"]({type:F,selectors:[["ds-item-public"]],features:[j["\u0275\u0275InheritDefinitionFeature"]],decls:27,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",1),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275elementStart"](4,"div",2),j["\u0275\u0275text"](5,"\n            "),j["\u0275\u0275elementStart"](6,"h2"),j["\u0275\u0275text"](7),j["\u0275\u0275pipe"](8,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n            "),j["\u0275\u0275elementStart"](10,"p"),j["\u0275\u0275text"](11),j["\u0275\u0275pipe"](12,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n            "),j["\u0275\u0275element"](14,"ds-modify-item-overview",3),j["\u0275\u0275text"](15,"\n            "),j["\u0275\u0275elementStart"](16,"button",4),j["\u0275\u0275listener"]("click",(function(){return t.performAction()})),j["\u0275\u0275text"](17),j["\u0275\u0275pipe"](18,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](19,"\n            "),j["\u0275\u0275elementStart"](20,"button",5),j["\u0275\u0275text"](21),j["\u0275\u0275pipe"](22,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](23,"\n\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](24,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](25,"\n\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n")),2&e&&(j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind2"](8,6,t.headerMessage,j["\u0275\u0275pureFunction1"](15,Z,t.item.handle))),j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](12,9,t.descriptionMessage)),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("item",t.item),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("",j["\u0275\u0275pipeBind1"](18,11,t.confirmMessage),"\n            "),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pureFunction1"](17,ee,t.itemPageRoute)),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n                ",j["\u0275\u0275pipeBind1"](22,13,t.cancelMessage),"\n            "))},directives:[L.a,f.h],pipes:[O.e],encapsulation:2}),F),ne=l("eIep"),ie=l("IzEk"),ae=l("xbPD"),re=l("pLZG"),oe=l("3jCq"),ce=l("84Zn"),se=l("loKC"),le=l("kN8A"),de=l("bxbP"),ue=l("sfEo"),pe=l("O/5o"),me=l("1aCu");function fe(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"ds-listable-object-component-loader",23),j["\u0275\u0275text"](1,"\n                                        "),j["\u0275\u0275elementEnd"]()),2&e){var n=j["\u0275\u0275nextContext"]().ngVar,i=j["\u0275\u0275nextContext"](6);j["\u0275\u0275property"]("object",n)("viewMode",i.viewMode)}}function be(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"ds-listable-object-component-loader",23),j["\u0275\u0275text"](1,"\n                                                    "),j["\u0275\u0275elementEnd"]()),2&e){var n=j["\u0275\u0275nextContext"](2).ngVar,i=j["\u0275\u0275nextContext"](6);j["\u0275\u0275property"]("object",n)("viewMode",i.viewMode)}}function ve(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div"),j["\u0275\u0275text"](1,"\n                                                        "),j["\u0275\u0275elementStart"](2,"div"),j["\u0275\u0275text"](3,"\n                                                            "),j["\u0275\u0275elementStart"](4,"div",29),j["\u0275\u0275text"](5),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](6,"\n                                                            "),j["\u0275\u0275elementStart"](7,"div"),j["\u0275\u0275text"](8),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n                                                        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](10,"\n                                                    "),j["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\n                                                                ",n.metadataField,"\n                                                            "),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("\n                                                                ",n.metadataValue.value,"\n                                                            ")}}function he(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275text"](0,"\n                                            "),j["\u0275\u0275elementStart"](1,"div"),j["\u0275\u0275text"](2,"\n                                                "),j["\u0275\u0275elementStart"](3,"div",24),j["\u0275\u0275text"](4),j["\u0275\u0275pipe"](5,"translate"),j["\u0275\u0275elementStart"](6,"button",25),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](7).closeVirtualMetadataModal()})),j["\u0275\u0275text"](7,"\n                                                        "),j["\u0275\u0275elementStart"](8,"span",26),j["\u0275\u0275text"](9,"\xd7"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](10,"\n                                                    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](11,"\n                                                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](12,"\n                                                "),j["\u0275\u0275elementStart"](13,"div",27),j["\u0275\u0275text"](14,"\n                                                    "),j["\u0275\u0275template"](15,be,2,2,"ds-listable-object-component-loader",17),j["\u0275\u0275text"](16,"\n                                                    "),j["\u0275\u0275template"](17,ve,11,2,"div",28),j["\u0275\u0275pipe"](18,"async"),j["\u0275\u0275text"](19,"\n                                                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](20,"\n                                            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](21,"\n                                        ")}if(2&e){var i=j["\u0275\u0275nextContext"]().ngVar,a=j["\u0275\u0275nextContext"]().$implicit,r=j["\u0275\u0275nextContext"](5);j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate1"]("\n                                                    ",j["\u0275\u0275pipeBind1"](5,3,"virtual-metadata.delete-item.modal-head"),"\n                                                    "),j["\u0275\u0275advance"](11),j["\u0275\u0275property"]("ngIf",i),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngForOf",j["\u0275\u0275pipeBind1"](18,5,r.getVirtualMetadata(a)))}}function ge(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n\n                                        "),j["\u0275\u0275template"](2,fe,2,2,"ds-listable-object-component-loader",17),j["\u0275\u0275text"](3,"\n                                        "),j["\u0275\u0275elementStart"](4,"div",18),j["\u0275\u0275text"](5,"\n                                            "),j["\u0275\u0275elementStart"](6,"div",19),j["\u0275\u0275text"](7,"\n                                                "),j["\u0275\u0275elementStart"](8,"button",20),j["\u0275\u0275listener"]("click",(function(){j["\u0275\u0275restoreView"](n);var e=j["\u0275\u0275reference"](16);return j["\u0275\u0275nextContext"](6).openVirtualMetadataModal(e)})),j["\u0275\u0275text"](9,"\n                                                    "),j["\u0275\u0275element"](10,"i",21),j["\u0275\u0275text"](11,"\n                                                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](12,"\n                                            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n                                        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](14,"\n\n                                        "),j["\u0275\u0275template"](15,he,22,7,"ng-template",null,22,j["\u0275\u0275templateRefExtractor"]),j["\u0275\u0275text"](17,"\n\n                                    "),j["\u0275\u0275elementContainerEnd"]()}if(2&e){var i=t.ngVar;j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",i)}}function xe(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div",11),j["\u0275\u0275text"](1,"\n                                    "),j["\u0275\u0275template"](2,ge,18,1,"ng-container",4),j["\u0275\u0275pipe"](3,"async"),j["\u0275\u0275text"](4,"\n                                "),j["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=j["\u0275\u0275nextContext"](5);j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngVar",j["\u0275\u0275pipeBind1"](3,1,i.getRelatedItem(n)))}}function ye(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"div",11),j["\u0275\u0275text"](1,"\n\n                            "),j["\u0275\u0275elementStart"](2,"div",12),j["\u0275\u0275listener"]("click",(function(){j["\u0275\u0275restoreView"](n);var e=t.ngVar,i=j["\u0275\u0275nextContext"]().$implicit;return j["\u0275\u0275nextContext"](3).setSelected(i,!e)})),j["\u0275\u0275text"](3,"\n                                "),j["\u0275\u0275elementStart"](4,"label"),j["\u0275\u0275text"](5,"\n                                    "),j["\u0275\u0275element"](6,"input",13),j["\u0275\u0275text"](7,"\n                                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](8,"\n                            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n\n                            "),j["\u0275\u0275elementStart"](10,"div",14),j["\u0275\u0275text"](11,"\n                                "),j["\u0275\u0275elementStart"](12,"h5",15),j["\u0275\u0275listener"]("click",(function(){j["\u0275\u0275restoreView"](n);var e=t.ngVar,i=j["\u0275\u0275nextContext"]().$implicit;return j["\u0275\u0275nextContext"](3).setSelected(i,!e)})),j["\u0275\u0275text"](13),j["\u0275\u0275pipe"](14,"translate"),j["\u0275\u0275pipe"](15,"async"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](16,"\n                                "),j["\u0275\u0275template"](17,xe,5,3,"div",16),j["\u0275\u0275pipe"](18,"async"),j["\u0275\u0275text"](19,"\n                            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](20,"\n\n                        "),j["\u0275\u0275elementEnd"]()}if(2&e){var i=t.ngVar,a=j["\u0275\u0275nextContext"]().$implicit,r=j["\u0275\u0275nextContext"](3);j["\u0275\u0275advance"](6),j["\u0275\u0275property"]("checked",i),j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate1"]("\n                                    ",j["\u0275\u0275pipeBind1"](14,3,r.getRelationshipMessageKey(j["\u0275\u0275pipeBind1"](15,5,r.getLabel(a)))),"\n                                "),j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("ngForOf",j["\u0275\u0275pipeBind1"](18,7,r.getRelationships(a)))}}function je(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div",8),j["\u0275\u0275text"](1,"\n\n                        "),j["\u0275\u0275template"](2,ye,21,9,"div",10),j["\u0275\u0275pipe"](3,"async"),j["\u0275\u0275text"](4,"\n\n                    "),j["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=j["\u0275\u0275nextContext"](3);j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngVar",j["\u0275\u0275pipeBind1"](3,1,i.isSelected(n)))}}function Se(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div",8),j["\u0275\u0275text"](1),j["\u0275\u0275pipe"](2,"translate"),j["\u0275\u0275template"](3,je,5,3,"div",9),j["\u0275\u0275text"](4,"\n\n                "),j["\u0275\u0275elementEnd"]()),2&e){var n=j["\u0275\u0275nextContext"]().ngVar;j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n\n                    ",j["\u0275\u0275pipeBind1"](2,2,"virtual-metadata.delete-item.info"),"\n\n                    "),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngForOf",n)}}function Oe(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n\n                "),j["\u0275\u0275template"](2,Se,5,4,"div",7),j["\u0275\u0275text"](3,"\n\n            "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar;j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",n&&n.length>0)}}var Ie,ke=function(e){return{id:e}},we=function(e){return[e,"edit"]},Ce=((Ie=function(n){s(o,n);var i=d(o);function o(e,t,n,a,c,s,l,d,u,p){var m;return r(this,o),(m=i.call(this,e,t,n,a,c)).route=e,m.router=t,m.notificationsService=n,m.itemDataService=a,m.translateService=c,m.modalService=s,m.objectUpdatesService=l,m.relationshipService=d,m.entityTypeService=u,m.linkService=p,m.messageKey="delete",m.viewMode=oe.a.ListElement,m.relationships$=new Map,m.relatedItems$=new Map,m.virtualMetadata$=new Map,m}return c(o,[{key:"ngOnInit",value:function(){var e=this;a(p(o.prototype),"ngOnInit",this).call(this),this.url=this.router.url;var n=this.item.firstMetadataValue("dspace.entity.type");this.types$=void 0!==n?this.entityTypeService.getEntityTypeByLabel(n).pipe(Object(P.i)(),Object(P.o)(),Object(ne.a)((function(t){return e.entityTypeService.getEntityTypeRelationships(t.id)})),Object(P.i)(),Object(P.o)(),Object(g.a)((function(e){return e.page})),Object(ne.a)((function(n){return 0===n.length?Object(v.a)(n):Object(h.a)(n.map((function(t){return e.getRelationships(t)}))).pipe(Object(g.a)((function(e){return n.reduce((function(n,i,a){return n.some((function(e){return e.id===i.id}))||0===e[a].length?n:[].concat(t(n),[i])}),[])})))}))):Object(v.a)([]),this.types$.pipe(Object(ie.a)(1)).subscribe((function(t){return e.objectUpdatesService.initialize(e.url,t,e.item.lastModified)}))}},{key:"openVirtualMetadataModal",value:function(e){this.modalRef=this.modalService.open(e)}},{key:"closeVirtualMetadataModal",value:function(){this.modalRef.close()}},{key:"getRelationshipMessageKey",value:function(e){return Object(x.b)(e)&&e.indexOf("Of")>-1?"relationships.".concat(e.substring(0,e.indexOf("Of")+2)):e}},{key:"getLabel",value:function(e){var t=this;return this.getRelationships(e).pipe(Object(ne.a)((function(n){return t.isLeftItem(n[0]).pipe(Object(g.a)((function(t){return t?e.leftwardType:e.rightwardType})))})))}},{key:"getRelationships",value:function(e){var t=this;return this.relationships$.has(e)||this.relationships$.set(e,this.relationshipService.getItemRelationshipsArray(this.item).pipe(Object(ne.a)((function(n){return Object(h.a)(n.map((function(e){return t.getRelationshipType(e)}))).pipe(Object(ae.a)([]),Object(g.a)((function(t){return n.filter((function(n,i){return e.id===t[i].id}))})))})))),this.relationships$.get(e)}},{key:"getRelationshipType",value:function(e){return this.linkService.resolveLinks(e,Object(ce.a)("relationshipType"),Object(ce.a)("leftItem"),Object(ce.a)("rightItem")),e.relationshipType.pipe(Object(P.i)(),Object(P.o)(),Object(re.a)((function(e){return Object(x.b)(e)&&Object(x.e)(e.uuid)})))}},{key:"getRelatedItem",value:function(e){return this.relatedItems$.has(e)||this.relatedItems$.set(e,this.isLeftItem(e).pipe(Object(ne.a)((function(t){return t?e.rightItem:e.leftItem})),Object(P.i)(),Object(P.o)())),this.relatedItems$.get(e)}},{key:"getVirtualMetadata",value:function(t){return this.virtualMetadata$.has(t)||this.virtualMetadata$.set(t,this.getRelatedItem(t).pipe(Object(g.a)((function(n){return Object.entries(n.metadata).map((function(n){var i=e(n,2),a=i[0];return i[1].filter((function(e){return e.authority&&e.authority.endsWith(t.id)})).map((function(e){return{metadataField:a,metadataValue:e}}))})).reduce((function(e,t){return e.concat(t)}))})))),this.virtualMetadata$.get(t)}},{key:"isLeftItem",value:function(e){var t=this;return e.leftItem.pipe(Object(P.i)(),Object(P.o)(),Object(re.a)((function(e){return Object(x.b)(e)&&Object(x.e)(e.uuid)})),Object(g.a)((function(e){return e.uuid===t.item.uuid})))}},{key:"isSelected",value:function(e){return this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.item.uuid,e.uuid)}},{key:"setSelected",value:function(e,t){this.objectUpdatesService.setSelectedVirtualMetadata(this.url,this.item.uuid,e.uuid,t)}},{key:"performAction",value:function(){var e=this;this.types$.pipe(Object(ne.a)((function(t){return Object(h.a)(t.map((function(t){return e.isSelected(t)}))).pipe(Object(ae.a)([]),Object(g.a)((function(e){return t.filter((function(t,n){return e[n]}))})),Object(g.a)((function(e){return e.map((function(e){return e.id}))})))}))).subscribe((function(t){e.itemDataService.delete(e.item.id,t).pipe(Object(P.g)()).subscribe((function(t){e.notify(t.hasSucceeded)}))}))}},{key:"notify",value:function(e){e?(this.notificationsService.success(this.translateService.get("item.edit."+this.messageKey+".success")),this.router.navigate([""])):(this.notificationsService.error(this.translateService.get("item.edit."+this.messageKey+".error")),this.router.navigate([Object(y.e)(this.item)]))}}]),o}(A)).\u0275fac=function(e){return new(e||Ie)(j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"]($.a),j["\u0275\u0275directiveInject"](z.a),j["\u0275\u0275directiveInject"](O.f),j["\u0275\u0275directiveInject"](S.u),j["\u0275\u0275directiveInject"](se.a),j["\u0275\u0275directiveInject"](le.a),j["\u0275\u0275directiveInject"](de.a),j["\u0275\u0275directiveInject"](ue.a))},Ie.\u0275cmp=j["\u0275\u0275defineComponent"]({type:Ie,selectors:[["ds-item-delete"]],inputs:{url:"url"},features:[j["\u0275\u0275InheritDefinitionFeature"]],decls:30,vars:22,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[4,"ngVar"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"],["class","mb-4",4,"ngIf"],[1,"mb-4"],["class","mb-4",4,"ngFor","ngForOf"],["class","d-flex flex-row",4,"ngVar"],[1,"d-flex","flex-row"],[1,"m-2",3,"click"],["type","checkbox",3,"checked"],[1,"flex-column","flex-grow-1"],[3,"click"],["class","d-flex flex-row",4,"ngFor","ngForOf"],[3,"object","viewMode",4,"ngIf"],[1,"ml-auto"],[1,"btn-group"],[1,"btn","btn-outline-info","btn-sm",3,"click"],[1,"fas","fa-info","fa-fw"],["virtualMetadataModal",""],[3,"object","viewMode"],[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",1),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275elementStart"](4,"div",2),j["\u0275\u0275text"](5,"\n\n            "),j["\u0275\u0275elementStart"](6,"h2"),j["\u0275\u0275text"](7),j["\u0275\u0275pipe"](8,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n            "),j["\u0275\u0275elementStart"](10,"p"),j["\u0275\u0275text"](11),j["\u0275\u0275pipe"](12,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n            "),j["\u0275\u0275element"](14,"ds-modify-item-overview",3),j["\u0275\u0275text"](15,"\n\n            "),j["\u0275\u0275template"](16,Oe,4,1,"ng-container",4),j["\u0275\u0275pipe"](17,"async"),j["\u0275\u0275text"](18,"\n\n            "),j["\u0275\u0275elementStart"](19,"button",5),j["\u0275\u0275listener"]("click",(function(){return t.performAction()})),j["\u0275\u0275text"](20),j["\u0275\u0275pipe"](21,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](22,"\n            "),j["\u0275\u0275elementStart"](23,"button",6),j["\u0275\u0275text"](24),j["\u0275\u0275pipe"](25,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](27,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](28,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](29,"\n")),2&e&&(j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind2"](8,7,t.headerMessage,j["\u0275\u0275pureFunction1"](18,ke,t.item.handle))),j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](12,10,t.descriptionMessage)),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("item",t.item),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngVar",j["\u0275\u0275pipeBind1"](17,12,t.types$)),j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate1"]("",j["\u0275\u0275pipeBind1"](21,14,t.confirmMessage),"\n            "),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pureFunction1"](20,we,t.itemPageRoute)),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n                ",j["\u0275\u0275pipeBind1"](25,16,t.cancelMessage),"\n            "))},directives:[L.a,pe.a,f.h,u.u,u.t,me.a],pipes:[O.e,u.b],encapsulation:2}),Ie),Ee=function(){function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];r(this,e),this.operationKey=t,this.operationUrl=n,this.featureID=i,this.authorized=o,this.setDisabled(a)}return c(e,[{key:"setDisabled",value:function(e){this.disabled=e}}]),e}(),Me=l("5+tZ"),Be=l("/uUt"),Ve=l("IAdc"),Re=l("2Vo4"),Ue=l("Cfvw"),Fe=l("FU+A"),Te=l("1mcE");function Pe(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"span"),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"button",5),j["\u0275\u0275text"](3),j["\u0275\u0275pipe"](4,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](5,"\n  "),j["\u0275\u0275elementEnd"]()),2&e){var n=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("disabled",n.operation.disabled)("routerLink",n.operation.operationUrl),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n      ",j["\u0275\u0275pipeBind1"](4,3,"item.edit.tabs.status.buttons."+n.operation.operationKey+".button"),"\n    ")}}function De(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"span",6),j["\u0275\u0275pipe"](1,"translate"),j["\u0275\u0275text"](2,"\n    "),j["\u0275\u0275elementStart"](3,"button",7),j["\u0275\u0275text"](4),j["\u0275\u0275pipe"](5,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](6,"\n  "),j["\u0275\u0275elementEnd"]()),2&e){var n=j["\u0275\u0275nextContext"]();j["\u0275\u0275property"]("ngbTooltip",j["\u0275\u0275pipeBind1"](1,3,"item.edit.tabs.status.buttons.unauthorized")),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("disabled",!0),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n      ",j["\u0275\u0275pipeBind1"](5,5,"item.edit.tabs.status.buttons."+n.operation.operationKey+".button"),"\n    ")}}var $e,ze=(($e=function e(){r(this,e)}).\u0275fac=function(e){return new(e||$e)},$e.\u0275cmp=j["\u0275\u0275defineComponent"]({type:$e,selectors:[["ds-item-operation"]],inputs:{operation:"operation"},decls:14,vars:5,consts:[[1,"col-3","float-left","d-flex","h-100","action-label"],[1,"justify-content-center","align-self-center"],[1,"col-9","float-left","action-button"],[4,"ngIf"],[3,"ngbTooltip",4,"ngIf"],[1,"btn","btn-outline-primary",3,"disabled","routerLink"],[3,"ngbTooltip"],[1,"btn","btn-outline-primary",3,"disabled"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n      "),j["\u0275\u0275elementStart"](2,"span",1),j["\u0275\u0275text"](3),j["\u0275\u0275pipe"](4,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](5,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](6,"\n"),j["\u0275\u0275elementStart"](7,"div",2),j["\u0275\u0275text"](8,"\n  "),j["\u0275\u0275template"](9,Pe,6,5,"span",3),j["\u0275\u0275text"](10,"\n  "),j["\u0275\u0275template"](11,De,7,7,"span",4),j["\u0275\u0275text"](12,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n")),2&e&&(j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("\n        ",j["\u0275\u0275pipeBind1"](4,3,"item.edit.tabs.status.buttons."+t.operation.operationKey+".label"),"\n      "),j["\u0275\u0275advance"](6),j["\u0275\u0275property"]("ngIf",t.operation.authorized),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",!t.operation.authorized))},directives:[u.u,f.h,S.gb],pipes:[O.e],encapsulation:2}),$e);function Le(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div",7),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",3),j["\u0275\u0275text"](3),j["\u0275\u0275pipe"](4,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](5,"\n    "),j["\u0275\u0275elementStart"](6,"div",8),j["\u0275\u0275text"](7),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](8,"\n  "),j["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("\n      ",j["\u0275\u0275pipeBind1"](4,3,"item.edit.tabs.status.labels."+n),":\n    "),j["\u0275\u0275advance"](3),j["\u0275\u0275propertyInterpolate1"]("id","status-",n,""),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n      ",i.statusData[n],"\n    ")}}function _e(e,t){if(1&e&&j["\u0275\u0275element"](0,"ds-item-operation",11),2&e){var n=j["\u0275\u0275nextContext"]().$implicit;j["\u0275\u0275property"]("operation",n)}}var Ne=function(e){return{"pt-3":e}};function Ae(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div",9),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275template"](2,_e,1,1,"ds-item-operation",10),j["\u0275\u0275text"](3,"\n  "),j["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;j["\u0275\u0275property"]("ngClass",j["\u0275\u0275pureFunction1"](2,Ne,n)),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",n)}}var qe,Je=((qe=function(){function e(t,n){r(this,e),this.route=t,this.authorizationService=n,this.operations$=new Re.a([])}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.itemRD$=this.route.parent.data.pipe(Object(g.a)((function(e){return e.dso}))),this.itemRD$.pipe(Object(D.a)(),Object(g.a)((function(e){return e.payload}))).subscribe((function(t){e.statusData=Object.assign({id:t.id,handle:t.handle,lastModified:t.lastModified}),e.statusDataKeys=Object.keys(e.statusData);var n=[];n.push(new Ee("authorizations",e.getCurrentUrl(t)+"/authorizations",Fe.a.CanManagePolicies,!0)),n.push(new Ee("mappedCollections",e.getCurrentUrl(t)+"/mapper",Fe.a.CanManageMappings,!0)),n.push(t.isWithdrawn?new Ee("reinstate",e.getCurrentUrl(t)+"/reinstate",Fe.a.ReinstateItem,!0):new Ee("withdraw",e.getCurrentUrl(t)+"/withdraw",Fe.a.WithdrawItem,!0)),n.push(t.isDiscoverable?new Ee("private",e.getCurrentUrl(t)+"/private",Fe.a.CanMakePrivate,!0):new Ee("public",e.getCurrentUrl(t)+"/public",Fe.a.CanMakePrivate,!0)),n.push(new Ee("delete",e.getCurrentUrl(t)+"/delete",Fe.a.CanDelete,!0)),n.push(new Ee("move",e.getCurrentUrl(t)+"/move",Fe.a.CanMove,!0)),e.operations$.next(n),Object(Ue.a)(n).pipe(Object(Me.a)((function(n){return Object(x.b)(n.featureID)?e.authorizationService.isAuthorized(n.featureID,t.self).pipe(Object(Be.a)(),Object(g.a)((function(e){return new Ee(n.operationKey,n.operationUrl,n.featureID,!e,e)}))):[n]})),Object(Ve.a)()).subscribe((function(t){return e.operations$.next(t)}))})),this.itemPageRoute$=this.itemRD$.pipe(Object(P.d)(),Object(g.a)((function(e){return Object(y.f)(e)})))}},{key:"getCurrentUrl",value:function(e){return Object(y.e)(e)}},{key:"trackOperation",value:function(e,t){return Object(x.b)(t)?t.operationKey:void 0}}]),e}()).\u0275fac=function(e){return new(e||qe)(j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](Te.a))},qe.\u0275cmp=j["\u0275\u0275defineComponent"]({type:qe,selectors:[["ds-item-status"]],decls:24,vars:16,consts:[[1,"mt-2"],[1,"row"],["class","w-100",4,"ngFor","ngForOf"],[1,"col-3","float-left","status-label"],["id","status-itemPage",1,"col-9","float-left","status-data"],[3,"routerLink"],["class","w-100",3,"ngClass",4,"ngFor","ngForOf"],[1,"w-100"],[1,"col-9","float-left","status-data",3,"id"],[1,"w-100",3,"ngClass"],[3,"operation",4,"ngIf"],[3,"operation"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"p",0),j["\u0275\u0275text"](1),j["\u0275\u0275pipe"](2,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](3,"\n"),j["\u0275\u0275elementStart"](4,"div",1),j["\u0275\u0275text"](5,"\n  "),j["\u0275\u0275template"](6,Le,9,5,"div",2),j["\u0275\u0275text"](7,"\n  "),j["\u0275\u0275elementStart"](8,"div",3),j["\u0275\u0275text"](9),j["\u0275\u0275pipe"](10,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](11,"\n  "),j["\u0275\u0275elementStart"](12,"div",4),j["\u0275\u0275text"](13,"\n    "),j["\u0275\u0275elementStart"](14,"a",5),j["\u0275\u0275pipe"](15,"async"),j["\u0275\u0275text"](16),j["\u0275\u0275pipe"](17,"async"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](18,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](19,"\n\n  "),j["\u0275\u0275template"](20,Ae,4,4,"div",6),j["\u0275\u0275pipe"](21,"async"),j["\u0275\u0275text"](22,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](23,"\n")),2&e&&(j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](2,6,"item.edit.tabs.status.description")),j["\u0275\u0275advance"](5),j["\u0275\u0275property"]("ngForOf",t.statusDataKeys),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("\n    ",j["\u0275\u0275pipeBind1"](10,8,"item.edit.tabs.status.labels.itemPage"),":\n  "),j["\u0275\u0275advance"](5),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pipeBind1"](15,10,t.itemPageRoute$)),j["\u0275\u0275advance"](2),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](17,12,t.itemPageRoute$)),j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("ngForOf",j["\u0275\u0275pipeBind1"](21,14,t.operations$)))},directives:[u.t,f.j,u.r,u.u,ze],pipes:[O.e,u.b],encapsulation:2,data:{animation:[b.a,b.c]}}),qe),Ke=l("5FsK"),Qe=l("d/jG"),Ye=l("1uah"),We=l("X8f1"),He=l("g7AC"),Ge=function(){function e(t,n,i,a,o){r(this,e),this.xs=t,this.sm=n,this.md=i,this.lg=a,this.xl=o}return c(e,[{key:"buildClasses",value:function(){return"col-".concat(this.xs," col-sm-").concat(this.sm," col-md-").concat(this.md," col-lg-").concat(this.lg," col-xl-").concat(this.xl)}}]),e}(),Xe=function(){function e(t){r(this,e),this.columns=t}return c(e,[{key:"combineColumns",value:function(e,t){if(e<t&&Object(x.b)(this.columns[e])&&Object(x.b)(this.columns[t])){for(var n=this.columns[e].xs,i=this.columns[e].sm,a=this.columns[e].md,r=this.columns[e].lg,o=this.columns[e].xl,c=e+1;c<t+1;c++)n+=this.columns[c].xs,i+=this.columns[c].sm,a+=this.columns[c].md,r+=this.columns[c].lg,o+=this.columns[c].xl;return new Ge(n,i,a,r,o)}}}]),e}(),Ze=l("PCBh"),et=l("mycY"),tt=l("X/78"),nt=l("yhw/"),it=["handleView"];function at(e,t){1&e&&(j["\u0275\u0275text"](0,"\n  "),j["\u0275\u0275elementStart"](1,"div",1),j["\u0275\u0275text"](2,"\n    "),j["\u0275\u0275element"](3,"i",2),j["\u0275\u0275pipe"](4,"translate"),j["\u0275\u0275text"](5,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](6,"\n")),2&e&&(j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("title",j["\u0275\u0275pipeBind1"](4,1,"item.edit.bitstreams.edit.buttons.drag")))}var rt,ot,ct=((rt=function(){function e(t){r(this,e),this.viewContainerRef=t}return c(e,[{key:"ngOnInit",value:function(){this.viewContainerRef.createEmbeddedView(this.handleView)}}]),e}()).\u0275fac=function(e){return new(e||rt)(j["\u0275\u0275directiveInject"](j.ViewContainerRef))},rt.\u0275cmp=j["\u0275\u0275defineComponent"]({type:rt,selectors:[["ds-item-edit-bitstream-drag-handle"]],viewQuery:function(e,t){var n;1&e&&j["\u0275\u0275staticViewQuery"](it,!0),2&e&&j["\u0275\u0275queryRefresh"](n=j["\u0275\u0275loadQuery"]())&&(t.handleView=n.first)},decls:3,vars:0,consts:[["handleView",""],[1,"drag-handle","text-muted","float-left","p-1","mr-2"],[1,"fas","fa-grip-vertical","fa-fw",3,"title"]],template:function(e,t){1&e&&(j["\u0275\u0275template"](0,at,7,3,"ng-template",null,0,j["\u0275\u0275templateRefExtractor"]),j["\u0275\u0275text"](2,"\n"))},pipes:[O.e],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}"]}),rt),st=l("7DXY"),lt=l("ltgo"),dt=l("Exvd"),ut=l("eReX"),pt=l("snSO"),mt=l("MFUF"),ft=((ot=function(){function e(t,n,i,a){r(this,e),this.objectUpdatesService=t,this.elRef=n,this.objectValuesPipe=i,this.paginationService=a,this.dropObject=new j.EventEmitter,this.pageSize=10,this.options=Object.assign(new st.a,{id:"dad",currentPage:1,pageSize:this.pageSize}),this.currentPage$=new Re.a(this.options),this.loading$=new Re.a(!1),this.subs=[]}return c(e,[{key:"ngOnInit",value:function(){this.initializeObjectsRD(),this.initializeURL(),this.initializeUpdates(),this.initializePagination()}},{key:"initializePagination",value:function(){var e=this;this.paginationService.getCurrentPagination(this.options.id,this.options).subscribe((function(t){e.currentPage$.next(t)}))}},{key:"initializeUpdates",value:function(){var e=this;this.objectsRD$.pipe(Object(P.i)(),Object(P.s)()).subscribe((function(t){e.objectUpdatesService.initialize(e.url,t,new Date)})),this.updates$=this.objectsRD$.pipe(Object(P.c)(),Object(P.s)(),Object(ne.a)((function(t){return e.objectUpdatesService.getFieldUpdatesExclusive(e.url,t)}))),this.subs.push(this.updates$.pipe(Object(g.a)((function(t){return e.objectValuesPipe.transform(t)})),Object(Be.a)(Object(ut.b)((function(e){return Object(x.b)(e)&&Object(x.b)(e.field)?e.field.uuid:void 0})))).subscribe((function(t){e.customOrder=t.map((function(e){return e.field.uuid})),e.loading$.next(!1)})),this.loading$.subscribe((function(t){return e.options.disabled=t})))}},{key:"drop",value:function(e){var t=this,n=e.previousIndex,i=e.currentIndex,a=this.currentPage$.value.currentPage-1,r=this.currentPage$.value.currentPage-1,o=this.elRef.nativeElement.querySelector(".page-item:hover");if(Object(x.b)(o)&&Object(x.b)(o.textContent)){var c=Number(o.textContent);Object(x.b)(c)&&!Number.isNaN(c)&&(r=c-1,i=0)}var s=a!==r;s||n===i||Object(lt.h)(this.customOrder,n,i);var l=r+1,d=a*this.pageSize+n,u=r*this.pageSize+i;d!==u&&(s&&this.loading$.next(!0),this.dropObject.emit(Object.assign({fromIndex:d,toIndex:u,finish:function(){s&&t.paginationComponent.doPageChange(l)}})))}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(x.b)(e)})).forEach((function(e){return e.unsubscribe()})),this.paginationService.clearPagination(this.options.id)}}]),e}()).\u0275fac=function(e){return new(e||ot)(j["\u0275\u0275directiveInject"](se.a),j["\u0275\u0275directiveInject"](j.ElementRef),j["\u0275\u0275directiveInject"](pt.a),j["\u0275\u0275directiveInject"](mt.a))},ot.\u0275cmp=j["\u0275\u0275defineComponent"]({type:ot,selectors:[["ds-paginated-drag-drop-abstract"]],viewQuery:function(e,t){var n;1&e&&j["\u0275\u0275viewQuery"](dt.a,!0),2&e&&j["\u0275\u0275queryRefresh"](n=j["\u0275\u0275loadQuery"]())&&(t.paginationComponent=n.first)},outputs:{dropObject:"dropObject"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),ot),bt=l("LvDl"),vt=l("C765"),ht=["bitstreamView"],gt=function(e){return["/bitstreams/",e,"edit"]};function xt(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275text"](0,"\n  "),j["\u0275\u0275elementStart"](1,"div"),j["\u0275\u0275text"](2,"\n    "),j["\u0275\u0275projection"](3),j["\u0275\u0275text"](4,"\n    "),j["\u0275\u0275elementStart"](5,"div",1),j["\u0275\u0275text"](6),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](7,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](8,"\n  "),j["\u0275\u0275elementStart"](9,"div"),j["\u0275\u0275text"](10,"\n    "),j["\u0275\u0275elementStart"](11,"div",2),j["\u0275\u0275text"](12),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](14,"\n  "),j["\u0275\u0275elementStart"](15,"div"),j["\u0275\u0275text"](16,"\n    "),j["\u0275\u0275elementStart"](17,"div",3),j["\u0275\u0275text"](18),j["\u0275\u0275pipe"](19,"async"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](20,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](21,"\n  "),j["\u0275\u0275elementStart"](22,"div"),j["\u0275\u0275text"](23,"\n    "),j["\u0275\u0275elementStart"](24,"div",3),j["\u0275\u0275text"](25,"\n      "),j["\u0275\u0275elementStart"](26,"div",4),j["\u0275\u0275text"](27,"\n        "),j["\u0275\u0275elementStart"](28,"a",5),j["\u0275\u0275pipe"](29,"translate"),j["\u0275\u0275text"](30,"\n          "),j["\u0275\u0275element"](31,"i",6),j["\u0275\u0275text"](32,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](33,"\n        "),j["\u0275\u0275elementStart"](34,"button",7),j["\u0275\u0275pipe"](35,"translate"),j["\u0275\u0275text"](36,"\n          "),j["\u0275\u0275element"](37,"i",8),j["\u0275\u0275text"](38,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](39,"\n        "),j["\u0275\u0275elementStart"](40,"button",9),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().remove()})),j["\u0275\u0275pipe"](41,"translate"),j["\u0275\u0275text"](42,"\n          "),j["\u0275\u0275element"](43,"i",10),j["\u0275\u0275text"](44,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](45,"\n        "),j["\u0275\u0275elementStart"](46,"button",11),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().undo()})),j["\u0275\u0275pipe"](47,"translate"),j["\u0275\u0275text"](48,"\n          "),j["\u0275\u0275element"](49,"i",12),j["\u0275\u0275text"](50,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](51,"\n      "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](52,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](53,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](54,"\n")}if(2&e){var i,a=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](1),j["\u0275\u0275classMapInterpolate1"]("",a.columnSizes.columns[0].buildClasses()," row-element d-flex"),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\n      ",a.bitstreamName,"\n    "),j["\u0275\u0275advance"](3),j["\u0275\u0275classMapInterpolate1"]("",a.columnSizes.columns[1].buildClasses()," row-element d-flex align-items-center"),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("\n      ",null==a.bitstream?null:a.bitstream.firstMetadataValue("dc.description"),"\n    "),j["\u0275\u0275advance"](3),j["\u0275\u0275classMapInterpolate1"]("",a.columnSizes.columns[2].buildClasses()," row-element d-flex align-items-center"),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("\n      ",null==(i=j["\u0275\u0275pipeBind1"](19,23,a.format$))?null:i.shortDescription,"\n    "),j["\u0275\u0275advance"](4),j["\u0275\u0275classMapInterpolate1"]("",a.columnSizes.columns[3].buildClasses()," row-element d-flex align-items-center"),j["\u0275\u0275advance"](6),j["\u0275\u0275propertyInterpolate"]("title",j["\u0275\u0275pipeBind1"](29,25,"item.edit.bitstreams.edit.buttons.download")),j["\u0275\u0275property"]("href",null==a.bitstream||null==a.bitstream._links||null==a.bitstream._links.content?null:a.bitstream._links.content.href,j["\u0275\u0275sanitizeUrl"]),j["\u0275\u0275advance"](6),j["\u0275\u0275propertyInterpolate"]("title",j["\u0275\u0275pipeBind1"](35,27,"item.edit.bitstreams.edit.buttons.edit")),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pureFunction1"](33,gt,a.bitstream.id)),j["\u0275\u0275advance"](6),j["\u0275\u0275propertyInterpolate"]("title",j["\u0275\u0275pipeBind1"](41,29,"item.edit.bitstreams.edit.buttons.remove")),j["\u0275\u0275property"]("disabled",!a.canRemove()),j["\u0275\u0275advance"](6),j["\u0275\u0275propertyInterpolate"]("title",j["\u0275\u0275pipeBind1"](47,31,"item.edit.bitstreams.edit.buttons.undo")),j["\u0275\u0275property"]("disabled",!a.canUndo())}}var yt,jt=[[["","slot","drag-handle"]]],St=["[slot=drag-handle]"],Ot=((yt=function(){function e(t,n,i){r(this,e),this.objectUpdatesService=t,this.dsoNameService=n,this.viewContainerRef=i}return c(e,[{key:"ngOnInit",value:function(){this.viewContainerRef.createEmbeddedView(this.bitstreamView)}},{key:"ngOnChanges",value:function(e){this.bitstream=Object(bt.cloneDeep)(this.fieldUpdate.field),this.bitstreamName=this.dsoNameService.getName(this.bitstream),this.format$=this.bitstream.format.pipe(Object(P.i)(),Object(P.o)())}},{key:"remove",value:function(){this.objectUpdatesService.saveRemoveFieldUpdate(this.bundleUrl,this.bitstream)}},{key:"undo",value:function(){this.objectUpdatesService.removeSingleFieldUpdate(this.bundleUrl,this.bitstream.uuid)}},{key:"canRemove",value:function(){return this.fieldUpdate.changeType!==We.c.REMOVE}},{key:"canUndo",value:function(){return this.fieldUpdate.changeType>=0}}]),e}()).\u0275fac=function(e){return new(e||yt)(j["\u0275\u0275directiveInject"](se.a),j["\u0275\u0275directiveInject"](vt.a),j["\u0275\u0275directiveInject"](j.ViewContainerRef))},yt.\u0275cmp=j["\u0275\u0275defineComponent"]({type:yt,selectors:[["ds-item-edit-bitstream"]],viewQuery:function(e,t){var n;1&e&&j["\u0275\u0275staticViewQuery"](ht,!0),2&e&&j["\u0275\u0275queryRefresh"](n=j["\u0275\u0275loadQuery"]())&&(t.bitstreamView=n.first)},inputs:{fieldUpdate:"fieldUpdate",bundleUrl:"bundleUrl",columnSizes:"columnSizes"},features:[j["\u0275\u0275NgOnChangesFeature"]],ngContentSelectors:St,decls:3,vars:0,consts:[["bitstreamView",""],[1,"float-left","d-flex","align-items-center"],[1,"w-100"],[1,"text-center","w-100"],[1,"btn-group","relationship-action-buttons"],[1,"btn","btn-outline-primary","btn-sm",3,"href","title"],[1,"fas","fa-download","fa-fw"],[1,"btn","btn-outline-primary","btn-sm",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"disabled","title","click"],[1,"fas","fa-undo-alt","fa-fw"]],template:function(e,t){1&e&&(j["\u0275\u0275projectionDef"](jt),j["\u0275\u0275template"](0,xt,55,35,"ng-template",null,0,j["\u0275\u0275templateRefExtractor"]),j["\u0275\u0275text"](2,"\n"))},directives:[f.h],pipes:[u.b,O.e],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}"]}),yt),It=l("Frqi"),kt=function(e,t,n,i){return{"table-warning":e,"table-danger":t,"table-success":n,"bg-white":i}};function wt(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div",7),j["\u0275\u0275text"](1,"\n          "),j["\u0275\u0275elementStart"](2,"ds-item-edit-bitstream",8),j["\u0275\u0275text"](3,"\n            "),j["\u0275\u0275elementStart"](4,"div",9),j["\u0275\u0275text"](5,"\n              "),j["\u0275\u0275element"](6,"ds-item-edit-bitstream-drag-handle"),j["\u0275\u0275text"](7,"\n            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](8,"\n          "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n        "),j["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=j["\u0275\u0275nextContext"](2).ngVar,a=j["\u0275\u0275nextContext"](3);j["\u0275\u0275property"]("id",n)("ngClass",j["\u0275\u0275pureFunction4"](5,kt,0===i[n].changeType,2===i[n].changeType,1===i[n].changeType,void 0===i[n].changeType)),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("fieldUpdate",i[n])("bundleUrl",a.bundle.self)("columnSizes",a.columnSizes)}}function Ct(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n        "),j["\u0275\u0275template"](2,wt,10,10,"div",6),j["\u0275\u0275text"](3,"\n      "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=j["\u0275\u0275nextContext"](4);j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngForOf",n.customOrder)}}var Et=function(e){return{"mb-3":e}};function Mt(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"div",5),j["\u0275\u0275listener"]("cdkDropListDropped",(function(e){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](3).drop(e)})),j["\u0275\u0275pipe"](1,"async"),j["\u0275\u0275text"](2,"\n      "),j["\u0275\u0275template"](3,Ct,4,1,"ng-container",2),j["\u0275\u0275text"](4,"\n    "),j["\u0275\u0275elementEnd"]()}if(2&e){var i,a=t.ngVar,r=j["\u0275\u0275nextContext"](3);j["\u0275\u0275property"]("id",r.bundle.id)("ngClass",j["\u0275\u0275pureFunction1"](5,Et,(null==(i=j["\u0275\u0275pipeBind1"](1,3,r.objectsRD$))||null==i.payload?null:i.payload.totalElements)>r.pageSize)),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("ngIf",a)}}function Bt(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275template"](2,Mt,5,7,"div",4),j["\u0275\u0275pipe"](3,"async"),j["\u0275\u0275text"](4,"\n  "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=j["\u0275\u0275nextContext"](2);j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngVar",j["\u0275\u0275pipeBind1"](3,1,n.updates$))}}function Vt(e,t){1&e&&(j["\u0275\u0275element"](0,"ds-loading",10),j["\u0275\u0275pipe"](1,"translate")),2&e&&j["\u0275\u0275property"]("message",j["\u0275\u0275pipeBind1"](1,1,"loading.bitstreams"))}function Rt(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"ds-pagination",1),j["\u0275\u0275pipe"](1,"async"),j["\u0275\u0275pipe"](2,"async"),j["\u0275\u0275text"](3,"\n  "),j["\u0275\u0275template"](4,Bt,5,3,"ng-container",2),j["\u0275\u0275pipe"](5,"async"),j["\u0275\u0275text"](6,"\n  "),j["\u0275\u0275template"](7,Vt,2,3,"ds-loading",3),j["\u0275\u0275pipe"](8,"async"),j["\u0275\u0275text"](9,"\n"),j["\u0275\u0275elementEnd"]()),2&e){var n,i,a=j["\u0275\u0275nextContext"]();j["\u0275\u0275property"]("hideGear",!0)("hidePagerWhenSinglePage",!0)("hidePaginationDetail",!0)("paginationOptions",a.options)("pageInfoState",null==(n=j["\u0275\u0275pipeBind1"](1,8,a.objectsRD$))?null:n.payload)("collectionSize",null==(i=j["\u0275\u0275pipeBind1"](2,10,a.objectsRD$))||null==i.payload?null:i.payload.totalElements),j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("ngIf",!j["\u0275\u0275pipeBind1"](5,12,a.loading$)),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("ngIf",j["\u0275\u0275pipeBind1"](8,14,a.loading$))}}var Ut,Ft=((Ut=function(e){s(n,e);var t=d(n);function n(e,i,a,o,c,s){var l;return r(this,n),(l=t.call(this,e,i,a,c)).objectUpdatesService=e,l.elRef=i,l.objectValuesPipe=a,l.bundleService=o,l.paginationService=c,l.requestService=s,l}return c(n,[{key:"ngOnInit",value:function(){a(p(n.prototype),"ngOnInit",this).call(this)}},{key:"initializeObjectsRD",value:function(){var e=this;this.objectsRD$=this.currentPage$.pipe(Object(ne.a)((function(t){var n=new He.a({pagination:Object.assign({},t)});return e.bundleService.getBitstreamsEndpoint(e.bundle.id,n).pipe(Object(ne.a)((function(t){return e.requestService.hasByHref$(t)})),Object(ne.a)((function(){return e.bundleService.getBitstreams(e.bundle.id,n,Object(ce.a)("format"))})))})))}},{key:"initializeURL",value:function(){this.url=this.bundle.self}}]),n}(ft)).\u0275fac=function(e){return new(e||Ut)(j["\u0275\u0275directiveInject"](se.a),j["\u0275\u0275directiveInject"](j.ElementRef),j["\u0275\u0275directiveInject"](pt.a),j["\u0275\u0275directiveInject"](nt.a),j["\u0275\u0275directiveInject"](mt.a),j["\u0275\u0275directiveInject"](tt.a))},Ut.\u0275cmp=j["\u0275\u0275defineComponent"]({type:Ut,selectors:[["ds-paginated-drag-and-drop-bitstream-list"]],inputs:{bundle:"bundle",columnSizes:"columnSizes"},features:[j["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:3,consts:[[3,"hideGear","hidePagerWhenSinglePage","hidePaginationDetail","paginationOptions","pageInfoState","collectionSize",4,"ngIf"],[3,"hideGear","hidePagerWhenSinglePage","hidePaginationDetail","paginationOptions","pageInfoState","collectionSize"],[4,"ngIf"],[3,"message",4,"ngIf"],["class","bundle-bitstreams-list","cdkDropList","",3,"id","ngClass","cdkDropListDropped",4,"ngVar"],["cdkDropList","",1,"bundle-bitstreams-list",3,"id","ngClass","cdkDropListDropped"],["class","row bitstream-row","cdkDrag","",3,"id","ngClass",4,"ngFor","ngForOf"],["cdkDrag","",1,"row","bitstream-row",3,"id","ngClass"],[3,"fieldUpdate","bundleUrl","columnSizes"],["slot","drag-handle","cdkDragHandle","",1,"d-flex","align-items-center"],[3,"message"]],template:function(e,t){var n;1&e&&(j["\u0275\u0275template"](0,Rt,10,16,"ds-pagination",0),j["\u0275\u0275pipe"](1,"async"),j["\u0275\u0275text"](2,"\n")),2&e&&j["\u0275\u0275property"]("ngIf",null==(n=j["\u0275\u0275pipeBind1"](1,1,t.objectsRD$))?null:n.payload)},directives:[u.u,dt.a,pe.a,lt.e,u.r,u.t,lt.a,Ot,lt.b,ct,It.a],pipes:[u.b,O.e],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}"]}),Ut),Tt=["bundleView"],Pt=function(e){return{name:e}},Dt=function(e){return[e,"bitstreams","new"]},$t=function(e){return{bundle:e}};function zt(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275text"](0,"\n  "),j["\u0275\u0275elementStart"](1,"div",1),j["\u0275\u0275text"](2,"\n    "),j["\u0275\u0275elementStart"](3,"div"),j["\u0275\u0275text"](4,"\n      "),j["\u0275\u0275element"](5,"ds-item-edit-bitstream-drag-handle"),j["\u0275\u0275text"](6,"\n      "),j["\u0275\u0275elementStart"](7,"div",2),j["\u0275\u0275text"](8),j["\u0275\u0275pipe"](9,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](10,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](11,"\n    "),j["\u0275\u0275elementStart"](12,"div"),j["\u0275\u0275text"](13,"\n      "),j["\u0275\u0275elementStart"](14,"div",3),j["\u0275\u0275text"](15,"\n        "),j["\u0275\u0275elementStart"](16,"button",4),j["\u0275\u0275pipe"](17,"translate"),j["\u0275\u0275text"](18,"\n          "),j["\u0275\u0275element"](19,"i",5),j["\u0275\u0275text"](20,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](21,"\n      "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](22,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](23,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](24,"\n  "),j["\u0275\u0275elementStart"](25,"ds-paginated-drag-and-drop-bitstream-list",6),j["\u0275\u0275listener"]("dropObject",(function(e){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().dropObject.emit(e)})),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n")}if(2&e){var i=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](3),j["\u0275\u0275classMapInterpolate1"]("",i.bundleNameColumn.buildClasses()," font-weight-bold row-element d-flex"),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\n        ",j["\u0275\u0275pipeBind2"](9,12,"item.edit.bitstreams.bundle.name",j["\u0275\u0275pureFunction1"](17,Pt,i.bundle.name)),"\n      "),j["\u0275\u0275advance"](4),j["\u0275\u0275classMapInterpolate1"]("",i.columnSizes.columns[3].buildClasses()," text-center row-element"),j["\u0275\u0275advance"](4),j["\u0275\u0275propertyInterpolate"]("title",j["\u0275\u0275pipeBind1"](17,15,"item.edit.bitstreams.bundle.edit.buttons.upload")),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pureFunction1"](19,Dt,i.itemPageRoute))("queryParams",j["\u0275\u0275pureFunction1"](21,$t,i.bundle.id)),j["\u0275\u0275advance"](9),j["\u0275\u0275property"]("bundle",i.bundle)("columnSizes",i.columnSizes)}}var Lt,_t=((Lt=function(){function e(t){r(this,e),this.viewContainerRef=t,this.dropObject=new j.EventEmitter}return c(e,[{key:"ngOnInit",value:function(){this.bundleNameColumn=this.columnSizes.combineColumns(0,2),this.viewContainerRef.createEmbeddedView(this.bundleView),this.itemPageRoute=Object(y.f)(this.item)}}]),e}()).\u0275fac=function(e){return new(e||Lt)(j["\u0275\u0275directiveInject"](j.ViewContainerRef))},Lt.\u0275cmp=j["\u0275\u0275defineComponent"]({type:Lt,selectors:[["ds-item-edit-bitstream-bundle"]],viewQuery:function(e,t){var n;1&e&&j["\u0275\u0275staticViewQuery"](Tt,!0),2&e&&j["\u0275\u0275queryRefresh"](n=j["\u0275\u0275loadQuery"]())&&(t.bundleView=n.first)},inputs:{bundle:"bundle",item:"item",columnSizes:"columnSizes"},outputs:{dropObject:"dropObject"},decls:3,vars:0,consts:[["bundleView",""],[1,"row","bundle-row"],[1,"float-left","d-flex","align-items-center"],[1,"btn-group","bundle-action-buttons"],[1,"btn","btn-outline-success","btn-sm",3,"routerLink","queryParams","title"],[1,"fas","fa-upload","fa-fw"],[3,"bundle","columnSizes","dropObject"]],template:function(e,t){1&e&&(j["\u0275\u0275template"](0,zt,27,23,"ng-template",null,0,j["\u0275\u0275templateRefExtractor"]),j["\u0275\u0275text"](2,"\n"))},directives:[ct,f.h,Ft],pipes:[O.e],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}"]}),Lt);function Nt(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"button",17),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](2).reinstate()})),j["\u0275\u0275element"](1,"i",18),j["\u0275\u0275text"](2,"\n      "),j["\u0275\u0275elementStart"](3,"span",5),j["\u0275\u0275text"](4),j["\u0275\u0275pipe"](5,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](6,"\n    "),j["\u0275\u0275elementEnd"]()}2&e&&(j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](5,1,"item.edit.bitstreams.reinstate-button"),""))}function At(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"button",19),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](2).discard()})),j["\u0275\u0275pipe"](1,"async"),j["\u0275\u0275element"](2,"i",20),j["\u0275\u0275text"](3,"\n      "),j["\u0275\u0275elementStart"](4,"span",5),j["\u0275\u0275text"](5),j["\u0275\u0275pipe"](6,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](7,"\n    "),j["\u0275\u0275elementEnd"]()}if(2&e){var i=j["\u0275\u0275nextContext"](2);j["\u0275\u0275property"]("disabled",!j["\u0275\u0275pipeBind1"](1,2,i.hasChanges())||i.submitting),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](6,4,"item.edit.bitstreams.discard-button"),"")}}function qt(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"ds-item-edit-bitstream-bundle",24),j["\u0275\u0275listener"]("dropObject",(function(e){j["\u0275\u0275restoreView"](n);var i=t.$implicit;return j["\u0275\u0275nextContext"](3).dropBitstream(i,e)})),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,a=j["\u0275\u0275nextContext"](3);j["\u0275\u0275property"]("bundle",i)("item",a.item)("columnSizes",a.columnSizes)}}function Jt(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div",21),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",22),j["\u0275\u0275text"](3,"\n      "),j["\u0275\u0275elementStart"](4,"div"),j["\u0275\u0275text"](5,"\n        "),j["\u0275\u0275element"](6,"ds-item-edit-bitstream-drag-handle"),j["\u0275\u0275text"](7),j["\u0275\u0275pipe"](8,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n      "),j["\u0275\u0275elementStart"](10,"div"),j["\u0275\u0275text"](11),j["\u0275\u0275pipe"](12,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n      "),j["\u0275\u0275elementStart"](14,"div"),j["\u0275\u0275text"](15),j["\u0275\u0275pipe"](16,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](17,"\n      "),j["\u0275\u0275elementStart"](18,"div"),j["\u0275\u0275text"](19),j["\u0275\u0275pipe"](20,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](21,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](22,"\n    "),j["\u0275\u0275template"](23,qt,2,3,"ds-item-edit-bitstream-bundle",23),j["\u0275\u0275text"](24,"\n  "),j["\u0275\u0275elementEnd"]()),2&e){var n=j["\u0275\u0275nextContext"]().ngVar,i=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](4),j["\u0275\u0275classMapInterpolate1"]("",i.columnSizes.columns[0].buildClasses()," row-element"),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("\n        ",j["\u0275\u0275pipeBind1"](8,17,"item.edit.bitstreams.headers.name"),"\n      "),j["\u0275\u0275advance"](3),j["\u0275\u0275classMapInterpolate1"]("",i.columnSizes.columns[1].buildClasses()," row-element"),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](12,19,"item.edit.bitstreams.headers.description")),j["\u0275\u0275advance"](3),j["\u0275\u0275classMapInterpolate1"]("",i.columnSizes.columns[2].buildClasses()," text-center row-element"),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](16,21,"item.edit.bitstreams.headers.format")),j["\u0275\u0275advance"](3),j["\u0275\u0275classMapInterpolate1"]("",i.columnSizes.columns[3].buildClasses()," text-center row-element"),j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](20,23,"item.edit.bitstreams.headers.actions")),j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("ngForOf",n)}}function Kt(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",25),j["\u0275\u0275text"](1),j["\u0275\u0275pipe"](2,"translate"),j["\u0275\u0275elementEnd"]()),2&e&&(j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n    ",j["\u0275\u0275pipeBind1"](2,1,"item.edit.bitstreams.empty"),"\n  "))}function Qt(e,t){1&e&&(j["\u0275\u0275element"](0,"ds-loading",26),j["\u0275\u0275pipe"](1,"translate")),2&e&&j["\u0275\u0275propertyInterpolate"]("message",j["\u0275\u0275pipeBind1"](1,1,"loading.bitstreams"))}function Yt(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"button",27),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](2).reinstate()})),j["\u0275\u0275element"](1,"i",18),j["\u0275\u0275text"](2,"\n        "),j["\u0275\u0275elementStart"](3,"span",5),j["\u0275\u0275text"](4),j["\u0275\u0275pipe"](5,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](6,"\n      "),j["\u0275\u0275elementEnd"]()}2&e&&(j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](5,1,"item.edit.bitstreams.reinstate-button"),""))}function Wt(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"button",19),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](2).discard()})),j["\u0275\u0275pipe"](1,"async"),j["\u0275\u0275element"](2,"i",20),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275elementStart"](4,"span",5),j["\u0275\u0275text"](5),j["\u0275\u0275pipe"](6,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](7,"\n      "),j["\u0275\u0275elementEnd"]()}if(2&e){var i=j["\u0275\u0275nextContext"](2);j["\u0275\u0275property"]("disabled",!j["\u0275\u0275pipeBind1"](1,2,i.hasChanges())||i.submitting),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](6,4,"item.edit.bitstreams.discard-button"),"")}}var Ht=function(e){return[e,"bitstreams","new"]};function Gt(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"div",1),j["\u0275\u0275text"](1,"\n  "),j["\u0275\u0275elementStart"](2,"div",2),j["\u0275\u0275text"](3,"\n    "),j["\u0275\u0275elementStart"](4,"button",3),j["\u0275\u0275element"](5,"i",4),j["\u0275\u0275text"](6,"\n      "),j["\u0275\u0275elementStart"](7,"span",5),j["\u0275\u0275text"](8),j["\u0275\u0275pipe"](9,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](10,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](11,"\n    "),j["\u0275\u0275template"](12,Nt,7,3,"button",6),j["\u0275\u0275pipe"](13,"async"),j["\u0275\u0275text"](14,"\n    "),j["\u0275\u0275elementStart"](15,"button",7),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().submit()})),j["\u0275\u0275pipe"](16,"async"),j["\u0275\u0275element"](17,"i",8),j["\u0275\u0275text"](18,"\n      "),j["\u0275\u0275elementStart"](19,"span",5),j["\u0275\u0275text"](20),j["\u0275\u0275pipe"](21,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](22,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](23,"\n    "),j["\u0275\u0275template"](24,At,8,6,"button",9),j["\u0275\u0275pipe"](25,"async"),j["\u0275\u0275text"](26,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](27,"\n\n  "),j["\u0275\u0275template"](28,Jt,25,25,"div",10),j["\u0275\u0275text"](29,"\n  "),j["\u0275\u0275template"](30,Kt,3,3,"div",11),j["\u0275\u0275text"](31,"\n  "),j["\u0275\u0275template"](32,Qt,2,3,"ds-loading",12),j["\u0275\u0275text"](33,"\n\n  "),j["\u0275\u0275elementStart"](34,"div",13),j["\u0275\u0275text"](35,"\n    "),j["\u0275\u0275elementStart"](36,"div",14),j["\u0275\u0275text"](37,"\n      "),j["\u0275\u0275template"](38,Yt,7,3,"button",15),j["\u0275\u0275pipe"](39,"async"),j["\u0275\u0275text"](40,"\n      "),j["\u0275\u0275elementStart"](41,"button",16),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().submit()})),j["\u0275\u0275pipe"](42,"async"),j["\u0275\u0275element"](43,"i",8),j["\u0275\u0275text"](44,"\n        "),j["\u0275\u0275elementStart"](45,"span",5),j["\u0275\u0275text"](46),j["\u0275\u0275pipe"](47,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](48,"\n      "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](49,"\n      "),j["\u0275\u0275template"](50,Wt,8,6,"button",9),j["\u0275\u0275pipe"](51,"async"),j["\u0275\u0275text"](52,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](53,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](54,"\n"),j["\u0275\u0275elementEnd"]()}if(2&e){var i=t.ngVar,a=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pureFunction1"](31,Ht,a.itemPageRoute)),j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](9,13,"item.edit.bitstreams.upload-button"),""),j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("ngIf",j["\u0275\u0275pipeBind1"](13,15,a.isReinstatable())),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("disabled",!j["\u0275\u0275pipeBind1"](16,17,a.hasChanges())||a.submitting),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](21,19,"item.edit.bitstreams.save-button"),""),j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("ngIf",!j["\u0275\u0275pipeBind1"](25,21,a.isReinstatable())),j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("ngIf",a.item&&(null==i?null:i.length)>0),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",0===(null==i?null:i.length)),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",!i),j["\u0275\u0275advance"](6),j["\u0275\u0275property"]("ngIf",j["\u0275\u0275pipeBind1"](39,23,a.isReinstatable())),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("disabled",!j["\u0275\u0275pipeBind1"](42,25,a.hasChanges())||a.submitting),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](47,27,"item.edit.bitstreams.save-button"),""),j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("ngIf",!j["\u0275\u0275pipeBind1"](51,29,a.isReinstatable()))}}var Xt,Zt=((Xt=function(e){s(i,e);var n=d(i);function i(e,t,a,o,c,s,l,d,u,p,m,f){var b;return r(this,i),(b=n.call(this,e,t,a,o,c,s)).itemService=e,b.objectUpdatesService=t,b.router=a,b.notificationsService=o,b.translateService=c,b.route=s,b.bitstreamService=l,b.objectCache=d,b.requestService=u,b.cdRef=p,b.bundleService=m,b.zone=f,b.bundlesOptions={id:"bundles-pagination-options",currentPage:1,pageSize:9999},b.columnSizes=new Xe([new Ge(2,2,3,4,4),new Ge(2,3,3,3,3),new Ge(2,2,2,2,2),new Ge(6,5,4,3,3)]),b.submitting=!1,b}return c(i,[{key:"postItemInit",value:function(){this.bundles$=this.itemService.getBundles(this.item.id,new He.a({pagination:this.bundlesOptions})).pipe(Object(P.i)(),Object(P.o)(),Object(g.a)((function(e){return e.page})))}},{key:"initializeNotificationsPrefix",value:function(){this.notificationsPrefix="item.edit.bitstreams.notifications."}},{key:"submit",value:function(){var e=this;this.submitting=!0,this.bundles$.pipe(Object(ie.a)(1)).pipe(Object(ne.a)((function(n){return Object(Ye.a).apply(void 0,t(n.map((function(t){return e.objectUpdatesService.getFieldUpdates(t.self,[],!0)}))))})),Object(g.a)((function(e){var n;return(n=[]).concat.apply(n,t(e.map((function(e){return Object.values(e).filter((function(e){return e.changeType===We.c.REMOVE}))}))))})),Object(g.a)((function(e){return e.map((function(e){return e.field}))}))).pipe(Object(ie.a)(1),Object(ne.a)((function(n){return Object(x.e)(n)?Object(Ye.a).apply(void 0,t(n.map((function(t){return e.bitstreamService.delete(t.id)})))):Object(v.a)(void 0)}))).pipe(Object(ie.a)(1)).subscribe((function(t){e.displayNotifications("item.edit.bitstreams.notifications.remove",t),e.reset(),e.submitting=!1}))}},{key:"dropBitstream",value:function(e,t){var n=this;this.zone.runOutsideAngular((function(){Object(x.b)(t)&&Object(x.b)(t.fromIndex)&&Object(x.b)(t.toIndex)&&Object(x.b)(t.finish)&&n.bundleService.patch(e,[{op:"move",from:"/_links/bitstreams/".concat(t.fromIndex,"/href"),path:"/_links/bitstreams/".concat(t.toIndex,"/href")}]).pipe(Object(ie.a)(1)).subscribe((function(i){n.zone.run((function(){n.displayNotifications("item.edit.bitstreams.notifications.move",[i]),n.requestService.removeByHrefSubstring(e.self).pipe(Object(re.a)((function(e){return e})),Object(ie.a)(1)).subscribe((function(){return t.finish()}))}))}))}))}},{key:"displayNotifications",value:function(e,t){var n=this;if(Object(x.e)(t)){var i=t.filter((function(e){return Object(x.b)(e)&&e.hasFailed})),a=t.filter((function(e){return Object(x.b)(e)&&e.hasSucceeded}));i.forEach((function(t){n.notificationsService.error(n.translateService.instant("".concat(e,".failed.title")),t.errorMessage)})),a.length>0&&this.notificationsService.success(this.translateService.instant("".concat(e,".saved.title")),this.translateService.instant("".concat(e,".saved.content")))}}},{key:"discard",value:function(){var e=this.notificationsService.info(this.getNotificationTitle("discarded"),this.getNotificationContent("discarded"),{timeOut:this.discardTimeOut});this.objectUpdatesService.discardAllFieldUpdates(this.url,e)}},{key:"reinstate",value:function(){var e=this;this.bundles$.pipe(Object(ie.a)(1)).subscribe((function(t){t.forEach((function(t){e.objectUpdatesService.reinstateFieldUpdates(t.self)}))}))}},{key:"isReinstatable",value:function(){var e=this;return this.bundles$.pipe(Object(ne.a)((function(n){return Object(Ye.a).apply(void 0,t(n.map((function(t){return e.objectUpdatesService.isReinstatable(t.self)}))))})),Object(g.a)((function(e){return e.includes(!0)})))}},{key:"hasChanges",value:function(){var e=this;return this.bundles$.pipe(Object(ne.a)((function(n){return Object(Ye.a).apply(void 0,t(n.map((function(t){return e.objectUpdatesService.hasUpdates(t.self)}))))})),Object(g.a)((function(e){return e.includes(!0)})))}},{key:"reset",value:function(){this.refreshItemCache()}},{key:"refreshItemCache",value:function(){var e=this;this.bundles$.pipe(Object(ie.a)(1)).subscribe((function(t){t.forEach((function(t){e.objectCache.remove(t.self),e.requestService.removeByHrefSubstring(t.self)})),e.objectCache.remove(e.item.self),e.requestService.removeByHrefSubstring(e.item.self)}))}},{key:"ngOnDestroy",value:function(){this.itemUpdateSubscription&&this.itemUpdateSubscription.unsubscribe()}}]),i}(Qe.a)).\u0275fac=function(e){return new(e||Xt)(j["\u0275\u0275directiveInject"](z.a),j["\u0275\u0275directiveInject"](se.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"]($.a),j["\u0275\u0275directiveInject"](O.f),j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](Ze.a),j["\u0275\u0275directiveInject"](et.a),j["\u0275\u0275directiveInject"](tt.a),j["\u0275\u0275directiveInject"](j.ChangeDetectorRef),j["\u0275\u0275directiveInject"](nt.a),j["\u0275\u0275directiveInject"](j.NgZone))},Xt.\u0275cmp=j["\u0275\u0275defineComponent"]({type:Xt,selectors:[["ds-item-bitstreams"]],features:[j["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:3,consts:[["class","item-bitstreams",4,"ngVar"],[1,"item-bitstreams"],[1,"button-row","top","d-flex","mt-2"],[1,"mr-auto","btn","btn-success",3,"routerLink"],[1,"fas","fa-upload"],[1,"d-none","d-sm-inline"],["class","btn btn-warning mr-1",3,"click",4,"ngIf"],[1,"btn","btn-primary","mr-1",3,"disabled","click"],[1,"fas","fa-save"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","container table-bordered mt-4",4,"ngIf"],["class","alert alert-info w-100 d-inline-block mt-4","role","alert",4,"ngIf"],[3,"message",4,"ngIf"],[1,"button-row","bottom"],[1,"mt-4","float-right"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-warning","mr-1",3,"click"],[1,"fas","fa-undo-alt"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"container","table-bordered","mt-4"],[1,"row","header-row","font-weight-bold"],[3,"bundle","item","columnSizes","dropObject",4,"ngFor","ngForOf"],[3,"bundle","item","columnSizes","dropObject"],["role","alert",1,"alert","alert-info","w-100","d-inline-block","mt-4"],[3,"message"],[1,"btn","btn-warning",3,"click"]],template:function(e,t){1&e&&(j["\u0275\u0275template"](0,Gt,55,33,"div",0),j["\u0275\u0275pipe"](1,"async"),j["\u0275\u0275text"](2,"\n")),2&e&&j["\u0275\u0275property"]("ngVar",j["\u0275\u0275pipeBind1"](1,1,t.bundles$))},directives:[pe.a,f.h,u.u,ct,u.t,_t,It.a],pipes:[u.b,O.e],styles:[".header-row[_ngcontent-%COMP%]{color:var(--bs-table-dark-color);background-color:var(--bs-table-dark-bg);border-color:var(--bs-table-dark-border-color)}.bundle-row[_ngcontent-%COMP%]{color:var(--bs-table-head-color);background-color:var(--bs-table-head-bg);border-color:var(--bs-table-border-color)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.drag-handle[_ngcontent-%COMP%]{visibility:hidden}.drag-handle[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}[_nghost-%COMP%]     .bitstream-row:hover .drag-handle{visibility:visible!important}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}"]}),Xt),en=l("JX91"),tn=l("QhmN"),nn=l("joI/"),an=l("gWc+"),rn=l("DNva"),on=l("f7iX"),cn=l("DdXh"),sn=["tabs"];function ln(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275text"](0,"\n            "),j["\u0275\u0275elementStart"](1,"div",9),j["\u0275\u0275text"](2,"\n              "),j["\u0275\u0275elementStart"](3,"ds-collection-select",10),j["\u0275\u0275listener"]("confirm",(function(e){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().removeMappings(e)}))("cancel",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().onCancel()})),j["\u0275\u0275pipe"](4,"async"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](5,"\n            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](6,"\n          ")}if(2&e){var i,a=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("key","browse")("dsoRD$",a.itemCollectionsRD$)("paginationOptions",null==(i=j["\u0275\u0275pipeBind1"](4,6,a.searchOptions$))?null:i.pagination)("confirmButton","item.edit.item-mapper.buttons.remove")("cancelButton","item.edit.item-mapper.cancel")("dangerConfirm",!0)}}function dn(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"div"),j["\u0275\u0275text"](1,"\n              "),j["\u0275\u0275elementStart"](2,"ds-collection-select",16),j["\u0275\u0275listener"]("confirm",(function(e){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](2).mapCollections(e)}))("cancel",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](2).onCancel()})),j["\u0275\u0275pipe"](3,"async"),j["\u0275\u0275pipe"](4,"async"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](5,"\n            "),j["\u0275\u0275elementEnd"]()}if(2&e){var i,a,r=j["\u0275\u0275nextContext"](2);j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("key","map")("dsoRD$",r.mappedCollectionsRD$)("paginationOptions",null==(i=j["\u0275\u0275pipeBind1"](3,6,r.searchOptions$))?null:i.pagination)("sortOptions",null==(a=j["\u0275\u0275pipeBind1"](4,8,r.searchOptions$))?null:a.sort)("confirmButton","item.edit.item-mapper.buttons.add")("cancelButton","item.edit.item-mapper.cancel")}}function un(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",17),j["\u0275\u0275text"](1),j["\u0275\u0275pipe"](2,"translate"),j["\u0275\u0275elementEnd"]()),2&e&&(j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n              ",j["\u0275\u0275pipeBind1"](2,1,"item.edit.item-mapper.no-search"),"\n            "))}function pn(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275text"](0,"\n            "),j["\u0275\u0275elementStart"](1,"div",11),j["\u0275\u0275text"](2,"\n              "),j["\u0275\u0275elementStart"](3,"div",12),j["\u0275\u0275text"](4,"\n                "),j["\u0275\u0275elementStart"](5,"ds-search-form",13),j["\u0275\u0275listener"]("submitSearch",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().performedSearch=!0})),j["\u0275\u0275pipe"](6,"async"),j["\u0275\u0275pipe"](7,"translate"),j["\u0275\u0275text"](8,"\n                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n              "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](10,"\n            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](11,"\n\n            "),j["\u0275\u0275template"](12,dn,6,10,"div",14),j["\u0275\u0275text"](13,"\n            "),j["\u0275\u0275template"](14,un,3,3,"div",15),j["\u0275\u0275text"](15,"\n          ")}if(2&e){var i,a=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](5),j["\u0275\u0275property"]("query",null==(i=j["\u0275\u0275pipeBind1"](6,6,a.searchOptions$))?null:i.query)("currentUrl","./")("inPlaceSearch",!0)("searchPlaceholder",j["\u0275\u0275pipeBind1"](7,8,"item.edit.item-mapper.search-form.placeholder")),j["\u0275\u0275advance"](7),j["\u0275\u0275property"]("ngIf",a.performedSearch),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",!a.performedSearch)}}var mn,fn=function(e){return{name:e}},bn=((mn=function(){function i(e,t,n,a,o,c,s,l,d){r(this,i),this.route=e,this.router=t,this.searchConfigService=n,this.searchService=a,this.notificationsService=o,this.itemDataService=c,this.collectionDataService=s,this.translateService=l,this.dsoNameService=d,this.performedSearch=!1}return c(i,[{key:"ngOnInit",value:function(){var e=this;this.itemRD$=this.route.parent.data.pipe(Object(ie.a)(1),Object(g.a)((function(e){return e.dso}))),this.itemName$=this.itemRD$.pipe(Object(re.a)((function(e){return Object(x.b)(e)})),Object(g.a)((function(t){return e.dsoNameService.getName(t.payload)}))),this.searchOptions$=this.searchConfigService.paginatedSearchOptions,this.loadCollectionLists()}},{key:"loadCollectionLists",value:function(){var n=this;console.log("loadCollectionLists"),this.shouldUpdate$=new Re.a(!0),this.itemCollectionsRD$=Object(h.a)(this.itemRD$.pipe(Object(P.j)()),this.shouldUpdate$).pipe(Object(ne.a)((function(t){var i=e(t,2),a=i[0],r=i[1];return!0===r&&n.shouldUpdate$.next(!1),n.collectionDataService.findAllByHref(n.itemDataService.getMappedCollectionsEndpoint(a.id),void 0,!r,!1).pipe(Object(P.c)())})));var i=this.itemRD$.pipe(Object(P.j)(),Object(ne.a)((function(e){return n.collectionDataService.findOwningCollectionFor(e)})),Object(P.c)()),a=Object(h.a)(this.itemCollectionsRD$,i,this.searchOptions$);this.mappedCollectionsRD$=a.pipe(Object(ne.a)((function(i){var a=e(i,3),r=a[0],o=a[1],c=a[2];return n.searchService.search(Object.assign(new He.a(c),{query:n.buildQuery([].concat(t(r.payload.page),[o.payload]),c.query),dsoTypes:[tn.a.COLLECTION]}),1e4).pipe(Object(P.y)(),Object(en.a)(void 0))})))}},{key:"mapCollections",value:function(t){var n=this,i=Object(h.a)([this.itemRD$.pipe(Object(P.i)(),Object(g.a)((function(e){return e.payload})),Object(g.a)((function(e){return e.id}))),this.itemCollectionsRD$.pipe(Object(P.i)(),Object(g.a)((function(e){return e.payload.page})),Object(g.a)((function(e){return e.map((function(e){return e.id}))})))]).pipe(Object(ne.a)((function(i){var a=e(i,2),r=a[0],o=a[1];return Object(h.a)(n.filterIds(t,o).map((function(e){return n.itemDataService.mapToCollection(r,e).pipe(Object(P.g)())})))})));this.showNotifications(i,"item.edit.item-mapper.notifications.add")}},{key:"removeMappings",value:function(e){var t=this,n=this.itemRD$.pipe(Object(P.i)(),Object(g.a)((function(e){return e.payload.id})),Object(ne.a)((function(n){return Object(h.a)(e.map((function(e){return t.itemDataService.removeMappingFromCollection(n,e).pipe(Object(P.g)())})))})));this.showNotifications(n,"item.edit.item-mapper.notifications.remove")}},{key:"filterIds",value:function(e,t){return e.filter((function(e){return t.indexOf(e)<0}))}},{key:"showNotifications",value:function(t,n){var i=this;t.subscribe((function(t){var a=t.filter((function(e){return e.hasSucceeded})),r=t.filter((function(e){return e.hasFailed}));a.length>0&&(Object(h.a)([i.translateService.get("".concat(n,".success.head")),i.translateService.get("".concat(n,".success.content"),{amount:a.length})]).subscribe((function(t){var n=e(t,2),a=n[0],r=n[1];i.notificationsService.success(a,r)})),i.shouldUpdate$.next(!0)),r.length>0&&Object(h.a)([i.translateService.get("".concat(n,".error.head")),i.translateService.get("".concat(n,".error.content"),{amount:r.length})]).subscribe((function(t){var n=e(t,2),a=n[0],r=n[1];i.notificationsService.error(a,r)})),i.switchToFirstTab()}))}},{key:"tabChange",value:function(e){this.performedSearch=!1,this.router.navigateByUrl(this.getCurrentUrl())}},{key:"getCurrentUrl",value:function(){return this.router.url.indexOf("?")>-1?this.router.url.substring(0,this.router.url.indexOf("?")):this.router.url}},{key:"buildQuery",value:function(e,t){var i,a=t,r=function(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return c=e.done,e},e:function(e){s=!0,o=e},f:function(){try{c||null==i.return||i.return()}finally{if(s)throw o}}}}(e);try{for(r.s();!(i=r.n()).done;){var o=i.value;a=this.addExcludeCollection(o.id,a)}}catch(c){r.e(c)}finally{r.f()}return a}},{key:"addExcludeCollection",value:function(e,t){var n="-search.resourceid:".concat(e);return Object(x.e)(t)?"".concat(t," AND ").concat(n):n}},{key:"switchToFirstTab",value:function(){this.tabs.select("browseTab")}},{key:"onCancel",value:function(){var e=this;this.itemRD$.pipe(Object(P.i)(),Object(P.o)(),Object(ie.a)(1)).subscribe((function(t){e.router.navigate([Object(y.f)(t)])}))}}]),i}()).\u0275fac=function(e){return new(e||mn)(j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"](nn.a),j["\u0275\u0275directiveInject"](an.a),j["\u0275\u0275directiveInject"]($.a),j["\u0275\u0275directiveInject"](z.a),j["\u0275\u0275directiveInject"](rn.a),j["\u0275\u0275directiveInject"](O.f),j["\u0275\u0275directiveInject"](vt.a))},mn.\u0275cmp=j["\u0275\u0275defineComponent"]({type:mn,selectors:[["ds-item-collection-mapper"]],viewQuery:function(e,t){var n;1&e&&j["\u0275\u0275viewQuery"](sn,!0),2&e&&j["\u0275\u0275queryRefresh"](n=j["\u0275\u0275loadQuery"]())&&(t.tabs=n.first)},decls:37,vars:21,consts:[[1,"container"],[1,"row"],[1,"col-12"],["id","item-name",3,"innerHTML"],[3,"destroyOnHide","tabChange"],["tabs","ngbTabset"],["id","browseTab",3,"title"],["ngbTabContent",""],["id","mapTab",3,"title"],[1,"mt-2"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","confirmButton","cancelButton","dangerConfirm","confirm","cancel"],[1,"row","mt-2"],[1,"col-12","col-lg-6"],["id","search-form",3,"query","currentUrl","inPlaceSearch","searchPlaceholder","submitSearch"],[4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","sortOptions","confirmButton","cancelButton","confirm","cancel"],["role","alert",1,"alert","alert-info","w-100"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n  "),j["\u0275\u0275elementStart"](2,"div",1),j["\u0275\u0275text"](3,"\n    "),j["\u0275\u0275elementStart"](4,"div",2),j["\u0275\u0275text"](5,"\n      "),j["\u0275\u0275elementStart"](6,"h2"),j["\u0275\u0275text"](7),j["\u0275\u0275pipe"](8,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n      "),j["\u0275\u0275element"](10,"p",3),j["\u0275\u0275pipe"](11,"translate"),j["\u0275\u0275pipe"](12,"async"),j["\u0275\u0275text"](13,"\n      "),j["\u0275\u0275elementStart"](14,"p"),j["\u0275\u0275text"](15),j["\u0275\u0275pipe"](16,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](17,"\n\n      "),j["\u0275\u0275elementStart"](18,"ngb-tabset",4,5),j["\u0275\u0275listener"]("tabChange",(function(e){return t.tabChange(e)})),j["\u0275\u0275text"](20,"\n        "),j["\u0275\u0275elementStart"](21,"ngb-tab",6),j["\u0275\u0275pipe"](22,"translate"),j["\u0275\u0275text"](23,"\n          "),j["\u0275\u0275template"](24,ln,7,8,"ng-template",7),j["\u0275\u0275text"](25,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n        "),j["\u0275\u0275elementStart"](27,"ngb-tab",8),j["\u0275\u0275pipe"](28,"translate"),j["\u0275\u0275text"](29,"\n          "),j["\u0275\u0275template"](30,pn,16,10,"ng-template",7),j["\u0275\u0275text"](31,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](32,"\n      "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](33,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](34,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](35,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](36,"\n")),2&e&&(j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](8,6,"item.edit.item-mapper.head")),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("innerHTML",j["\u0275\u0275pipeBind2"](11,8,"item.edit.item-mapper.item",j["\u0275\u0275pureFunction1"](19,fn,j["\u0275\u0275pipeBind1"](12,11,t.itemName$))),j["\u0275\u0275sanitizeHtml"]),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](16,13,"item.edit.item-mapper.description")),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("destroyOnHide",!0),j["\u0275\u0275advance"](3),j["\u0275\u0275propertyInterpolate"]("title",j["\u0275\u0275pipeBind1"](22,15,"item.edit.item-mapper.tabs.browse")),j["\u0275\u0275advance"](6),j["\u0275\u0275propertyInterpolate"]("title",j["\u0275\u0275pipeBind1"](28,17,"item.edit.item-mapper.tabs.map")))},directives:[S.ab,S.X,S.Y,on.a,cn.a,u.u],pipes:[O.e,u.b],styles:[""],data:{animation:[b.a,b.c]},changeDetection:0}),mn),vn=l("Kr+g"),hn=l("s7LF");function gn(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"span"),j["\u0275\u0275text"](1),j["\u0275\u0275pipe"](2,"translate"),j["\u0275\u0275elementEnd"]()),2&e&&(j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"](" ",j["\u0275\u0275pipeBind1"](2,1,"item.edit.move.move"),""))}function xn(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"span"),j["\u0275\u0275element"](1,"i",10),j["\u0275\u0275text"](2),j["\u0275\u0275pipe"](3,"translate"),j["\u0275\u0275elementEnd"]()),2&e&&(j["\u0275\u0275advance"](2),j["\u0275\u0275textInterpolate1"]("\n                    ",j["\u0275\u0275pipeBind1"](3,1,"item.edit.move.processing"),"\n                "))}var yn,jn=function(e){return{id:e}},Sn=function(e){return[e,"edit"]},On=((yn=function(){function e(t,n,i,a,o,c){r(this,e),this.route=t,this.router=n,this.notificationsService=i,this.itemDataService=a,this.searchService=o,this.translateService=c,this.selectorType=tn.a.COLLECTION,this.inheritPolicies=!1,this.collectionSearchResults=Object(v.a)([]),this.canSubmit=!1,this.processing=!1,this.pagination=new st.a}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.itemRD$=this.route.data.pipe(Object(g.a)((function(e){return e.dso})),Object(P.i)()),this.itemPageRoute$=this.itemRD$.pipe(Object(P.d)(),Object(g.a)((function(e){return Object(y.f)(e)}))),this.itemRD$.subscribe((function(t){e.item=t.payload})),this.pagination.pageSize=5,this.loadSuggestions("")}},{key:"findSuggestions",value:function(e){this.loadSuggestions(e)}},{key:"loadSuggestions",value:function(e){this.collectionSearchResults=this.searchService.search(new He.a({pagination:this.pagination,dsoTypes:[tn.a.COLLECTION],query:e})).pipe(Object(D.a)(),Object(g.a)((function(e){return e.payload.page.map((function(e){return e.indexableObject}))})))}},{key:"onClick",value:function(e){this.selectedCollection=e,this.selectedCollectionName=e.name,this.canSubmit=!0}},{key:"getCurrentUrl",value:function(){return this.router.url}},{key:"moveCollection",value:function(){var e=this;this.processing=!0,this.itemDataService.moveToCollection(this.item.id,this.selectedCollection).pipe(Object(P.g)()).subscribe((function(t){e.router.navigate([Object(y.e)(e.item)]),t.hasSucceeded?e.notificationsService.success(e.translateService.get("item.edit.move.success")):e.notificationsService.error(e.translateService.get("item.edit.move.error")),e.processing=!1}))}},{key:"resetCollection",value:function(e){this.canSubmit=!1}}]),e}()).\u0275fac=function(e){return new(e||yn)(j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"]($.a),j["\u0275\u0275directiveInject"](z.a),j["\u0275\u0275directiveInject"](an.a),j["\u0275\u0275directiveInject"](O.f))},yn.\u0275cmp=j["\u0275\u0275defineComponent"]({type:yn,selectors:[["ds-item-move"]],decls:61,vars:38,consts:[[1,"container"],[1,"row"],[1,"col-12"],["id","search-form","ngDefaultControl","",3,"suggestions","placeholder","action","name","ngModel","ngModelChange","clickSuggestion","typeSuggestion","findSuggestions","click"],["f",""],["type","checkbox","name","tc","id","inheritPoliciesCheckbox",3,"ngModel","ngModelChange"],["for","inheritPoliciesCheckbox"],[1,"btn","btn-primary",3,"disabled","click"],[4,"ngIf"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-circle-notch","fa-spin"]],template:function(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",1),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275elementStart"](4,"div",2),j["\u0275\u0275text"](5,"\n            "),j["\u0275\u0275elementStart"](6,"h2"),j["\u0275\u0275text"](7),j["\u0275\u0275pipe"](8,"translate"),j["\u0275\u0275pipe"](9,"async"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](10,"\n            "),j["\u0275\u0275elementStart"](11,"p"),j["\u0275\u0275text"](12),j["\u0275\u0275pipe"](13,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](14,"\n            "),j["\u0275\u0275elementStart"](15,"div",1),j["\u0275\u0275text"](16,"\n                "),j["\u0275\u0275elementStart"](17,"div",2),j["\u0275\u0275text"](18,"\n                    "),j["\u0275\u0275elementStart"](19,"ds-dso-input-suggestions",3,4),j["\u0275\u0275listener"]("ngModelChange",(function(e){return t.selectedCollectionName=e}))("clickSuggestion",(function(e){return t.onClick(e)}))("typeSuggestion",(function(e){return t.resetCollection(e)}))("findSuggestions",(function(e){return t.findSuggestions(e)}))("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275reference"](20).open()})),j["\u0275\u0275pipe"](21,"async"),j["\u0275\u0275pipe"](22,"translate"),j["\u0275\u0275text"](23,"\n                    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](24,"\n\n                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](25,"\n            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n            "),j["\u0275\u0275elementStart"](27,"div",1),j["\u0275\u0275text"](28,"\n                "),j["\u0275\u0275elementStart"](29,"div",2),j["\u0275\u0275text"](30,"\n                    "),j["\u0275\u0275elementStart"](31,"p"),j["\u0275\u0275text"](32,"\n                        "),j["\u0275\u0275elementStart"](33,"input",5),j["\u0275\u0275listener"]("ngModelChange",(function(e){return t.inheritPolicies=e})),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](34,"\n                        "),j["\u0275\u0275elementStart"](35,"label",6),j["\u0275\u0275text"](36),j["\u0275\u0275pipe"](37,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](38,"\n                    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](39,"\n                    "),j["\u0275\u0275elementStart"](40,"p"),j["\u0275\u0275text"](41),j["\u0275\u0275pipe"](42,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](43,"\n                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](44,"\n            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](45,"\n\n            "),j["\u0275\u0275elementStart"](46,"button",7),j["\u0275\u0275listener"]("click",(function(){return t.moveCollection()})),j["\u0275\u0275text"](47,"\n                "),j["\u0275\u0275template"](48,gn,3,3,"span",8),j["\u0275\u0275text"](49,"\n                "),j["\u0275\u0275template"](50,xn,4,3,"span",8),j["\u0275\u0275text"](51,"\n            "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](52,"\n            "),j["\u0275\u0275elementStart"](53,"button",9),j["\u0275\u0275pipe"](54,"async"),j["\u0275\u0275text"](55),j["\u0275\u0275pipe"](56,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](57,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](58,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](59,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](60,"\n")}var i;2&e&&(j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind2"](8,15,"item.edit.move.head",j["\u0275\u0275pureFunction1"](34,jn,null==(i=j["\u0275\u0275pipeBind1"](9,18,t.itemRD$))||null==i.payload?null:i.payload.handle))),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](13,20,"item.edit.move.description")),j["\u0275\u0275advance"](7),j["\u0275\u0275property"]("suggestions",j["\u0275\u0275pipeBind1"](21,22,t.collectionSearchResults))("placeholder",j["\u0275\u0275pipeBind1"](22,24,"item.edit.move.search.placeholder"))("action",t.getCurrentUrl())("name","item-move")("ngModel",t.selectedCollectionName),j["\u0275\u0275advance"](14),j["\u0275\u0275property"]("ngModel",t.inheritPolicies),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](37,26,"item.edit.move.inheritpolicies.checkbox")),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\n                        ",j["\u0275\u0275pipeBind1"](42,28,"item.edit.move.inheritpolicies.description"),"\n                    "),j["\u0275\u0275advance"](5),j["\u0275\u0275property"]("disabled",!t.canSubmit),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",!t.processing),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",t.processing),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("routerLink",j["\u0275\u0275pureFunction1"](36,Sn,j["\u0275\u0275pipeBind1"](54,30,t.itemPageRoute$))),j["\u0275\u0275advance"](2),j["\u0275\u0275textInterpolate1"]("\n                ",j["\u0275\u0275pipeBind1"](56,32,"item.edit.move.cancel"),"\n            "))},directives:[vn.a,hn.DefaultValueAccessor,hn.NgControlStatus,hn.NgModel,hn.CheckboxControlValueAccessor,u.u,f.h],pipes:[O.e,u.b],encapsulation:2}),yn),In=l("aFKe"),kn=l("1Pbu"),wn=l("kcku"),Cn=l("4SI6"),En=l("EGek");function Mn(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div"),j["\u0275\u0275text"](1,"\n                        "),j["\u0275\u0275elementStart"](2,"div",15),j["\u0275\u0275text"](3),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](4,"\n                        "),j["\u0275\u0275elementStart"](5,"div"),j["\u0275\u0275text"](6),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](7,"\n                    "),j["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("\n                            ",n.metadataField,"\n                        "),j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("\n                            ",n.metadataValue.value,"\n                        ")}}function Bn(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"div",9),j["\u0275\u0275listener"]("click",(function(){j["\u0275\u0275restoreView"](n);var e=t.ngVar,i=j["\u0275\u0275nextContext"]().$implicit;return j["\u0275\u0275nextContext"]().setSelectedVirtualMetadataItem(i,!e)})),j["\u0275\u0275text"](1,"\n                "),j["\u0275\u0275elementStart"](2,"div",10),j["\u0275\u0275text"](3,"\n                    "),j["\u0275\u0275elementStart"](4,"label"),j["\u0275\u0275text"](5,"\n                        "),j["\u0275\u0275element"](6,"input",11),j["\u0275\u0275text"](7,"\n                    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](8,"\n                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n                "),j["\u0275\u0275elementStart"](10,"div",12),j["\u0275\u0275text"](11,"\n                    "),j["\u0275\u0275elementStart"](12,"ds-listable-object-component-loader",13),j["\u0275\u0275text"](13,"\n                    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](14,"\n                    "),j["\u0275\u0275template"](15,Mn,8,2,"div",14),j["\u0275\u0275text"](16,"\n                "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](17,"\n            "),j["\u0275\u0275elementEnd"]()}if(2&e){var i=t.ngVar,a=j["\u0275\u0275nextContext"]().$implicit,r=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](6),j["\u0275\u0275property"]("checked",i),j["\u0275\u0275advance"](6),j["\u0275\u0275property"]("object",a),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("ngForOf",r.virtualMetadata.get(a.uuid))}}function Vn(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n            "),j["\u0275\u0275template"](2,Bn,18,3,"div",8),j["\u0275\u0275pipe"](3,"async"),j["\u0275\u0275text"](4,"\n        "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit,i=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngVar",j["\u0275\u0275pipeBind1"](3,1,i.isSelectedVirtualMetadataItem(n)))}}var Rn,Un=((Rn=function(){function t(e){r(this,t),this.objectUpdatesService=e,this.close=new j.EventEmitter,this.save=new j.EventEmitter,this.virtualMetadata=new Map}return c(t,[{key:"getVirtualMetadata",value:function(t){var n=this;return Object.entries(t.metadata).map((function(t){var i=e(t,2),a=i[0];return i[1].filter((function(e){return!a.startsWith("relation")&&e.authority&&e.authority.endsWith(n.relationshipId)})).map((function(e){return{metadataField:a,metadataValue:e}}))})).reduce((function(e,t){return e.concat(t)}),[])}},{key:"setSelectedVirtualMetadataItem",value:function(e,t){this.objectUpdatesService.setSelectedVirtualMetadata(this.url,this.relationshipId,e.uuid,t)}},{key:"isSelectedVirtualMetadataItem",value:function(e){return this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.relationshipId,e.uuid)}},{key:"trackItem",value:function(e,t){return t&&t.uuid}},{key:"ngOnInit",value:function(){var e=this;this.items.forEach((function(t){e.virtualMetadata.set(t.uuid,e.getVirtualMetadata(t))}))}},{key:"items",get:function(){return[this.leftItem,this.rightItem]}}]),t}()).\u0275fac=function(e){return new(e||Rn)(j["\u0275\u0275directiveInject"](se.a))},Rn.\u0275cmp=j["\u0275\u0275defineComponent"]({type:Rn,selectors:[["ds-virtual-metadata"]],inputs:{url:"url",relationshipId:"relationshipId",leftItem:"leftItem",rightItem:"rightItem"},outputs:{close:"close",save:"save"},decls:27,vars:8,consts:[[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","flex-row-reverse","m-2"],[1,"btn","btn-primary","save",3,"click"],[1,"fas","fa-save"],["class","item d-flex flex-row",3,"click",4,"ngVar"],[1,"item","d-flex","flex-row",3,"click"],[1,"m-2"],["type","checkbox",1,"select",3,"checked"],[1,"flex-column"],[3,"object"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div"),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275elementStart"](2,"div",0),j["\u0275\u0275text"](3),j["\u0275\u0275pipe"](4,"translate"),j["\u0275\u0275elementStart"](5,"button",1),j["\u0275\u0275listener"]("click",(function(){return t.close.emit()})),j["\u0275\u0275text"](6,"\n            "),j["\u0275\u0275elementStart"](7,"span",2),j["\u0275\u0275text"](8,"\xd7"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](9,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](10,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](11,"\n    "),j["\u0275\u0275elementStart"](12,"div",3),j["\u0275\u0275text"](13,"\n        "),j["\u0275\u0275template"](14,Vn,5,3,"ng-container",4),j["\u0275\u0275text"](15,"\n        "),j["\u0275\u0275elementStart"](16,"div",5),j["\u0275\u0275text"](17,"\n            "),j["\u0275\u0275elementStart"](18,"button",6),j["\u0275\u0275listener"]("click",(function(){return t.save.emit()})),j["\u0275\u0275text"](19,"\n                "),j["\u0275\u0275element"](20,"i",7),j["\u0275\u0275text"](21),j["\u0275\u0275pipe"](22,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](23,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](24,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](25,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n")),2&e&&(j["\u0275\u0275advance"](3),j["\u0275\u0275textInterpolate1"]("",j["\u0275\u0275pipeBind1"](4,4,"virtual-metadata.delete-relationship.modal-head"),"\n        "),j["\u0275\u0275advance"](11),j["\u0275\u0275property"]("ngForOf",t.items)("ngForTrackBy",t.trackItem),j["\u0275\u0275advance"](7),j["\u0275\u0275textInterpolate1"](" ",j["\u0275\u0275pipeBind1"](22,6,"item.edit.metadata.save-button"),"\n            "))},directives:[u.t,pe.a,me.a],pipes:[O.e,u.b],encapsulation:2}),Rn);function Fn(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"div",2),j["\u0275\u0275text"](1,"\n  "),j["\u0275\u0275elementStart"](2,"div",3),j["\u0275\u0275text"](3,"\n    "),j["\u0275\u0275elementStart"](4,"ds-listable-object-component-loader",4),j["\u0275\u0275pipe"](5,"async"),j["\u0275\u0275text"](6,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](7,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](8,"\n  "),j["\u0275\u0275elementStart"](9,"div",5),j["\u0275\u0275text"](10,"\n    "),j["\u0275\u0275elementStart"](11,"div",6),j["\u0275\u0275text"](12,"\n      "),j["\u0275\u0275elementStart"](13,"button",7),j["\u0275\u0275listener"]("click",(function(){j["\u0275\u0275restoreView"](n);var e=j["\u0275\u0275nextContext"](),t=j["\u0275\u0275reference"](4);return e.openVirtualMetadataModal(t)})),j["\u0275\u0275pipe"](14,"translate"),j["\u0275\u0275text"](15,"\n        "),j["\u0275\u0275element"](16,"i",8),j["\u0275\u0275text"](17,"\n      "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](18,"\n      "),j["\u0275\u0275elementStart"](19,"button",9),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().undo()})),j["\u0275\u0275pipe"](20,"translate"),j["\u0275\u0275text"](21,"\n        "),j["\u0275\u0275element"](22,"i",10),j["\u0275\u0275text"](23,"\n      "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](24,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](25,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](26,"\n"),j["\u0275\u0275elementEnd"]()}if(2&e){var i=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("object",j["\u0275\u0275pipeBind1"](5,7,i.relatedItem$))("viewMode",i.viewMode)("value",i.nameVariant),j["\u0275\u0275advance"](9),j["\u0275\u0275propertyInterpolate"]("title",j["\u0275\u0275pipeBind1"](14,9,"item.edit.metadata.edit.buttons.remove")),j["\u0275\u0275property"]("disabled",!i.canRemove()),j["\u0275\u0275advance"](6),j["\u0275\u0275propertyInterpolate"]("title",j["\u0275\u0275pipeBind1"](20,11,"item.edit.metadata.edit.buttons.undo")),j["\u0275\u0275property"]("disabled",!i.canUndo())}}function Tn(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275text"](0,"\n  "),j["\u0275\u0275elementStart"](1,"ds-virtual-metadata",11),j["\u0275\u0275listener"]("close",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().closeVirtualMetadataModal()}))("save",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"]().remove()})),j["\u0275\u0275pipe"](2,"async"),j["\u0275\u0275pipe"](3,"async"),j["\u0275\u0275text"](4,"\n  "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](5,"\n")}if(2&e){var i=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](1),j["\u0275\u0275property"]("relationshipId",i.relationship.id)("leftItem",j["\u0275\u0275pipeBind1"](2,4,i.leftItem$))("rightItem",j["\u0275\u0275pipeBind1"](3,6,i.rightItem$))("url",i.url)}}var Pn,Dn=((Pn=function(){function e(t,n){r(this,e),this.objectUpdatesService=t,this.modalService=n,this.viewMode=oe.a.ListElement}return c(e,[{key:"ngOnChanges",value:function(){var e=this;this.relationship?(this.leftItem$=this.relationship.leftItem.pipe(Object(P.i)(),Object(P.o)(),Object(re.a)((function(e){return Object(x.b)(e)&&Object(x.e)(e.uuid)}))),this.rightItem$=this.relationship.rightItem.pipe(Object(P.i)(),Object(P.o)(),Object(re.a)((function(e){return Object(x.b)(e)&&Object(x.e)(e.uuid)}))),this.relatedItem$=Object(h.a)(this.leftItem$,this.rightItem$).pipe(Object(g.a)((function(t){return t.find((function(t){return t.uuid!==e.editItem.uuid}))})))):this.relatedItem$=Object(v.a)(this.update.relatedItem)}},{key:"remove",value:function(){var e=this;this.closeVirtualMetadataModal(),Object(h.a)(this.leftItem$,this.rightItem$).pipe(Object(g.a)((function(t){return t.map((function(t){return e.objectUpdatesService.isSelectedVirtualMetadata(e.url,e.relationship.id,t.uuid)}))})),Object(ne.a)((function(e){return Object(h.a)(e)})),Object(g.a)((function(t){return Object.assign({},e.fieldUpdate.field,{keepLeftVirtualMetadata:!0===t[0],keepRightVirtualMetadata:!0===t[1]})})),Object(ie.a)(1)).subscribe((function(t){return e.objectUpdatesService.saveRemoveFieldUpdate(e.url,t)}))}},{key:"openVirtualMetadataModal",value:function(e){this.modalRef=this.modalService.open(e)}},{key:"closeVirtualMetadataModal",value:function(){this.modalRef.close()}},{key:"undo",value:function(){this.objectUpdatesService.removeSingleFieldUpdate(this.url,this.fieldUpdate.field.uuid)}},{key:"canRemove",value:function(){return this.fieldUpdate.changeType!==We.c.REMOVE&&this.fieldUpdate.changeType!==We.c.ADD}},{key:"canUndo",value:function(){return this.fieldUpdate.changeType>=0}},{key:"relationship",get:function(){return this.update.relationship}},{key:"update",get:function(){return this.fieldUpdate.field}},{key:"nameVariant",get:function(){return this.update.nameVariant}}]),e}()).\u0275fac=function(e){return new(e||Pn)(j["\u0275\u0275directiveInject"](se.a),j["\u0275\u0275directiveInject"](S.u))},Pn.\u0275cmp=j["\u0275\u0275defineComponent"]({type:Pn,selectors:[["ds-edit-relationship"]],inputs:{fieldUpdate:"fieldUpdate",url:"url",editItem:"editItem"},features:[j["\u0275\u0275NgOnChangesFeature"]],decls:6,vars:3,consts:[["class","row",4,"ngIf"],["virtualMetadataModal",""],[1,"row"],[1,"col-10","relationship"],[3,"object","viewMode","value"],[1,"col-2"],[1,"btn-group","relationship-action-buttons"],[1,"btn","btn-outline-danger","btn-sm",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"disabled","title","click"],[1,"fas","fa-undo-alt","fa-fw"],[3,"relationshipId","leftItem","rightItem","url","close","save"]],template:function(e,t){1&e&&(j["\u0275\u0275template"](0,Fn,27,13,"div",0),j["\u0275\u0275pipe"](1,"async"),j["\u0275\u0275text"](2,"\n"),j["\u0275\u0275template"](3,Tn,6,8,"ng-template",null,1,j["\u0275\u0275templateRefExtractor"]),j["\u0275\u0275text"](5,"\n")),2&e&&j["\u0275\u0275property"]("ngIf",j["\u0275\u0275pipeBind1"](1,1,t.relatedItem$))},directives:[u.u,me.a,Un],pipes:[u.b,O.e],styles:[".btn[disabled][_ngcontent-%COMP%]{color:var(--bs-gray-600);border-color:var(--bs-gray-600);z-index:0}.relationship-action-buttons[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}"]}),Pn),$n=function(){return{}},zn=function(e,t,n){return{"alert-success":e,"alert-warning":t,"alert-danger":n}};function Ln(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"ds-edit-relationship",6),j["\u0275\u0275text"](1,"\n            "),j["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=j["\u0275\u0275nextContext"](4);j["\u0275\u0275property"]("fieldUpdate",n||j["\u0275\u0275pureFunction0"](4,$n))("url",i.url)("editItem",i.item)("ngClass",j["\u0275\u0275pureFunction3"](5,zn,1===n.changeType,0===n.changeType,2===n.changeType))}}function _n(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div"),j["\u0275\u0275text"](1),j["\u0275\u0275pipe"](2,"translate"),j["\u0275\u0275elementEnd"]()),2&e&&(j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate"](j["\u0275\u0275pipeBind1"](2,1,"item.edit.relationships.no-relationships")))}function Nn(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n            "),j["\u0275\u0275template"](2,Ln,2,9,"ds-edit-relationship",5),j["\u0275\u0275text"](3,"\n            "),j["\u0275\u0275template"](4,_n,3,3,"div",4),j["\u0275\u0275text"](5,"\n        "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar,i=j["\u0275\u0275nextContext"](3);j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngForOf",n)("ngForTrackBy",i.trackUpdate),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",0===n.length)}}function An(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n        "),j["\u0275\u0275template"](2,Nn,6,3,"ng-container",3),j["\u0275\u0275pipe"](3,"dsObjectValues"),j["\u0275\u0275text"](4,"\n    "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=j["\u0275\u0275nextContext"]().ngVar;j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngVar",j["\u0275\u0275pipeBind1"](3,1,n))}}function qn(e,t){1&e&&j["\u0275\u0275element"](0,"ds-loading")}function Jn(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275template"](2,An,5,3,"ng-container",4),j["\u0275\u0275text"](3,"\n    "),j["\u0275\u0275template"](4,qn,1,0,"ds-loading",4),j["\u0275\u0275text"](5,"\n"),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar;j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",n),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",!n)}}var Kn,Qn=((Kn=function(){function t(e,n,i,a,o){r(this,t),this.objectUpdatesService=e,this.linkService=n,this.relationshipService=i,this.modalService=a,this.selectableListService=o}return c(t,[{key:"getRelationshipMessageKey",value:function(){return Object(h.a)(this.getLabel(),this.relatedEntityType$).pipe(Object(g.a)((function(t){var n=e(t,2),i=n[0],a=n[1];if(Object(x.b)(i)&&i.indexOf("is")>-1&&i.indexOf("Of")>-1){var r="".concat(i.substring(2,i.indexOf("Of")));return r!==a.label?"relationships.is".concat(r,"Of.").concat(a.label):"relationships.is".concat(r,"Of")}return i})))}},{key:"getLabel",value:function(){var e=this;return Object(h.a)([this.relationshipType.leftType,this.relationshipType.rightType].map((function(e){return e.pipe(Object(P.i)(),Object(P.o)())}))).pipe(Object(g.a)((function(t){return[e.relationshipType.leftwardType,e.relationshipType.rightwardType][t.findIndex((function(t){return t.id===e.itemType.id}))]})))}},{key:"trackUpdate",value:function(e,t){return t&&t.field?t.field.uuid:void 0}},{key:"openLookup",value:function(){var e=this;this.modalRef=this.modalService.open(kn.a,{size:"lg"});var t=this.modalRef.componentInstance;t.repeatable=!0,t.listId=this.listId,t.item=this.item,this.item.owningCollection.pipe(Object(P.j)()).subscribe((function(e){t.collection=e})),t.select=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach((function(t){var n=t.indexableObject;e.getFieldUpdatesForRelatedItem(n).subscribe((function(t){t.forEach((function(t){return e.objectUpdatesService.removeSingleFieldUpdate(e.url,t.uuid)})),0===t.length&&e.relationshipService.getNameVariant(e.listId,n.uuid).subscribe((function(t){e.objectUpdatesService.saveAddFieldUpdate(e.url,{uuid:e.relationshipType.id+"-"+n.uuid,nameVariant:t,type:e.relationshipType,relatedItem:n})}))}))}))},t.deselect=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach((function(t){var n=t.indexableObject;e.objectUpdatesService.removeSingleFieldUpdate(e.url,e.relationshipType.id+"-"+n.uuid),e.getFieldUpdatesForRelatedItem(n).subscribe((function(t){return t.forEach((function(t){return e.objectUpdatesService.saveRemoveFieldUpdate(e.url,t)}))}))}))},this.relatedEntityType$.pipe(Object(ie.a)(1)).subscribe((function(e){t.relationshipOptions=Object.assign(new wn.a,{relationshipType:e.label,searchConfiguration:e.label.toLowerCase(),nameVariants:!0})})),this.selectableListService.deselectAll(this.listId),this.updates$.pipe(Object(ne.a)((function(t){return Object.values(t).length>0?Object(h.a)(Object.values(t).filter((function(e){return e.changeType!==We.c.REMOVE})).map((function(t){var n=t.field;return n.relationship?e.getRelatedItem(n.relationship):Object(v.a)(n.relatedItem)}))):Object(v.a)([])})),Object(ie.a)(1),Object(g.a)((function(e){return e.map((function(e){var t=new Cn.a;return t.indexableObject=e,t.hitHighlights={},t}))}))).subscribe((function(t){e.selectableListService.select(e.listId,t)}))}},{key:"getFieldUpdatesForRelatedItem",value:function(e){var t=this;return this.updates$.pipe(Object(ie.a)(1),Object(g.a)((function(e){return Object.values(e).map((function(e){return e.field})).filter((function(e){return e.relationship}))})),Object(Me.a)((function(n){return Object(h.a)(n.map((function(e){return t.getRelatedItem(e.relationship)}))).pipe(Object(ae.a)([]),Object(g.a)((function(t){return n.filter((function(n,i){return t[i].uuid===e.uuid}))})))})))}},{key:"getRelatedItem",value:function(e){return this.relationshipService.isLeftItem(e,this.item).pipe(Object(ne.a)((function(t){return t?e.rightItem:e.leftItem})),Object(P.i)(),Object(P.o)())}},{key:"ngOnInit",value:function(){var e=this;this.relatedEntityType$=Object(h.a)([this.relationshipType.leftType,this.relationshipType.rightType].map((function(e){return e.pipe(Object(P.i)(),Object(P.o)())}))).pipe(Object(g.a)((function(t){return t.find((function(t){return t.uuid!==e.itemType.uuid}))})),Object(x.c)()),this.relatedEntityType$.pipe(Object(ie.a)(1)).subscribe((function(t){return e.listId="edit-relationship-".concat(e.itemType.id,"-").concat(t.id)})),this.updates$=this.getItemRelationships().pipe(Object(ne.a)((function(t){return Object(h.a)(t.map((function(t){return e.relationshipService.isLeftItem(t,e.item)}))).pipe(Object(ae.a)([]),Object(g.a)((function(n){return n.map((function(n,i){var a=t[i];return{uuid:a.id,type:e.relationshipType,relationship:a,nameVariant:n?a.rightwardValue:a.leftwardValue}}))})))})),Object(ne.a)((function(t){return e.objectUpdatesService.getFieldUpdates(e.url,t).pipe(Object(g.a)((function(t){var n={};return Object.keys(t).forEach((function(i){Object(x.b)(t[i])&&t[i].field.type.id===e.relationshipType.id&&(n[i]=t[i])})),n})))})),Object(en.a)({}))}},{key:"getItemRelationships",value:function(){var e=this;return this.linkService.resolveLink(this.item,Object(ce.a)("relationships",void 0,!0,!0,!0,Object(ce.a)("relationshipType"),Object(ce.a)("leftItem"),Object(ce.a)("rightItem"))),this.item.relationships.pipe(Object(P.c)(),Object(g.a)((function(e){return e.payload.page.filter((function(e){return Object(x.b)(e)}))})),Object(ne.a)((function(t){return Object(h.a)(t.map((function(e){return e.relationshipType.pipe(Object(P.i)(),Object(P.o)())}))).pipe(Object(ae.a)([]),Object(g.a)((function(n){return t.filter((function(t,i){return n[i].id===e.relationshipType.id}))})))})))}}]),t}()).\u0275fac=function(e){return new(e||Kn)(j["\u0275\u0275directiveInject"](se.a),j["\u0275\u0275directiveInject"](ue.a),j["\u0275\u0275directiveInject"](le.a),j["\u0275\u0275directiveInject"](S.u),j["\u0275\u0275directiveInject"](En.a))},Kn.\u0275cmp=j["\u0275\u0275defineComponent"]({type:Kn,selectors:[["ds-edit-relationship-list"]],inputs:{item:"item",itemType:"itemType",url:"url",relationshipType:"relationshipType"},decls:17,vars:11,consts:[[1,"ml-2","btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[4,"ngVar"],[4,"ngIf"],["class","relationship-row d-block alert",3,"fieldUpdate","url","editItem","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"relationship-row","d-block","alert",3,"fieldUpdate","url","editItem","ngClass"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"h5"),j["\u0275\u0275text"](1),j["\u0275\u0275pipe"](2,"translate"),j["\u0275\u0275pipe"](3,"async"),j["\u0275\u0275elementStart"](4,"button",0),j["\u0275\u0275listener"]("click",(function(){return t.openLookup()})),j["\u0275\u0275text"](5,"\n        "),j["\u0275\u0275element"](6,"i",1),j["\u0275\u0275text"](7,"\n        "),j["\u0275\u0275elementStart"](8,"span",2),j["\u0275\u0275text"](9),j["\u0275\u0275pipe"](10,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](11,"\n    "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](12,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](13,"\n"),j["\u0275\u0275template"](14,Jn,6,2,"ng-container",3),j["\u0275\u0275pipe"](15,"async"),j["\u0275\u0275text"](16,"\n")),2&e&&(j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n    ",j["\u0275\u0275pipeBind1"](2,3,j["\u0275\u0275pipeBind1"](3,5,t.getRelationshipMessageKey())),"\n    "),j["\u0275\u0275advance"](8),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](10,7,"item.edit.relationships.edit.buttons.add"),""),j["\u0275\u0275advance"](5),j["\u0275\u0275property"]("ngVar",j["\u0275\u0275pipeBind1"](15,9,t.updates$)))},directives:[pe.a,u.u,u.t,Dn,u.r,It.a],pipes:[O.e,u.b,pt.a],styles:[".relationship-row[_ngcontent-%COMP%]:not(.alert){padding:var(--bs-alert-padding-y) 0}.relationship-row.alert[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-alert-padding-x));margin-right:calc(-1 * var(--bs-alert-padding-x));margin-top:-1px;margin-bottom:-1px}"]}),Kn);function Yn(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"button",14),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](3).discard()})),j["\u0275\u0275pipe"](1,"async"),j["\u0275\u0275element"](2,"i",15),j["\u0275\u0275text"](3,"\n          "),j["\u0275\u0275elementStart"](4,"span",9),j["\u0275\u0275text"](5),j["\u0275\u0275pipe"](6,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](7,"\n        "),j["\u0275\u0275elementEnd"]()}if(2&e){var i=j["\u0275\u0275nextContext"](3);j["\u0275\u0275property"]("disabled",!j["\u0275\u0275pipeBind1"](1,2,i.hasChanges())),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function Wn(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"button",16),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](3).reinstate()})),j["\u0275\u0275element"](1,"i",17),j["\u0275\u0275text"](2,"\n          "),j["\u0275\u0275elementStart"](3,"span",9),j["\u0275\u0275text"](4),j["\u0275\u0275pipe"](5,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](6,"\n        "),j["\u0275\u0275elementEnd"]()}2&e&&(j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function Hn(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div",19),j["\u0275\u0275text"](1,"\n            "),j["\u0275\u0275element"](2,"ds-edit-relationship-list",20),j["\u0275\u0275pipe"](3,"async"),j["\u0275\u0275text"](4,"\n          "),j["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=j["\u0275\u0275nextContext"](5);j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("url",i.url)("item",i.item)("itemType",j["\u0275\u0275pipeBind1"](3,4,i.entityType$))("relationshipType",n)}}function Gn(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n          "),j["\u0275\u0275template"](2,Hn,5,6,"div",18),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=j["\u0275\u0275nextContext"]().ngVar;j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngForOf",n)}}function Xn(e,t){1&e&&j["\u0275\u0275element"](0,"ds-loading")}function Zn(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n        "),j["\u0275\u0275template"](2,Gn,4,1,"ng-container",2),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275template"](4,Xn,1,0,"ds-loading",2),j["\u0275\u0275text"](5,"\n      "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar;j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",n),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",!n)}}function ei(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"button",21),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](3).discard()})),j["\u0275\u0275pipe"](1,"async"),j["\u0275\u0275element"](2,"i",15),j["\u0275\u0275text"](3,"\n            "),j["\u0275\u0275elementStart"](4,"span",9),j["\u0275\u0275text"](5),j["\u0275\u0275pipe"](6,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](7,"\n          "),j["\u0275\u0275elementEnd"]()}if(2&e){var i=j["\u0275\u0275nextContext"](3);j["\u0275\u0275property"]("disabled",!j["\u0275\u0275pipeBind1"](1,2,i.hasChanges())),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function ti(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementStart"](0,"button",22),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](3).reinstate()})),j["\u0275\u0275element"](1,"i",17),j["\u0275\u0275text"](2,"\n            "),j["\u0275\u0275elementStart"](3,"span",9),j["\u0275\u0275text"](4),j["\u0275\u0275pipe"](5,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](6,"\n          "),j["\u0275\u0275elementEnd"]()}2&e&&(j["\u0275\u0275advance"](4),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function ni(e,t){if(1&e){var n=j["\u0275\u0275getCurrentView"]();j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n      "),j["\u0275\u0275elementStart"](2,"div",4),j["\u0275\u0275text"](3,"\n        "),j["\u0275\u0275template"](4,Yn,8,6,"button",5),j["\u0275\u0275pipe"](5,"async"),j["\u0275\u0275text"](6,"\n        "),j["\u0275\u0275template"](7,Wn,7,3,"button",6),j["\u0275\u0275pipe"](8,"async"),j["\u0275\u0275text"](9,"\n        "),j["\u0275\u0275elementStart"](10,"button",7),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](2).submit()})),j["\u0275\u0275pipe"](11,"async"),j["\u0275\u0275element"](12,"i",8),j["\u0275\u0275text"](13,"\n          "),j["\u0275\u0275elementStart"](14,"span",9),j["\u0275\u0275text"](15),j["\u0275\u0275pipe"](16,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](17,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](18,"\n      "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](19,"\n      "),j["\u0275\u0275template"](20,Zn,6,2,"ng-container",1),j["\u0275\u0275pipe"](21,"async"),j["\u0275\u0275text"](22,"\n      "),j["\u0275\u0275elementStart"](23,"div",10),j["\u0275\u0275text"](24,"\n        "),j["\u0275\u0275elementStart"](25,"div",11),j["\u0275\u0275text"](26,"\n          "),j["\u0275\u0275template"](27,ei,8,6,"button",12),j["\u0275\u0275pipe"](28,"async"),j["\u0275\u0275text"](29,"\n          "),j["\u0275\u0275template"](30,ti,7,3,"button",13),j["\u0275\u0275pipe"](31,"async"),j["\u0275\u0275text"](32,"\n          "),j["\u0275\u0275elementStart"](33,"button",7),j["\u0275\u0275listener"]("click",(function(){return j["\u0275\u0275restoreView"](n),j["\u0275\u0275nextContext"](2).submit()})),j["\u0275\u0275pipe"](34,"async"),j["\u0275\u0275element"](35,"i",8),j["\u0275\u0275text"](36,"\n            "),j["\u0275\u0275elementStart"](37,"span",9),j["\u0275\u0275text"](38),j["\u0275\u0275pipe"](39,"translate"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](40,"\n          "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](41,"\n        "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](42,"\n      "),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](43,"\n    "),j["\u0275\u0275elementContainerEnd"]()}if(2&e){var i=j["\u0275\u0275nextContext"](2);j["\u0275\u0275advance"](4),j["\u0275\u0275property"]("ngIf",!j["\u0275\u0275pipeBind1"](5,9,i.isReinstatable())),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("ngIf",j["\u0275\u0275pipeBind1"](8,11,i.isReinstatable())),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("disabled",!j["\u0275\u0275pipeBind1"](11,13,i.hasChanges())),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](16,15,"item.edit.metadata.save-button"),""),j["\u0275\u0275advance"](5),j["\u0275\u0275property"]("ngVar",j["\u0275\u0275pipeBind1"](21,17,i.relationshipTypes$)),j["\u0275\u0275advance"](7),j["\u0275\u0275property"]("ngIf",!j["\u0275\u0275pipeBind1"](28,19,i.isReinstatable())),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("ngIf",j["\u0275\u0275pipeBind1"](31,21,i.isReinstatable())),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("disabled",!j["\u0275\u0275pipeBind1"](34,23,i.hasChanges())),j["\u0275\u0275advance"](5),j["\u0275\u0275textInterpolate1"]("\xa0",j["\u0275\u0275pipeBind1"](39,25,"item.edit.metadata.save-button"),"")}}function ii(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",23),j["\u0275\u0275text"](1),j["\u0275\u0275pipe"](2,"translate"),j["\u0275\u0275elementEnd"]()),2&e&&(j["\u0275\u0275advance"](1),j["\u0275\u0275textInterpolate1"]("\n      ",j["\u0275\u0275pipeBind1"](2,1,"item.edit.relationships.no-entity-type"),"\n    "))}function ai(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275template"](2,ni,44,27,"ng-container",2),j["\u0275\u0275text"](3,"\n    "),j["\u0275\u0275template"](4,ii,3,3,"div",3),j["\u0275\u0275text"](5,"\n  "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar;j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",n),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",!n)}}var ri,oi=((ri=function(n){s(a,n);var i=d(a);function a(e,t,n,o,c,s,l,d,u,p,m){var f;return r(this,a),(f=i.call(this,e,t,n,o,c,s)).itemService=e,f.objectUpdatesService=t,f.router=n,f.notificationsService=o,f.translateService=c,f.route=s,f.relationshipService=l,f.objectCache=d,f.requestService=u,f.entityTypeService=p,f.cdr=m,f}return c(a,[{key:"initializeUpdates",value:function(){var e=this,t=this.item.firstMetadataValue("dspace.entity.type");void 0!==t?(this.entityType$=this.entityTypeService.getEntityTypeByLabel(t).pipe(Object(P.i)(),Object(P.o)()),this.relationshipTypes$=this.entityType$.pipe(Object(ne.a)((function(t){return e.entityTypeService.getEntityTypeRelationships(t.id,!0,!0,Object(ce.a)("leftType"),Object(ce.a)("rightType")).pipe(Object(P.i)(),Object(P.o)(),Object(g.a)((function(e){return e.page})))})))):this.entityType$=Object(v.a)(void 0)}},{key:"initializeNotificationsPrefix",value:function(){this.notificationsPrefix="item.edit.relationships.notifications."}},{key:"submit",value:function(){var t=this,n=this.relationshipService.getItemRelationshipsArray(this.item).pipe(Object(en.a)([]),Object(g.a)((function(e){return e.map((function(e){return Object.assign(new In.a,e,{uuid:e.id})}))})),Object(ne.a)((function(e){return t.objectUpdatesService.getFieldUpdatesExclusive(t.url,e)})),Object(g.a)((function(e){return Object.values(e).filter((function(e){return e.changeType===We.c.REMOVE})).map((function(e){return e.field}))}))),i=this.objectUpdatesService.getFieldUpdates(this.url,[]).pipe(Object(g.a)((function(e){return Object.values(e).filter((function(e){return Object(x.b)(e)})).filter((function(e){return e.changeType===We.c.ADD})).map((function(e){return e.field}))})));Object(h.a)(n,i).pipe(Object(ie.a)(1)).subscribe((function(n){var i=e(n,2),a=i[0],r=i[1];[t.deleteRelationships(a),t.addRelationships(r)].forEach((function(e){return e.subscribe((function(e){e.length>0&&(t.initializeOriginalFields(),t.cdr.detectChanges(),t.displayNotifications(e))}))}))}))}},{key:"deleteRelationships",value:function(e){var n=this;return Object(Ye.a).apply(void 0,t(e.map((function(e){var t;return t=e.keepLeftVirtualMetadata&&e.keepRightVirtualMetadata?"all":e.keepLeftVirtualMetadata?"left":e.keepRightVirtualMetadata?"right":"none",n.relationshipService.deleteRelationship(e.uuid,t)}))))}},{key:"addRelationships",value:function(e){var n=this;return Object(Ye.a).apply(void 0,t(e.map((function(e){return n.entityType$.pipe(Object(ne.a)((function(t){return n.entityTypeService.isLeftType(e.type,t)})),Object(ne.a)((function(t){var i,a,r,o;return t?(i=n.item,a=e.relatedItem,r=null,o=e.nameVariant):(i=e.relatedItem,a=n.item,r=e.nameVariant,o=null),n.relationshipService.addRelationship(e.type.id,i,a,r,o)})))}))))}},{key:"displayNotifications",value:function(e){var t=this,n=e.filter((function(e){return e.hasFailed})),i=e.filter((function(e){return e.hasSucceeded}));n.forEach((function(e){t.notificationsService.error(t.getNotificationTitle("failed"),e.errorMessage)})),i.length>0&&this.notificationsService.success(this.getNotificationTitle("saved"),this.getNotificationContent("saved"))}},{key:"initializeOriginalFields",value:function(){var e=this;return console.log("init"),this.relationshipService.getRelatedItems(this.item).pipe(Object(ie.a)(1)).subscribe((function(t){e.objectUpdatesService.initialize(e.url,t,e.item.lastModified)}))}}]),a}(Qe.a)).\u0275fac=function(e){return new(e||ri)(j["\u0275\u0275directiveInject"](z.a),j["\u0275\u0275directiveInject"](se.a),j["\u0275\u0275directiveInject"](f.g),j["\u0275\u0275directiveInject"]($.a),j["\u0275\u0275directiveInject"](O.f),j["\u0275\u0275directiveInject"](f.a),j["\u0275\u0275directiveInject"](le.a),j["\u0275\u0275directiveInject"](et.a),j["\u0275\u0275directiveInject"](tt.a),j["\u0275\u0275directiveInject"](de.a),j["\u0275\u0275directiveInject"](j.ChangeDetectorRef))},ri.\u0275cmp=j["\u0275\u0275defineComponent"]({type:ri,selectors:[["ds-item-relationships"]],features:[j["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:3,consts:[[1,"item-relationships"],[4,"ngVar"],[4,"ngIf"],["class","alert alert-info mt-2","role","alert",4,"ngIf"],[1,"button-row","top","d-flex"],["class","btn btn-danger ml-auto",3,"disabled","click",4,"ngIf"],["class","btn btn-warning ml-auto",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-save"],[1,"d-none","d-sm-inline"],[1,"button-row","bottom"],[1,"float-right"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-danger","ml-auto",3,"disabled","click"],[1,"fas","fa-times"],[1,"btn","btn-warning","ml-auto",3,"click"],[1,"fas","fa-undo-alt"],["class","mb-4",4,"ngFor","ngForOf"],[1,"mb-4"],[3,"url","item","itemType","relationshipType"],[1,"btn","btn-danger",3,"disabled","click"],[1,"btn","btn-warning",3,"click"],["role","alert",1,"alert","alert-info","mt-2"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n  "),j["\u0275\u0275template"](2,ai,6,2,"ng-container",1),j["\u0275\u0275pipe"](3,"async"),j["\u0275\u0275text"](4,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](5,"\n")),2&e&&(j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngVar",j["\u0275\u0275pipeBind1"](3,1,t.entityType$)))},directives:[pe.a,u.u,u.t,Qn,It.a],pipes:[u.b,O.e],styles:[".button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:calc(.5 * var(--bs-spacer))}.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}@media screen and (min-width:576px){.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:var(--ds-edit-item-button-min-width)}}.button-row.top[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-top:calc(var(--bs-spacer) / 2);margin-bottom:calc(var(--bs-spacer) / 2)}"]}),ri),ci=l("A0IO"),si=l("ac5F"),li=l("VYMa"),di=l("Y9an");function ui(e,t){if(1&e&&j["\u0275\u0275element"](0,"ds-item-versions",5),2&e){var n=j["\u0275\u0275nextContext"]().ngVar;j["\u0275\u0275property"]("item",n)("displayWhenEmpty",!0)("displayTitle",!1)}}function pi(e,t){if(1&e&&(j["\u0275\u0275elementStart"](0,"div",3),j["\u0275\u0275text"](1,"\n  "),j["\u0275\u0275template"](2,ui,1,3,"ds-item-versions",4),j["\u0275\u0275text"](3,"\n"),j["\u0275\u0275elementEnd"]()),2&e){var n=t.ngVar;j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngIf",n)}}var mi,fi=((mi=function(){function e(t){r(this,e),this.route=t,this.AlertTypeEnum=si.a}return c(e,[{key:"ngOnInit",value:function(){this.itemRD$=this.route.parent.data.pipe(Object(g.a)((function(e){return e.dso}))).pipe(Object(P.i)())}}]),e}()).\u0275fac=function(e){return new(e||mi)(j["\u0275\u0275directiveInject"](f.a))},mi.\u0275cmp=j["\u0275\u0275defineComponent"]({type:mi,selectors:[["ds-item-version-history"]],decls:8,vars:5,consts:[[1,"mt-4"],[3,"content","type"],["class","mt-2",4,"ngVar"],[1,"mt-2"],[3,"item","displayWhenEmpty","displayTitle",4,"ngIf"],[3,"item","displayWhenEmpty","displayTitle"]],template:function(e,t){var n;1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n  "),j["\u0275\u0275element"](2,"ds-alert",1),j["\u0275\u0275text"](3,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](4,"\n"),j["\u0275\u0275template"](5,pi,4,1,"div",2),j["\u0275\u0275pipe"](6,"async"),j["\u0275\u0275text"](7,"\n")),2&e&&(j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("content","item.edit.tabs.versionhistory.under-construction")("type",t.AlertTypeEnum.Warning),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("ngVar",null==(n=j["\u0275\u0275pipeBind1"](6,3,t.itemRD$))?null:n.payload))},directives:[li.a,pe.a,u.u,di.a],pipes:[u.b],encapsulation:2}),mi),bi=l("JIr8"),vi=l("f+Ev"),hi=l("B/au"),gi=l("+Bs4"),xi=l("xPuV");function yi(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n      "),j["\u0275\u0275element"](2,"ds-resource-policies",2),j["\u0275\u0275text"](3,"\n    "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit;j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("resourceType","bitstream")("resourceUUID",n.id)}}function ji(e,t){if(1&e&&(j["\u0275\u0275elementContainerStart"](0),j["\u0275\u0275text"](1,"\n    "),j["\u0275\u0275element"](2,"ds-resource-policies",2),j["\u0275\u0275text"](3,"\n    "),j["\u0275\u0275template"](4,yi,4,2,"ng-container",3),j["\u0275\u0275pipe"](5,"async"),j["\u0275\u0275text"](6,"\n  "),j["\u0275\u0275elementContainerEnd"]()),2&e){var n,i=t.$implicit,a=j["\u0275\u0275nextContext"]();j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("resourceType","bundle")("resourceUUID",i.id),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("ngForOf",null==(n=j["\u0275\u0275pipeBind1"](5,3,a.bundleBitstreamsMap.get(i.id)))?null:n.page)}}var Si,Oi,Ii,ki,wi,Ci,Ei,Mi,Bi,Vi,Ri,Ui=((Si=function(){function e(t,n){r(this,e),this.linkService=t,this.route=n,this.bundleBitstreamsMap=new Map,this.bundles$=new Re.a([]),this.subs=[]}return c(e,[{key:"ngOnInit",value:function(){var e=this;this.item$=this.route.data.pipe(Object(g.a)((function(e){return e.dso})),Object(P.k)(),Object(g.a)((function(t){return e.linkService.resolveLink(t,Object(ce.a)("bundles",new hi.f,!0,!0,!0,Object(ce.a)("bitstreams")))})));var t=this.item$.pipe(Object(re.a)((function(e){return Object(x.e)(e.bundles)})),Object(Me.a)((function(e){return e.bundles})),Object(P.k)(),Object(bi.a)((function(e){return console.error(e),Object(v.a)(Object(vi.b)(null,[]))})));this.subs.push(t.pipe(Object(ie.a)(1),Object(g.a)((function(e){return e.page}))).subscribe((function(t){e.bundles$.next(t)})),t.pipe(Object(ie.a)(1),Object(Me.a)((function(e){return e.page})),Object(g.a)((function(t){return{id:t.id,bitstreams:e.getBundleBitstreams(t)}}))).subscribe((function(t){e.bundleBitstreamsMap.set(t.id,t.bitstreams)})))}},{key:"getItemUUID",value:function(){return this.item$.pipe(Object(g.a)((function(e){return e.id})),Object(D.a)((function(e){return Object(x.e)(e)})))}},{key:"getItemBundles",value:function(){return this.bundles$.asObservable()}},{key:"getBundleBitstreams",value:function(e){return e.bitstreams.pipe(Object(P.j)(),Object(bi.a)((function(e){return console.error(e),Object(v.a)(Object(vi.b)(null,[]))})))}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(x.b)(e)})).forEach((function(e){return e.unsubscribe()}))}}]),e}()).\u0275fac=function(e){return new(e||Si)(j["\u0275\u0275directiveInject"](ue.a),j["\u0275\u0275directiveInject"](f.a))},Si.\u0275cmp=j["\u0275\u0275defineComponent"]({type:Si,selectors:[["ds-item-authorizations"]],decls:11,vars:9,consts:[[1,"container"],[3,"type","content"],[3,"resourceType","resourceUUID"],[4,"ngFor","ngForTrackById","ngForOf"]],template:function(e,t){1&e&&(j["\u0275\u0275elementStart"](0,"div",0),j["\u0275\u0275text"](1,"\n  "),j["\u0275\u0275element"](2,"ds-alert",1),j["\u0275\u0275text"](3,"\n  "),j["\u0275\u0275element"](4,"ds-resource-policies",2),j["\u0275\u0275pipe"](5,"async"),j["\u0275\u0275text"](6,"\n  "),j["\u0275\u0275template"](7,ji,7,5,"ng-container",3),j["\u0275\u0275pipe"](8,"async"),j["\u0275\u0275text"](9,"\n"),j["\u0275\u0275elementEnd"](),j["\u0275\u0275text"](10,"\n\n")),2&e&&(j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("type","alert-info")("content","item.edit.authorizations.heading"),j["\u0275\u0275advance"](2),j["\u0275\u0275property"]("resourceType","item")("resourceUUID",j["\u0275\u0275pipeBind1"](5,5,t.getItemUUID())),j["\u0275\u0275advance"](3),j["\u0275\u0275property"]("ngForOf",j["\u0275\u0275pipeBind1"](8,7,t.getItemBundles())))},directives:[li.a,gi.a,u.t,xi.a],pipes:[u.b],encapsulation:2}),Si),Fi=l("n1Qy"),Ti=l("G5zm"),Pi=l("EEUA"),Di=l("ALMP"),$i=l("tv3Y"),zi=l("YqLK"),Li=l("0TMo"),_i=l("Y2Xq"),Ni=l("Vurf"),Ai=((ki=function(e){s(n,e);var t=d(n);function n(e,i,a,o){var c;return r(this,n),(c=t.call(this,e,i,a,o)).resolver=e,c.authorizationService=i,c.router=a,c.authService=o,c}return c(n,[{key:"getFeatureID",value:function(e,t){return Object(v.a)(Fe.a.ReinstateItem)}}]),n}(Li.a)).\u0275fac=function(e){return new(e||ki)(j["\u0275\u0275inject"](_i.a),j["\u0275\u0275inject"](Te.a),j["\u0275\u0275inject"](f.g),j["\u0275\u0275inject"](Ni.a))},ki.\u0275prov=j["\u0275\u0275defineInjectable"]({token:ki,factory:ki.\u0275fac,providedIn:"root"}),ki),qi=((Ii=function(e){s(n,e);var t=d(n);function n(e,i,a,o){var c;return r(this,n),(c=t.call(this,e,i,a,o)).resolver=e,c.authorizationService=i,c.router=a,c.authService=o,c}return c(n,[{key:"getFeatureID",value:function(e,t){return Object(v.a)(Fe.a.WithdrawItem)}}]),n}(Li.a)).\u0275fac=function(e){return new(e||Ii)(j["\u0275\u0275inject"](_i.a),j["\u0275\u0275inject"](Te.a),j["\u0275\u0275inject"](f.g),j["\u0275\u0275inject"](Ni.a))},Ii.\u0275prov=j["\u0275\u0275defineInjectable"]({token:Ii,factory:Ii.\u0275fac,providedIn:"root"}),Ii),Ji=((Oi=function(e){s(n,e);var t=d(n);function n(e,i,a,o){var c;return r(this,n),(c=t.call(this,e,i,a,o)).resolver=e,c.authorizationService=i,c.router=a,c.authService=o,c}return c(n,[{key:"getFeatureID",value:function(e,t){return Object(v.a)(Fe.a.CanEditMetadata)}}]),n}(Li.a)).\u0275fac=function(e){return new(e||Oi)(j["\u0275\u0275inject"](_i.a),j["\u0275\u0275inject"](Te.a),j["\u0275\u0275inject"](f.g),j["\u0275\u0275inject"](Ni.a))},Oi.\u0275prov=j["\u0275\u0275defineInjectable"]({token:Oi,factory:Oi.\u0275fac,providedIn:"root"}),Oi),Ki=l("TtSl"),Qi=l("HENg"),Yi=((Vi=function(e){s(n,e);var t=d(n);function n(e,i,a,o){var c;return r(this,n),(c=t.call(this,e,i,a,o)).resolver=e,c.authorizationService=i,c.router=a,c.authService=o,c}return c(n,[{key:"getFeatureIDs",value:function(e,t){return Object(v.a)([Fe.a.CanManageMappings,Fe.a.WithdrawItem,Fe.a.ReinstateItem,Fe.a.CanManagePolicies,Fe.a.CanMakePrivate,Fe.a.CanDelete,Fe.a.CanMove])}}]),n}(Qi.a)).\u0275fac=function(e){return new(e||Vi)(j["\u0275\u0275inject"](_i.a),j["\u0275\u0275inject"](Te.a),j["\u0275\u0275inject"](f.g),j["\u0275\u0275inject"](Ni.a))},Vi.\u0275prov=j["\u0275\u0275defineInjectable"]({token:Vi,factory:Vi.\u0275fac,providedIn:"root"}),Vi),Wi=((Bi=function(e){s(n,e);var t=d(n);function n(e,i,a,o){var c;return r(this,n),(c=t.call(this,e,i,a,o)).resolver=e,c.authorizationService=i,c.router=a,c.authService=o,c}return c(n,[{key:"getFeatureID",value:function(e,t){return Object(v.a)(Fe.a.CanManageBitstreamBundles)}}]),n}(Li.a)).\u0275fac=function(e){return new(e||Bi)(j["\u0275\u0275inject"](_i.a),j["\u0275\u0275inject"](Te.a),j["\u0275\u0275inject"](f.g),j["\u0275\u0275inject"](Ni.a))},Bi.\u0275prov=j["\u0275\u0275defineInjectable"]({token:Bi,factory:Bi.\u0275fac,providedIn:"root"}),Bi),Hi=((Mi=function(e){s(n,e);var t=d(n);function n(e,i,a,o){var c;return r(this,n),(c=t.call(this,e,i,a,o)).resolver=e,c.authorizationService=i,c.router=a,c.authService=o,c}return c(n,[{key:"getFeatureID",value:function(e,t){return Object(v.a)(Fe.a.CanManageRelationships)}}]),n}(Li.a)).\u0275fac=function(e){return new(e||Mi)(j["\u0275\u0275inject"](_i.a),j["\u0275\u0275inject"](Te.a),j["\u0275\u0275inject"](f.g),j["\u0275\u0275inject"](Ni.a))},Mi.\u0275prov=j["\u0275\u0275defineInjectable"]({token:Mi,factory:Mi.\u0275fac,providedIn:"root"}),Mi),Gi=((Ei=function(e){s(n,e);var t=d(n);function n(e,i,a,o){var c;return r(this,n),(c=t.call(this,e,i,a,o)).resolver=e,c.authorizationService=i,c.router=a,c.authService=o,c}return c(n,[{key:"getFeatureID",value:function(e,t){return Object(v.a)(Fe.a.CanManageVersions)}}]),n}(Li.a)).\u0275fac=function(e){return new(e||Ei)(j["\u0275\u0275inject"](_i.a),j["\u0275\u0275inject"](Te.a),j["\u0275\u0275inject"](f.g),j["\u0275\u0275inject"](Ni.a))},Ei.\u0275prov=j["\u0275\u0275defineInjectable"]({token:Ei,factory:Ei.\u0275fac,providedIn:"root"}),Ei),Xi=((Ci=function(e){s(n,e);var t=d(n);function n(e,i,a,o){var c;return r(this,n),(c=t.call(this,e,i,a,o)).resolver=e,c.authorizationService=i,c.router=a,c.authService=o,c}return c(n,[{key:"getFeatureID",value:function(e,t){return Object(v.a)(Fe.a.CanManageMappings)}}]),n}(Li.a)).\u0275fac=function(e){return new(e||Ci)(j["\u0275\u0275inject"](_i.a),j["\u0275\u0275inject"](Te.a),j["\u0275\u0275inject"](f.g),j["\u0275\u0275inject"](Ni.a))},Ci.\u0275prov=j["\u0275\u0275defineInjectable"]({token:Ci,factory:Ci.\u0275fac,providedIn:"root"}),Ci),Zi=((wi=function e(){r(this,e)}).\u0275mod=j["\u0275\u0275defineNgModule"]({type:wi}),wi.\u0275inj=j["\u0275\u0275defineInjector"]({factory:function(e){return new(e||wi)},providers:[ci.a,$i.a,Ti.a,Fi.a,Ai,qi,Ki.a,Ji,Yi,Wi,Hi,Gi,Xi],imports:[[f.k.forChild([{path:"",resolve:{breadcrumb:ci.a},data:{breadcrumbKey:"item.edit"},children:[{path:"",component:T,children:[{path:"",redirectTo:"status",pathMatch:"full"},{path:"status",component:Je,data:{title:"item.edit.tabs.status.title",showBreadcrumbs:!0},canActivate:[Yi]},{path:"bitstreams",component:Zt,data:{title:"item.edit.tabs.bitstreams.title",showBreadcrumbs:!0},canActivate:[Wi]},{path:"metadata",component:Ke.a,data:{title:"item.edit.tabs.metadata.title",showBreadcrumbs:!0},canActivate:[Ji]},{path:"relationships",component:oi,data:{title:"item.edit.tabs.relationships.title",showBreadcrumbs:!0},canActivate:[Hi]},{path:"versionhistory",component:fi,data:{title:"item.edit.tabs.versionhistory.title",showBreadcrumbs:!0},canActivate:[Gi]},{path:"mapper",component:bn,data:{title:"item.edit.tabs.item-mapper.title",showBreadcrumbs:!0},canActivate:[Xi]}]},{path:"mapper",component:bn},{path:zi.g,component:K,canActivate:[qi]},{path:zi.f,component:W,canActivate:[Ai]},{path:zi.d,component:X},{path:zi.e,component:te},{path:zi.b,component:Ce},{path:zi.c,component:On,data:{title:"item.edit.move.title"}},{path:zi.a,children:[{path:"create",resolve:{resourcePolicyTarget:Fi.a},component:Pi.a,data:{title:"resource-policies.create.page.title"}},{path:"edit",resolve:{resourcePolicy:Ti.a},component:Di.a,data:{title:"resource-policies.edit.page.title"}},{path:"",component:Ui,data:{title:"item.edit.authorizations.title"}}]}]}])]]}),wi),ea=l("HQAL"),ta=((Ri=function e(){r(this,e)}).\u0275mod=j["\u0275\u0275defineNgModule"]({type:Ri}),Ri.\u0275inj=j["\u0275\u0275defineInjector"]({factory:function(e){return new(e||Ri)},providers:[nt.a,pt.a],imports:[[u.c,m.a,Zi,ea.a,lt.g]]}),Ri)},"d/jG":function(n,i,a){"use strict";a.d(i,"a",(function(){return w}));var o=a("itXk"),l=a("lJxs"),u=a("vkgz"),p=a("eIep"),m=a("SxV6"),f=a("daFX"),b=a("AytR"),v=a("MEmd"),h=a("1QIV"),g=a("J3qs"),x=a("u0Hx"),y=a("8Y7J"),j=a("iqTE"),S=a("loKC"),O=a("iInd"),I=a("lI3o"),k=a("TSSN"),w=function(){var n=function(n){s(a,n);var i=d(a);function a(e,t,n,o,c,s){var l;return r(this,a),(l=i.call(this,t,o,c)).itemService=e,l.objectUpdatesService=t,l.router=n,l.notificationsService=o,l.translateService=c,l.route=s,l}return c(a,[{key:"ngOnInit",value:function(){var n=this;Object(g.b)(this.item)?this.setItem(this.item):this.itemUpdateSubscription=Object(o.a)([this.route.data,this.route.parent.data]).pipe(Object(l.a)((function(t){var n=e(t,2),i=n[0],a=n[1];return Object.assign({},i,a)})),Object(l.a)((function(e){return e.dso})),Object(u.a)((function(e){n.item=e.payload})),Object(p.a)((function(e){var i;return(i=n.itemService).findByHref.apply(i,[e.payload._links.self.href,!0,!0].concat(t(x.a)))})),Object(h.c)()).subscribe((function(e){n.setItem(e.payload)})),this.discardTimeOut=b.a.item.edit.undoTimeout,this.url=this.router.url,this.url.indexOf("?")>0&&(this.url=this.url.substr(0,this.url.indexOf("?"))),this.hasChanges().pipe(Object(m.a)()).subscribe((function(e){e?n.checkLastModified():n.initializeOriginalFields()})),this.initializeNotificationsPrefix(),this.initializeUpdates()}},{key:"setItem",value:function(e){this.item=e,this.itemPageRoute=Object(v.f)(this.item),this.postItemInit(),this.initializeUpdates()}},{key:"ngOnDestroy",value:function(){Object(g.b)(this.itemUpdateSubscription)&&this.itemUpdateSubscription.unsubscribe()}},{key:"postItemInit",value:function(){}},{key:"initializeUpdates",value:function(){}},{key:"initializeNotificationsPrefix",value:function(){}},{key:"initializeOriginalFields",value:function(){}},{key:"submit",value:function(){}},{key:"trackUpdate",value:function(e,t){return t&&t.field?t.field.uuid:void 0}},{key:"isValid",value:function(){return this.objectUpdatesService.isValidPage(this.url)}},{key:"checkLastModified",value:function(){var e=this,t=this.item.lastModified;this.objectUpdatesService.getLastModified(this.url).pipe(Object(m.a)()).subscribe((function(n){n.getDate()!==t.getDate()&&(e.notificationsService.warning(e.getNotificationTitle("outdated"),e.getNotificationContent("outdated")),e.initializeOriginalFields())}))}}]),a}(f.a);return n.\u0275fac=function(e){return new(e||n)(y["\u0275\u0275directiveInject"](j.a),y["\u0275\u0275directiveInject"](S.a),y["\u0275\u0275directiveInject"](O.g),y["\u0275\u0275directiveInject"](I.a),y["\u0275\u0275directiveInject"](k.f),y["\u0275\u0275directiveInject"](O.a))},n.\u0275cmp=y["\u0275\u0275defineComponent"]({type:n,selectors:[["ds-abstract-item-update"]],inputs:{item:"item"},features:[y["\u0275\u0275InheritDefinitionFeature"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),n}()},hucJ:function(e,n,i){"use strict";i.d(n,"a",(function(){return p}));var a=i("1QIV"),o=i("lJxs"),s=i("J3qs"),l=i("8Y7J"),d=i("GCaJ"),u=i("h5qW"),p=function(){var e=function(){function e(t,n){r(this,e),this.breadcrumbService=t,this.dataService=n}return c(e,[{key:"resolve",value:function(e,n){var i,r=this,c=e.params.id;return(i=this.dataService).findById.apply(i,[c,!0,!1].concat(t(this.followLinks))).pipe(Object(a.g)(),Object(a.o)(),Object(o.a)((function(e){if(Object(s.b)(e)){var t=n.url,i=t.substr(0,t.indexOf(c))+c;return{provider:r.breadcrumbService,key:e,url:i}}})))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275inject"](d.a),l["\u0275\u0275inject"](u.a))},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},mjBp:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("8Y7J"),a=function(){var e=function(){function e(){r(this,e)}return c(e,[{key:"canActivate",value:function(e,t){return e.data={title:e.params.configuration+".search.title"},!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}()},ofZh:function(e,t,n){"use strict";n.r(t),n.d(t,"SearchPageComponent",(function(){return c}));var i=n("8Y7J"),a=n("FZ4K"),o=n("tVEM"),c=function(){var e=function e(){r(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-search-page"]],decls:4,vars:0,template:function(e,t){1&e&&(i["\u0275\u0275element"](0,"ds-search"),i["\u0275\u0275text"](1,"\n"),i["\u0275\u0275element"](2,"ds-search-tracker"),i["\u0275\u0275text"](3,"\n"))},directives:[a.a,o.a],encapsulation:2}),e}()},tVEM:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("eIep"),a=n("lJxs"),o=n("FZ4K"),l=n("ztnu"),u=n("joI/"),p=n("1QIV"),m=n("8Y7J"),f=n("gWc+"),b=n("7LZ0"),v=n("14tD"),h=n("ppE2"),g=n("srUL"),x=n("iInd"),y=function(){var e=function(e){s(n,e);var t=d(n);function n(e,i,a,o,c,s,l){var d;return r(this,n),(d=t.call(this,e,i,a,o,c,l)).service=e,d.sidebarService=i,d.windowService=a,d.searchConfigService=o,d.routeService=c,d.angulartics2=s,d.router=l,d}return c(n,[{key:"ngOnInit",value:function(){var e=this;this.getSearchOptions().pipe(Object(i.a)((function(t){return e.service.searchEntries(t).pipe(Object(p.i)(),Object(a.a)((function(e){return{config:t,searchQueryResponse:e.payload}})))}))).subscribe((function(t){for(var n=t.config,i=t.searchQueryResponse,a=[],r=i.appliedFilters||[],o=0,c=r.length;o<c;o++)a.push(r[o]);e.angulartics2.eventTrack.next({action:"search",properties:{searchOptions:n,page:{size:n.pagination.size,totalElements:i.pageInfo.totalElements,totalPages:i.pageInfo.totalPages,number:n.pagination.currentPage},sort:{by:n.sort.field,order:n.sort.direction},filters:a}})}))}}]),n}(o.a);return e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](f.a),m["\u0275\u0275directiveInject"](b.a),m["\u0275\u0275directiveInject"](v.a),m["\u0275\u0275directiveInject"](l.SEARCH_CONFIG_SERVICE),m["\u0275\u0275directiveInject"](h.a),m["\u0275\u0275directiveInject"](g.b),m["\u0275\u0275directiveInject"](x.g))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-search-tracker"]],features:[m["\u0275\u0275ProvidersFeature"]([{provide:l.SEARCH_CONFIG_SERVICE,useClass:u.a}]),m["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:0,template:function(e,t){1&e&&m["\u0275\u0275text"](0,"\xa0\n")},styles:["[_nghost-%COMP%]{display:none}"]}),e}()},tv3Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("zr/d"),a=n("LRne"),o=n("8Y7J"),s=function(){var e=function(){function e(){r(this,e)}return c(e,[{key:"getBreadcrumbs",value:function(e,t){return Object(a.a)([new i.a(e+".breadcrumbs",t)])}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},u0Hx:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f}));var i=n("84Zn"),a=n("B/au"),o=n("1QIV"),s=n("8jtY"),l=n("8Y7J"),d=n("iqTE"),u=n("tqRt"),p=n("iInd"),m=[Object(i.a)("owningCollection",void 0,!0,!0,!0,Object(i.a)("parentCommunity",void 0,!0,!0,!0,Object(i.a)("parentCommunity"))),Object(i.a)("bundles",new a.f,!0,!0,!0,Object(i.a)("bitstreams")),Object(i.a)("relationships"),Object(i.a)("version",void 0,!0,!0,!0,Object(i.a)("versionhistory"))],f=function(){var e=function(){function e(t,n,i){r(this,e),this.itemService=t,this.store=n,this.router=i}return c(e,[{key:"resolve",value:function(e,t){var n,i=this,a=(n=this.itemService).findById.apply(n,[e.params.id,!0,!1].concat(m)).pipe(Object(o.g)());return a.subscribe((function(e){i.store.dispatch(new s.a(t.url,e.payload))})),a}}]),e}();return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275inject"](d.a),l["\u0275\u0275inject"](u.h),l["\u0275\u0275inject"](p.g))},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}()},"zr/d":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function e(t,n){r(this,e),this.text=t,this.url=n}}}])}();
//# sourceMappingURL=4-es5.66989098c66eb3f71da9.js.map