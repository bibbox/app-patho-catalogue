!function(){function e(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(c){i=!0,a=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[6,34],{A0IO:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("J3qs"),i=n("q5u1"),o=n("8Y7J"),c=n("tv3Y"),l=function(){var e=function(){function e(t){a(this,e),this.breadcrumbService=t}return s(e,[{key:"resolve",value:function(e,t){var n=e.data.breadcrumbKey;if(Object(r.a)(n))throw new Error('You provided an i18nBreadcrumbResolver for url "'+e.url+"\" but no breadcrumbKey in the route's data");var a=Object(i.b)(e);return{provider:this.breadcrumbService,key:n,url:a}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](c.a))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},esCw:function(r,i,o){"use strict";o.r(i),o.d(i,"AccessControlModule",(function(){return Et}));var c=o("SVse"),l=o("iInd"),p=o("PCNd"),u=o("2Vo4"),d=o("itXk"),m=o("eIep"),f=o("lJxs"),g=o("IzEk"),b=o("f+Ev"),v=o("J3qs"),x=o("7DXY"),h=function e(){a(this,e)},S=o("FU+A"),y=o("1QIV"),I=o("Q8wr"),E=o("oBfO"),P=o("8Y7J"),O=o("wLgS"),j=o("TSSN"),k=o("lI3o"),B=o("1mcE"),w=o("s7LF"),C=o("G0yt"),G=o("MFUF"),D=o("X/78"),F=o("QOHy"),A=o("LRne"),L=o("Anbb"),$=o("YIpg"),N=o("Q5/L"),q=o("Vurf"),R=o("hqmO"),M=o("Exvd");function V(e,t){1&e&&P["\u0275\u0275element"](0,"div")}function z(e,t){if(1&e&&(P["\u0275\u0275text"](0,"\n  "),P["\u0275\u0275elementStart"](1,"h4"),P["\u0275\u0275text"](2),P["\u0275\u0275pipe"](3,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](4,"\n")),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](2),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](3,1,n.messagePrefix+".create"))}}function _(e,t){if(1&e&&(P["\u0275\u0275text"](0,"\n  "),P["\u0275\u0275elementStart"](1,"h4"),P["\u0275\u0275text"](2),P["\u0275\u0275pipe"](3,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](4,"\n")),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](2),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](3,1,n.messagePrefix+".edit"))}}var T=function(e){return{"d-none":e}};function H(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"button",16),P["\u0275\u0275listener"]("click",(function(){return P["\u0275\u0275restoreView"](n),P["\u0275\u0275nextContext"]().impersonate()})),P["\u0275\u0275pipe"](1,"async"),P["\u0275\u0275text"](2,"\n      "),P["\u0275\u0275element"](3,"i",17),P["\u0275\u0275text"](4),P["\u0275\u0275pipe"](5,"translate"),P["\u0275\u0275elementEnd"]()}if(2&e){var r=P["\u0275\u0275nextContext"]();P["\u0275\u0275property"]("ngClass",P["\u0275\u0275pureFunction1"](6,T,!P["\u0275\u0275pipeBind1"](1,2,r.canImpersonate$))),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](5,4,"admin.access-control.epeople.actions.impersonate"),"\n    ")}}function Q(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"button",18),P["\u0275\u0275listener"]("click",(function(){return P["\u0275\u0275restoreView"](n),P["\u0275\u0275nextContext"]().stopImpersonating()})),P["\u0275\u0275text"](1,"\n      "),P["\u0275\u0275element"](2,"i",17),P["\u0275\u0275text"](3),P["\u0275\u0275pipe"](4,"translate"),P["\u0275\u0275elementEnd"]()}2&e&&(P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](4,1,"admin.access-control.epeople.actions.stop-impersonating"),"\n    "))}var W=function(e){return[e]};function U(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"tr"),P["\u0275\u0275text"](1,"\n          "),P["\u0275\u0275elementStart"](2,"td"),P["\u0275\u0275text"](3),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](4,"\n          "),P["\u0275\u0275elementStart"](5,"td"),P["\u0275\u0275elementStart"](6,"a",26),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=t.$implicit;return P["\u0275\u0275nextContext"](3).groupsDataService.startEditingNewGroup(e)})),P["\u0275\u0275text"](7),P["\u0275\u0275elementEnd"](),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](8,"\n        "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,i=P["\u0275\u0275nextContext"](3);P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](r.id),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("routerLink",P["\u0275\u0275pureFunction1"](3,W,i.groupsDataService.getGroupEditPageRouterLink(r))),P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate"](r.name)}}function Y(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"ds-pagination",21),P["\u0275\u0275listener"]("pageChange",(function(e){return P["\u0275\u0275restoreView"](n),P["\u0275\u0275nextContext"](2).onPageChange(e)})),P["\u0275\u0275pipe"](1,"async"),P["\u0275\u0275pipe"](2,"async"),P["\u0275\u0275text"](3,"\n\n    "),P["\u0275\u0275elementStart"](4,"div",22),P["\u0275\u0275text"](5,"\n      "),P["\u0275\u0275elementStart"](6,"table",23),P["\u0275\u0275text"](7,"\n        "),P["\u0275\u0275elementStart"](8,"thead"),P["\u0275\u0275text"](9,"\n        "),P["\u0275\u0275elementStart"](10,"tr"),P["\u0275\u0275text"](11,"\n          "),P["\u0275\u0275elementStart"](12,"th",24),P["\u0275\u0275text"](13),P["\u0275\u0275pipe"](14,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](15,"\n          "),P["\u0275\u0275elementStart"](16,"th",24),P["\u0275\u0275text"](17),P["\u0275\u0275pipe"](18,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](19,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](20,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](21,"\n        "),P["\u0275\u0275elementStart"](22,"tbody"),P["\u0275\u0275text"](23,"\n        "),P["\u0275\u0275template"](24,U,9,5,"tr",25),P["\u0275\u0275pipe"](25,"async"),P["\u0275\u0275text"](26,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](27,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](28,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](29,"\n\n  "),P["\u0275\u0275elementEnd"]()}if(2&e){var r,i,a,o=P["\u0275\u0275nextContext"](2);P["\u0275\u0275property"]("paginationOptions",o.config)("pageInfoState",null==(r=P["\u0275\u0275pipeBind1"](1,8,o.groups))?null:r.payload)("collectionSize",null==(i=P["\u0275\u0275pipeBind1"](2,10,o.groups))||null==i.payload?null:i.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),P["\u0275\u0275advance"](13),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](14,12,o.messagePrefix+".table.id")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](18,14,o.messagePrefix+".table.name")),P["\u0275\u0275advance"](7),P["\u0275\u0275property"]("ngForOf",null==(a=P["\u0275\u0275pipeBind1"](25,16,o.groups))||null==a.payload?null:a.payload.page)}}function J(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"div",27),P["\u0275\u0275text"](1,"\n    "),P["\u0275\u0275elementStart"](2,"div"),P["\u0275\u0275text"](3),P["\u0275\u0275pipe"](4,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](5,"\n    "),P["\u0275\u0275elementStart"](6,"div"),P["\u0275\u0275text"](7,"\n      "),P["\u0275\u0275elementStart"](8,"button",28),P["\u0275\u0275text"](9),P["\u0275\u0275pipe"](10,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](11,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](12,"\n  "),P["\u0275\u0275elementEnd"]()),2&e){var n=P["\u0275\u0275nextContext"](2);P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](4,3,n.messagePrefix+".memberOfNoGroups")),P["\u0275\u0275advance"](5),P["\u0275\u0275property"]("routerLink",P["\u0275\u0275pureFunction1"](7,W,n.groupsDataService.getGroupRegistryRouterLink())),P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](10,5,n.messagePrefix+".goToGroups"))}}function K(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"div"),P["\u0275\u0275text"](1,"\n  "),P["\u0275\u0275elementStart"](2,"h5"),P["\u0275\u0275text"](3),P["\u0275\u0275pipe"](4,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](5,"\n\n  "),P["\u0275\u0275template"](6,Y,30,18,"ds-pagination",19),P["\u0275\u0275pipe"](7,"async"),P["\u0275\u0275text"](8,"\n\n  "),P["\u0275\u0275template"](9,J,13,9,"div",20),P["\u0275\u0275pipe"](10,"async"),P["\u0275\u0275text"](11,"\n"),P["\u0275\u0275elementEnd"]()),2&e){var n,r,i=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](4,3,i.messagePrefix+".groupsEPersonIsMemberOf")),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",(null==(n=P["\u0275\u0275pipeBind1"](7,5,i.groups))||null==n.payload?null:n.payload.totalElements)>0),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",0==(null==(r=P["\u0275\u0275pipeBind1"](10,7,i.groups))||null==r.payload?null:r.payload.totalElements))}}var Z,X=((Z=function(){function e(t,n,r,i,o,s,c,l,p,u){var d=this;a(this,e),this.epersonService=t,this.groupsDataService=n,this.formBuilderService=r,this.translateService=i,this.notificationsService=o,this.authService=s,this.authorizationService=c,this.modalService=l,this.paginationService=p,this.requestService=u,this.labelPrefix="admin.access-control.epeople.form.",this.formId="eperson-form",this.messagePrefix="admin.access-control.epeople.form",this.formLayout={firstName:{grid:{host:"row"}},lastName:{grid:{host:"row"}},email:{grid:{host:"row"}},canLogIn:{grid:{host:"col col-sm-6 d-inline-block"}},requireCertificate:{grid:{host:"col col-sm-6 d-inline-block"}}},this.submitForm=new P.EventEmitter,this.cancelForm=new P.EventEmitter,this.canReset$=Object(A.a)(!1),this.subs=[],this.config=Object.assign(new x.a,{id:"gem",pageSize:5,currentPage:1}),this.isImpersonated=!1,this.subs.push(this.epersonService.getActiveEPerson().subscribe((function(e){d.epersonInitial=e,Object(v.b)(e)&&(d.isImpersonated=d.authService.isImpersonatingUser(e.id))})))}return s(e,[{key:"ngOnInit",value:function(){this.initialisePage()}},{key:"initialisePage",value:function(){var e=this;Object(d.a)(this.translateService.get("".concat(this.messagePrefix,".firstName")),this.translateService.get("".concat(this.messagePrefix,".lastName")),this.translateService.get("".concat(this.messagePrefix,".email")),this.translateService.get("".concat(this.messagePrefix,".canLogIn")),this.translateService.get("".concat(this.messagePrefix,".requireCertificate")),this.translateService.get("".concat(this.messagePrefix,".emailHint"))).subscribe((function(t){var r=n(t,6),i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],l=r[5];e.firstName=new F.I({id:"firstName",label:i,name:"firstName",validators:{required:null},required:!0}),e.lastName=new F.I({id:"lastName",label:a,name:"lastName",validators:{required:null},required:!0}),e.email=new F.I({id:"email",label:o,name:"email",validators:{required:null,pattern:"^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$"},required:!0,hint:l}),e.canLogIn=new F.q({id:"canLogIn",label:s,name:"canLogIn",value:null==e.epersonInitial||e.epersonInitial.canLogIn}),e.requireCertificate=new F.q({id:"requireCertificate",label:c,name:"requireCertificate",value:null!=e.epersonInitial&&e.epersonInitial.requireCertificate}),e.formModel=[e.firstName,e.lastName,e.email,e.canLogIn,e.requireCertificate],e.formGroup=e.formBuilderService.createFormGroup(e.formModel),e.subs.push(e.epersonService.getActiveEPerson().subscribe((function(t){null!=t&&(e.groups=e.groupsDataService.findAllByHref(t._links.groups.href,{currentPage:1,elementsPerPage:e.config.pageSize})),e.formGroup.patchValue({firstName:null!=t?t.firstMetadataValue("eperson.firstname"):"",lastName:null!=t?t.firstMetadataValue("eperson.lastname"):"",email:null!=t?t.email:"",canLogIn:null==t||t.canLogIn,requireCertificate:null!=t&&t.requireCertificate})})));var p=e.epersonService.getActiveEPerson();e.groups=p.pipe(Object(m.a)((function(t){return Object(d.a)([Object(A.a)(t),e.paginationService.getFindListOptions(e.config.id,{currentPage:1,elementsPerPage:e.config.pageSize})])})),Object(m.a)((function(t){var r=n(t,2),i=r[0],a=r[1];return null!=i?e.groupsDataService.findAllByHref(i._links.groups.href,a):Object(A.a)(void 0)}))),e.canImpersonate$=p.pipe(Object(m.a)((function(t){return e.authorizationService.isAuthorized(S.a.LoginOnBehalfOf,Object(v.b)(t)?t.self:void 0)}))),e.canDelete$=p.pipe(Object(m.a)((function(t){return e.authorizationService.isAuthorized(S.a.CanDelete,Object(v.b)(t)?t.self:void 0)})))}))}},{key:"onCancel",value:function(){this.epersonService.cancelEditEPerson(),this.cancelForm.emit()}},{key:"onSubmit",value:function(){var e=this;this.epersonService.getActiveEPerson().pipe(Object(g.a)(1)).subscribe((function(t){var n={metadata:{"eperson.firstname":[{value:e.firstName.value}],"eperson.lastname":[{value:e.lastName.value}]},email:e.email.value,canLogIn:e.canLogIn.value,requireCertificate:e.requireCertificate.value};null==t?e.createNewEPerson(n):e.editEPerson(t,n)}))}},{key:"createNewEPerson",value:function(e){var t=this,n=Object.assign(new L.a,e);this.epersonService.create(n).pipe(Object(y.g)()).subscribe((function(e){e.hasSucceeded?(t.notificationsService.success(t.translateService.get(t.labelPrefix+"notification.created.success",{name:n.name})),t.submitForm.emit(n)):(t.notificationsService.error(t.translateService.get(t.labelPrefix+"notification.created.failure",{name:n.name})),t.cancelForm.emit())})),this.showNotificationIfEmailInUse(n,"created")}},{key:"editEPerson",value:function(e,t){var n=this,r=Object.assign(new L.a,{id:e.id,metadata:{"eperson.firstname":[{value:this.firstName.value?this.firstName.value:e.firstMetadataValue("eperson.firstname")}],"eperson.lastname":[{value:this.lastName.value?this.lastName.value:e.firstMetadataValue("eperson.lastname")}]},email:Object(v.b)(t.email)?t.email:e.email,canLogIn:Object(v.b)(t.canLogIn)?t.canLogIn:e.canLogIn,requireCertificate:Object(v.b)(t.requireCertificate)?t.requireCertificate:e.requireCertificate,_links:e._links});this.epersonService.updateEPerson(r).pipe(Object(y.g)()).subscribe((function(e){e.hasSucceeded?(n.notificationsService.success(n.translateService.get(n.labelPrefix+"notification.edited.success",{name:r.name})),n.submitForm.emit(r)):(n.notificationsService.error(n.translateService.get(n.labelPrefix+"notification.edited.failure",{name:r.name})),n.cancelForm.emit())})),null!=t.email&&t.email!==e.email&&this.showNotificationIfEmailInUse(r,"edited")}},{key:"showNotificationIfEmailInUse",value:function(e,t){var n=this;this.subs.push(this.epersonService.searchByScope("email",e.email,{currentPage:1,elementsPerPage:0}).pipe(Object(y.i)(),Object(y.o)()).subscribe((function(r){r.totalElements>0&&n.notificationsService.error(n.translateService.get(n.labelPrefix+"notification."+t+".failure.emailInUse",{name:e.name,email:e.email}))})))}},{key:"onPageChange",value:function(e){this.updateGroups({currentPage:e,elementsPerPage:this.config.pageSize})}},{key:"updateGroups",value:function(e){var t=this;this.subs.push(this.epersonService.getActiveEPerson().subscribe((function(n){t.groups=t.groupsDataService.findAllByHref(n._links.groups.href,e)})))}},{key:"impersonate",value:function(){this.authService.impersonate(this.epersonInitial.id),this.isImpersonated=!0}},{key:"delete",value:function(){var e=this;this.epersonService.getActiveEPerson().pipe(Object(g.a)(1)).subscribe((function(t){var n=e.modalService.open(I.a);n.componentInstance.dso=t,n.componentInstance.headerLabel="confirmation-modal.delete-eperson.header",n.componentInstance.infoLabel="confirmation-modal.delete-eperson.info",n.componentInstance.cancelLabel="confirmation-modal.delete-eperson.cancel",n.componentInstance.confirmLabel="confirmation-modal.delete-eperson.confirm",n.componentInstance.brandColor="danger",n.componentInstance.confirmIcon="fas fa-trash",n.componentInstance.response.pipe(Object(g.a)(1)).subscribe((function(n){n&&Object(v.b)(t.id)&&e.epersonService.deleteEPerson(t).pipe(Object(y.g)()).subscribe((function(n){n.hasSucceeded?(e.notificationsService.success(e.translateService.get(e.labelPrefix+"notification.deleted.success",{name:t.name})),e.submitForm.emit()):e.notificationsService.error("Error occured when trying to delete EPerson with id: "+t.id+" with code: "+n.statusCode+" and message: "+n.errorMessage),e.cancelForm.emit()}))}))}))}},{key:"stopImpersonating",value:function(){this.authService.stopImpersonatingAndRefresh(),this.isImpersonated=!1}},{key:"ngOnDestroy",value:function(){this.onCancel(),this.subs.filter((function(e){return Object(v.b)(e)})).forEach((function(e){return e.unsubscribe()})),this.paginationService.clearPagination(this.config.id)}},{key:"reset",value:function(){var e=this;this.epersonService.getActiveEPerson().pipe(Object(g.a)(1)).subscribe((function(t){e.requestService.removeByHrefSubstring(t.self)})),this.initialisePage()}}]),e}()).\u0275fac=function(e){return new(e||Z)(P["\u0275\u0275directiveInject"](O.a),P["\u0275\u0275directiveInject"]($.a),P["\u0275\u0275directiveInject"](N.a),P["\u0275\u0275directiveInject"](j.f),P["\u0275\u0275directiveInject"](k.a),P["\u0275\u0275directiveInject"](q.a),P["\u0275\u0275directiveInject"](B.a),P["\u0275\u0275directiveInject"](C.u),P["\u0275\u0275directiveInject"](G.a),P["\u0275\u0275directiveInject"](D.a))},Z.\u0275cmp=P["\u0275\u0275defineComponent"]({type:Z,selectors:[["ds-eperson-form"]],outputs:{submitForm:"submitForm",cancelForm:"cancelForm"},decls:47,vars:30,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["createHeader",""],["editheader",""],[3,"formId","formModel","formGroup","formLayout","displayCancel","submitForm"],["before","",1,"btn-group"],[1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["between","",1,"btn-group"],[1,"btn","btn-primary",3,"disabled"],[1,"fa","fa-key"],["between","",1,"btn-group","ml-1"],["class","btn btn-primary",3,"ngClass","click",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],["after","",1,"btn","btn-danger","delete-button",3,"disabled","click"],[1,"fas","fa-trash"],[4,"ngIf"],[1,"btn","btn-primary",3,"ngClass","click"],[1,"fa","fa-user-secret"],[1,"btn","btn-primary",3,"click"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage","pageChange",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage","pageChange"],[1,"table-responsive"],["id","groups",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],[3,"routerLink","click"],["role","alert",1,"alert","alert-info","w-100","mb-2"],[1,"btn","btn-primary",3,"routerLink"]],template:function(e,t){if(1&e&&(P["\u0275\u0275template"](0,V,1,0,"div",0),P["\u0275\u0275pipe"](1,"async"),P["\u0275\u0275text"](2,"\n\n"),P["\u0275\u0275template"](3,z,5,3,"ng-template",null,1,P["\u0275\u0275templateRefExtractor"]),P["\u0275\u0275text"](5,"\n\n"),P["\u0275\u0275template"](6,_,5,3,"ng-template",null,2,P["\u0275\u0275templateRefExtractor"]),P["\u0275\u0275text"](8,"\n\n"),P["\u0275\u0275elementStart"](9,"ds-form",3),P["\u0275\u0275listener"]("submitForm",(function(){return t.onSubmit()})),P["\u0275\u0275text"](10,"\n  "),P["\u0275\u0275elementStart"](11,"div",4),P["\u0275\u0275text"](12,"\n    "),P["\u0275\u0275elementStart"](13,"button",5),P["\u0275\u0275listener"]("click",(function(){return t.onCancel()})),P["\u0275\u0275element"](14,"i",6),P["\u0275\u0275text"](15),P["\u0275\u0275pipe"](16,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](17,"\n  "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](18,"\n  "),P["\u0275\u0275elementStart"](19,"div",7),P["\u0275\u0275text"](20,"\n    "),P["\u0275\u0275elementStart"](21,"button",8),P["\u0275\u0275pipe"](22,"async"),P["\u0275\u0275text"](23,"\n      "),P["\u0275\u0275element"](24,"i",9),P["\u0275\u0275text"](25),P["\u0275\u0275pipe"](26,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](27,"\n  "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](28,"\n  "),P["\u0275\u0275elementStart"](29,"div",10),P["\u0275\u0275text"](30,"\n    "),P["\u0275\u0275template"](31,H,6,8,"button",11),P["\u0275\u0275text"](32,"\n    "),P["\u0275\u0275template"](33,Q,5,3,"button",12),P["\u0275\u0275text"](34,"\n  "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](35,"\n  "),P["\u0275\u0275elementStart"](36,"button",13),P["\u0275\u0275listener"]("click",(function(){return t.delete()})),P["\u0275\u0275pipe"](37,"async"),P["\u0275\u0275text"](38,"\n    "),P["\u0275\u0275element"](39,"i",14),P["\u0275\u0275text"](40),P["\u0275\u0275pipe"](41,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](42,"\n"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](43,"\n\n"),P["\u0275\u0275template"](44,K,12,9,"div",15),P["\u0275\u0275pipe"](45,"async"),P["\u0275\u0275text"](46,"\n")),2&e){var n=P["\u0275\u0275reference"](4),r=P["\u0275\u0275reference"](7);P["\u0275\u0275property"]("ngIf",P["\u0275\u0275pipeBind1"](1,16,t.epersonService.getActiveEPerson()))("ngIfThen",r)("ngIfElse",n),P["\u0275\u0275advance"](9),P["\u0275\u0275property"]("formId",t.formId)("formModel",t.formModel)("formGroup",t.formGroup)("formLayout",t.formLayout)("displayCancel",!1),P["\u0275\u0275advance"](6),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](16,18,t.messagePrefix+".return"),""),P["\u0275\u0275advance"](6),P["\u0275\u0275property"]("disabled",!P["\u0275\u0275pipeBind1"](22,20,t.canReset$)),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](26,22,"admin.access-control.epeople.actions.reset"),"\n    "),P["\u0275\u0275advance"](6),P["\u0275\u0275property"]("ngIf",!t.isImpersonated),P["\u0275\u0275advance"](2),P["\u0275\u0275property"]("ngIf",t.isImpersonated),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("disabled",!P["\u0275\u0275pipeBind1"](37,24,t.canDelete$)),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](41,26,"admin.access-control.epeople.actions.delete"),"\n  "),P["\u0275\u0275advance"](4),P["\u0275\u0275property"]("ngIf",P["\u0275\u0275pipeBind1"](45,28,t.epersonService.getActiveEPerson()))}},directives:[c.u,R.a,w.NgControlStatusGroup,w.FormGroupDirective,c.r,M.a,c.t,l.j,l.h],pipes:[c.b,j.e],encapsulation:2}),Z),ee=o("Frqi");function te(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"div"),P["\u0275\u0275text"](1,"\n          "),P["\u0275\u0275elementStart"](2,"button",7),P["\u0275\u0275listener"]("click",(function(){return P["\u0275\u0275restoreView"](n),P["\u0275\u0275nextContext"]().isEPersonFormShown=!0})),P["\u0275\u0275text"](3,"\n            "),P["\u0275\u0275element"](4,"i",8),P["\u0275\u0275text"](5,"\n            "),P["\u0275\u0275elementStart"](6,"span",9),P["\u0275\u0275text"](7),P["\u0275\u0275pipe"](8,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](9,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](10,"\n        "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](7),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](8,1,r.labelPrefix+"button.add"))}}function ne(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"ds-eperson-form",10),P["\u0275\u0275listener"]("submitForm",(function(){return P["\u0275\u0275restoreView"](n),P["\u0275\u0275nextContext"]().reset()}))("cancelForm",(function(){return P["\u0275\u0275restoreView"](n),P["\u0275\u0275nextContext"]().isEPersonFormShown=!1})),P["\u0275\u0275elementEnd"]()}}function re(e,t){1&e&&P["\u0275\u0275element"](0,"ds-loading")}var ie=function(e){return{"table-primary":e}},ae=function(e){return{name:e}};function oe(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"tr",30),P["\u0275\u0275pipe"](1,"async"),P["\u0275\u0275text"](2,"\n                "),P["\u0275\u0275elementStart"](3,"td"),P["\u0275\u0275text"](4),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](5,"\n                "),P["\u0275\u0275elementStart"](6,"td"),P["\u0275\u0275text"](7),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](8,"\n                "),P["\u0275\u0275elementStart"](9,"td"),P["\u0275\u0275text"](10),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](11,"\n                "),P["\u0275\u0275elementStart"](12,"td"),P["\u0275\u0275text"](13,"\n                  "),P["\u0275\u0275elementStart"](14,"div",31),P["\u0275\u0275text"](15,"\n                    "),P["\u0275\u0275elementStart"](16,"button",32),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=t.$implicit;return P["\u0275\u0275nextContext"](3).toggleEditEPerson(e.eperson)})),P["\u0275\u0275pipe"](17,"translate"),P["\u0275\u0275text"](18,"\n                      "),P["\u0275\u0275element"](19,"i",33),P["\u0275\u0275text"](20,"\n                    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](21,"\n                    "),P["\u0275\u0275elementStart"](22,"button",34),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=t.$implicit;return P["\u0275\u0275nextContext"](3).deleteEPerson(e.eperson)})),P["\u0275\u0275pipe"](23,"translate"),P["\u0275\u0275text"](24,"\n                      "),P["\u0275\u0275element"](25,"i",35),P["\u0275\u0275text"](26,"\n                    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](27,"\n                  "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](28,"\n                "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](29,"\n              "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,i=P["\u0275\u0275nextContext"](3);P["\u0275\u0275property"]("ngClass",P["\u0275\u0275pureFunction1"](15,ie,P["\u0275\u0275pipeBind1"](1,7,i.isActive(r.eperson)))),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](r.eperson.id),P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](r.eperson.name),P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](r.eperson.email),P["\u0275\u0275advance"](6),P["\u0275\u0275propertyInterpolate"]("title",P["\u0275\u0275pipeBind2"](17,9,i.labelPrefix+"table.edit.buttons.edit",P["\u0275\u0275pureFunction1"](17,ae,r.eperson.name))),P["\u0275\u0275advance"](6),P["\u0275\u0275propertyInterpolate"]("title",P["\u0275\u0275pipeBind2"](23,12,i.labelPrefix+"table.edit.buttons.remove",P["\u0275\u0275pureFunction1"](19,ae,r.eperson.name))),P["\u0275\u0275property"]("disabled",!r.ableToDelete)}}function se(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"ds-pagination",25),P["\u0275\u0275pipe"](1,"async"),P["\u0275\u0275text"](2,"\n\n          "),P["\u0275\u0275elementStart"](3,"div",26),P["\u0275\u0275text"](4,"\n            "),P["\u0275\u0275elementStart"](5,"table",27),P["\u0275\u0275text"](6,"\n              "),P["\u0275\u0275elementStart"](7,"thead"),P["\u0275\u0275text"](8,"\n              "),P["\u0275\u0275elementStart"](9,"tr"),P["\u0275\u0275text"](10,"\n                "),P["\u0275\u0275elementStart"](11,"th",28),P["\u0275\u0275text"](12),P["\u0275\u0275pipe"](13,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](14,"\n                "),P["\u0275\u0275elementStart"](15,"th",28),P["\u0275\u0275text"](16),P["\u0275\u0275pipe"](17,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](18,"\n                "),P["\u0275\u0275elementStart"](19,"th",28),P["\u0275\u0275text"](20),P["\u0275\u0275pipe"](21,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](22,"\n                "),P["\u0275\u0275elementStart"](23,"th"),P["\u0275\u0275text"](24),P["\u0275\u0275pipe"](25,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](26,"\n              "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](27,"\n              "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](28,"\n              "),P["\u0275\u0275elementStart"](29,"tbody"),P["\u0275\u0275text"](30,"\n              "),P["\u0275\u0275template"](31,oe,30,21,"tr",29),P["\u0275\u0275pipe"](32,"async"),P["\u0275\u0275text"](33,"\n              "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](34,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](35,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](36,"\n\n        "),P["\u0275\u0275elementEnd"]()),2&e){var n,r,i=P["\u0275\u0275nextContext"](2);P["\u0275\u0275property"]("paginationOptions",i.config)("pageInfoState",i.pageInfoState$)("collectionSize",null==(n=P["\u0275\u0275pipeBind1"](1,10,i.pageInfoState$))?null:n.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),P["\u0275\u0275advance"](12),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](13,12,i.labelPrefix+"table.id")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](17,14,i.labelPrefix+"table.name")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](21,16,i.labelPrefix+"table.email")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](25,18,i.labelPrefix+"table.edit")),P["\u0275\u0275advance"](7),P["\u0275\u0275property"]("ngForOf",null==(r=P["\u0275\u0275pipeBind1"](32,20,i.ePeopleDto$))?null:r.page)}}function ce(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"div",36),P["\u0275\u0275text"](1),P["\u0275\u0275pipe"](2,"translate"),P["\u0275\u0275elementEnd"]()),2&e){var n=P["\u0275\u0275nextContext"](2);P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate1"]("\n          ",P["\u0275\u0275pipeBind1"](2,1,n.labelPrefix+"no-items"),"\n        ")}}function le(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"div"),P["\u0275\u0275text"](1,"\n        "),P["\u0275\u0275elementStart"](2,"h3",11),P["\u0275\u0275text"](3),P["\u0275\u0275pipe"](4,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](5,"\n        "),P["\u0275\u0275elementStart"](6,"form",12),P["\u0275\u0275listener"]("ngSubmit",(function(){P["\u0275\u0275restoreView"](n);var e=P["\u0275\u0275nextContext"]();return e.search(e.searchForm.value)})),P["\u0275\u0275text"](7,"\n          "),P["\u0275\u0275elementStart"](8,"div"),P["\u0275\u0275text"](9,"\n            "),P["\u0275\u0275elementStart"](10,"select",13),P["\u0275\u0275text"](11,"\n              "),P["\u0275\u0275elementStart"](12,"option",14),P["\u0275\u0275text"](13),P["\u0275\u0275pipe"](14,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](15,"\n              "),P["\u0275\u0275elementStart"](16,"option",15),P["\u0275\u0275text"](17),P["\u0275\u0275pipe"](18,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](19,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](20,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](21,"\n          "),P["\u0275\u0275elementStart"](22,"div",16),P["\u0275\u0275text"](23,"\n            "),P["\u0275\u0275elementStart"](24,"div",17),P["\u0275\u0275text"](25,"\n              "),P["\u0275\u0275element"](26,"input",18),P["\u0275\u0275pipe"](27,"translate"),P["\u0275\u0275pipe"](28,"translate"),P["\u0275\u0275text"](29,"\n              "),P["\u0275\u0275elementStart"](30,"span",19),P["\u0275\u0275text"](31,"\n                "),P["\u0275\u0275elementStart"](32,"button",20),P["\u0275\u0275text"](33,"\n                  "),P["\u0275\u0275element"](34,"i",21),P["\u0275\u0275text"](35),P["\u0275\u0275pipe"](36,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](37,"\n              "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](38,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](39,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](40,"\n          "),P["\u0275\u0275elementStart"](41,"div"),P["\u0275\u0275text"](42,"\n            "),P["\u0275\u0275elementStart"](43,"button",22),P["\u0275\u0275listener"]("click",(function(){return P["\u0275\u0275restoreView"](n),P["\u0275\u0275nextContext"]().clearFormAndResetResult()})),P["\u0275\u0275text"](44),P["\u0275\u0275pipe"](45,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](46,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](47,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](48,"\n\n        "),P["\u0275\u0275template"](49,re,1,0,"ds-loading",5),P["\u0275\u0275pipe"](50,"async"),P["\u0275\u0275text"](51,"\n        "),P["\u0275\u0275template"](52,se,37,22,"ds-pagination",23),P["\u0275\u0275pipe"](53,"async"),P["\u0275\u0275pipe"](54,"async"),P["\u0275\u0275text"](55,"\n\n        "),P["\u0275\u0275template"](56,ce,3,3,"div",24),P["\u0275\u0275pipe"](57,"async"),P["\u0275\u0275text"](58,"\n      "),P["\u0275\u0275elementEnd"]()}if(2&e){var r,i,a=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate1"]("",P["\u0275\u0275pipeBind1"](4,11,a.labelPrefix+"search.head"),"\n\n        "),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("formGroup",a.searchForm),P["\u0275\u0275advance"](7),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](14,13,a.labelPrefix+"search.scope.metadata")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](18,15,a.labelPrefix+"search.scope.email")),P["\u0275\u0275advance"](9),P["\u0275\u0275property"]("placeholder",P["\u0275\u0275pipeBind1"](28,19,a.labelPrefix+"search.placeholder")),P["\u0275\u0275attribute"]("aria-label",P["\u0275\u0275pipeBind1"](27,17,a.labelPrefix+"search.placeholder")),P["\u0275\u0275advance"](9),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](36,21,a.labelPrefix+"search.button"),"\n                "),P["\u0275\u0275advance"](9),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](45,23,a.labelPrefix+"button.see-all")),P["\u0275\u0275advance"](5),P["\u0275\u0275property"]("ngIf",P["\u0275\u0275pipeBind1"](50,25,a.searching$)),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",(null==(r=P["\u0275\u0275pipeBind1"](53,27,a.pageInfoState$))?null:r.totalElements)>0&&!P["\u0275\u0275pipeBind1"](54,29,a.searching$)),P["\u0275\u0275advance"](4),P["\u0275\u0275property"]("ngIf",0==(null==(i=P["\u0275\u0275pipeBind1"](57,31,a.pageInfoState$))?null:i.totalElements))}}var pe,ue=((pe=function(){function e(t,n,r,i,o,s,c,l,p){a(this,e),this.epersonService=t,this.translateService=n,this.notificationsService=r,this.authorizationService=i,this.formBuilder=o,this.router=s,this.modalService=c,this.paginationService=l,this.requestService=p,this.labelPrefix="admin.access-control.epeople.",this.ePeople$=new u.a(Object(b.b)(new E.a,[])),this.ePeopleDto$=new u.a({}),this.pageInfoState$=new u.a(void 0),this.searching$=new u.a(!1),this.config=Object.assign(new x.a,{id:"elp",pageSize:5,currentPage:1}),this.subs=[],this.currentSearchQuery="",this.currentSearchScope="metadata",this.searchForm=this.formBuilder.group({scope:"metadata",query:""})}return s(e,[{key:"ngOnInit",value:function(){this.initialisePage()}},{key:"initialisePage",value:function(){var e=this;this.searching$.next(!0),this.isEPersonFormShown=!1,this.search({scope:this.currentSearchScope,query:this.currentSearchQuery}),this.subs.push(this.epersonService.getActiveEPerson().subscribe((function(t){null!=t&&t.id&&(e.isEPersonFormShown=!0)}))),this.subs.push(this.ePeople$.pipe(Object(m.a)((function(n){return n.pageInfo.totalElements>0?Object(d.a).apply(void 0,t(n.page.map((function(t){return e.authorizationService.isAuthorized(S.a.CanDelete,Object(v.b)(t)?t.self:void 0).pipe(Object(f.a)((function(e){var n=new h;return n.ableToDelete=e,n.eperson=t,n})))})))).pipe(Object(f.a)((function(e){return Object(b.b)(n.pageInfo,e)}))):[n]}))).subscribe((function(t){e.searching$.next(!1),e.ePeopleDto$.next(t),e.pageInfoState$.next(t.pageInfo)})))}},{key:"search",value:function(e){var t=this;this.searching$.next(!0),Object(v.b)(this.findListOptionsSub)&&this.findListOptionsSub.unsubscribe(),this.findListOptionsSub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe(Object(m.a)((function(n){var r=e.query,i=e.scope;return null!=r&&t.currentSearchQuery!==r&&(t.router.navigate([t.epersonService.getEPeoplePageRouterLink()],{queryParamsHandling:"merge"}),t.currentSearchQuery=r,t.paginationService.resetPage(t.config.id)),null!=i&&t.currentSearchScope!==i&&(t.router.navigate([t.epersonService.getEPeoplePageRouterLink()],{queryParamsHandling:"merge"}),t.currentSearchScope=i,t.paginationService.resetPage(t.config.id)),t.epersonService.searchByScope(t.currentSearchScope,t.currentSearchQuery,{currentPage:n.currentPage,elementsPerPage:n.pageSize})})),Object(y.c)()).subscribe((function(e){t.ePeople$.next(e.payload),t.pageInfoState$.next(e.payload.pageInfo)}))}},{key:"isActive",value:function(e){return this.getActiveEPerson().pipe(Object(f.a)((function(t){return e===t})))}},{key:"getActiveEPerson",value:function(){return this.epersonService.getActiveEPerson()}},{key:"toggleEditEPerson",value:function(e){var t=this;this.getActiveEPerson().pipe(Object(g.a)(1)).subscribe((function(n){e===n?(t.epersonService.cancelEditEPerson(),t.isEPersonFormShown=!1):(t.epersonService.editEPerson(e),t.isEPersonFormShown=!0)})),this.scrollToTop()}},{key:"deleteEPerson",value:function(e){var t=this;if(Object(v.b)(e.id)){var n=this.modalService.open(I.a);n.componentInstance.dso=e,n.componentInstance.headerLabel="confirmation-modal.delete-eperson.header",n.componentInstance.infoLabel="confirmation-modal.delete-eperson.info",n.componentInstance.cancelLabel="confirmation-modal.delete-eperson.cancel",n.componentInstance.confirmLabel="confirmation-modal.delete-eperson.confirm",n.componentInstance.brandColor="danger",n.componentInstance.confirmIcon="fas fa-trash",n.componentInstance.response.pipe(Object(g.a)(1)).subscribe((function(n){n&&Object(v.b)(e.id)&&t.epersonService.deleteEPerson(e).pipe(Object(y.g)()).subscribe((function(n){n.hasSucceeded?(t.notificationsService.success(t.translateService.get(t.labelPrefix+"notification.deleted.success",{name:e.name})),t.reset()):t.notificationsService.error("Error occured when trying to delete EPerson with id: "+e.id+" with code: "+n.statusCode+" and message: "+n.errorMessage)}))}))}}},{key:"ngOnDestroy",value:function(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.config.id)}},{key:"cleanupSubscribes",value:function(){this.subs.filter((function(e){return Object(v.b)(e)})).forEach((function(e){return e.unsubscribe()}))}},{key:"scrollToTop",value:function(){!function e(){var t=document.documentElement.scrollTop||document.body.scrollTop;t>0&&(window.requestAnimationFrame(e),window.scrollTo(0,t-t/8))}()}},{key:"clearFormAndResetResult",value:function(){this.searchForm.patchValue({query:""}),this.search({query:""})}},{key:"reset",value:function(){var e=this;this.epersonService.getBrowseEndpoint().pipe(Object(g.a)(1)).subscribe((function(t){e.requestService.setStaleByHrefSubstring(t).pipe(Object(g.a)(1)).subscribe((function(){e.epersonService.cancelEditEPerson(),e.isEPersonFormShown=!1}))}))}}]),e}()).\u0275fac=function(e){return new(e||pe)(P["\u0275\u0275directiveInject"](O.a),P["\u0275\u0275directiveInject"](j.f),P["\u0275\u0275directiveInject"](k.a),P["\u0275\u0275directiveInject"](B.a),P["\u0275\u0275directiveInject"](w.FormBuilder),P["\u0275\u0275directiveInject"](l.g),P["\u0275\u0275directiveInject"](C.u),P["\u0275\u0275directiveInject"](G.a),P["\u0275\u0275directiveInject"](D.a))},pe.\u0275cmp=P["\u0275\u0275defineComponent"]({type:pe,selectors:[["ds-epeople-registry"]],decls:22,vars:6,consts:[[1,"container"],[1,"epeople-registry","row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom","mb-3"],["id","header",1,"pb-2"],[4,"ngIf"],[3,"submitForm","cancelForm",4,"ngIf"],[1,"mr-auto","btn","btn-success","addEPerson-button",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[3,"submitForm","cancelForm"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"formGroup","ngSubmit"],["name","scope","id","scope","formControlName","scope","aria-label","Search scope",1,"form-control"],["value","metadata"],["value","email"],[1,"flex-grow-1","mr-3","ml-3"],[1,"form-group","input-group"],["type","text","name","query","id","query","formControlName","query",1,"form-control",3,"placeholder"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"search-button","btn","btn-secondary",3,"click"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","epeople",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","access-control-editEPersonButton",3,"title","click"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"disabled","title","click"],[1,"fas","fa-trash-alt","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"]],template:function(e,t){1&e&&(P["\u0275\u0275elementStart"](0,"div",0),P["\u0275\u0275text"](1,"\n  "),P["\u0275\u0275elementStart"](2,"div",1),P["\u0275\u0275text"](3,"\n    "),P["\u0275\u0275elementStart"](4,"div",2),P["\u0275\u0275text"](5,"\n      "),P["\u0275\u0275elementStart"](6,"div",3),P["\u0275\u0275text"](7,"\n        "),P["\u0275\u0275elementStart"](8,"h2",4),P["\u0275\u0275text"](9),P["\u0275\u0275pipe"](10,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](11,"\n\n        "),P["\u0275\u0275template"](12,te,11,3,"div",5),P["\u0275\u0275text"](13,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](14,"\n\n      "),P["\u0275\u0275template"](15,ne,1,0,"ds-eperson-form",6),P["\u0275\u0275text"](16,"\n\n      "),P["\u0275\u0275template"](17,le,59,33,"div",5),P["\u0275\u0275text"](18,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](19,"\n  "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](20,"\n"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](21,"\n")),2&e&&(P["\u0275\u0275advance"](9),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](10,4,t.labelPrefix+"head")),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",!t.isEPersonFormShown),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",t.isEPersonFormShown),P["\u0275\u0275advance"](2),P["\u0275\u0275property"]("ngIf",!t.isEPersonFormShown))},directives:[c.u,X,w["\u0275angular_packages_forms_forms_y"],w.NgControlStatusGroup,w.FormGroupDirective,w.SelectControlValueAccessor,w.NgControlStatus,w.FormControlName,w.NgSelectOption,w["\u0275angular_packages_forms_forms_x"],w.DefaultValueAccessor,ee.a,M.a,c.t,c.r],pipes:[j.e,c.b],encapsulation:2}),pe),de=o("JIr8"),me=o("HaPv"),fe=o("KIxa"),ge=o("ArZ3"),be=o("ye/0"),ve=o("YLTE"),xe=o("ac5F"),he=o("84Zn"),Se=o("/O7Z"),ye=o("VYMa"),Ie=o("5+tZ"),Ee=function(e){return{name:e}};function Pe(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"button",24),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=P["\u0275\u0275nextContext"]().$implicit;return P["\u0275\u0275nextContext"](2).deleteMemberFromGroup(e)})),P["\u0275\u0275pipe"](1,"translate"),P["\u0275\u0275text"](2,"\n                "),P["\u0275\u0275element"](3,"i",25),P["\u0275\u0275text"](4,"\n              "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=P["\u0275\u0275nextContext"]().$implicit,i=P["\u0275\u0275nextContext"](2);P["\u0275\u0275propertyInterpolate"]("title",P["\u0275\u0275pipeBind2"](1,1,i.messagePrefix+".table.edit.buttons.remove",P["\u0275\u0275pureFunction1"](4,Ee,r.eperson.name)))}}function Oe(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"button",26),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=P["\u0275\u0275nextContext"]().$implicit;return P["\u0275\u0275nextContext"](2).addMemberToGroup(e)})),P["\u0275\u0275pipe"](1,"translate"),P["\u0275\u0275text"](2,"\n                "),P["\u0275\u0275element"](3,"i",27),P["\u0275\u0275text"](4,"\n              "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=P["\u0275\u0275nextContext"]().$implicit,i=P["\u0275\u0275nextContext"](2);P["\u0275\u0275propertyInterpolate"]("title",P["\u0275\u0275pipeBind2"](1,1,i.messagePrefix+".table.edit.buttons.add",P["\u0275\u0275pureFunction1"](4,Ee,r.eperson.name)))}}var je=function(e){return[e]};function ke(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"tr"),P["\u0275\u0275text"](1,"\n          "),P["\u0275\u0275elementStart"](2,"td"),P["\u0275\u0275text"](3),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](4,"\n          "),P["\u0275\u0275elementStart"](5,"td"),P["\u0275\u0275elementStart"](6,"a",20),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=t.$implicit;return P["\u0275\u0275nextContext"](2).ePersonDataService.startEditingNewEPerson(e.eperson)})),P["\u0275\u0275text"](7),P["\u0275\u0275elementEnd"](),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](8,"\n          "),P["\u0275\u0275elementStart"](9,"td"),P["\u0275\u0275text"](10,"\n            "),P["\u0275\u0275elementStart"](11,"div",21),P["\u0275\u0275text"](12,"\n              "),P["\u0275\u0275template"](13,Pe,5,6,"button",22),P["\u0275\u0275text"](14,"\n\n              "),P["\u0275\u0275template"](15,Oe,5,6,"button",23),P["\u0275\u0275text"](16,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](17,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](18,"\n        "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,i=P["\u0275\u0275nextContext"](2);P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](r.eperson.id),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("routerLink",P["\u0275\u0275pureFunction1"](5,je,i.ePersonDataService.getEPeoplePageRouterLink())),P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate"](r.eperson.name),P["\u0275\u0275advance"](6),P["\u0275\u0275property"]("ngIf",r.memberOfGroup),P["\u0275\u0275advance"](2),P["\u0275\u0275property"]("ngIf",!r.memberOfGroup)}}function Be(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"ds-pagination",15),P["\u0275\u0275pipe"](1,"async"),P["\u0275\u0275pipe"](2,"async"),P["\u0275\u0275text"](3,"\n\n    "),P["\u0275\u0275elementStart"](4,"div",16),P["\u0275\u0275text"](5,"\n      "),P["\u0275\u0275elementStart"](6,"table",17),P["\u0275\u0275text"](7,"\n        "),P["\u0275\u0275elementStart"](8,"thead"),P["\u0275\u0275text"](9,"\n        "),P["\u0275\u0275elementStart"](10,"tr"),P["\u0275\u0275text"](11,"\n          "),P["\u0275\u0275elementStart"](12,"th",18),P["\u0275\u0275text"](13),P["\u0275\u0275pipe"](14,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](15,"\n          "),P["\u0275\u0275elementStart"](16,"th",18),P["\u0275\u0275text"](17),P["\u0275\u0275pipe"](18,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](19,"\n          "),P["\u0275\u0275elementStart"](20,"th"),P["\u0275\u0275text"](21),P["\u0275\u0275pipe"](22,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](23,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](24,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](25,"\n        "),P["\u0275\u0275elementStart"](26,"tbody"),P["\u0275\u0275text"](27,"\n        "),P["\u0275\u0275template"](28,ke,19,7,"tr",19),P["\u0275\u0275pipe"](29,"async"),P["\u0275\u0275text"](30,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](31,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](32,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](33,"\n\n  "),P["\u0275\u0275elementEnd"]()),2&e){var n,r,i=P["\u0275\u0275nextContext"]();P["\u0275\u0275property"]("paginationOptions",i.configSearch)("pageInfoState",P["\u0275\u0275pipeBind1"](1,9,i.ePeopleSearchDtos))("collectionSize",null==(n=P["\u0275\u0275pipeBind1"](2,11,i.ePeopleSearchDtos))?null:n.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),P["\u0275\u0275advance"](13),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](14,13,i.messagePrefix+".table.id")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](18,15,i.messagePrefix+".table.name")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](22,17,i.messagePrefix+".table.edit")),P["\u0275\u0275advance"](7),P["\u0275\u0275property"]("ngForOf",null==(r=P["\u0275\u0275pipeBind1"](29,19,i.ePeopleSearchDtos))?null:r.page)}}function we(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"div",28),P["\u0275\u0275text"](1),P["\u0275\u0275pipe"](2,"translate"),P["\u0275\u0275elementEnd"]()),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate1"]("\n    ",P["\u0275\u0275pipeBind1"](2,1,n.messagePrefix+".no-items"),"\n  ")}}function Ce(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"tr"),P["\u0275\u0275text"](1,"\n          "),P["\u0275\u0275elementStart"](2,"td"),P["\u0275\u0275text"](3),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](4,"\n          "),P["\u0275\u0275elementStart"](5,"td"),P["\u0275\u0275elementStart"](6,"a",20),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=t.$implicit;return P["\u0275\u0275nextContext"](2).ePersonDataService.startEditingNewEPerson(e.eperson)})),P["\u0275\u0275text"](7),P["\u0275\u0275elementEnd"](),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](8,"\n          "),P["\u0275\u0275elementStart"](9,"td"),P["\u0275\u0275text"](10,"\n            "),P["\u0275\u0275elementStart"](11,"div",21),P["\u0275\u0275text"](12,"\n              "),P["\u0275\u0275elementStart"](13,"button",24),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=t.$implicit;return P["\u0275\u0275nextContext"](2).deleteMemberFromGroup(e)})),P["\u0275\u0275pipe"](14,"translate"),P["\u0275\u0275text"](15,"\n                "),P["\u0275\u0275element"](16,"i",25),P["\u0275\u0275text"](17,"\n              "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](18,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](19,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](20,"\n        "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,i=P["\u0275\u0275nextContext"](2);P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](r.eperson.id),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("routerLink",P["\u0275\u0275pureFunction1"](7,je,i.ePersonDataService.getEPeoplePageRouterLink())),P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate"](r.eperson.name),P["\u0275\u0275advance"](6),P["\u0275\u0275propertyInterpolate"]("title",P["\u0275\u0275pipeBind2"](14,4,i.messagePrefix+".table.edit.buttons.remove",P["\u0275\u0275pureFunction1"](9,Ee,r.eperson.name)))}}function Ge(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"ds-pagination",15),P["\u0275\u0275pipe"](1,"async"),P["\u0275\u0275pipe"](2,"async"),P["\u0275\u0275text"](3,"\n\n    "),P["\u0275\u0275elementStart"](4,"div",16),P["\u0275\u0275text"](5,"\n      "),P["\u0275\u0275elementStart"](6,"table",29),P["\u0275\u0275text"](7,"\n        "),P["\u0275\u0275elementStart"](8,"thead"),P["\u0275\u0275text"](9,"\n        "),P["\u0275\u0275elementStart"](10,"tr"),P["\u0275\u0275text"](11,"\n          "),P["\u0275\u0275elementStart"](12,"th",18),P["\u0275\u0275text"](13),P["\u0275\u0275pipe"](14,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](15,"\n          "),P["\u0275\u0275elementStart"](16,"th",18),P["\u0275\u0275text"](17),P["\u0275\u0275pipe"](18,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](19,"\n          "),P["\u0275\u0275elementStart"](20,"th"),P["\u0275\u0275text"](21),P["\u0275\u0275pipe"](22,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](23,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](24,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](25,"\n        "),P["\u0275\u0275elementStart"](26,"tbody"),P["\u0275\u0275text"](27,"\n        "),P["\u0275\u0275template"](28,Ce,21,11,"tr",19),P["\u0275\u0275pipe"](29,"async"),P["\u0275\u0275text"](30,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](31,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](32,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](33,"\n\n  "),P["\u0275\u0275elementEnd"]()),2&e){var n,r,i=P["\u0275\u0275nextContext"]();P["\u0275\u0275property"]("paginationOptions",i.config)("pageInfoState",P["\u0275\u0275pipeBind1"](1,9,i.ePeopleMembersOfGroupDtos))("collectionSize",null==(n=P["\u0275\u0275pipeBind1"](2,11,i.ePeopleMembersOfGroupDtos))?null:n.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),P["\u0275\u0275advance"](13),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](14,13,i.messagePrefix+".table.id")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](18,15,i.messagePrefix+".table.name")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](22,17,i.messagePrefix+".table.edit")),P["\u0275\u0275advance"](7),P["\u0275\u0275property"]("ngForOf",null==(r=P["\u0275\u0275pipeBind1"](29,19,i.ePeopleMembersOfGroupDtos))?null:r.page)}}function De(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"div",28),P["\u0275\u0275text"](1),P["\u0275\u0275pipe"](2,"translate"),P["\u0275\u0275elementEnd"]()),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate1"]("\n    ",P["\u0275\u0275pipeBind1"](2,1,n.messagePrefix+".no-members-yet"),"\n  ")}}var Fe,Ae=function(e){return e[e.ActiveGroup=0]="ActiveGroup",e[e.MembersDTO=1]="MembersDTO",e[e.SearchResultsDTO=2]="SearchResultsDTO",e}({}),Le=((Fe=function(){function n(e,t,r,i,o,s,c){a(this,n),this.groupDataService=e,this.ePersonDataService=t,this.translateService=r,this.notificationsService=i,this.formBuilder=o,this.paginationService=s,this.router=c,this.ePeopleSearchDtos=new u.a(void 0),this.ePeopleMembersOfGroupDtos=new u.a(void 0),this.configSearch=Object.assign(new x.a,{id:"sml",pageSize:5,currentPage:1}),this.config=Object.assign(new x.a,{id:"ml",pageSize:5,currentPage:1}),this.subs=new Map,this.currentSearchQuery="",this.currentSearchScope="metadata"}return s(n,[{key:"ngOnInit",value:function(){var e=this;this.searchForm=this.formBuilder.group({scope:"metadata",query:""}),this.subs.set(Ae.ActiveGroup,this.groupDataService.getActiveGroup().subscribe((function(t){null!=t&&(e.groupBeingEdited=t,e.retrieveMembers(e.config.currentPage))})))}},{key:"retrieveMembers",value:function(e){var n=this;this.unsubFrom(Ae.MembersDTO),this.subs.set(Ae.MembersDTO,this.paginationService.getCurrentPagination(this.config.id,this.config).pipe(Object(m.a)((function(e){return n.ePersonDataService.findAllByHref(n.groupBeingEdited._links.epersons.href,{currentPage:e.currentPage,elementsPerPage:e.pageSize})})),Object(y.b)(),Object(f.a)((function(e){if(!e.hasFailed)return e;n.notificationsService.error(n.translateService.get(n.messagePrefix+".notification.failure",{cause:e.errorMessage}))})),Object(m.a)((function(e){return Object(d.a).apply(void 0,t(e.payload.page.map((function(e){return Object(d.a)(n.isMemberOfGroup(e),(function(t){var n=new h;return n.eperson=e,n.memberOfGroup=t,n}))})))).pipe(Object(f.a)((function(t){return Object(b.b)(e.payload.pageInfo,t)})))}))).subscribe((function(e){n.ePeopleMembersOfGroupDtos.next(e)})))}},{key:"isMemberOfGroup",value:function(e){var t=this;return this.groupDataService.getActiveGroup().pipe(Object(g.a)(1),Object(Ie.a)((function(n){return null!=n?t.ePersonDataService.findAllByHref(n._links.epersons.href,{currentPage:1,elementsPerPage:9999},!1).pipe(Object(y.i)(),Object(y.o)(),Object(f.a)((function(t){return t.page.filter((function(t){return t.id===e.id}))})),Object(f.a)((function(e){return e.length>0}))):Object(A.a)(!1)})))}},{key:"unsubFrom",value:function(e){this.subs.has(e)&&(this.subs.get(e).unsubscribe(),this.subs.delete(e))}},{key:"deleteMemberFromGroup",value:function(e){var t=this;this.groupDataService.getActiveGroup().pipe(Object(g.a)(1)).subscribe((function(n){if(null!=n){var r=t.groupDataService.deleteMemberFromGroup(n,e.eperson);t.showNotifications("deleteMember",r,e.eperson.name,n),t.search({scope:t.currentSearchScope,query:t.currentSearchQuery})}else t.notificationsService.error(t.translateService.get(t.messagePrefix+".notification.failure.noActiveGroup"))}))}},{key:"addMemberToGroup",value:function(e){var t=this;e.memberOfGroup=!0,this.groupDataService.getActiveGroup().pipe(Object(g.a)(1)).subscribe((function(n){if(null!=n){var r=t.groupDataService.addMemberToGroup(n,e.eperson);t.showNotifications("addMember",r,e.eperson.name,n)}else t.notificationsService.error(t.translateService.get(t.messagePrefix+".notification.failure.noActiveGroup"))}))}},{key:"search",value:function(e){var n=this;this.unsubFrom(Ae.SearchResultsDTO),this.subs.set(Ae.SearchResultsDTO,this.paginationService.getCurrentPagination(this.configSearch.id,this.configSearch).pipe(Object(m.a)((function(t){var r=e.query,i=e.scope;return null!=r&&n.currentSearchQuery!==r&&n.groupBeingEdited&&(n.router.navigate([],{queryParamsHandling:"merge"}),n.currentSearchQuery=r,n.paginationService.resetPage(n.configSearch.id)),null!=i&&n.currentSearchScope!==i&&n.groupBeingEdited&&(n.router.navigate([],{queryParamsHandling:"merge"}),n.currentSearchScope=i,n.paginationService.resetPage(n.configSearch.id)),n.searchDone=!0,n.ePersonDataService.searchByScope(n.currentSearchScope,n.currentSearchQuery,{currentPage:t.currentPage,elementsPerPage:t.pageSize})})),Object(y.b)(),Object(f.a)((function(e){if(!e.hasFailed)return e;n.notificationsService.error(n.translateService.get(n.messagePrefix+".notification.failure",{cause:e.errorMessage}))})),Object(m.a)((function(e){return Object(d.a).apply(void 0,t(e.payload.page.map((function(e){return Object(d.a)(n.isMemberOfGroup(e),(function(t){var n=new h;return n.eperson=e,n.memberOfGroup=t,n}))})))).pipe(Object(f.a)((function(t){return Object(b.b)(e.payload.pageInfo,t)})))}))).subscribe((function(e){n.ePeopleSearchDtos.next(e)})))}},{key:"ngOnDestroy",value:function(){var t,n=e(this.subs.keys());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.unsubFrom(r)}}catch(i){n.e(i)}finally{n.f()}this.paginationService.clearPagination(this.config.id),this.paginationService.clearPagination(this.configSearch.id)}},{key:"showNotifications",value:function(e,t,n,r){var i=this;t.pipe(Object(y.g)()).subscribe((function(t){t.hasSucceeded?(i.notificationsService.success(i.translateService.get(i.messagePrefix+".notification.success."+e,{name:n})),i.ePersonDataService.clearLinkRequests(r._links.epersons.href)):i.notificationsService.error(i.translateService.get(i.messagePrefix+".notification.failure."+e,{name:n}))}))}},{key:"clearFormAndResetResult",value:function(){this.searchForm.patchValue({query:""}),this.search({query:""})}}]),n}()).\u0275fac=function(e){return new(e||Fe)(P["\u0275\u0275directiveInject"]($.a),P["\u0275\u0275directiveInject"](O.a),P["\u0275\u0275directiveInject"](j.f),P["\u0275\u0275directiveInject"](k.a),P["\u0275\u0275directiveInject"](w.FormBuilder),P["\u0275\u0275directiveInject"](G.a),P["\u0275\u0275directiveInject"](l.g))},Fe.\u0275cmp=P["\u0275\u0275defineComponent"]({type:Fe,selectors:[["ds-members-list"]],inputs:{messagePrefix:"messagePrefix"},decls:69,vars:36,consts:[[1,"border-bottom","pb-2"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"formGroup","ngSubmit"],["name","scope","id","scope","formControlName","scope","aria-label","Search scope",1,"form-control"],["value","metadata"],["value","email"],[1,"flex-grow-1","mr-3","ml-3"],[1,"form-group","input-group"],["type","text","name","query","id","query","formControlName","query","aria-label","Search input",1,"form-control"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary",3,"click"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","epersonsSearch",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],[3,"routerLink","click"],[1,"btn-group","edit-field"],["class","btn btn-outline-danger btn-sm",3,"title","click",4,"ngIf"],["class","btn btn-outline-primary btn-sm",3,"title","click",4,"ngIf"],[1,"btn","btn-outline-danger","btn-sm",3,"title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-primary","btn-sm",3,"title","click"],[1,"fas","fa-plus","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["id","ePeopleMembersOfGroup",1,"table","table-striped","table-hover","table-bordered"]],template:function(e,t){if(1&e&&(P["\u0275\u0275elementContainerStart"](0),P["\u0275\u0275text"](1,"\n  "),P["\u0275\u0275elementStart"](2,"h3",0),P["\u0275\u0275text"](3),P["\u0275\u0275pipe"](4,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](5,"\n\n  "),P["\u0275\u0275elementStart"](6,"h4",1),P["\u0275\u0275text"](7),P["\u0275\u0275pipe"](8,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](9,"\n  "),P["\u0275\u0275elementStart"](10,"form",2),P["\u0275\u0275listener"]("ngSubmit",(function(){return t.search(t.searchForm.value)})),P["\u0275\u0275text"](11,"\n    "),P["\u0275\u0275elementStart"](12,"div"),P["\u0275\u0275text"](13,"\n      "),P["\u0275\u0275elementStart"](14,"select",3),P["\u0275\u0275text"](15,"\n        "),P["\u0275\u0275elementStart"](16,"option",4),P["\u0275\u0275text"](17),P["\u0275\u0275pipe"](18,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](19,"\n        "),P["\u0275\u0275elementStart"](20,"option",5),P["\u0275\u0275text"](21),P["\u0275\u0275pipe"](22,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](23,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](24,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](25,"\n    "),P["\u0275\u0275elementStart"](26,"div",6),P["\u0275\u0275text"](27,"\n      "),P["\u0275\u0275elementStart"](28,"div",7),P["\u0275\u0275text"](29,"\n        "),P["\u0275\u0275element"](30,"input",8),P["\u0275\u0275text"](31,"\n        "),P["\u0275\u0275elementStart"](32,"span",9),P["\u0275\u0275text"](33,"\n            "),P["\u0275\u0275elementStart"](34,"button",10),P["\u0275\u0275text"](35,"\n              "),P["\u0275\u0275element"](36,"i",11),P["\u0275\u0275text"](37),P["\u0275\u0275pipe"](38,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](39,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](40,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](41,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](42,"\n    "),P["\u0275\u0275elementStart"](43,"div"),P["\u0275\u0275text"](44,"\n      "),P["\u0275\u0275elementStart"](45,"button",12),P["\u0275\u0275listener"]("click",(function(){return t.clearFormAndResetResult()})),P["\u0275\u0275text"](46),P["\u0275\u0275pipe"](47,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](48,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](49,"\n  "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](50,"\n\n  "),P["\u0275\u0275template"](51,Be,34,21,"ds-pagination",13),P["\u0275\u0275pipe"](52,"async"),P["\u0275\u0275text"](53,"\n\n  "),P["\u0275\u0275template"](54,we,3,3,"div",14),P["\u0275\u0275pipe"](55,"async"),P["\u0275\u0275text"](56,"\n\n  "),P["\u0275\u0275elementStart"](57,"h4"),P["\u0275\u0275text"](58),P["\u0275\u0275pipe"](59,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](60,"\n\n  "),P["\u0275\u0275template"](61,Ge,34,21,"ds-pagination",13),P["\u0275\u0275pipe"](62,"async"),P["\u0275\u0275text"](63,"\n\n  "),P["\u0275\u0275template"](64,De,3,3,"div",14),P["\u0275\u0275pipe"](65,"async"),P["\u0275\u0275pipe"](66,"async"),P["\u0275\u0275text"](67,"\n\n"),P["\u0275\u0275elementContainerEnd"](),P["\u0275\u0275text"](68,"\n")),2&e){var n,r,i,a=null;P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](4,12,t.messagePrefix+".head")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate1"]("",P["\u0275\u0275pipeBind1"](8,14,t.messagePrefix+".search.head"),"\n\n  "),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("formGroup",t.searchForm),P["\u0275\u0275advance"](7),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](18,16,t.messagePrefix+".search.scope.metadata")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](22,18,t.messagePrefix+".search.scope.email")),P["\u0275\u0275advance"](16),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](38,20,t.messagePrefix+".search.button"),""),P["\u0275\u0275advance"](9),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](47,22,t.messagePrefix+".button.see-all")),P["\u0275\u0275advance"](5),P["\u0275\u0275property"]("ngIf",(null==(n=P["\u0275\u0275pipeBind1"](52,24,t.ePeopleSearchDtos))?null:n.totalElements)>0),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",0==(null==(r=P["\u0275\u0275pipeBind1"](55,26,t.ePeopleSearchDtos))?null:r.totalElements)&&t.searchDone),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](59,28,t.messagePrefix+".headMembers")),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",(null==(i=P["\u0275\u0275pipeBind1"](62,30,t.ePeopleMembersOfGroupDtos))?null:i.totalElements)>0),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",null==P["\u0275\u0275pipeBind1"](65,32,t.ePeopleMembersOfGroupDtos)||0==(null==(a=P["\u0275\u0275pipeBind1"](66,34,t.ePeopleMembersOfGroupDtos))?null:a.totalElements))}},directives:[w["\u0275angular_packages_forms_forms_y"],w.NgControlStatusGroup,w.FormGroupDirective,w.SelectControlValueAccessor,w.NgControlStatus,w.FormControlName,w.NgSelectOption,w["\u0275angular_packages_forms_forms_x"],w.DefaultValueAccessor,c.u,M.a,c.t,l.j],pipes:[j.e,c.b],encapsulation:2}),Fe),$e=function(e){return{name:e}};function Ne(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"button",22),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=P["\u0275\u0275nextContext"]().$implicit;return P["\u0275\u0275nextContext"](2).deleteSubgroupFromGroup(e)})),P["\u0275\u0275pipe"](1,"translate"),P["\u0275\u0275text"](2,"\n                "),P["\u0275\u0275element"](3,"i",23),P["\u0275\u0275text"](4,"\n              "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=P["\u0275\u0275nextContext"]().$implicit,i=P["\u0275\u0275nextContext"](2);P["\u0275\u0275propertyInterpolate"]("title",P["\u0275\u0275pipeBind2"](1,1,i.messagePrefix+".table.edit.buttons.remove",P["\u0275\u0275pureFunction1"](4,$e,r.name)))}}function qe(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"p"),P["\u0275\u0275text"](1),P["\u0275\u0275pipe"](2,"translate"),P["\u0275\u0275elementEnd"]()),2&e){var n=P["\u0275\u0275nextContext"](3);P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](2,1,n.messagePrefix+".table.edit.currentGroup"))}}function Re(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"button",24),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=P["\u0275\u0275nextContext"]().$implicit;return P["\u0275\u0275nextContext"](2).addSubgroupToGroup(e)})),P["\u0275\u0275pipe"](1,"translate"),P["\u0275\u0275text"](2,"\n                "),P["\u0275\u0275element"](3,"i",25),P["\u0275\u0275text"](4,"\n              "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=P["\u0275\u0275nextContext"]().$implicit,i=P["\u0275\u0275nextContext"](2);P["\u0275\u0275propertyInterpolate"]("title",P["\u0275\u0275pipeBind2"](1,1,i.messagePrefix+".table.edit.buttons.add",P["\u0275\u0275pureFunction1"](4,$e,r.name)))}}var Me=function(e){return[e]};function Ve(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"tr"),P["\u0275\u0275text"](1,"\n          "),P["\u0275\u0275elementStart"](2,"td"),P["\u0275\u0275text"](3),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](4,"\n          "),P["\u0275\u0275elementStart"](5,"td"),P["\u0275\u0275elementStart"](6,"a",17),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=t.$implicit;return P["\u0275\u0275nextContext"](2).groupDataService.startEditingNewGroup(e)})),P["\u0275\u0275text"](7),P["\u0275\u0275elementEnd"](),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](8,"\n          "),P["\u0275\u0275elementStart"](9,"td"),P["\u0275\u0275text"](10,"\n            "),P["\u0275\u0275elementStart"](11,"div",18),P["\u0275\u0275text"](12,"\n              "),P["\u0275\u0275template"](13,Ne,5,6,"button",19),P["\u0275\u0275pipe"](14,"async"),P["\u0275\u0275pipe"](15,"async"),P["\u0275\u0275text"](16,"\n\n              "),P["\u0275\u0275template"](17,qe,3,3,"p",20),P["\u0275\u0275pipe"](18,"async"),P["\u0275\u0275text"](19,"\n\n              "),P["\u0275\u0275template"](20,Re,5,6,"button",21),P["\u0275\u0275pipe"](21,"async"),P["\u0275\u0275pipe"](22,"async"),P["\u0275\u0275text"](23,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](24,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](25,"\n        "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,i=P["\u0275\u0275nextContext"](2);P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](r.id),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("routerLink",P["\u0275\u0275pureFunction1"](16,Me,i.groupDataService.getGroupEditPageRouterLink(r))),P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate"](r.name),P["\u0275\u0275advance"](6),P["\u0275\u0275property"]("ngIf",P["\u0275\u0275pipeBind1"](14,6,i.isSubgroupOfGroup(r))&&!P["\u0275\u0275pipeBind1"](15,8,i.isActiveGroup(r))),P["\u0275\u0275advance"](4),P["\u0275\u0275property"]("ngIf",P["\u0275\u0275pipeBind1"](18,10,i.isActiveGroup(r))),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",!P["\u0275\u0275pipeBind1"](21,12,i.isSubgroupOfGroup(r))&&!P["\u0275\u0275pipeBind1"](22,14,i.isActiveGroup(r)))}}function ze(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"ds-pagination",12),P["\u0275\u0275pipe"](1,"async"),P["\u0275\u0275pipe"](2,"async"),P["\u0275\u0275text"](3,"\n\n    "),P["\u0275\u0275elementStart"](4,"div",13),P["\u0275\u0275text"](5,"\n      "),P["\u0275\u0275elementStart"](6,"table",14),P["\u0275\u0275text"](7,"\n        "),P["\u0275\u0275elementStart"](8,"thead"),P["\u0275\u0275text"](9,"\n        "),P["\u0275\u0275elementStart"](10,"tr"),P["\u0275\u0275text"](11,"\n          "),P["\u0275\u0275elementStart"](12,"th",15),P["\u0275\u0275text"](13),P["\u0275\u0275pipe"](14,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](15,"\n          "),P["\u0275\u0275elementStart"](16,"th",15),P["\u0275\u0275text"](17),P["\u0275\u0275pipe"](18,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](19,"\n          "),P["\u0275\u0275elementStart"](20,"th"),P["\u0275\u0275text"](21),P["\u0275\u0275pipe"](22,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](23,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](24,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](25,"\n        "),P["\u0275\u0275elementStart"](26,"tbody"),P["\u0275\u0275text"](27,"\n        "),P["\u0275\u0275template"](28,Ve,26,18,"tr",16),P["\u0275\u0275pipe"](29,"async"),P["\u0275\u0275text"](30,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](31,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](32,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](33,"\n  "),P["\u0275\u0275elementEnd"]()),2&e){var n,r,i,a=P["\u0275\u0275nextContext"]();P["\u0275\u0275property"]("paginationOptions",a.configSearch)("pageInfoState",null==(n=P["\u0275\u0275pipeBind1"](1,9,a.searchResults$))?null:n.payload)("collectionSize",null==(r=P["\u0275\u0275pipeBind1"](2,11,a.searchResults$))||null==r.payload?null:r.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),P["\u0275\u0275advance"](13),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](14,13,a.messagePrefix+".table.id")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](18,15,a.messagePrefix+".table.name")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](22,17,a.messagePrefix+".table.edit")),P["\u0275\u0275advance"](7),P["\u0275\u0275property"]("ngForOf",null==(i=P["\u0275\u0275pipeBind1"](29,19,a.searchResults$))||null==i.payload?null:i.payload.page)}}function _e(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"div",26),P["\u0275\u0275text"](1),P["\u0275\u0275pipe"](2,"translate"),P["\u0275\u0275elementEnd"]()),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate1"]("\n    ",P["\u0275\u0275pipeBind1"](2,1,n.messagePrefix+".no-items"),"\n  ")}}function Te(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"tr"),P["\u0275\u0275text"](1,"\n          "),P["\u0275\u0275elementStart"](2,"td"),P["\u0275\u0275text"](3),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](4,"\n          "),P["\u0275\u0275elementStart"](5,"td"),P["\u0275\u0275elementStart"](6,"a",17),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=t.$implicit;return P["\u0275\u0275nextContext"](2).groupDataService.startEditingNewGroup(e)})),P["\u0275\u0275text"](7),P["\u0275\u0275elementEnd"](),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](8,"\n          "),P["\u0275\u0275elementStart"](9,"td"),P["\u0275\u0275text"](10,"\n            "),P["\u0275\u0275elementStart"](11,"div",18),P["\u0275\u0275text"](12,"\n              "),P["\u0275\u0275elementStart"](13,"button",22),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=t.$implicit;return P["\u0275\u0275nextContext"](2).deleteSubgroupFromGroup(e)})),P["\u0275\u0275pipe"](14,"translate"),P["\u0275\u0275text"](15,"\n                "),P["\u0275\u0275element"](16,"i",23),P["\u0275\u0275text"](17,"\n              "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](18,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](19,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](20,"\n        "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,i=P["\u0275\u0275nextContext"](2);P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](r.id),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("routerLink",P["\u0275\u0275pureFunction1"](7,Me,i.groupDataService.getGroupEditPageRouterLink(r))),P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate"](r.name),P["\u0275\u0275advance"](6),P["\u0275\u0275propertyInterpolate"]("title",P["\u0275\u0275pipeBind2"](14,4,i.messagePrefix+".table.edit.buttons.remove",P["\u0275\u0275pureFunction1"](9,$e,r.name)))}}function He(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"ds-pagination",12),P["\u0275\u0275pipe"](1,"async"),P["\u0275\u0275pipe"](2,"async"),P["\u0275\u0275text"](3,"\n\n    "),P["\u0275\u0275elementStart"](4,"div",13),P["\u0275\u0275text"](5,"\n      "),P["\u0275\u0275elementStart"](6,"table",27),P["\u0275\u0275text"](7,"\n        "),P["\u0275\u0275elementStart"](8,"thead"),P["\u0275\u0275text"](9,"\n        "),P["\u0275\u0275elementStart"](10,"tr"),P["\u0275\u0275text"](11,"\n          "),P["\u0275\u0275elementStart"](12,"th",15),P["\u0275\u0275text"](13),P["\u0275\u0275pipe"](14,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](15,"\n          "),P["\u0275\u0275elementStart"](16,"th",15),P["\u0275\u0275text"](17),P["\u0275\u0275pipe"](18,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](19,"\n          "),P["\u0275\u0275elementStart"](20,"th"),P["\u0275\u0275text"](21),P["\u0275\u0275pipe"](22,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](23,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](24,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](25,"\n        "),P["\u0275\u0275elementStart"](26,"tbody"),P["\u0275\u0275text"](27,"\n        "),P["\u0275\u0275template"](28,Te,21,11,"tr",16),P["\u0275\u0275pipe"](29,"async"),P["\u0275\u0275text"](30,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](31,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](32,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](33,"\n  "),P["\u0275\u0275elementEnd"]()),2&e){var n,r,i,a=P["\u0275\u0275nextContext"]();P["\u0275\u0275property"]("paginationOptions",a.config)("pageInfoState",null==(n=P["\u0275\u0275pipeBind1"](1,9,a.subGroups$))?null:n.payload)("collectionSize",null==(r=P["\u0275\u0275pipeBind1"](2,11,a.subGroups$))||null==r.payload?null:r.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),P["\u0275\u0275advance"](13),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](14,13,a.messagePrefix+".table.id")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](18,15,a.messagePrefix+".table.name")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](22,17,a.messagePrefix+".table.edit")),P["\u0275\u0275advance"](7),P["\u0275\u0275property"]("ngForOf",null==(i=P["\u0275\u0275pipeBind1"](29,19,a.subGroups$))||null==i.payload?null:i.payload.page)}}function Qe(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"div",26),P["\u0275\u0275text"](1),P["\u0275\u0275pipe"](2,"translate"),P["\u0275\u0275elementEnd"]()),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate1"]("\n    ",P["\u0275\u0275pipeBind1"](2,1,n.messagePrefix+".no-subgroups-yet"),"\n  ")}}var We,Ue=function(e){return e[e.Members=0]="Members",e[e.ActiveGroup=1]="ActiveGroup",e[e.SearchResults=2]="SearchResults",e}({}),Ye=((We=function(){function t(e,n,r,i,o,s){a(this,t),this.groupDataService=e,this.translateService=n,this.notificationsService=r,this.formBuilder=i,this.paginationService=o,this.router=s,this.searchResults$=new u.a(void 0),this.subGroups$=new u.a(void 0),this.subs=new Map,this.configSearch=Object.assign(new x.a,{id:"ssgl",pageSize:5,currentPage:1}),this.config=Object.assign(new x.a,{id:"sgl",pageSize:5,currentPage:1}),this.currentSearchQuery=""}return s(t,[{key:"ngOnInit",value:function(){var e=this;this.searchForm=this.formBuilder.group({query:""}),this.subs.set(Ue.ActiveGroup,this.groupDataService.getActiveGroup().subscribe((function(t){null!=t&&(e.groupBeingEdited=t,e.retrieveSubGroups())})))}},{key:"retrieveSubGroups",value:function(){var e=this;this.unsubFrom(Ue.Members),this.subs.set(Ue.Members,this.paginationService.getCurrentPagination(this.config.id,this.config).pipe(Object(m.a)((function(t){return e.groupDataService.findAllByHref(e.groupBeingEdited._links.subgroups.href,{currentPage:t.currentPage,elementsPerPage:t.pageSize})}))).subscribe((function(t){e.subGroups$.next(t)})))}},{key:"isSubgroupOfGroup",value:function(e){var t=this;return this.groupDataService.getActiveGroup().pipe(Object(g.a)(1),Object(Ie.a)((function(n){return null!=n?n.uuid===e.uuid?Object(A.a)(!1):t.groupDataService.findAllByHref(n._links.subgroups.href,{currentPage:1,elementsPerPage:9999}).pipe(Object(y.i)(),Object(y.o)(),Object(f.a)((function(t){return t.page.filter((function(t){return t.id===e.id}))})),Object(f.a)((function(e){return e.length>0}))):Object(A.a)(!1)})))}},{key:"isActiveGroup",value:function(e){return this.groupDataService.getActiveGroup().pipe(Object(g.a)(1),Object(Ie.a)((function(t){return null!=t&&t.uuid===e.uuid?Object(A.a)(!0):Object(A.a)(!1)})))}},{key:"deleteSubgroupFromGroup",value:function(e){var t=this;this.groupDataService.getActiveGroup().pipe(Object(g.a)(1)).subscribe((function(n){if(null!=n){var r=t.groupDataService.deleteSubGroupFromGroup(n,e);t.showNotifications("deleteSubgroup",r,e.name,n)}else t.notificationsService.error(t.translateService.get(t.messagePrefix+".notification.failure.noActiveGroup"))}))}},{key:"addSubgroupToGroup",value:function(e){var t=this;this.groupDataService.getActiveGroup().pipe(Object(g.a)(1)).subscribe((function(n){if(null!=n)if(n.uuid!==e.uuid){var r=t.groupDataService.addSubGroupToGroup(n,e);t.showNotifications("addSubgroup",r,e.name,n)}else t.notificationsService.error(t.translateService.get(t.messagePrefix+".notification.failure.subgroupToAddIsActiveGroup"));else t.notificationsService.error(t.translateService.get(t.messagePrefix+".notification.failure.noActiveGroup"))}))}},{key:"search",value:function(e){var t=this,n=e.query;null!=n&&this.currentSearchQuery!==n&&(this.router.navigateByUrl(this.groupDataService.getGroupEditPageRouterLink(this.groupBeingEdited)),this.currentSearchQuery=n,this.configSearch.currentPage=1),this.searchDone=!0,this.unsubFrom(Ue.SearchResults),this.subs.set(Ue.SearchResults,this.paginationService.getCurrentPagination(this.configSearch.id,this.configSearch).pipe(Object(m.a)((function(e){return t.groupDataService.searchGroups(t.currentSearchQuery,{currentPage:e.currentPage,elementsPerPage:e.pageSize})}))).subscribe((function(e){t.searchResults$.next(e)})))}},{key:"unsubFrom",value:function(e){this.subs.has(e)&&(this.subs.get(e).unsubscribe(),this.subs.delete(e))}},{key:"ngOnDestroy",value:function(){var t,n=e(this.subs.keys());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.unsubFrom(r)}}catch(i){n.e(i)}finally{n.f()}this.paginationService.clearPagination(this.config.id),this.paginationService.clearPagination(this.configSearch.id)}},{key:"showNotifications",value:function(e,t,n,r){var i=this;t.pipe(Object(y.g)()).subscribe((function(t){t.hasSucceeded?(i.notificationsService.success(i.translateService.get(i.messagePrefix+".notification.success."+e,{name:n})),i.groupDataService.clearGroupLinkRequests(r._links.subgroups.href)):i.notificationsService.error(i.translateService.get(i.messagePrefix+".notification.failure."+e,{name:n}))}))}},{key:"clearFormAndResetResult",value:function(){this.searchForm.patchValue({query:""}),this.search({query:""})}}]),t}()).\u0275fac=function(e){return new(e||We)(P["\u0275\u0275directiveInject"]($.a),P["\u0275\u0275directiveInject"](j.f),P["\u0275\u0275directiveInject"](k.a),P["\u0275\u0275directiveInject"](w.FormBuilder),P["\u0275\u0275directiveInject"](G.a),P["\u0275\u0275directiveInject"](l.g))},We.\u0275cmp=P["\u0275\u0275defineComponent"]({type:We,selectors:[["ds-subgroups-list"]],inputs:{messagePrefix:"messagePrefix"},decls:54,vars:28,consts:[[1,"border-bottom","pb-2"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"formGroup","ngSubmit"],[1,"flex-grow-1","mr-3"],[1,"form-group","input-group","mr-3"],["type","text","name","query","id","query","formControlName","query","aria-label","Search input",1,"form-control"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary","float-right",3,"click"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","groupsSearch",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],[3,"routerLink","click"],[1,"btn-group","edit-field"],["class","btn btn-outline-danger btn-sm deleteButton",3,"title","click",4,"ngIf"],[4,"ngIf"],["class","btn btn-outline-primary btn-sm addButton",3,"title","click",4,"ngIf"],[1,"btn","btn-outline-danger","btn-sm","deleteButton",3,"title","click"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-primary","btn-sm","addButton",3,"title","click"],[1,"fas","fa-plus","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["id","subgroupsOfGroup",1,"table","table-striped","table-hover","table-bordered"]],template:function(e,t){var n,r,i,a;1&e&&(P["\u0275\u0275elementContainerStart"](0),P["\u0275\u0275text"](1,"\n  "),P["\u0275\u0275elementStart"](2,"h3",0),P["\u0275\u0275text"](3),P["\u0275\u0275pipe"](4,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](5,"\n\n  "),P["\u0275\u0275elementStart"](6,"h4",1),P["\u0275\u0275text"](7),P["\u0275\u0275pipe"](8,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](9,"\n  "),P["\u0275\u0275elementStart"](10,"form",2),P["\u0275\u0275listener"]("ngSubmit",(function(){return t.search(t.searchForm.value)})),P["\u0275\u0275text"](11,"\n    "),P["\u0275\u0275elementStart"](12,"div",3),P["\u0275\u0275text"](13,"\n      "),P["\u0275\u0275elementStart"](14,"div",4),P["\u0275\u0275text"](15,"\n        "),P["\u0275\u0275element"](16,"input",5),P["\u0275\u0275text"](17,"\n        "),P["\u0275\u0275elementStart"](18,"span",6),P["\u0275\u0275text"](19,"\n            "),P["\u0275\u0275elementStart"](20,"button",7),P["\u0275\u0275text"](21,"\n              "),P["\u0275\u0275element"](22,"i",8),P["\u0275\u0275text"](23),P["\u0275\u0275pipe"](24,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](25,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](26,"\n\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](27,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](28,"\n    "),P["\u0275\u0275elementStart"](29,"div"),P["\u0275\u0275text"](30,"\n      "),P["\u0275\u0275elementStart"](31,"button",9),P["\u0275\u0275listener"]("click",(function(){return t.clearFormAndResetResult()})),P["\u0275\u0275text"](32),P["\u0275\u0275pipe"](33,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](34,"\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](35,"\n  "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](36,"\n\n  "),P["\u0275\u0275template"](37,ze,34,21,"ds-pagination",10),P["\u0275\u0275pipe"](38,"async"),P["\u0275\u0275text"](39,"\n\n  "),P["\u0275\u0275template"](40,_e,3,3,"div",11),P["\u0275\u0275pipe"](41,"async"),P["\u0275\u0275text"](42,"\n\n  "),P["\u0275\u0275elementStart"](43,"h4"),P["\u0275\u0275text"](44),P["\u0275\u0275pipe"](45,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](46,"\n\n  "),P["\u0275\u0275template"](47,He,34,21,"ds-pagination",10),P["\u0275\u0275pipe"](48,"async"),P["\u0275\u0275text"](49,"\n\n  "),P["\u0275\u0275template"](50,Qe,3,3,"div",11),P["\u0275\u0275pipe"](51,"async"),P["\u0275\u0275text"](52,"\n\n"),P["\u0275\u0275elementContainerEnd"](),P["\u0275\u0275text"](53,"\n")),2&e&&(P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](4,10,t.messagePrefix+".head")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate1"]("",P["\u0275\u0275pipeBind1"](8,12,t.messagePrefix+".search.head"),"\n\n  "),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("formGroup",t.searchForm),P["\u0275\u0275advance"](13),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](24,14,t.messagePrefix+".search.button"),"\n            "),P["\u0275\u0275advance"](9),P["\u0275\u0275textInterpolate1"]("\n        ",P["\u0275\u0275pipeBind1"](33,16,t.messagePrefix+".button.see-all"),"\n      "),P["\u0275\u0275advance"](5),P["\u0275\u0275property"]("ngIf",(null==(n=P["\u0275\u0275pipeBind1"](38,18,t.searchResults$))||null==n.payload?null:n.payload.totalElements)>0),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",0==(null==(r=P["\u0275\u0275pipeBind1"](41,20,t.searchResults$))||null==r.payload?null:r.payload.totalElements)&&t.searchDone),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](45,22,t.messagePrefix+".headSubgroups")),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",(null==(i=P["\u0275\u0275pipeBind1"](48,24,t.subGroups$))||null==i.payload?null:i.payload.totalElements)>0),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",0==(null==(a=P["\u0275\u0275pipeBind1"](51,26,t.subGroups$))||null==a.payload?null:a.payload.totalElements)))},directives:[w["\u0275angular_packages_forms_forms_y"],w.NgControlStatusGroup,w.FormGroupDirective,w.DefaultValueAccessor,w.NgControlStatus,w.FormControlName,c.u,M.a,c.t,l.j],pipes:[j.e,c.b],encapsulation:2}),We);function Je(e,t){1&e&&P["\u0275\u0275element"](0,"div")}function Ke(e,t){if(1&e&&(P["\u0275\u0275text"](0,"\n        "),P["\u0275\u0275elementStart"](1,"h2",14),P["\u0275\u0275text"](2),P["\u0275\u0275pipe"](3,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](4,"\n      ")),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](2),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](3,1,n.messagePrefix+".head.create"))}}function Ze(e,t){if(1&e&&(P["\u0275\u0275text"](0,"\n        "),P["\u0275\u0275elementStart"](1,"h2",14),P["\u0275\u0275text"](2),P["\u0275\u0275pipe"](3,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](4,"\n      ")),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](2),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](3,1,n.messagePrefix+".head.edit"))}}function Xe(e,t){if(1&e&&P["\u0275\u0275element"](0,"ds-alert",15),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275property"]("type",n.AlertTypeEnum.Warning)("content",n.messagePrefix+".alert.permanent")}}var et=function(e,t,n){return{name:e,comcol:t,comcolEditRolesRoute:n}};function tt(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"ds-alert",15),P["\u0275\u0275pipe"](1,"translate"),P["\u0275\u0275pipe"](2,"async"),P["\u0275\u0275pipe"](3,"async"),P["\u0275\u0275pipe"](4,"async"),P["\u0275\u0275text"](5,"\n      "),P["\u0275\u0275elementEnd"]()),2&e){var n=P["\u0275\u0275nextContext"](),r=null;P["\u0275\u0275property"]("type",n.AlertTypeEnum.Warning)("content",P["\u0275\u0275pipeBind2"](1,2,n.messagePrefix+".alert.workflowGroup",P["\u0275\u0275pureFunction3"](11,et,null==(r=P["\u0275\u0275pipeBind1"](2,5,n.getLinkedDSO(n.groupBeingEdited)))||null==r.payload?null:r.payload.name,null==(r=P["\u0275\u0275pipeBind1"](3,7,n.getLinkedDSO(n.groupBeingEdited)))||null==r.payload?null:r.payload.type,P["\u0275\u0275pipeBind1"](4,9,n.getLinkedEditRolesRoute(n.groupBeingEdited)))))}}function nt(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"div",16),P["\u0275\u0275text"](1,"\n          "),P["\u0275\u0275elementStart"](2,"button",17),P["\u0275\u0275listener"]("click",(function(){return P["\u0275\u0275restoreView"](n),P["\u0275\u0275nextContext"]().delete()})),P["\u0275\u0275pipe"](3,"async"),P["\u0275\u0275text"](4,"\n            "),P["\u0275\u0275element"](5,"i",18),P["\u0275\u0275text"](6),P["\u0275\u0275pipe"](7,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](8,"\n        "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](2),P["\u0275\u0275property"]("disabled",!P["\u0275\u0275pipeBind1"](3,2,r.canEdit$)||r.groupBeingEdited.permanent),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](7,4,r.messagePrefix+".actions.delete"),"\n          ")}}function rt(e,t){if(1&e&&P["\u0275\u0275element"](0,"ds-members-list",19),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275property"]("messagePrefix",n.messagePrefix+".members-list")}}function it(e,t){if(1&e&&P["\u0275\u0275element"](0,"ds-subgroups-list",19),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275property"]("messagePrefix",n.messagePrefix+".subgroups-list")}}var at,ot=((at=function(){function e(t,n,r,i,o,s,c,l,p,u,d){a(this,e),this.groupDataService=t,this.ePersonDataService=n,this.dSpaceObjectDataService=r,this.formBuilderService=i,this.translateService=o,this.notificationsService=s,this.route=c,this.router=l,this.authorizationService=p,this.modalService=u,this.requestService=d,this.messagePrefix="admin.access-control.groups.form",this.formId="group-form",this.formLayout={groupName:{grid:{host:"row"}},groupDescription:{grid:{host:"row"}}},this.submitForm=new P.EventEmitter,this.cancelForm=new P.EventEmitter,this.subs=[],this.AlertTypeEnum=xe.a}return s(e,[{key:"ngOnInit",value:function(){this.initialisePage()}},{key:"initialisePage",value:function(){var e=this;this.subs.push(this.route.params.subscribe((function(t){"newGroup"!==t.groupId&&e.setActiveGroup(t.groupId)}))),this.canEdit$=this.groupDataService.getActiveGroup().pipe(Object(v.c)(),Object(m.a)((function(t){return Object(d.a)(e.authorizationService.isAuthorized(S.a.CanDelete,Object(v.e)(t)?t.self:void 0),e.hasLinkedDSO(t),(function(e,t){return e&&!t}))}))),Object(d.a)(this.translateService.get("".concat(this.messagePrefix,".groupName")),this.translateService.get("".concat(this.messagePrefix,".groupDescription"))).subscribe((function(t){var r=n(t,2),i=r[0],a=r[1];e.groupName=new F.I({id:"groupName",label:i,name:"groupName",validators:{required:null},required:!0}),e.groupDescription=new F.O({id:"groupDescription",label:a,name:"groupDescription",required:!1}),e.formModel=[e.groupName,e.groupDescription],e.formGroup=e.formBuilderService.createFormGroup(e.formModel),e.subs.push(Object(d.a)(e.groupDataService.getActiveGroup(),e.canEdit$).subscribe((function(t){var r=n(t,2),i=r[0],a=r[1];null!=i&&(e.groupBeingEdited=i,e.formGroup.patchValue({groupName:null!=i?i.name:"",groupDescription:null!=i?i.firstMetadataValue("dc.description"):""}),a&&!i.permanent||e.formGroup.disable())})))}))}},{key:"onCancel",value:function(){this.groupDataService.cancelEditGroup(),this.cancelForm.emit(),this.router.navigate([this.groupDataService.getGroupRegistryRouterLink()])}},{key:"onSubmit",value:function(){var e=this;this.groupDataService.getActiveGroup().pipe(Object(g.a)(1)).subscribe((function(t){null===t?e.createNewGroup({name:e.groupName.value,metadata:{"dc.description":[{value:e.groupDescription.value}]}}):e.editGroup(t)}))}},{key:"createNewGroup",value:function(e){var t=this,n=Object.assign(new ge.a,e);this.groupDataService.create(n).pipe(Object(y.g)()).subscribe((function(e){e.hasSucceeded?(t.notificationsService.success(t.translateService.get(t.messagePrefix+".notification.created.success",{name:n.name})),t.submitForm.emit(n),Object(v.e)(e.payload)&&(t.setActiveGroupWithLink(e.payload._links.self.href),t.groupDataService.clearGroupsRequests(),t.router.navigateByUrl(t.groupDataService.getGroupEditPageRouterLinkWithID(e.payload.uuid)))):(t.notificationsService.error(t.translateService.get(t.messagePrefix+".notification.created.failure",{name:n.name})),t.showNotificationIfNameInUse(n,"created"),t.cancelForm.emit())}))}},{key:"showNotificationIfNameInUse",value:function(e,t){var n=this;this.subs.push(this.groupDataService.searchGroups(e.name,{currentPage:1,elementsPerPage:0}).pipe(Object(y.i)(),Object(y.o)()).subscribe((function(r){r.totalElements>0&&n.notificationsService.error(n.translateService.get(n.messagePrefix+".notification."+t+".failure.groupNameInUse",{name:e.name}))})))}},{key:"editGroup",value:function(e){var n=this,r=[];Object(v.b)(this.groupDescription.value)&&(r=[].concat(t(r),[{op:"replace",path:"/metadata/dc.description/0/value",value:this.groupDescription.value}])),Object(v.b)(this.groupName.value)&&(r=[].concat(t(r),[{op:"replace",path:"/name",value:this.groupName.value}])),this.groupDataService.patch(e,r).pipe(Object(y.g)()).subscribe((function(t){t.hasSucceeded?(n.notificationsService.success(n.translateService.get(n.messagePrefix+".notification.edited.success",{name:t.payload.name})),n.submitForm.emit(t.payload)):(n.notificationsService.error(n.translateService.get(n.messagePrefix+".notification.edited.failure",{name:e.name})),n.cancelForm.emit())}))}},{key:"setActiveGroup",value:function(e){var t=this;this.groupDataService.cancelEditGroup(),this.groupDataService.findById(e).pipe(Object(y.i)(),Object(y.o)()).subscribe((function(e){t.groupDataService.editGroup(e)}))}},{key:"setActiveGroupWithLink",value:function(e){var t=this;this.groupDataService.getActiveGroup().pipe(Object(g.a)(1)).subscribe((function(n){null===n&&(t.groupDataService.cancelEditGroup(),t.groupDataService.findByHref(e,!1,!1,Object(he.a)("subgroups"),Object(he.a)("epersons"),Object(he.a)("object")).pipe(Object(y.i)(),Object(y.o)()).subscribe((function(e){t.groupDataService.editGroup(e)})))}))}},{key:"delete",value:function(){var e=this;this.groupDataService.getActiveGroup().pipe(Object(g.a)(1)).subscribe((function(t){var n=e.modalService.open(I.a);n.componentInstance.dso=t,n.componentInstance.headerLabel=e.messagePrefix+".delete-group.modal.header",n.componentInstance.infoLabel=e.messagePrefix+".delete-group.modal.info",n.componentInstance.cancelLabel=e.messagePrefix+".delete-group.modal.cancel",n.componentInstance.confirmLabel=e.messagePrefix+".delete-group.modal.confirm",n.componentInstance.brandColor="danger",n.componentInstance.confirmIcon="fas fa-trash",n.componentInstance.response.pipe(Object(g.a)(1)).subscribe((function(n){n&&Object(v.b)(t.id)&&e.groupDataService.delete(t.id).pipe(Object(y.g)()).subscribe((function(n){n.hasSucceeded?(e.notificationsService.success(e.translateService.get(e.messagePrefix+".notification.deleted.success",{name:t.name})),e.reset()):e.notificationsService.error(e.translateService.get(e.messagePrefix+".notification.deleted.failure.title",{name:t.name}),e.translateService.get(e.messagePrefix+".notification.deleted.failure.content",{cause:n.errorMessage}))}))}))}))}},{key:"reset",value:function(){var e=this;this.groupDataService.getBrowseEndpoint().pipe(Object(g.a)(1)).subscribe((function(t){e.requestService.removeByHrefSubstring(t)})),this.onCancel()}},{key:"ngOnDestroy",value:function(){this.groupDataService.cancelEditGroup(),this.subs.filter((function(e){return Object(v.b)(e)})).forEach((function(e){return e.unsubscribe()}))}},{key:"hasLinkedDSO",value:function(e){if(Object(v.b)(e)&&Object(v.b)(e._links.object.href))return this.getLinkedDSO(e).pipe(Object(f.a)((function(e){return!(!Object(v.b)(e)||!Object(v.b)(e.payload))})),Object(de.a)((function(){return Object(A.a)(!1)})))}},{key:"getLinkedDSO",value:function(e){if(Object(v.b)(e)&&Object(v.b)(e._links.object.href))return void 0===e.object?this.dSpaceObjectDataService.findByHref(e._links.object.href):e.object}},{key:"getLinkedEditRolesRoute",value:function(e){if(Object(v.b)(e)&&Object(v.b)(e._links.object.href))return this.getLinkedDSO(e).pipe(Object(f.a)((function(e){if(Object(v.b)(e)&&Object(v.b)(e.payload))switch(e.payload.type){case ve.a.type.value:return Object(fe.f)(e.payload.id);case be.a.type.value:return Object(me.g)(e.payload.id)}})))}}]),e}()).\u0275fac=function(e){return new(e||at)(P["\u0275\u0275directiveInject"]($.a),P["\u0275\u0275directiveInject"](O.a),P["\u0275\u0275directiveInject"](Se.a),P["\u0275\u0275directiveInject"](N.a),P["\u0275\u0275directiveInject"](j.f),P["\u0275\u0275directiveInject"](k.a),P["\u0275\u0275directiveInject"](l.a),P["\u0275\u0275directiveInject"](l.g),P["\u0275\u0275directiveInject"](B.a),P["\u0275\u0275directiveInject"](C.u),P["\u0275\u0275directiveInject"](D.a))},at.\u0275cmp=P["\u0275\u0275defineComponent"]({type:at,selectors:[["ds-group-form"]],hostBindings:function(e,t){1&e&&P["\u0275\u0275listener"]("beforeunload",(function(){return t.ngOnDestroy()}),!1,P["\u0275\u0275resolveWindow"])},outputs:{submitForm:"submitForm",cancelForm:"cancelForm"},decls:44,vars:22,consts:[[1,"container"],[1,"group-form","row"],[1,"col-12"],[4,"ngIf","ngIfThen","ngIfElse"],["createHeader",""],["editheader",""],[3,"type","content",4,"ngIf"],[3,"formId","formModel","formGroup","formLayout","displayCancel","submitForm"],["before","",1,"btn-group"],[1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["after","","class","btn-group",4,"ngIf"],[1,"mb-5"],[3,"messagePrefix",4,"ngIf"],[1,"border-bottom","pb-2"],[3,"type","content"],["after","",1,"btn-group"],[1,"btn","btn-danger","delete-button",3,"disabled","click"],[1,"fa","fa-trash"],[3,"messagePrefix"]],template:function(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"div",0),P["\u0275\u0275text"](1,"\n  "),P["\u0275\u0275elementStart"](2,"div",1),P["\u0275\u0275text"](3,"\n    "),P["\u0275\u0275elementStart"](4,"div",2),P["\u0275\u0275text"](5,"\n\n      "),P["\u0275\u0275template"](6,Je,1,0,"div",3),P["\u0275\u0275pipe"](7,"async"),P["\u0275\u0275text"](8,"\n\n      "),P["\u0275\u0275template"](9,Ke,5,3,"ng-template",null,4,P["\u0275\u0275templateRefExtractor"]),P["\u0275\u0275text"](11,"\n\n      "),P["\u0275\u0275template"](12,Ze,5,3,"ng-template",null,5,P["\u0275\u0275templateRefExtractor"]),P["\u0275\u0275text"](14,"\n\n      "),P["\u0275\u0275template"](15,Xe,1,2,"ds-alert",6),P["\u0275\u0275text"](16,"\n      "),P["\u0275\u0275template"](17,tt,6,15,"ds-alert",6),P["\u0275\u0275pipe"](18,"async"),P["\u0275\u0275pipe"](19,"async"),P["\u0275\u0275text"](20,"\n\n      "),P["\u0275\u0275elementStart"](21,"ds-form",7),P["\u0275\u0275listener"]("submitForm",(function(){return t.onSubmit()})),P["\u0275\u0275text"](22,"\n        "),P["\u0275\u0275elementStart"](23,"div",8),P["\u0275\u0275text"](24,"\n          "),P["\u0275\u0275elementStart"](25,"button",9),P["\u0275\u0275listener"]("click",(function(){return t.onCancel()})),P["\u0275\u0275element"](26,"i",10),P["\u0275\u0275text"](27),P["\u0275\u0275pipe"](28,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](29,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](30,"\n        "),P["\u0275\u0275template"](31,nt,9,6,"div",11),P["\u0275\u0275text"](32,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](33,"\n\n      "),P["\u0275\u0275elementStart"](34,"div",12),P["\u0275\u0275text"](35,"\n        "),P["\u0275\u0275template"](36,rt,1,1,"ds-members-list",13),P["\u0275\u0275text"](37,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](38,"\n      "),P["\u0275\u0275template"](39,it,1,1,"ds-subgroups-list",13),P["\u0275\u0275text"](40,"\n\n\n\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](41,"\n  "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](42,"\n"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](43,"\n")),2&e){var n=P["\u0275\u0275reference"](10),r=P["\u0275\u0275reference"](13);P["\u0275\u0275advance"](6),P["\u0275\u0275property"]("ngIf",P["\u0275\u0275pipeBind1"](7,14,t.groupDataService.getActiveGroup()))("ngIfThen",r)("ngIfElse",n),P["\u0275\u0275advance"](9),P["\u0275\u0275property"]("ngIf",null==t.groupBeingEdited?null:t.groupBeingEdited.permanent),P["\u0275\u0275advance"](2),P["\u0275\u0275property"]("ngIf",!P["\u0275\u0275pipeBind1"](18,16,t.canEdit$)&&P["\u0275\u0275pipeBind1"](19,18,t.groupDataService.getActiveGroup())),P["\u0275\u0275advance"](4),P["\u0275\u0275property"]("formId",t.formId)("formModel",t.formModel)("formGroup",t.formGroup)("formLayout",t.formLayout)("displayCancel",!1),P["\u0275\u0275advance"](6),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](28,20,t.messagePrefix+".return"),""),P["\u0275\u0275advance"](4),P["\u0275\u0275property"]("ngIf",null!=t.groupBeingEdited),P["\u0275\u0275advance"](5),P["\u0275\u0275property"]("ngIf",null!=t.groupBeingEdited),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",null!=t.groupBeingEdited)}},directives:[c.u,R.a,w.NgControlStatusGroup,w.FormGroupDirective,ye.a,Le,Ye],pipes:[c.b,j.e],encapsulation:2}),at),st=function e(){a(this,e)},ct=o("ppE2");function lt(e,t){1&e&&P["\u0275\u0275element"](0,"ds-loading")}var pt=function(e){return{name:e}};function ut(e,t){if(1&e){var n=P["\u0275\u0275getCurrentView"]();P["\u0275\u0275elementStart"](0,"button",29),P["\u0275\u0275listener"]("click",(function(){P["\u0275\u0275restoreView"](n);var e=P["\u0275\u0275nextContext"]().$implicit;return P["\u0275\u0275nextContext"](2).deleteGroup(e)})),P["\u0275\u0275pipe"](1,"translate"),P["\u0275\u0275text"](2,"\n                    "),P["\u0275\u0275element"](3,"i",30),P["\u0275\u0275text"](4,"\n                  "),P["\u0275\u0275elementEnd"]()}if(2&e){var r=P["\u0275\u0275nextContext"]().$implicit,i=P["\u0275\u0275nextContext"](2);P["\u0275\u0275propertyInterpolate"]("title",P["\u0275\u0275pipeBind2"](1,1,i.messagePrefix+"table.edit.buttons.remove",P["\u0275\u0275pureFunction1"](4,pt,r.group.name)))}}function dt(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"tr"),P["\u0275\u0275text"](1,"\n              "),P["\u0275\u0275elementStart"](2,"td"),P["\u0275\u0275text"](3),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](4,"\n              "),P["\u0275\u0275elementStart"](5,"td"),P["\u0275\u0275text"](6),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](7,"\n              "),P["\u0275\u0275elementStart"](8,"td"),P["\u0275\u0275text"](9),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](10,"\n              "),P["\u0275\u0275elementStart"](11,"td"),P["\u0275\u0275text"](12,"\n                "),P["\u0275\u0275elementStart"](13,"div",25),P["\u0275\u0275text"](14,"\n                  "),P["\u0275\u0275elementStart"](15,"button",26),P["\u0275\u0275pipe"](16,"translate"),P["\u0275\u0275text"](17,"\n                    "),P["\u0275\u0275element"](18,"i",27),P["\u0275\u0275text"](19,"\n                  "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](20,"\n                  "),P["\u0275\u0275template"](21,ut,5,6,"button",28),P["\u0275\u0275text"](22,"\n                "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](23,"\n              "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](24,"\n            "),P["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,r=P["\u0275\u0275nextContext"](2);P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](n.group.id),P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"](n.group.name),P["\u0275\u0275advance"](3),P["\u0275\u0275textInterpolate"]((null==n.epersons?null:n.epersons.totalElements)+(null==n.subgroups?null:n.subgroups.totalElements)),P["\u0275\u0275advance"](6),P["\u0275\u0275propertyInterpolate"]("title",P["\u0275\u0275pipeBind2"](16,6,r.messagePrefix+"table.edit.buttons.edit",P["\u0275\u0275pureFunction1"](9,pt,n.group.name))),P["\u0275\u0275property"]("routerLink",r.groupService.getGroupEditPageRouterLink(n.group)),P["\u0275\u0275advance"](6),P["\u0275\u0275property"]("ngIf",!(null!=n.group&&n.group.permanent)&&n.ableToDelete)}}function mt(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"ds-pagination",20),P["\u0275\u0275pipe"](1,"async"),P["\u0275\u0275text"](2,"\n\n        "),P["\u0275\u0275elementStart"](3,"div",21),P["\u0275\u0275text"](4,"\n          "),P["\u0275\u0275elementStart"](5,"table",22),P["\u0275\u0275text"](6,"\n            "),P["\u0275\u0275elementStart"](7,"thead"),P["\u0275\u0275text"](8,"\n            "),P["\u0275\u0275elementStart"](9,"tr"),P["\u0275\u0275text"](10,"\n              "),P["\u0275\u0275elementStart"](11,"th",23),P["\u0275\u0275text"](12),P["\u0275\u0275pipe"](13,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](14,"\n              "),P["\u0275\u0275elementStart"](15,"th",23),P["\u0275\u0275text"](16),P["\u0275\u0275pipe"](17,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](18,"\n              "),P["\u0275\u0275elementStart"](19,"th",23),P["\u0275\u0275text"](20),P["\u0275\u0275pipe"](21,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](22,"\n              "),P["\u0275\u0275elementStart"](23,"th"),P["\u0275\u0275text"](24),P["\u0275\u0275pipe"](25,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](26,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](27,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](28,"\n            "),P["\u0275\u0275elementStart"](29,"tbody"),P["\u0275\u0275text"](30,"\n            "),P["\u0275\u0275template"](31,dt,25,11,"tr",24),P["\u0275\u0275pipe"](32,"async"),P["\u0275\u0275text"](33,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](34,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](35,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](36,"\n      "),P["\u0275\u0275elementEnd"]()),2&e){var n,r,i=P["\u0275\u0275nextContext"]();P["\u0275\u0275property"]("paginationOptions",i.config)("pageInfoState",i.pageInfoState$)("collectionSize",null==(n=P["\u0275\u0275pipeBind1"](1,10,i.pageInfoState$))?null:n.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),P["\u0275\u0275advance"](12),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](13,12,i.messagePrefix+"table.id")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](17,14,i.messagePrefix+"table.name")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](21,16,i.messagePrefix+"table.members")),P["\u0275\u0275advance"](4),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](25,18,i.messagePrefix+"table.edit")),P["\u0275\u0275advance"](7),P["\u0275\u0275property"]("ngForOf",null==(r=P["\u0275\u0275pipeBind1"](32,20,i.groupsDto$))?null:r.page)}}function ft(e,t){if(1&e&&(P["\u0275\u0275elementStart"](0,"div",31),P["\u0275\u0275text"](1),P["\u0275\u0275pipe"](2,"translate"),P["\u0275\u0275elementEnd"]()),2&e){var n=P["\u0275\u0275nextContext"]();P["\u0275\u0275advance"](1),P["\u0275\u0275textInterpolate1"]("\n        ",P["\u0275\u0275pipeBind1"](2,1,n.messagePrefix+"no-items"),"\n      ")}}var gt,bt,vt,xt=function(){return["newGroup"]},ht=((gt=function(){function e(t,n,r,i,o,s,c,l,p,d,m){a(this,e),this.groupService=t,this.ePersonDataService=n,this.dSpaceObjectDataService=r,this.translateService=i,this.notificationsService=o,this.formBuilder=s,this.routeService=c,this.router=l,this.authorizationService=p,this.paginationService=d,this.requestService=m,this.messagePrefix="admin.access-control.groups.",this.config=Object.assign(new x.a,{id:"gl",pageSize:5,currentPage:1}),this.groupsDto$=new u.a({}),this.deletedGroupsIds=[],this.pageInfoState$=new u.a(void 0),this.searching$=new u.a(!1),this.subs=[],this.currentSearchQuery="",this.searchForm=this.formBuilder.group({query:this.currentSearchQuery})}return s(e,[{key:"ngOnInit",value:function(){this.search({query:this.currentSearchQuery})}},{key:"search",value:function(e){var t=this;this.searching$.next(!0),Object(v.b)(this.searchSub)&&(this.searchSub.unsubscribe(),this.subs=this.subs.filter((function(e){return e!==t.searchSub}))),this.searchSub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe(Object(m.a)((function(n){var r=e.query;return null!=r&&t.currentSearchQuery!==r&&(t.currentSearchQuery=r,t.paginationService.updateRouteWithUrl(t.config.id,[],{page:1})),t.groupService.searchGroups(t.currentSearchQuery.trim(),{currentPage:n.currentPage,elementsPerPage:n.pageSize})})),Object(y.c)(),Object(y.o)(),Object(m.a)((function(e){return 0===e.page.length?Object(A.a)(Object(b.b)(e.pageInfo,[])):Object(d.a)(e.page.map((function(e){if(!t.deletedGroupsIds.includes(e.id))return Object(d.a)([t.authorizationService.isAuthorized(S.a.CanDelete,Object(v.b)(e)?e.self:void 0),t.hasLinkedDSO(e),t.getSubgroups(e),t.getMembers(e)]).pipe(Object(f.a)((function(t){var r=n(t,4),i=r[0],a=r[1],o=r[2],s=r[3],c=new st;return c.ableToDelete=i&&!a,c.group=e,c.subgroups=o.payload,c.epersons=s.payload,c})))}))).pipe(Object(f.a)((function(t){return Object(b.b)(e.pageInfo,t)})))}))).subscribe((function(e){t.groupsDto$.next(e),t.pageInfoState$.next(e.pageInfo),t.searching$.next(!1)})),this.subs.push(this.searchSub)}},{key:"deleteGroup",value:function(e){var n=this;Object(v.b)(e.group.id)&&this.groupService.delete(e.group.id).pipe(Object(y.g)()).subscribe((function(r){r.hasSucceeded?(n.deletedGroupsIds=[].concat(t(n.deletedGroupsIds),[e.group.id]),n.notificationsService.success(n.translateService.get(n.messagePrefix+"notification.deleted.success",{name:e.group.name})),n.reset()):n.notificationsService.error(n.translateService.get(n.messagePrefix+"notification.deleted.failure.title",{name:e.group.name}),n.translateService.get(n.messagePrefix+"notification.deleted.failure.content",{cause:r.errorMessage}))}))}},{key:"reset",value:function(){var e=this;this.groupService.getBrowseEndpoint().pipe(Object(g.a)(1)).subscribe((function(t){e.requestService.setStaleByHrefSubstring(t)}))}},{key:"getMembers",value:function(e){return this.ePersonDataService.findAllByHref(e._links.epersons.href).pipe(Object(y.i)())}},{key:"getSubgroups",value:function(e){return this.groupService.findAllByHref(e._links.subgroups.href).pipe(Object(y.i)())}},{key:"hasLinkedDSO",value:function(e){return this.dSpaceObjectDataService.findByHref(e._links.object.href).pipe(Object(y.i)(),Object(f.a)((function(e){return Object(v.b)(e)&&Object(v.b)(e.payload)})),Object(de.a)((function(){return Object(A.a)(!1)})))}},{key:"clearFormAndResetResult",value:function(){this.searchForm.patchValue({query:""}),this.search({query:""})}},{key:"ngOnDestroy",value:function(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.config.id)}},{key:"cleanupSubscribes",value:function(){Object(v.b)(this.paginationSub)&&this.paginationSub.unsubscribe(),this.subs.filter((function(e){return Object(v.b)(e)})).forEach((function(e){return e.unsubscribe()})),this.paginationService.clearPagination(this.config.id)}}]),e}()).\u0275fac=function(e){return new(e||gt)(P["\u0275\u0275directiveInject"]($.a),P["\u0275\u0275directiveInject"](O.a),P["\u0275\u0275directiveInject"](Se.a),P["\u0275\u0275directiveInject"](j.f),P["\u0275\u0275directiveInject"](k.a),P["\u0275\u0275directiveInject"](w.FormBuilder),P["\u0275\u0275directiveInject"](ct.a),P["\u0275\u0275directiveInject"](l.g),P["\u0275\u0275directiveInject"](B.a),P["\u0275\u0275directiveInject"](G.a),P["\u0275\u0275directiveInject"](D.a))},gt.\u0275cmp=P["\u0275\u0275defineComponent"]({type:gt,selectors:[["ds-groups-registry"]],decls:71,vars:35,consts:[[1,"container"],[1,"groups-registry","row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom","mb-3"],["id","header",1,"pb-2"],[1,"mr-auto","btn","btn-success",3,"routerLink"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"formGroup","ngSubmit"],[1,"flex-grow-1","mr-3"],[1,"form-group","input-group"],["type","text","name","query","id","query","formControlName","query",1,"form-control",3,"placeholder"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary",3,"click"],[4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage",4,"ngIf"],["class","alert alert-info w-100 mb-2","role","alert",4,"ngIf"],[3,"paginationOptions","pageInfoState","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","groups",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[4,"ngFor","ngForOf"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],["class","btn btn-outline-danger btn-sm",3,"title","click",4,"ngIf"],[1,"btn","btn-outline-danger","btn-sm",3,"title","click"],[1,"fas","fa-trash-alt","fa-fw"],["role","alert",1,"alert","alert-info","w-100","mb-2"]],template:function(e,t){var n,r;1&e&&(P["\u0275\u0275elementStart"](0,"div",0),P["\u0275\u0275text"](1,"\n  "),P["\u0275\u0275elementStart"](2,"div",1),P["\u0275\u0275text"](3,"\n    "),P["\u0275\u0275elementStart"](4,"div",2),P["\u0275\u0275text"](5,"\n      "),P["\u0275\u0275elementStart"](6,"div",3),P["\u0275\u0275text"](7,"\n        "),P["\u0275\u0275elementStart"](8,"h2",4),P["\u0275\u0275text"](9),P["\u0275\u0275pipe"](10,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](11,"\n        "),P["\u0275\u0275elementStart"](12,"div"),P["\u0275\u0275text"](13,"\n          "),P["\u0275\u0275elementStart"](14,"button",5),P["\u0275\u0275text"](15,"\n            "),P["\u0275\u0275element"](16,"i",6),P["\u0275\u0275text"](17,"\n            "),P["\u0275\u0275elementStart"](18,"span",7),P["\u0275\u0275text"](19),P["\u0275\u0275pipe"](20,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](21,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](22,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](23,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](24,"\n\n      "),P["\u0275\u0275elementStart"](25,"h3",8),P["\u0275\u0275text"](26),P["\u0275\u0275pipe"](27,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](28,"\n      "),P["\u0275\u0275elementStart"](29,"form",9),P["\u0275\u0275listener"]("ngSubmit",(function(){return t.search(t.searchForm.value)})),P["\u0275\u0275text"](30,"\n        "),P["\u0275\u0275elementStart"](31,"div",10),P["\u0275\u0275text"](32,"\n          "),P["\u0275\u0275elementStart"](33,"div",11),P["\u0275\u0275text"](34,"\n            "),P["\u0275\u0275element"](35,"input",12),P["\u0275\u0275pipe"](36,"translate"),P["\u0275\u0275pipe"](37,"translate"),P["\u0275\u0275text"](38,"\n            "),P["\u0275\u0275elementStart"](39,"span",13),P["\u0275\u0275text"](40,"\n              "),P["\u0275\u0275elementStart"](41,"button",14),P["\u0275\u0275text"](42,"\n                "),P["\u0275\u0275element"](43,"i",15),P["\u0275\u0275text"](44),P["\u0275\u0275pipe"](45,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](46,"\n            "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](47,"\n          "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](48,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](49,"\n        "),P["\u0275\u0275elementStart"](50,"div"),P["\u0275\u0275text"](51,"\n          "),P["\u0275\u0275elementStart"](52,"button",16),P["\u0275\u0275listener"]("click",(function(){return t.clearFormAndResetResult()})),P["\u0275\u0275text"](53),P["\u0275\u0275pipe"](54,"translate"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](55,"\n        "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](56,"\n      "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](57,"\n\n      "),P["\u0275\u0275template"](58,lt,1,0,"ds-loading",17),P["\u0275\u0275pipe"](59,"async"),P["\u0275\u0275text"](60,"\n      "),P["\u0275\u0275template"](61,mt,37,22,"ds-pagination",18),P["\u0275\u0275pipe"](62,"async"),P["\u0275\u0275pipe"](63,"async"),P["\u0275\u0275text"](64,"\n\n      "),P["\u0275\u0275template"](65,ft,3,3,"div",19),P["\u0275\u0275pipe"](66,"async"),P["\u0275\u0275text"](67,"\n\n    "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](68,"\n  "),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](69,"\n"),P["\u0275\u0275elementEnd"](),P["\u0275\u0275text"](70,"\n")),2&e&&(P["\u0275\u0275advance"](9),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](10,12,t.messagePrefix+"head")),P["\u0275\u0275advance"](5),P["\u0275\u0275property"]("routerLink",P["\u0275\u0275pureFunction0"](34,xt)),P["\u0275\u0275advance"](5),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](20,14,t.messagePrefix+"button.add")),P["\u0275\u0275advance"](7),P["\u0275\u0275textInterpolate"](P["\u0275\u0275pipeBind1"](27,16,t.messagePrefix+"search.head")),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("formGroup",t.searchForm),P["\u0275\u0275advance"](6),P["\u0275\u0275property"]("placeholder",P["\u0275\u0275pipeBind1"](37,20,t.messagePrefix+"search.placeholder")),P["\u0275\u0275attribute"]("aria-label",P["\u0275\u0275pipeBind1"](36,18,t.messagePrefix+"search.placeholder")),P["\u0275\u0275advance"](9),P["\u0275\u0275textInterpolate1"](" ",P["\u0275\u0275pipeBind1"](45,22,t.messagePrefix+"search.button"),"\n              "),P["\u0275\u0275advance"](9),P["\u0275\u0275textInterpolate1"]("\n            ",P["\u0275\u0275pipeBind1"](54,24,t.messagePrefix+"button.see-all"),"\n          "),P["\u0275\u0275advance"](5),P["\u0275\u0275property"]("ngIf",P["\u0275\u0275pipeBind1"](59,26,t.searching$)),P["\u0275\u0275advance"](3),P["\u0275\u0275property"]("ngIf",(null==(n=P["\u0275\u0275pipeBind1"](62,28,t.pageInfoState$))?null:n.totalElements)>0&&!P["\u0275\u0275pipeBind1"](63,30,t.searching$)),P["\u0275\u0275advance"](4),P["\u0275\u0275property"]("ngIf",0==(null==(r=P["\u0275\u0275pipeBind1"](66,32,t.pageInfoState$))?null:r.totalElements)))},directives:[l.h,w["\u0275angular_packages_forms_forms_y"],w.NgControlStatusGroup,w.FormGroupDirective,w.DefaultValueAccessor,w.NgControlStatus,w.FormControlName,c.u,ee.a,M.a,c.t],pipes:[j.e,c.b],encapsulation:2}),gt),St=o("mOAm"),yt=o("A0IO"),It=((vt=function e(){a(this,e)}).\u0275mod=P["\u0275\u0275defineNgModule"]({type:vt}),vt.\u0275inj=P["\u0275\u0275defineInjector"]({factory:function(e){return new(e||vt)},imports:[[l.k.forChild([{path:"epeople",component:ue,resolve:{breadcrumb:yt.a},data:{title:"admin.access-control.epeople.title",breadcrumbKey:"admin.access-control.epeople"}},{path:St.a,component:ht,resolve:{breadcrumb:yt.a},data:{title:"admin.access-control.groups.title",breadcrumbKey:"admin.access-control.groups"}},{path:"".concat(St.a,"/newGroup"),component:ot,resolve:{breadcrumb:yt.a},data:{title:"admin.access-control.groups.title.addGroup",breadcrumbKey:"admin.access-control.groups.addGroup"}},{path:"".concat(St.a,"/:groupId"),component:ot,resolve:{breadcrumb:yt.a},data:{title:"admin.access-control.groups.title.singleGroup",breadcrumbKey:"admin.access-control.groups.singleGroup"}}])]]}),vt),Et=((bt=function e(){a(this,e)}).\u0275mod=P["\u0275\u0275defineNgModule"]({type:bt}),bt.\u0275inj=P["\u0275\u0275defineInjector"]({factory:function(e){return new(e||bt)},imports:[[c.c,p.a,l.k,It]]}),bt)},tv3Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("zr/d"),i=n("LRne"),o=n("8Y7J"),c=function(){var e=function(){function e(){a(this,e)}return s(e,[{key:"getBreadcrumbs",value:function(e,t){return Object(i.a)([new r.a(e+".breadcrumbs",t)])}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},"zr/d":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function e(t,n){a(this,e),this.text=t,this.url=n}}}])}();
//# sourceMappingURL=6-es5.11aed0cced3547443d7f.js.map