(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{wAxY:function(e,t,n){"use strict";n.r(t),n.d(t,"EditCollectionPageModule",(function(){return Xe}));var i=n("SVse"),a=n("PCNd"),o=n("iInd"),r=n("2Vo4"),c=n("itXk"),s=n("mEo1"),l=n("lJxs"),d=n("eIep"),p=n("JX91"),u=n("IzEk"),m=n("1QIV"),h=n("QhmN"),f=n("qc8P"),b=n("J3qs"),v=n("ztnu"),x=n("joI/"),S=n("g7AC"),g=n("84Zn"),y=n("8Y7J"),I=n("gWc+"),C=n("lI3o"),j=n("iqTE"),O=n("DNva"),E=n("TSSN"),w=n("C765"),T=n("G0yt"),B=n("Oupr"),R=n("DdXh");const k=["tabs"];function $(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275text"](0,"\n            "),y["\u0275\u0275elementStart"](1,"div",9),y["\u0275\u0275text"](2,"\n              "),y["\u0275\u0275elementStart"](3,"ds-item-select",10),y["\u0275\u0275listener"]("confirm",(function(t){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"]().mapItems(t,!0)}))("cancel",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"]().onCancel()})),y["\u0275\u0275pipe"](4,"async"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](5,"\n            "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](6,"\n          ")}if(2&e){const e=y["\u0275\u0275nextContext"]();var n;y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("key","browse")("dsoRD$",e.collectionItemsRD$)("paginationOptions",null==(n=y["\u0275\u0275pipeBind1"](4,7,e.searchOptions$))?null:n.pagination)("confirmButton","collection.edit.item-mapper.remove")("cancelButton","collection.edit.item-mapper.cancel")("dangerConfirm",!0)("hideCollection",!0)}}function D(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"div"),y["\u0275\u0275text"](1,"\n              "),y["\u0275\u0275elementStart"](2,"ds-item-select",16),y["\u0275\u0275listener"]("confirm",(function(t){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"](2).mapItems(t)}))("cancel",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"](2).onCancel()})),y["\u0275\u0275pipe"](3,"async"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](4,"\n            "),y["\u0275\u0275elementEnd"]()}if(2&e){const e=y["\u0275\u0275nextContext"](2);var n;y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("key","map")("dsoRD$",e.mappedItemsRD$)("paginationOptions",null==(n=y["\u0275\u0275pipeBind1"](3,5,e.searchOptions$))?null:n.pagination)("confirmButton","collection.edit.item-mapper.confirm")("cancelButton","collection.edit.item-mapper.cancel")}}function F(e,t){1&e&&(y["\u0275\u0275elementStart"](0,"div",17),y["\u0275\u0275text"](1),y["\u0275\u0275pipe"](2,"translate"),y["\u0275\u0275elementEnd"]()),2&e&&(y["\u0275\u0275advance"](1),y["\u0275\u0275textInterpolate1"]("\n              ",y["\u0275\u0275pipeBind1"](2,1,"collection.edit.item-mapper.no-search"),"\n            "))}function N(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275text"](0,"\n            "),y["\u0275\u0275elementStart"](1,"div",11),y["\u0275\u0275text"](2,"\n              "),y["\u0275\u0275elementStart"](3,"div",12),y["\u0275\u0275text"](4,"\n                "),y["\u0275\u0275elementStart"](5,"ds-search-form",13),y["\u0275\u0275listener"]("submitSearch",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"]().performedSearch=!0})),y["\u0275\u0275pipe"](6,"async"),y["\u0275\u0275pipe"](7,"async"),y["\u0275\u0275pipe"](8,"translate"),y["\u0275\u0275text"](9,"\n                "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](10,"\n              "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](11,"\n            "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](12,"\n\n            "),y["\u0275\u0275template"](13,D,5,7,"div",14),y["\u0275\u0275text"](14,"\n            "),y["\u0275\u0275template"](15,F,3,3,"div",15),y["\u0275\u0275text"](16,"\n          ")}if(2&e){const e=y["\u0275\u0275nextContext"]();var n,i;y["\u0275\u0275advance"](5),y["\u0275\u0275property"]("query",null==(n=y["\u0275\u0275pipeBind1"](6,7,e.searchOptions$))?null:n.query)("scope",null==(i=y["\u0275\u0275pipeBind1"](7,9,e.searchOptions$))?null:i.scope)("currentUrl","./")("inPlaceSearch",!0)("searchPlaceholder",y["\u0275\u0275pipeBind1"](8,11,"collection.edit.item-mapper.search-form.placeholder")),y["\u0275\u0275advance"](8),y["\u0275\u0275property"]("ngIf",e.performedSearch),y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("ngIf",!e.performedSearch)}}const M=function(e){return{name:e}};let V=(()=>{class e{constructor(e,t,n,i,a,o,r,c,s){this.route=e,this.router=t,this.searchConfigService=n,this.searchService=i,this.notificationsService=a,this.itemDataService=o,this.collectionDataService=r,this.translateService=c,this.dsoNameService=s,this.defaultSortOptions=new f.b("dc.title",f.a.ASC),this.performedSearch=!1}ngOnInit(){this.collectionRD$=this.route.parent.data.pipe(Object(l.a)(e=>e.dso),Object(m.i)()),this.collectionName$=this.collectionRD$.pipe(Object(l.a)(e=>this.dsoNameService.getName(e.payload))),this.searchOptions$=this.searchConfigService.paginatedSearchOptions,this.loadItemLists()}loadItemLists(){this.shouldUpdate$=new r.a(!0);const e=Object(c.a)(this.collectionRD$,this.searchOptions$,this.shouldUpdate$);this.collectionItemsRD$=e.pipe(Object(d.a)(([e,t,n])=>(!0===n&&this.shouldUpdate$.next(!1),this.itemDataService.findAllByHref(e.payload._links.mappedItems.href,Object.assign(t,{sort:this.defaultSortOptions}),!n,!1,Object(g.a)("owningCollection")).pipe(Object(m.c)())))),this.mappedItemsRD$=e.pipe(Object(d.a)(([e,t,n])=>this.searchService.search(Object.assign(new S.a(t),{query:this.buildQuery(e.payload.id,t.query),scope:void 0,dsoTypes:[h.a.ITEM],sort:this.defaultSortOptions}),1e4).pipe(Object(m.y)(),Object(p.a)(void 0))))}mapItems(e,t){const n=this.collectionRD$.pipe(Object(m.i)(),Object(l.a)(e=>e.payload),Object(d.a)(n=>Object(c.a)(e.map(e=>t?this.itemDataService.removeMappingFromCollection(e,n.id).pipe(Object(m.g)()):this.itemDataService.mapToCollection(e,n._links.self.href).pipe(Object(m.g)())))));this.showNotifications(n,t)}showNotifications(e,t){const n=t?"unmap":"map";e.subscribe(e=>{const t=e.filter(e=>e.hasSucceeded),i=e.filter(e=>e.hasFailed);t.length>0&&(Object(c.a)(this.translateService.get(`collection.edit.item-mapper.notifications.${n}.success.head`),this.translateService.get(`collection.edit.item-mapper.notifications.${n}.success.content`,{amount:t.length})).subscribe(([e,t])=>{this.notificationsService.success(e,t)}),this.shouldUpdate$.next(!0)),i.length>0&&Object(c.a)(this.translateService.get(`collection.edit.item-mapper.notifications.${n}.error.head`),this.translateService.get(`collection.edit.item-mapper.notifications.${n}.error.content`,{amount:i.length})).subscribe(([e,t])=>{this.notificationsService.error(e,t)}),this.switchToFirstTab()})}tabChange(e){this.performedSearch=!1,this.router.navigateByUrl(this.getCurrentUrl())}getCurrentUrl(){return this.router.url.indexOf("?")>-1?this.router.url.substring(0,this.router.url.indexOf("?")):this.router.url}buildQuery(e,t){const n=`-location.coll:"${e}"`;return Object(b.e)(t)?`${n} AND ${t}`:n}switchToFirstTab(){this.tabs.select("browseTab")}onCancel(){this.collectionRD$.pipe(Object(m.i)(),Object(m.o)(),Object(u.a)(1)).subscribe(e=>{this.router.navigate(["/collections/",e.id])})}}return e.\u0275fac=function(t){return new(t||e)(y["\u0275\u0275directiveInject"](o.a),y["\u0275\u0275directiveInject"](o.g),y["\u0275\u0275directiveInject"](v.SEARCH_CONFIG_SERVICE),y["\u0275\u0275directiveInject"](I.a),y["\u0275\u0275directiveInject"](C.a),y["\u0275\u0275directiveInject"](j.a),y["\u0275\u0275directiveInject"](O.a),y["\u0275\u0275directiveInject"](E.f),y["\u0275\u0275directiveInject"](w.a))},e.\u0275cmp=y["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-collection-item-mapper"]],viewQuery:function(e,t){var n;1&e&&y["\u0275\u0275viewQuery"](k,!0),2&e&&y["\u0275\u0275queryRefresh"](n=y["\u0275\u0275loadQuery"]())&&(t.tabs=n.first)},features:[y["\u0275\u0275ProvidersFeature"]([{provide:v.SEARCH_CONFIG_SERVICE,useClass:x.a}])],decls:37,vars:21,consts:[[1,"container"],[1,"row"],[1,"col-12"],["id","collection-name",3,"innerHTML"],[3,"destroyOnHide","tabChange"],["tabs","ngbTabset"],["id","browseTab",3,"title"],["ngbTabContent",""],["id","mapTab",3,"title"],[1,"mt-2"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","confirmButton","cancelButton","dangerConfirm","hideCollection","confirm","cancel"],[1,"row","mt-2"],[1,"col-12","col-lg-6"],["id","search-form",3,"query","scope","currentUrl","inPlaceSearch","searchPlaceholder","submitSearch"],[4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","confirmButton","cancelButton","confirm","cancel"],["role","alert",1,"alert","alert-info","w-100"]],template:function(e,t){1&e&&(y["\u0275\u0275elementStart"](0,"div",0),y["\u0275\u0275text"](1,"\n  "),y["\u0275\u0275elementStart"](2,"div",1),y["\u0275\u0275text"](3,"\n    "),y["\u0275\u0275elementStart"](4,"div",2),y["\u0275\u0275text"](5,"\n      "),y["\u0275\u0275elementStart"](6,"h2"),y["\u0275\u0275text"](7),y["\u0275\u0275pipe"](8,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](9,"\n      "),y["\u0275\u0275element"](10,"p",3),y["\u0275\u0275pipe"](11,"translate"),y["\u0275\u0275pipe"](12,"async"),y["\u0275\u0275text"](13,"\n      "),y["\u0275\u0275elementStart"](14,"p"),y["\u0275\u0275text"](15),y["\u0275\u0275pipe"](16,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](17,"\n\n      "),y["\u0275\u0275elementStart"](18,"ngb-tabset",4,5),y["\u0275\u0275listener"]("tabChange",(function(e){return t.tabChange(e)})),y["\u0275\u0275text"](20,"\n        "),y["\u0275\u0275elementStart"](21,"ngb-tab",6),y["\u0275\u0275pipe"](22,"translate"),y["\u0275\u0275text"](23,"\n          "),y["\u0275\u0275template"](24,$,7,9,"ng-template",7),y["\u0275\u0275text"](25,"\n        "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](26,"\n        "),y["\u0275\u0275elementStart"](27,"ngb-tab",8),y["\u0275\u0275pipe"](28,"translate"),y["\u0275\u0275text"](29,"\n          "),y["\u0275\u0275template"](30,N,17,13,"ng-template",7),y["\u0275\u0275text"](31,"\n        "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](32,"\n      "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](33,"\n    "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](34,"\n  "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](35,"\n"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](36,"\n")),2&e&&(y["\u0275\u0275advance"](7),y["\u0275\u0275textInterpolate"](y["\u0275\u0275pipeBind1"](8,6,"collection.edit.item-mapper.head")),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("innerHTML",y["\u0275\u0275pipeBind2"](11,8,"collection.edit.item-mapper.collection",y["\u0275\u0275pureFunction1"](19,M,y["\u0275\u0275pipeBind1"](12,11,t.collectionName$))),y["\u0275\u0275sanitizeHtml"]),y["\u0275\u0275advance"](5),y["\u0275\u0275textInterpolate"](y["\u0275\u0275pipeBind1"](16,13,"collection.edit.item-mapper.description")),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("destroyOnHide",!0),y["\u0275\u0275advance"](3),y["\u0275\u0275propertyInterpolate"]("title",y["\u0275\u0275pipeBind1"](22,15,"collection.edit.item-mapper.tabs.browse")),y["\u0275\u0275advance"](6),y["\u0275\u0275propertyInterpolate"]("title",y["\u0275\u0275pipeBind1"](28,17,"collection.edit.item-mapper.tabs.map")))},directives:[T.ab,T.X,T.Y,B.a,R.a,i.u],pipes:[E.e,i.b],styles:[""],data:{animation:[s.a,s.c]},changeDetection:0}),e})();var L=n("J8r5"),H=n("HaPv");const P=function(e){return{active:e}},U=function(e){return[e]};function _(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"li",13),y["\u0275\u0275text"](1,"\n            "),y["\u0275\u0275elementStart"](2,"a",14),y["\u0275\u0275text"](3),y["\u0275\u0275pipe"](4,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](5,"\n          "),y["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=y["\u0275\u0275nextContext"]();y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("ngClass",y["\u0275\u0275pureFunction1"](5,P,e===n.currentPage))("routerLink",y["\u0275\u0275pureFunction1"](7,U,"./"+e)),y["\u0275\u0275advance"](1),y["\u0275\u0275textInterpolate1"]("\n              ",y["\u0275\u0275pipeBind1"](4,3,n.type+".edit.tabs."+e+".head"),"\n            ")}}function q(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"a",15),y["\u0275\u0275pipe"](1,"async"),y["\u0275\u0275text"](2,"\n              "),y["\u0275\u0275element"](3,"i",16),y["\u0275\u0275text"](4),y["\u0275\u0275pipe"](5,"translate"),y["\u0275\u0275elementEnd"]()),2&e){const e=y["\u0275\u0275nextContext"]();var n;y["\u0275\u0275property"]("routerLink",e.getPageUrl(null==(n=y["\u0275\u0275pipeBind1"](1,2,e.dsoRD$))?null:n.payload)),y["\u0275\u0275advance"](4),y["\u0275\u0275textInterpolate1"](" ",y["\u0275\u0275pipeBind1"](5,4,e.type+".edit.return"),"\n            ")}}let G=(()=>{class e extends L.a{constructor(e,t){super(e,t),this.router=e,this.route=t,this.type="collection"}getPageUrl(e){return Object(H.j)(e.id)}}return e.\u0275fac=function(t){return new(t||e)(y["\u0275\u0275directiveInject"](o.g),y["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=y["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-edit-collection"]],features:[y["\u0275\u0275InheritDefinitionFeature"]],decls:47,vars:11,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom"],[1,"btn","btn-danger",3,"routerLink"],[1,"fas","fa-trash"],[1,"pt-2"],[1,"nav","nav-tabs","justify-content-start","mb-2"],["class","nav-item",4,"ngFor","ngForOf"],[1,"tab-pane","active"],[1,"mb-4"],[1,"col-12","text-right"],["class","btn btn-outline-secondary",3,"routerLink",4,"ngIf"],[1,"nav-item"],[1,"nav-link",3,"ngClass","routerLink"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-arrow-left"]],template:function(e,t){var n;1&e&&(y["\u0275\u0275elementStart"](0,"div",0),y["\u0275\u0275text"](1,"\n  "),y["\u0275\u0275elementStart"](2,"div",1),y["\u0275\u0275text"](3,"\n    "),y["\u0275\u0275elementStart"](4,"div",2),y["\u0275\u0275text"](5,"\n      "),y["\u0275\u0275elementStart"](6,"div",3),y["\u0275\u0275text"](7,"\n        "),y["\u0275\u0275elementStart"](8,"h2"),y["\u0275\u0275text"](9),y["\u0275\u0275pipe"](10,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](11,"\n        "),y["\u0275\u0275elementStart"](12,"div"),y["\u0275\u0275text"](13,"\n          "),y["\u0275\u0275elementStart"](14,"a",4),y["\u0275\u0275pipe"](15,"async"),y["\u0275\u0275text"](16,"\n            "),y["\u0275\u0275element"](17,"i",5),y["\u0275\u0275text"](18),y["\u0275\u0275pipe"](19,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](20,"\n        "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](21,"\n      "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](22,"\n      "),y["\u0275\u0275elementStart"](23,"div",6),y["\u0275\u0275text"](24,"\n        "),y["\u0275\u0275elementStart"](25,"ul",7),y["\u0275\u0275text"](26,"\n          "),y["\u0275\u0275template"](27,_,6,9,"li",8),y["\u0275\u0275text"](28,"\n        "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](29,"\n        "),y["\u0275\u0275elementStart"](30,"div",9),y["\u0275\u0275text"](31,"\n          "),y["\u0275\u0275elementStart"](32,"div",10),y["\u0275\u0275text"](33,"\n            "),y["\u0275\u0275element"](34,"router-outlet"),y["\u0275\u0275text"](35,"\n          "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](36,"\n          "),y["\u0275\u0275elementStart"](37,"div",11),y["\u0275\u0275text"](38,"\n            "),y["\u0275\u0275template"](39,q,6,6,"a",12),y["\u0275\u0275text"](40,"\n          "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](41,"\n        "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](42,"\n      "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](43,"\n    "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](44,"\n  "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](45,"\n"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](46,"\n")),2&e&&(y["\u0275\u0275advance"](9),y["\u0275\u0275textInterpolate"](y["\u0275\u0275pipeBind1"](10,5,t.type+".edit.head")),y["\u0275\u0275advance"](5),y["\u0275\u0275property"]("routerLink",("community"===t.type?"/communities/":"/collections/")+(null==(n=y["\u0275\u0275pipeBind1"](15,7,t.dsoRD$))?null:n.payload.uuid)+"/delete"),y["\u0275\u0275advance"](4),y["\u0275\u0275textInterpolate1"](" ",y["\u0275\u0275pipeBind1"](19,9,t.type+".edit.delete"),""),y["\u0275\u0275advance"](9),y["\u0275\u0275property"]("ngForOf",t.pages),y["\u0275\u0275advance"](12),y["\u0275\u0275property"]("ngIf",!t.hideReturnButton))},directives:[o.j,i.t,o.l,i.u,i.r],pipes:[E.e,i.b],encapsulation:2}),e})();var A=n("6nfC"),z=n("ye/0"),X=n("PN+Z"),Y=n("vkgz"),K=n("lP90"),Q=n("mycY"),J=n("X/78"),Z=n("O/5o"),W=n("njH3");function ee(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"button",7),y["\u0275\u0275listener"]("click",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"](2).addItemTemplate()})),y["\u0275\u0275text"](1,"\n      "),y["\u0275\u0275element"](2,"i",8),y["\u0275\u0275text"](3,"\n      "),y["\u0275\u0275elementStart"](4,"span",9),y["\u0275\u0275text"](5),y["\u0275\u0275pipe"](6,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](7,"\n    "),y["\u0275\u0275elementEnd"]()}2&e&&(y["\u0275\u0275advance"](5),y["\u0275\u0275textInterpolate1"]("\xa0",y["\u0275\u0275pipeBind1"](6,1,"collection.edit.template.add-button"),""))}function te(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"button",10),y["\u0275\u0275listener"]("click",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"](2).deleteItemTemplate()})),y["\u0275\u0275text"](1,"\n      "),y["\u0275\u0275element"](2,"i",11),y["\u0275\u0275text"](3,"\n      "),y["\u0275\u0275elementStart"](4,"span",9),y["\u0275\u0275text"](5),y["\u0275\u0275pipe"](6,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](7,"\n    "),y["\u0275\u0275elementEnd"]()}2&e&&(y["\u0275\u0275advance"](5),y["\u0275\u0275textInterpolate1"]("\xa0",y["\u0275\u0275pipeBind1"](6,1,"collection.edit.template.delete-button"),""))}function ne(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"button",12),y["\u0275\u0275pipe"](1,"async"),y["\u0275\u0275text"](2,"\n      "),y["\u0275\u0275element"](3,"i",13),y["\u0275\u0275text"](4,"\n      "),y["\u0275\u0275elementStart"](5,"span",9),y["\u0275\u0275text"](6),y["\u0275\u0275pipe"](7,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](8,"\n    "),y["\u0275\u0275elementEnd"]()),2&e){const e=y["\u0275\u0275nextContext"](2);var n;y["\u0275\u0275property"]("routerLink","/collections/"+(null==(n=y["\u0275\u0275pipeBind1"](1,2,e.dsoRD$))?null:n.payload.uuid)+"/itemtemplate"),y["\u0275\u0275advance"](6),y["\u0275\u0275textInterpolate1"]("\xa0",y["\u0275\u0275pipeBind1"](7,4,"collection.edit.template.edit-button"),"")}}function ie(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"div",2),y["\u0275\u0275text"](1,"\n  "),y["\u0275\u0275elementStart"](2,"label"),y["\u0275\u0275text"](3),y["\u0275\u0275pipe"](4,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](5,"\n  "),y["\u0275\u0275elementStart"](6,"div",3),y["\u0275\u0275text"](7,"\n    "),y["\u0275\u0275template"](8,ee,8,3,"button",4),y["\u0275\u0275text"](9,"\n    "),y["\u0275\u0275template"](10,te,8,3,"button",5),y["\u0275\u0275text"](11,"\n    "),y["\u0275\u0275template"](12,ne,9,6,"button",6),y["\u0275\u0275text"](13,"\n  "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](14,"\n"),y["\u0275\u0275elementEnd"]()),2&e){const e=t.ngVar;y["\u0275\u0275advance"](3),y["\u0275\u0275textInterpolate"](y["\u0275\u0275pipeBind1"](4,4,"collection.edit.template.label")),y["\u0275\u0275advance"](5),y["\u0275\u0275property"]("ngIf",!(null!=e&&e.payload)),y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("ngIf",null==e?null:e.payload),y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("ngIf",null==e?null:e.payload)}}let ae=(()=>{class e extends A.a{constructor(e,t,n,i,a,o,r,c){super(e,n,i,a,o),this.collectionDataService=e,this.itemTemplateService=t,this.router=n,this.route=i,this.notificationsService=a,this.translate=o,this.objectCache=r,this.requestService=c,this.frontendURL="/collections/",this.type=z.a.type}ngOnInit(){super.ngOnInit(),this.initTemplateItem()}initTemplateItem(){this.itemTemplateRD$=this.dsoRD$.pipe(Object(m.j)(),Object(d.a)(e=>this.itemTemplateService.findByCollectionID(e.uuid)))}addItemTemplate(){const e=this.dsoRD$.pipe(Object(m.j)()),t=e.pipe(Object(d.a)(e=>this.itemTemplateService.create(new X.a,e.uuid).pipe(Object(m.j)()))),n=e.pipe(Object(d.a)(e=>this.itemTemplateService.getCollectionEndpoint(e.id)));Object(c.a)(e,t,n).subscribe(([e,t,n])=>{this.requestService.setStaleByHrefSubstring(n),this.router.navigate([Object(H.i)(e.uuid)])})}deleteItemTemplate(){const e=this.dsoRD$.pipe(Object(m.j)()),t=e.pipe(Object(d.a)(e=>this.itemTemplateService.findByCollectionID(e.uuid).pipe(Object(m.j)()))),n=e.pipe(Object(d.a)(e=>this.itemTemplateService.getCollectionEndpoint(e.id)));Object(c.a)(e,t,n).pipe(Object(d.a)(([e,t,n])=>this.itemTemplateService.deleteByCollectionID(t,e.uuid).pipe(Object(Y.a)(i=>{i&&(this.objectCache.remove(n),this.objectCache.remove(t.self),this.requestService.setStaleByHrefSubstring(t.self),this.requestService.setStaleByHrefSubstring(n),this.requestService.setStaleByHrefSubstring(e.self))})))).subscribe(e=>{e?this.notificationsService.success(null,this.translate.get("collection.edit.template.notifications.delete.success")):this.notificationsService.error(null,this.translate.get("collection.edit.template.notifications.delete.error")),this.initTemplateItem()})}}return e.\u0275fac=function(t){return new(t||e)(y["\u0275\u0275directiveInject"](O.a),y["\u0275\u0275directiveInject"](K.a),y["\u0275\u0275directiveInject"](o.g),y["\u0275\u0275directiveInject"](o.a),y["\u0275\u0275directiveInject"](C.a),y["\u0275\u0275directiveInject"](E.f),y["\u0275\u0275directiveInject"](Q.a),y["\u0275\u0275directiveInject"](J.a))},e.\u0275cmp=y["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-collection-metadata"]],features:[y["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:6,consts:[["class","container-fluid mb-2",4,"ngVar"],[3,"dso","submitForm","back","finish"],[1,"container-fluid","mb-2"],[1,"button-row"],["class","btn btn-success",3,"click",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],["class","btn btn-primary",3,"routerLink",4,"ngIf"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash-alt"],[1,"btn","btn-primary",3,"routerLink"],[1,"fas","fa-edit"]],template:function(e,t){var n;1&e&&(y["\u0275\u0275template"](0,ie,15,6,"div",0),y["\u0275\u0275pipe"](1,"async"),y["\u0275\u0275text"](2,"\n"),y["\u0275\u0275elementStart"](3,"ds-collection-form",1),y["\u0275\u0275listener"]("submitForm",(function(e){return t.onSubmit(e)}))("back",(function(){return t.navigateToHomePage()}))("finish",(function(){return t.navigateToHomePage()})),y["\u0275\u0275pipe"](4,"async"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](5,"\n")),2&e&&(y["\u0275\u0275property"]("ngVar",y["\u0275\u0275pipeBind1"](1,2,t.itemTemplateRD$)),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("dso",null==(n=y["\u0275\u0275pipeBind1"](4,4,t.dsoRD$))?null:n.payload))},directives:[Z.a,W.a,i.u,o.h],pipes:[i.b,E.e],encapsulation:2}),e})();var oe=n("SxV6"),re=n("V17L");function ce(e,t){if(1&e&&(y["\u0275\u0275elementStart"](0,"ds-comcol-role",1),y["\u0275\u0275pipe"](1,"async"),y["\u0275\u0275text"](2,"\n"),y["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=y["\u0275\u0275nextContext"]();y["\u0275\u0275property"]("dso",y["\u0275\u0275pipeBind1"](1,2,n.collection$))("comcolRole",e)}}let se=(()=>{class e{constructor(e){this.route=e}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe(Object(oe.a)(),Object(l.a)(e=>e.dso)),this.collection$=this.dsoRD$.pipe(Object(m.i)(),Object(m.o)()),this.comcolRoles$=this.collection$.pipe(Object(l.a)(e=>[{name:"collection-admin",href:e._links.adminGroup.href},{name:"submitters",href:e._links.submittersGroup.href},{name:"item_read",href:e._links.itemReadGroup.href},{name:"bitstream_read",href:e._links.bitstreamReadGroup.href},...e._links.workflowGroups]))}}return e.\u0275fac=function(t){return new(t||e)(y["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=y["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-collection-roles"]],decls:3,vars:3,consts:[[3,"dso","comcolRole",4,"ngFor","ngForOf"],[3,"dso","comcolRole"]],template:function(e,t){1&e&&(y["\u0275\u0275template"](0,ce,3,4,"ds-comcol-role",0),y["\u0275\u0275pipe"](1,"async"),y["\u0275\u0275text"](2,"\n")),2&e&&y["\u0275\u0275property"]("ngForOf",y["\u0275\u0275pipeBind1"](1,1,t.comcolRoles$))},directives:[i.t,re.a],pipes:[i.b],encapsulation:2}),e})();var le=n("daFX"),de=n("QOHy"),pe=n("q7s5"),ue=n("LvDl"),me=n("AytR"),he=n("loKC"),fe=n("Frqi"),be=n("hqmO"),ve=n("s7LF");function xe(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"button",12),y["\u0275\u0275listener"]("click",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"]().discard()})),y["\u0275\u0275pipe"](1,"async"),y["\u0275\u0275element"](2,"i",13),y["\u0275\u0275text"](3,"\n      "),y["\u0275\u0275elementStart"](4,"span",6),y["\u0275\u0275text"](5),y["\u0275\u0275pipe"](6,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](7,"\n    "),y["\u0275\u0275elementEnd"]()}if(2&e){const e=y["\u0275\u0275nextContext"]();y["\u0275\u0275property"]("disabled",!y["\u0275\u0275pipeBind1"](1,2,e.hasChanges())),y["\u0275\u0275advance"](5),y["\u0275\u0275textInterpolate1"]("\xa0",y["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function Se(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"button",14),y["\u0275\u0275listener"]("click",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"]().reinstate()})),y["\u0275\u0275element"](1,"i",15),y["\u0275\u0275text"](2,"\n      "),y["\u0275\u0275elementStart"](3,"span",6),y["\u0275\u0275text"](4),y["\u0275\u0275pipe"](5,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](6,"\n    "),y["\u0275\u0275elementEnd"]()}2&e&&(y["\u0275\u0275advance"](4),y["\u0275\u0275textInterpolate1"]("\xa0",y["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function ge(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"div",16),y["\u0275\u0275text"](1,"\n    "),y["\u0275\u0275elementStart"](2,"input",17),y["\u0275\u0275listener"]("change",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"]().changeExternalSource()})),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](3,"\n    "),y["\u0275\u0275elementStart"](4,"label",18),y["\u0275\u0275text"](5),y["\u0275\u0275pipe"](6,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](7,"\n  "),y["\u0275\u0275elementEnd"]()}if(2&e){const e=y["\u0275\u0275nextContext"]();y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("checked",(null==e.contentSource?null:e.contentSource.harvestType)!==e.harvestTypeNone),y["\u0275\u0275advance"](3),y["\u0275\u0275textInterpolate"](y["\u0275\u0275pipeBind1"](6,2,"collection.edit.tabs.source.external"))}}function ye(e,t){1&e&&(y["\u0275\u0275element"](0,"ds-loading",19),y["\u0275\u0275pipe"](1,"translate")),2&e&&y["\u0275\u0275property"]("message",y["\u0275\u0275pipeBind1"](1,1,"loading.content-source"))}function Ie(e,t){1&e&&(y["\u0275\u0275elementStart"](0,"h4"),y["\u0275\u0275text"](1),y["\u0275\u0275pipe"](2,"translate"),y["\u0275\u0275elementEnd"]()),2&e&&(y["\u0275\u0275advance"](1),y["\u0275\u0275textInterpolate"](y["\u0275\u0275pipeBind1"](2,1,"collection.edit.tabs.source.form.head")))}function Ce(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"ds-form",20),y["\u0275\u0275listener"]("dfChange",(function(t){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"]().onChange(t)}))("submitForm",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"]().onSubmit()}))("cancel",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"]().onCancel()})),y["\u0275\u0275elementEnd"]()}if(2&e){const e=y["\u0275\u0275nextContext"]();y["\u0275\u0275property"]("formId","collection-source-form-id")("formGroup",e.formGroup)("formModel",e.formModel)("formLayout",e.formLayout)("displaySubmit",!1)("displayCancel",!1)}}function je(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"button",12),y["\u0275\u0275listener"]("click",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"](2).discard()})),y["\u0275\u0275pipe"](1,"async"),y["\u0275\u0275element"](2,"i",13),y["\u0275\u0275text"](3,"\n      "),y["\u0275\u0275elementStart"](4,"span",6),y["\u0275\u0275text"](5),y["\u0275\u0275pipe"](6,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](7,"\n    "),y["\u0275\u0275elementEnd"]()}if(2&e){const e=y["\u0275\u0275nextContext"](2);y["\u0275\u0275property"]("disabled",!y["\u0275\u0275pipeBind1"](1,2,e.hasChanges())),y["\u0275\u0275advance"](5),y["\u0275\u0275textInterpolate1"]("\xa0",y["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function Oe(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"button",14),y["\u0275\u0275listener"]("click",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"](2).reinstate()})),y["\u0275\u0275element"](1,"i",15),y["\u0275\u0275text"](2,"\n      "),y["\u0275\u0275elementStart"](3,"span",6),y["\u0275\u0275text"](4),y["\u0275\u0275pipe"](5,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](6,"\n    "),y["\u0275\u0275elementEnd"]()}2&e&&(y["\u0275\u0275advance"](4),y["\u0275\u0275textInterpolate1"]("\xa0",y["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function Ee(e,t){if(1&e){const e=y["\u0275\u0275getCurrentView"]();y["\u0275\u0275elementStart"](0,"div",0),y["\u0275\u0275text"](1,"\n  "),y["\u0275\u0275elementStart"](2,"div",1),y["\u0275\u0275text"](3,"\n    "),y["\u0275\u0275template"](4,je,8,6,"button",2),y["\u0275\u0275pipe"](5,"async"),y["\u0275\u0275text"](6,"\n    "),y["\u0275\u0275template"](7,Oe,7,3,"button",3),y["\u0275\u0275pipe"](8,"async"),y["\u0275\u0275text"](9,"\n    "),y["\u0275\u0275elementStart"](10,"button",4),y["\u0275\u0275listener"]("click",(function(){return y["\u0275\u0275restoreView"](e),y["\u0275\u0275nextContext"]().onSubmit()})),y["\u0275\u0275pipe"](11,"async"),y["\u0275\u0275element"](12,"i",5),y["\u0275\u0275text"](13,"\n      "),y["\u0275\u0275elementStart"](14,"span",6),y["\u0275\u0275text"](15),y["\u0275\u0275pipe"](16,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](17,"\n    "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](18,"\n  "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](19,"\n"),y["\u0275\u0275elementEnd"]()}if(2&e){const e=y["\u0275\u0275nextContext"]();y["\u0275\u0275advance"](4),y["\u0275\u0275property"]("ngIf",!y["\u0275\u0275pipeBind1"](5,4,e.isReinstatable())),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("ngIf",y["\u0275\u0275pipeBind1"](8,6,e.isReinstatable())),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("disabled",!y["\u0275\u0275pipeBind1"](11,8,e.hasChanges())||!e.isValid()||e.initialHarvestType===e.harvestTypeNone&&e.contentSource.harvestType===e.initialHarvestType),y["\u0275\u0275advance"](5),y["\u0275\u0275textInterpolate1"]("\xa0",y["\u0275\u0275pipeBind1"](16,10,"item.edit.metadata.save-button"),"")}}let we=(()=>{class e extends le.a{constructor(e,t,n,i,a,o,r,c,s){super(e,t,a),this.objectUpdatesService=e,this.notificationsService=t,this.location=n,this.formService=i,this.translate=a,this.route=o,this.router=r,this.collectionService=c,this.requestService=s,this.LABEL_KEY_PREFIX="collection.edit.tabs.source.form.",this.ERROR_KEY_PREFIX="collection.edit.tabs.source.form.errors.",this.OPTIONS_KEY_PREFIX="collection.edit.tabs.source.form.options.",this.oaiSourceModel=new de.I({id:"oaiSource",name:"oaiSource",required:!0,validators:{required:null},errorMessages:{required:"You must provide a set id of the target collection."}}),this.oaiSetIdModel=new de.I({id:"oaiSetId",name:"oaiSetId"}),this.metadataConfigIdModel=new de.M({id:"metadataConfigId",name:"metadataConfigId"}),this.harvestTypeModel=new de.L({id:"harvestType",name:"harvestType",options:[{value:pe.b.Metadata},{value:pe.b.MetadataAndRef},{value:pe.b.MetadataAndBitstreams}]}),this.inputModels=[this.oaiSourceModel,this.oaiSetIdModel,this.metadataConfigIdModel,this.harvestTypeModel],this.formModel=[new de.C({id:"oaiSourceContainer",group:[this.oaiSourceModel]}),new de.C({id:"oaiSetContainer",group:[this.oaiSetIdModel,this.metadataConfigIdModel]}),new de.C({id:"harvestTypeContainer",group:[this.harvestTypeModel]})],this.formLayout={oaiSource:{grid:{host:"col-12 d-inline-block"}},oaiSetId:{grid:{host:"col col-sm-6 d-inline-block"}},metadataConfigId:{grid:{host:"col col-sm-6 d-inline-block"}},harvestType:{grid:{host:"col-12",option:"btn-outline-secondary"}},oaiSetContainer:{grid:{host:"row"}},oaiSourceContainer:{grid:{host:"row"}},harvestTypeContainer:{grid:{host:"row"}}},this.harvestTypeNone=pe.b.None,this.previouslySelectedHarvestType=pe.b.Metadata,this.displayedNotifications=[]}ngOnInit(){this.notificationsPrefix="collection.edit.tabs.source.notifications.",this.discardTimeOut=me.a.collection.edit.undoTimeout,this.url=this.router.url,this.url.indexOf("?")>0&&(this.url=this.url.substr(0,this.url.indexOf("?"))),this.formGroup=this.formService.createFormGroup(this.formModel),this.collectionRD$=this.route.parent.data.pipe(Object(oe.a)(),Object(l.a)(e=>e.dso)),this.collectionRD$.pipe(Object(m.i)(),Object(l.a)(e=>e.payload.uuid),Object(d.a)(e=>this.collectionService.getContentSource(e)),Object(m.g)()).subscribe(e=>{this.initializeOriginalContentSource(e.payload)}),this.updateFieldTranslations(),this.translate.onLangChange.subscribe(()=>{this.updateFieldTranslations()})}initializeOriginalContentSource(e){this.contentSource=e,this.initialHarvestType=e.harvestType,this.initializeMetadataConfigs();const t=Object(ue.cloneDeep)(this.contentSource);this.objectUpdatesService.initialize(this.url,[t],new Date),this.update$=this.objectUpdatesService.getFieldUpdates(this.url,[t]).pipe(Object(l.a)(e=>e[t.uuid])),this.updateSub=this.update$.subscribe(e=>{if(e){const t=e.field;let n;Object(b.b)(this.contentSource)&&Object(b.e)(this.contentSource.metadataConfigs)&&(n=this.contentSource.metadataConfigs[0].id),Object(b.b)(t)&&Object(b.b)(t.metadataConfigId)&&(n=t.metadataConfigId),Object(b.b)(t)&&(this.formGroup.patchValue({oaiSourceContainer:{oaiSource:t.oaiSource},oaiSetContainer:{oaiSetId:t.oaiSetId,metadataConfigId:n},harvestTypeContainer:{harvestType:t.harvestType}}),this.contentSource=Object(ue.cloneDeep)(t)),this.contentSource.metadataConfigId=n}})}initializeMetadataConfigs(){this.metadataConfigIdModel.options=this.contentSource.metadataConfigs.map(e=>Object.assign({value:e.id,label:e.label})),this.metadataConfigIdModel.options.length>0&&this.formGroup.patchValue({oaiSetContainer:{metadataConfigId:this.metadataConfigIdModel.options[0].value}})}updateFieldTranslations(){this.inputModels.forEach(e=>{this.updateFieldTranslation(e)})}updateFieldTranslation(e){e.label=this.translate.instant(this.LABEL_KEY_PREFIX+e.id),Object(b.e)(e.validators)&&(e.errorMessages={},Object.keys(e.validators).forEach(t=>{e.errorMessages[t]=this.translate.instant(this.ERROR_KEY_PREFIX+e.id+"."+t)})),e instanceof de.K&&Object(b.e)(e.options)&&e.options.forEach(t=>{Object(b.a)(t.label)&&(t.label=this.translate.instant(this.OPTIONS_KEY_PREFIX+e.id+"."+t.value))})}onChange(e){this.updateContentSourceField(e.model,!0),this.saveFieldUpdate()}onSubmit(){this.collectionRD$.pipe(Object(m.i)(),Object(l.a)(e=>e.payload.uuid),Object(d.a)(e=>this.collectionService.getHarvesterEndpoint(e)),Object(u.a)(1)).subscribe(e=>this.requestService.removeByHrefSubstring(e)),this.collectionRD$.pipe(Object(m.i)(),Object(l.a)(e=>e.payload.uuid),Object(d.a)(e=>this.collectionService.updateContentSource(e,this.contentSource)),Object(u.a)(1)).subscribe(e=>{Object(b.b)(e.harvestType)?(this.clearNotifications(),this.initializeOriginalContentSource(e),this.displayedNotifications.push(this.notificationsService.success(this.getNotificationTitle("saved"),this.getNotificationContent("saved")))):this.displayedNotifications.push(e)})}onCancel(){this.location.back()}isValid(){return this.contentSource.harvestType===pe.b.None||this.formGroup.valid}changeExternalSource(){this.contentSource.harvestType===pe.b.None?this.contentSource.harvestType=this.previouslySelectedHarvestType:(this.previouslySelectedHarvestType=this.contentSource.harvestType,this.contentSource.harvestType=pe.b.None),this.updateContentSource(!1)}updateContentSource(e){this.inputModels.forEach(t=>{this.updateContentSourceField(t,e)}),this.saveFieldUpdate()}updateContentSourceField(e,t){Object(b.b)(e.value)&&(e.id!==this.harvestTypeModel.id||t)&&(this.contentSource[e.id]=e.value)}saveFieldUpdate(){this.objectUpdatesService.saveAddFieldUpdate(this.url,Object(ue.cloneDeep)(this.contentSource))}clearNotifications(){this.displayedNotifications.forEach(e=>{this.notificationsService.remove(e)}),this.displayedNotifications=[]}ngOnDestroy(){this.updateSub&&this.updateSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(y["\u0275\u0275directiveInject"](he.a),y["\u0275\u0275directiveInject"](C.a),y["\u0275\u0275directiveInject"](i.o),y["\u0275\u0275directiveInject"](de.F),y["\u0275\u0275directiveInject"](E.f),y["\u0275\u0275directiveInject"](o.a),y["\u0275\u0275directiveInject"](o.g),y["\u0275\u0275directiveInject"](O.a),y["\u0275\u0275directiveInject"](J.a))},e.\u0275cmp=y["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-collection-source"]],features:[y["\u0275\u0275InheritDefinitionFeature"]],decls:35,vars:20,consts:[[1,"container-fluid"],[1,"d-inline-block","float-right"],["class"," btn btn-danger",3,"disabled","click",4,"ngIf"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-save"],[1,"d-none","d-sm-inline"],["class","form-check mb-4",4,"ngIf"],[3,"message",4,"ngIf"],[4,"ngIf"],[3,"formId","formGroup","formModel","formLayout","displaySubmit","displayCancel","dfChange","submitForm","cancel",4,"ngIf"],["class","container-fluid",4,"ngIf"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-undo-alt"],[1,"form-check","mb-4"],["type","checkbox","id","externalSourceCheck",1,"form-check-input",3,"checked","change"],["for","externalSourceCheck",1,"form-check-label"],[3,"message"],[3,"formId","formGroup","formModel","formLayout","displaySubmit","displayCancel","dfChange","submitForm","cancel"]],template:function(e,t){1&e&&(y["\u0275\u0275elementStart"](0,"div",0),y["\u0275\u0275text"](1,"\n  "),y["\u0275\u0275elementStart"](2,"div",1),y["\u0275\u0275text"](3,"\n    "),y["\u0275\u0275template"](4,xe,8,6,"button",2),y["\u0275\u0275pipe"](5,"async"),y["\u0275\u0275text"](6,"\n    "),y["\u0275\u0275template"](7,Se,7,3,"button",3),y["\u0275\u0275pipe"](8,"async"),y["\u0275\u0275text"](9,"\n    "),y["\u0275\u0275elementStart"](10,"button",4),y["\u0275\u0275listener"]("click",(function(){return t.onSubmit()})),y["\u0275\u0275pipe"](11,"async"),y["\u0275\u0275element"](12,"i",5),y["\u0275\u0275text"](13,"\n      "),y["\u0275\u0275elementStart"](14,"span",6),y["\u0275\u0275text"](15),y["\u0275\u0275pipe"](16,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](17,"\n    "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](18,"\n  "),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](19,"\n  "),y["\u0275\u0275elementStart"](20,"h4"),y["\u0275\u0275text"](21),y["\u0275\u0275pipe"](22,"translate"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](23,"\n  "),y["\u0275\u0275template"](24,ge,8,4,"div",7),y["\u0275\u0275text"](25,"\n  "),y["\u0275\u0275template"](26,ye,2,3,"ds-loading",8),y["\u0275\u0275text"](27,"\n  "),y["\u0275\u0275template"](28,Ie,3,3,"h4",9),y["\u0275\u0275text"](29,"\n"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](30,"\n"),y["\u0275\u0275template"](31,Ce,1,6,"ds-form",10),y["\u0275\u0275text"](32,"\n"),y["\u0275\u0275template"](33,Ee,20,12,"div",11),y["\u0275\u0275text"](34,"\n")),2&e&&(y["\u0275\u0275advance"](4),y["\u0275\u0275property"]("ngIf",!y["\u0275\u0275pipeBind1"](5,10,t.isReinstatable())),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("ngIf",y["\u0275\u0275pipeBind1"](8,12,t.isReinstatable())),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("disabled",!y["\u0275\u0275pipeBind1"](11,14,t.hasChanges())||!t.isValid()||t.initialHarvestType===t.harvestTypeNone&&t.contentSource.harvestType===t.initialHarvestType),y["\u0275\u0275advance"](5),y["\u0275\u0275textInterpolate1"]("\xa0",y["\u0275\u0275pipeBind1"](16,16,"item.edit.metadata.save-button"),""),y["\u0275\u0275advance"](6),y["\u0275\u0275textInterpolate"](y["\u0275\u0275pipeBind1"](22,18,"collection.edit.tabs.source.head")),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("ngIf",t.contentSource),y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("ngIf",!t.contentSource),y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("ngIf",t.contentSource&&(null==t.contentSource?null:t.contentSource.harvestType)!==t.harvestTypeNone),y["\u0275\u0275advance"](3),y["\u0275\u0275property"]("ngIf",t.formGroup&&t.contentSource&&(null==t.contentSource?null:t.contentSource.harvestType)!==t.harvestTypeNone),y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("ngIf",(null==t.contentSource?null:t.contentSource.harvestType)!==t.harvestTypeNone))},directives:[i.u,fe.a,be.a,ve.NgControlStatusGroup,ve.FormGroupDirective],pipes:[i.b,E.e],encapsulation:2}),e})();var Te=n("pLZG"),Be=n("Rgmz");const Re=function(e){return{collection:e}};let ke=(()=>{class e{constructor(e,t){this.route=e,this.dsoNameService=t}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe(Object(u.a)(1),Object(l.a)(e=>e.dso)),this.collectionName$=this.dsoRD$.pipe(Object(Te.a)(e=>Object(b.b)(e)),Object(l.a)(e=>this.dsoNameService.getName(e.payload)))}}return e.\u0275fac=function(t){return new(t||e)(y["\u0275\u0275directiveInject"](o.a),y["\u0275\u0275directiveInject"](w.a))},e.\u0275cmp=y["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-collection-curate"]],decls:11,vars:11,consts:[[1,"container"],[3,"dsoHandle"]],template:function(e,t){var n;1&e&&(y["\u0275\u0275elementStart"](0,"div",0),y["\u0275\u0275text"](1,"\n    "),y["\u0275\u0275elementStart"](2,"h3"),y["\u0275\u0275text"](3),y["\u0275\u0275pipe"](4,"translate"),y["\u0275\u0275pipe"](5,"async"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](6,"\n    "),y["\u0275\u0275element"](7,"ds-curation-form",1),y["\u0275\u0275pipe"](8,"async"),y["\u0275\u0275text"](9,"\n"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](10,"\n")),2&e&&(y["\u0275\u0275advance"](3),y["\u0275\u0275textInterpolate"](y["\u0275\u0275pipeBind2"](4,2,"collection.curate.header",y["\u0275\u0275pureFunction1"](9,Re,y["\u0275\u0275pipeBind1"](5,5,t.collectionName$)))),y["\u0275\u0275advance"](4),y["\u0275\u0275property"]("dsoHandle",null==(n=y["\u0275\u0275pipeBind1"](8,7,t.dsoRD$))?null:n.payload.handle))},directives:[Be.a],pipes:[E.e,i.b],encapsulation:2}),e})();var $e=n("+Bs4");let De=(()=>{class e{constructor(e){this.route=e}ngOnInit(){this.dsoRD$=this.route.parent.parent.data.pipe(Object(oe.a)(),Object(l.a)(e=>e.dso))}}return e.\u0275fac=function(t){return new(t||e)(y["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=y["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-collection-authorizations"]],decls:6,vars:4,consts:[[1,"container"],[3,"resourceType","resourceUUID"]],template:function(e,t){var n;1&e&&(y["\u0275\u0275elementStart"](0,"div",0),y["\u0275\u0275text"](1,"\n  "),y["\u0275\u0275element"](2,"ds-resource-policies",1),y["\u0275\u0275pipe"](3,"async"),y["\u0275\u0275text"](4,"\n"),y["\u0275\u0275elementEnd"](),y["\u0275\u0275text"](5,"\n")),2&e&&(y["\u0275\u0275advance"](2),y["\u0275\u0275property"]("resourceType","collection")("resourceUUID",null==(n=y["\u0275\u0275pipeBind1"](3,2,t.dsoRD$))||null==n.payload?null:n.payload.id))},directives:[$e.a],pipes:[i.b],encapsulation:2}),e})();var Fe=n("A0IO"),Ne=n("n1Qy"),Me=n("EEUA"),Ve=n("G5zm"),Le=n("ALMP"),He=n("rdLr"),Pe=n("LRne"),Ue=n("FU+A"),_e=n("1mcE"),qe=n("Vurf");let Ge=(()=>{class e extends He.a{constructor(e,t,n){super(e,t,n),this.authorizationService=e,this.router=t,this.authService=n}getFeatureID(e,t){return Object(Pe.a)(Ue.a.IsCollectionAdmin)}}return e.\u0275fac=function(t){return new(t||e)(y["\u0275\u0275inject"](_e.a),y["\u0275\u0275inject"](o.g),y["\u0275\u0275inject"](qe.a))},e.\u0275prov=y["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ae=(()=>{class e{}return e.\u0275mod=y["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=y["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[Ve.a,Ne.a],imports:[[o.k.forChild([{path:"",resolve:{breadcrumb:Fe.a},data:{breadcrumbKey:"collection.edit"},component:G,canActivate:[Ge],children:[{path:"",redirectTo:"metadata",pathMatch:"full"},{path:"metadata",component:ae,data:{title:"collection.edit.tabs.metadata.title",hideReturnButton:!0,showBreadcrumbs:!0}},{path:"roles",component:se,data:{title:"collection.edit.tabs.roles.title",showBreadcrumbs:!0}},{path:"source",component:we,data:{title:"collection.edit.tabs.source.title",showBreadcrumbs:!0}},{path:"curate",component:ke,data:{title:"collection.edit.tabs.curate.title",showBreadcrumbs:!0}},{path:"authorizations",data:{showBreadcrumbs:!0},children:[{path:"create",resolve:{resourcePolicyTarget:Ne.a},component:Me.a,data:{title:"resource-policies.create.page.title"}},{path:"edit",resolve:{resourcePolicy:Ve.a},component:Le.a,data:{title:"resource-policies.edit.page.title"}},{path:"",component:De,data:{title:"collection.edit.tabs.authorizations.title",showBreadcrumbs:!0}}]},{path:"mapper",component:V,data:{title:"collection.edit.tabs.item-mapper.title",hideReturnButton:!0,showBreadcrumbs:!0}}]}])]]}),e})();var ze=n("yBEL");let Xe=(()=>{class e{}return e.\u0275mod=y["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=y["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.c,a.a,Ae,ze.a]]}),e})()}}]);
//# sourceMappingURL=38-es2015.ba1ce9abb15892b5f2f8.js.map