(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"0VLH":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("J3qs"),s=n("zZO8");class o extends s.a{constructor(e,...t){super(e,...t),this._rootElement=e,this._subRootElement=t.join("/")}get rootElement(){return this._rootElement}get subRootElement(){return this._subRootElement}getPath(e){Object(i.h)(e)&&Array.isArray(e)&&(e=e.join("/"));let t="/"+this.toString();return Object(i.h)(e)&&(t+="/"+e),{rootElement:this._rootElement,subRootElement:this._subRootElement,path:t}}}},"20cJ":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("/eM4"),s=n("5+tZ"),o=n("6c/T"),a=n("8Y7J"),r=n("G0yt"),c=n("J/vq"),l=n("iInd"),d=n("lI3o"),p=n("SVse"),u=n("TSSN");function m(e,t){if(1&e&&(a["\u0275\u0275elementStart"](0,"div",5),a["\u0275\u0275text"](1,"\n      "),a["\u0275\u0275elementStart"](2,"div",6),a["\u0275\u0275text"](3,"\n        "),a["\u0275\u0275elementStart"](4,"strong"),a["\u0275\u0275text"](5),a["\u0275\u0275pipe"](6,"translate"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](7,"\n        "),a["\u0275\u0275elementStart"](8,"p"),a["\u0275\u0275text"](9),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](10,"\n      "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](11,"\n    "),a["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;a["\u0275\u0275advance"](5),a["\u0275\u0275textInterpolate"](a["\u0275\u0275pipeBind1"](6,2,"item.preview."+e.key)),a["\u0275\u0275advance"](4),a["\u0275\u0275textInterpolate"](e.value.value)}}let b=(()=>{class e{constructor(e,t,n,i,s){this.activeModal=e,this.submissionService=t,this.modalService=n,this.router=i,this.notificationService=s}ngOnInit(){this.metadataList=[],Object.keys(this.externalSourceEntry.metadata).forEach(e=>{this.metadataList.push({key:e,value:i.a.first(this.externalSourceEntry.metadata,e)})})}closeMetadataModal(){this.activeModal.dismiss(!1)}import(){this.modalRef=this.modalService.open(o.a,{size:"lg"}),this.closeMetadataModal(),this.modalRef.componentInstance.selectedEvent.pipe(Object(s.a)(e=>this.submissionService.createSubmissionFromExternalSource(this.externalSourceEntry._links.self.href,e.collection.id))).subscribe(e=>{let t=!1;1===e.length&&null!==e[0]&&(t=!0,this.router.navigateByUrl("/workspaceitems/"+e[0].id+"/edit")),t||this.notificationService.error("submission.import-external.preview.error.import.title","submission.import-external.preview.error.import.body"),this.modalRef.close()})}}return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275directiveInject"](r.b),a["\u0275\u0275directiveInject"](c.a),a["\u0275\u0275directiveInject"](r.u),a["\u0275\u0275directiveInject"](l.g),a["\u0275\u0275directiveInject"](d.a))},e.\u0275cmp=a["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-import-external-preview"]],inputs:{externalSourceEntry:"externalSourceEntry"},decls:59,vars:10,consts:[[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"container"],[1,"row"],[1,"col-md-12"],["class","row",4,"ngFor","ngForOf"],[1,"col-md-12","text-right"],["role","button",1,"btn","btn-success",3,"click"],["aria-hidden","true",1,"fa","fa-file-import"]],template:function(e,t){1&e&&(a["\u0275\u0275elementStart"](0,"div",0),a["\u0275\u0275text"](1,"\n  "),a["\u0275\u0275elementStart"](2,"h2"),a["\u0275\u0275text"](3),a["\u0275\u0275pipe"](4,"translate"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](5,"\n  "),a["\u0275\u0275elementStart"](6,"button",1),a["\u0275\u0275listener"]("click",(function(){return t.closeMetadataModal()})),a["\u0275\u0275text"](7,"\n      "),a["\u0275\u0275elementStart"](8,"span",2),a["\u0275\u0275text"](9,"\xd7"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](10,"\n  "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](11,"\n"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](12,"\n"),a["\u0275\u0275elementStart"](13,"div",3),a["\u0275\u0275text"](14,"\n  "),a["\u0275\u0275elementStart"](15,"div",4),a["\u0275\u0275text"](16,"\n    "),a["\u0275\u0275elementStart"](17,"div",5),a["\u0275\u0275text"](18,"\n      "),a["\u0275\u0275elementStart"](19,"div",6),a["\u0275\u0275text"](20,"\n        "),a["\u0275\u0275elementStart"](21,"p"),a["\u0275\u0275text"](22),a["\u0275\u0275pipe"](23,"translate"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](24,"\n      "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](25,"\n    "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](26,"\n    "),a["\u0275\u0275elementStart"](27,"div",5),a["\u0275\u0275text"](28,"\n      "),a["\u0275\u0275elementStart"](29,"div",6),a["\u0275\u0275text"](30,"\n        "),a["\u0275\u0275element"](31,"hr"),a["\u0275\u0275text"](32,"\n      "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](33,"\n    "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](34,"\n    "),a["\u0275\u0275template"](35,m,12,4,"div",7),a["\u0275\u0275text"](36,"\n    "),a["\u0275\u0275elementStart"](37,"div",5),a["\u0275\u0275text"](38,"\n      "),a["\u0275\u0275elementStart"](39,"div",6),a["\u0275\u0275text"](40,"\n        "),a["\u0275\u0275element"](41,"hr"),a["\u0275\u0275text"](42,"\n      "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](43,"\n    "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](44,"\n    "),a["\u0275\u0275elementStart"](45,"div",5),a["\u0275\u0275text"](46,"\n      "),a["\u0275\u0275elementStart"](47,"div",8),a["\u0275\u0275text"](48,"\n        "),a["\u0275\u0275elementStart"](49,"button",9),a["\u0275\u0275listener"]("click",(function(){return t.import()})),a["\u0275\u0275text"](50,"\n          "),a["\u0275\u0275element"](51,"i",10),a["\u0275\u0275text"](52),a["\u0275\u0275pipe"](53,"translate"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](54,"\n      "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](55,"\n    "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](56,"\n  "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](57,"\n"),a["\u0275\u0275elementEnd"](),a["\u0275\u0275text"](58,"\n")),2&e&&(a["\u0275\u0275advance"](3),a["\u0275\u0275textInterpolate"](a["\u0275\u0275pipeBind1"](4,4,"submission.import-external.preview.title")),a["\u0275\u0275advance"](19),a["\u0275\u0275textInterpolate"](a["\u0275\u0275pipeBind1"](23,6,"submission.import-external.preview.subtitle")),a["\u0275\u0275advance"](13),a["\u0275\u0275property"]("ngForOf",t.metadataList),a["\u0275\u0275advance"](17),a["\u0275\u0275textInterpolate1"](" ",a["\u0275\u0275pipeBind1"](53,8,"submission.import-external.preview.button.import"),"\n        "))},directives:[p.t],pipes:[u.e],styles:[".close[_ngcontent-%COMP%]:focus{outline:none!important}"]}),e})()},"3aq+":function(e,t,n){var i={"./custom/app/submission/edit/submission-edit.component":["OutP",74]};function s(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],s=t[0];return n.e(t[1]).then((function(){return n(s)}))}s.keys=function(){return Object.keys(i)},s.id="3aq+",e.exports=s},"3cpT":function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i=n("8Y7J"),s=n("LRne"),o=n("JIr8"),a=n("vkgz"),r=n("f+Ev"),c=n("oBfO"),l=n("GG8d"),d=n("B/au"),p=n("1QIV"),u=n("J3qs"),m=n("dHui"),b=n("14tD"),h=n("SVse"),f=n("G0yt"),v=n("MNke"),g=n("s7LF"),x=n("TSSN");function S(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",10),i["\u0275\u0275text"](1,"\n  "),i["\u0275\u0275elementStart"](2,"input",11),i["\u0275\u0275listener"]("keyup.enter",(function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"]();return""===t.searchString?null:t.search()}))("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().searchString=t})),i["\u0275\u0275pipe"](3,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](4,"\n"),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](2),i["\u0275\u0275propertyInterpolate"]("placeholder",i["\u0275\u0275pipeBind1"](3,2,"submission.import-external.search.placeholder")),i["\u0275\u0275property"]("ngModel",e.searchString)}}function I(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"input",11),i["\u0275\u0275listener"]("keyup.enter",(function(){i["\u0275\u0275restoreView"](e);const t=i["\u0275\u0275nextContext"]();return""===t.searchString?null:t.search()}))("ngModelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().searchString=t})),i["\u0275\u0275pipe"](1,"translate"),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275propertyInterpolate"]("placeholder",i["\u0275\u0275pipeBind1"](1,2,"submission.import-external.search.placeholder")),i["\u0275\u0275property"]("ngModel",e.searchString)}}function O(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"button",12),i["\u0275\u0275listener"]("click",(function(){i["\u0275\u0275restoreView"](e);const n=t.$implicit;return i["\u0275\u0275nextContext"]().makeSourceSelection(n)})),i["\u0275\u0275pipe"](1,"translate"),i["\u0275\u0275text"](2),i["\u0275\u0275pipe"](3,"translate"),i["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;i["\u0275\u0275propertyInterpolate"]("title",i["\u0275\u0275pipeBind1"](1,2,"submission.import-external.source."+(null==e?null:e.name))),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](3,4,"submission.import-external.source."+(null==e?null:e.name)))}}function y(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div",13),i["\u0275\u0275elementStart"](1,"p"),i["\u0275\u0275text"](2),i["\u0275\u0275pipe"](3,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e&&(i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](3,1,"submission.import-external.source.loading")))}const j=function(e){return{"input-group-append":e}};let C=(()=>{class e{constructor(e,t,n){this.externalService=e,this.cdr=t,this.windowService=n,this.sourceListLoading=!1,this.externalSourceData=new i.EventEmitter}ngOnInit(){this.selectedElement={id:"",name:"loading"},this.searchString="",this.sourceList=[],this.findListOptions=Object.assign({},new d.f,{elementsPerPage:5,currentPage:1}),this.externalService.findAll(this.findListOptions).pipe(Object(o.a)(()=>{const e=new c.a,t=Object(r.b)(e,[]),n=Object(l.c)(t);return Object(s.a)(n)}),Object(p.j)()).subscribe(e=>{e.page.forEach(e=>{this.sourceList.push({id:e.id,name:e.name}),this.initExternalSourceData.sourceId===e.id&&(this.selectedElement={id:e.id,name:e.name},this.searchString=this.initExternalSourceData.query)}),""===this.selectedElement.id&&(this.selectedElement=this.sourceList[0]),this.pageInfo=e.pageInfo,this.cdr.detectChanges()}),this.isXsOrSm$=this.windowService.isXsOrSm()}makeSourceSelection(e){this.selectedElement=e}onScroll(){!this.sourceListLoading&&this.pageInfo.currentPage+1<=this.pageInfo.totalPages&&(this.sourceListLoading=!0,this.findListOptions=Object.assign({},new d.f,{elementsPerPage:5,currentPage:this.findListOptions.currentPage+1}),this.sub=this.externalService.findAll(this.findListOptions).pipe(Object(o.a)(()=>{const e=new c.a,t=Object(r.b)(e,[]),n=Object(l.c)(t);return Object(s.a)(n)}),Object(p.i)(),Object(a.a)(()=>this.sourceListLoading=!1)).subscribe(e=>{e.payload.page.forEach(e=>{this.sourceList.push({id:e.id,name:e.name})}),this.pageInfo=e.payload.pageInfo,this.cdr.detectChanges()}))}search(){this.externalSourceData.emit({sourceId:this.selectedElement.id,query:this.searchString})}ngOnDestroy(){Object(u.b)(this.sub)&&this.sub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](m.a),i["\u0275\u0275directiveInject"](i.ChangeDetectorRef),i["\u0275\u0275directiveInject"](b.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-import-external-searchbar"]],inputs:{initExternalSourceData:"initExternalSourceData"},outputs:{externalSourceData:"externalSourceData"},decls:34,vars:31,consts:[["class","input-group mb-2",4,"ngIf"],[1,"input-group","mb-5"],["type","text","class","form-control","aria-label","","aria-describedby","",3,"ngModel","placeholder","keyup.enter","ngModelChange",4,"ngIf"],["ngbDropdown","","role","group","aria-label","",3,"ngClass"],["ngbDropdownToggle","",1,"btn","btn-outline-secondary","w-fx",3,"title"],["ngbDropdownMenu","","aria-haspopup","true","aria-expanded","false","aria-labelledby","scrollableDropdownMenuButton",1,"dropdown-menu","scrollable-dropdown-menu","w-100"],["aria-labelledby","scrollableDropdownMenuButton","infiniteScroll","",1,"scrollable-menu",3,"infiniteScrollDistance","infiniteScrollThrottle","scrollWindow","scrolled"],["ngbDropdownItem","","class","dropdown-item text-truncate",3,"title","click",4,"ngFor","ngForOf"],["ngbDropdownItem","","class","scrollable-dropdown-loading text-center",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"title","disabled","click"],[1,"input-group","mb-2"],["type","text","aria-label","","aria-describedby","",1,"form-control",3,"ngModel","placeholder","keyup.enter","ngModelChange"],["ngbDropdownItem","",1,"dropdown-item","text-truncate",3,"title","click"],["ngbDropdownItem","",1,"scrollable-dropdown-loading","text-center"]],template:function(e,t){1&e&&(i["\u0275\u0275template"](0,S,5,4,"div",0),i["\u0275\u0275pipe"](1,"async"),i["\u0275\u0275text"](2,"\n"),i["\u0275\u0275elementStart"](3,"div",1),i["\u0275\u0275text"](4,"\n  "),i["\u0275\u0275template"](5,I,2,4,"input",2),i["\u0275\u0275pipe"](6,"async"),i["\u0275\u0275text"](7,"\n  "),i["\u0275\u0275elementStart"](8,"div",3),i["\u0275\u0275pipe"](9,"async"),i["\u0275\u0275text"](10,"\n    "),i["\u0275\u0275elementStart"](11,"button",4),i["\u0275\u0275pipe"](12,"translate"),i["\u0275\u0275text"](13),i["\u0275\u0275pipe"](14,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](15,"\n    "),i["\u0275\u0275elementStart"](16,"div",5),i["\u0275\u0275text"](17,"\n      "),i["\u0275\u0275elementStart"](18,"div",6),i["\u0275\u0275listener"]("scrolled",(function(){return t.onScroll()})),i["\u0275\u0275text"](19,"\n        "),i["\u0275\u0275template"](20,O,4,6,"button",7),i["\u0275\u0275text"](21,"\n        "),i["\u0275\u0275template"](22,y,4,3,"div",8),i["\u0275\u0275text"](23,"\n      "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](24,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](25,"\n    "),i["\u0275\u0275elementStart"](26,"button",9),i["\u0275\u0275listener"]("click",(function(){return t.search()})),i["\u0275\u0275pipe"](27,"translate"),i["\u0275\u0275pipe"](28,"translate"),i["\u0275\u0275text"](29),i["\u0275\u0275pipe"](30,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](31,"\n  "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](32,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](33,"\n")),2&e&&(i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](1,13,t.isXsOrSm$)),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](6,15,t.isXsOrSm$)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngClass",i["\u0275\u0275pureFunction1"](29,j,!i["\u0275\u0275pipeBind1"](9,17,t.isXsOrSm$))),i["\u0275\u0275advance"](3),i["\u0275\u0275propertyInterpolate"]("title",i["\u0275\u0275pipeBind1"](12,19,"submission.import-external.search.source.hint")),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](14,21,"submission.import-external.source."+(null==t.selectedElement?null:t.selectedElement.name))),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("infiniteScrollDistance",2)("infiniteScrollThrottle",50)("scrollWindow",!1),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngForOf",t.sourceList),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",t.sourceListLoading),i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("title",""===t.searchString?i["\u0275\u0275pipeBind1"](27,23,"submission.import-external.search.button.hint"):i["\u0275\u0275pipeBind1"](28,25,"submission.import-external.search.button"))("disabled",""===t.searchString),i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](30,27,"submission.import-external.search.button")))},directives:[h.u,f.n,h.r,f.r,f.q,v.a,h.t,g.DefaultValueAccessor,g.NgControlStatus,g.NgModel,f.p],pipes:[h.b,x.e],styles:[".input-group-append[_ngcontent-%COMP%]:last-child > .btn[_ngcontent-%COMP%]:not(:last-child):not(.dropdown-toggle){margin-left:-1px;border-radius:0 .25rem .25rem 0}.input-group-append[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]{border-radius:0}.w-fx[_ngcontent-%COMP%]{min-width:200px}.scrollable-menu[_ngcontent-%COMP%]{height:auto;max-height:calc(var(--ds-dropdown-menu-max-height) / 2);overflow-x:hidden}.scrollable-dropdown-loading[_ngcontent-%COMP%]{background-color:var(--bs-primary);color:#fff;height:calc(var(--bs-spacer) * 2)!important;line-height:calc(var(--bs-spacer) * 2);position:-webkit-sticky;position:sticky;bottom:0}"]}),e})()},"4GeW":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.Relationships="relationships",e.SubmissionForm="submission-form",e.Upload="upload",e.License="license",e.CcLicense="cclicense",e.collection="collection",e}({})},"6c/T":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("8Y7J"),s=n("G0yt"),o=n("Oqsf"),a=n("TSSN");let r=(()=>{class e{constructor(e){this.activeModal=e,this.selectedEvent=new i.EventEmitter}selectObject(e){this.selectedEvent.emit(e)}closeCollectionModal(){this.activeModal.dismiss(!1)}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](s.b))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-import-external-collection"]],outputs:{selectedEvent:"selectedEvent"},decls:19,vars:3,consts:[[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"selectionChange"]],template:function(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275text"](1,"\n  "),i["\u0275\u0275elementStart"](2,"div",0),i["\u0275\u0275text"](3),i["\u0275\u0275pipe"](4,"translate"),i["\u0275\u0275elementStart"](5,"button",1),i["\u0275\u0275listener"]("click",(function(){return t.closeCollectionModal()})),i["\u0275\u0275text"](6,"\n      "),i["\u0275\u0275elementStart"](7,"span",2),i["\u0275\u0275text"](8,"\xd7"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](9,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](10,"\n  "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](11,"\n  "),i["\u0275\u0275elementStart"](12,"div",3),i["\u0275\u0275text"](13,"\n    "),i["\u0275\u0275elementStart"](14,"ds-collection-dropdown",4),i["\u0275\u0275listener"]("selectionChange",(function(e){return t.selectObject(e)})),i["\u0275\u0275text"](15,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](16,"\n  "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](17,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](18,"\n")),2&e&&(i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate1"]("",i["\u0275\u0275pipeBind1"](4,1,"dso-selector.create.collection.head"),"\n    "))},directives:[o.a],pipes:[a.e],styles:[".close[_ngcontent-%COMP%]:focus{outline:none!important}"]}),e})()},"Ahb/":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("JTKQ"),s=n("8Y7J");function o(e,t){}let a=(()=>{class e extends i.a{getComponentName(){return"SubmissionSubmitComponent"}importThemedComponent(e){return n("TkMu")(`./${e}/app/submission/submit/submission-submit.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(null,"THnG"))}}return e.\u0275fac=function(t){return r(t||e)},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-themed-submission-submit"]],features:[s["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:0,consts:[["vcr",""]],template:function(e,t){1&e&&(s["\u0275\u0275template"](0,o,0,0,"ng-template",null,0,s["\u0275\u0275templateRefExtractor"]),s["\u0275\u0275text"](2,"\n"))},encapsulation:2}),e})();const r=s["\u0275\u0275getInheritedFactory"](a)},JHLN:function(e,t,n){var i={"./custom/app/submission/import-external/submission-import-external.component":["mVFA",75]};function s(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],s=t[0];return n.e(t[1]).then((function(){return n(s)}))}s.keys=function(){return Object.keys(i)},s.id="JHLN",e.exports=s},RMpN:function(e,t,n){"use strict";n.r(t),n.d(t,"SubmissionImportExternalComponent",(function(){return N}));var i=n("2Vo4"),s=n("itXk"),o=n("IzEk"),a=n("pLZG"),r=n("eIep"),c=n("vkgz"),l=n("5+tZ"),d=n("f+Ev"),p=n("ynxc"),u=n("7DXY"),m=n("GG8d"),b=n("20cJ"),h=n("mEo1"),f=n("oBfO"),v=n("J3qs"),g=n("1QIV"),x=n("8Y7J"),S=n("joI/"),I=n("dHui"),O=n("ppE2"),y=n("iInd"),j=n("G0yt"),C=n("3cpT"),E=n("SVse"),D=n("O/5o"),w=n("jLV+"),F=n("Frqi"),M=n("VYMa"),k=n("TSSN");function L(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"h3"),x["\u0275\u0275text"](1),x["\u0275\u0275pipe"](2,"translate"),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"](3);x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate"](x["\u0275\u0275pipeBind1"](2,1,"submission.sections.describe.relationship-lookup.selection-tab.title."+e.routeData.sourceId))}}const B=function(e,t){return{repeatable:e,listId:t}};function V(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementStart"](0,"ds-viewable-collection",13),x["\u0275\u0275listener"]("importObject",(function(t){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"](3).import(t)})),x["\u0275\u0275text"](1,"\n        "),x["\u0275\u0275elementEnd"]()}if(2&e){const e=x["\u0275\u0275nextContext"]().ngVar,t=x["\u0275\u0275nextContext"](2);x["\u0275\u0275property"]("@fadeIn",void 0)("objects",e)("selectionConfig",x["\u0275\u0275pureFunction2"](8,B,t.repeatable,t.listId))("config",t.initialPagination)("hideGear",!0)("context",t.context)("importable",!0)("importConfig",t.importConfig)}}function T(e,t){1&e&&(x["\u0275\u0275element"](0,"ds-loading",14),x["\u0275\u0275pipe"](1,"translate")),2&e&&x["\u0275\u0275propertyInterpolate"]("message",x["\u0275\u0275pipeBind1"](1,1,"loading.search-results"))}function R(e,t){1&e&&(x["\u0275\u0275elementStart"](0,"div",15),x["\u0275\u0275text"](1),x["\u0275\u0275pipe"](2,"translate"),x["\u0275\u0275elementEnd"]()),2&e&&(x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n          ",x["\u0275\u0275pipeBind1"](2,1,"search.results.empty"),"\n        "))}function $(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n        "),x["\u0275\u0275template"](2,L,3,3,"h3",9),x["\u0275\u0275text"](3,"\n        "),x["\u0275\u0275template"](4,V,2,11,"ds-viewable-collection",10),x["\u0275\u0275pipe"](5,"async"),x["\u0275\u0275text"](6,"\n        "),x["\u0275\u0275template"](7,T,2,3,"ds-loading",11),x["\u0275\u0275pipe"](8,"async"),x["\u0275\u0275text"](9,"\n        "),x["\u0275\u0275template"](10,R,3,3,"div",12),x["\u0275\u0275pipe"](11,"async"),x["\u0275\u0275text"](12,"\n      "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngVar,n=x["\u0275\u0275nextContext"](2);x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",e&&0!==(null==e||null==e.payload||null==e.payload.page?null:e.payload.page.length)),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",(null==e?null:e.hasSucceeded)&&!x["\u0275\u0275pipeBind1"](5,4,n.isLoading$)&&(null==e||null==e.payload||null==e.payload.page?null:e.payload.page.length)>0),x["\u0275\u0275advance"](3),x["\u0275\u0275property"]("ngIf",x["\u0275\u0275pipeBind1"](8,6,n.isLoading$)),x["\u0275\u0275advance"](3),x["\u0275\u0275property"]("ngIf",!x["\u0275\u0275pipeBind1"](11,8,n.isLoading$)&&0===(null==e||null==e.payload||null==e.payload.page?null:e.payload.page.length))}}function P(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"div",2),x["\u0275\u0275text"](1,"\n      "),x["\u0275\u0275template"](2,$,13,10,"ng-container",8),x["\u0275\u0275pipe"](3,"async"),x["\u0275\u0275text"](4,"\n    "),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngVar",x["\u0275\u0275pipeBind1"](3,1,e.entriesRD$))}}function _(e,t){1&e&&(x["\u0275\u0275elementStart"](0,"div",2),x["\u0275\u0275text"](1,"\n      "),x["\u0275\u0275elementStart"](2,"ds-alert",16),x["\u0275\u0275text"](3,"\n        "),x["\u0275\u0275elementStart"](4,"p",17),x["\u0275\u0275text"](5),x["\u0275\u0275pipe"](6,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](7,"\n      "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](8,"\n    "),x["\u0275\u0275elementEnd"]()),2&e&&(x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("type","alert-info"),x["\u0275\u0275advance"](3),x["\u0275\u0275textInterpolate"](x["\u0275\u0275pipeBind1"](6,2,"submission.import-external.page.hint")))}const A=function(){return["/mydspace"]};let N=(()=>{class e{constructor(e,t,n,s,o){this.searchConfigService=e,this.externalService=t,this.routeService=n,this.router=s,this.modalService=o,this.entriesRD$=new i.a(null),this.isLoading$=new i.a(!1),this.reload$=new i.a({query:"",source:""}),this.initialPagination=Object.assign(new u.a,{id:"spc",pageSize:10}),this.subs=[]}ngOnInit(){this.label="Journal",this.listId="list-submission-external-sources",this.context=p.a.EntitySearchModalWithNameVariants,this.repeatable=!1,this.routeData={sourceId:"",query:""},this.importConfig={buttonLabel:"submission.sections.describe.relationship-lookup.external-source.import-button-title."+this.label},this.entriesRD$=new i.a(Object(m.c)(Object(d.b)(new f.a,[]))),this.isLoading$=new i.a(!1),this.subs.push(Object(s.a)([this.routeService.getQueryParameterValue("source"),this.routeService.getQueryParameterValue("query")]).pipe(Object(o.a)(1)).subscribe(([e,t])=>{this.reload$.next({query:t,source:e}),this.retrieveExternalSources()}))}getExternalSourceData(e){this.router.navigate([],{queryParams:{source:e.sourceId,query:e.query},replaceUrl:!0}).then(()=>{this.reload$.next({source:e.sourceId,query:e.query}),this.retrieveExternalSources()})}import(e){this.modalRef=this.modalService.open(b.a,{size:"lg"}),this.modalRef.componentInstance.externalSourceEntry=e}ngOnDestroy(){this.subs.filter(e=>Object(v.b)(e)).forEach(e=>e.unsubscribe()),Object(v.b)(this.retrieveExternalSourcesSub)&&this.retrieveExternalSourcesSub.unsubscribe()}retrieveExternalSources(){Object(v.b)(this.retrieveExternalSourcesSub)&&this.retrieveExternalSourcesSub.unsubscribe(),this.retrieveExternalSourcesSub=this.reload$.pipe(Object(a.a)(e=>Object(v.e)(e.source)&&Object(v.e)(e.query)),Object(r.a)(e=>{const t=e.query;return this.routeData.sourceId=e.source,this.routeData.query=t,this.searchConfigService.paginatedSearchOptions.pipe(Object(c.a)(e=>this.isLoading$.next(!0)),Object(a.a)(e=>e.query===t),Object(l.a)(e=>this.externalService.getExternalSourceEntries(this.routeData.sourceId,e).pipe(Object(g.f)())))})).subscribe(e=>{this.entriesRD$.next(e),this.isLoading$.next(!1)})}}return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275directiveInject"](S.a),x["\u0275\u0275directiveInject"](I.a),x["\u0275\u0275directiveInject"](O.a),x["\u0275\u0275directiveInject"](y.g),x["\u0275\u0275directiveInject"](j.u))},e.\u0275cmp=x["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-import-external"]],decls:37,vars:11,consts:[[1,"container"],[1,"row"],[1,"col-md-12"],["id","header",1,"pb-2"],[3,"initExternalSourceData","externalSourceData"],["class","col-md-12",4,"ngIf"],["role","button",1,"btn","btn-outline-secondary",3,"routerLink"],["aria-hidden","true",1,"fa","fa-chevron-left"],[4,"ngVar"],[4,"ngIf"],[3,"objects","selectionConfig","config","hideGear","context","importable","importConfig","importObject",4,"ngIf"],[3,"message",4,"ngIf"],["id","empty-external-entry-list",4,"ngIf"],[3,"objects","selectionConfig","config","hideGear","context","importable","importConfig","importObject"],[3,"message"],["id","empty-external-entry-list"],[3,"type"],[1,"lead","mb-0"]],template:function(e,t){1&e&&(x["\u0275\u0275elementStart"](0,"div",0),x["\u0275\u0275text"](1,"\n  "),x["\u0275\u0275elementStart"](2,"div",1),x["\u0275\u0275text"](3,"\n    "),x["\u0275\u0275elementStart"](4,"div",2),x["\u0275\u0275text"](5,"\n      "),x["\u0275\u0275elementStart"](6,"h2",3),x["\u0275\u0275text"](7),x["\u0275\u0275pipe"](8,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](9,"\n      "),x["\u0275\u0275elementStart"](10,"ds-submission-import-external-searchbar",4),x["\u0275\u0275listener"]("externalSourceData",(function(e){return t.getExternalSourceData(e)})),x["\u0275\u0275text"](11,"\n      "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](12,"\n    "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](13,"\n  "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](14,"\n  "),x["\u0275\u0275elementStart"](15,"div",1),x["\u0275\u0275text"](16,"\n    "),x["\u0275\u0275template"](17,P,5,3,"div",5),x["\u0275\u0275text"](18,"\n    "),x["\u0275\u0275template"](19,_,9,4,"div",5),x["\u0275\u0275text"](20,"\n  "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](21,"\n  "),x["\u0275\u0275elementStart"](22,"div",1),x["\u0275\u0275text"](23,"\n    "),x["\u0275\u0275elementStart"](24,"div",2),x["\u0275\u0275text"](25,"\n      "),x["\u0275\u0275element"](26,"hr"),x["\u0275\u0275text"](27,"\n      "),x["\u0275\u0275elementStart"](28,"a",6),x["\u0275\u0275text"](29,"\n        "),x["\u0275\u0275element"](30,"i",7),x["\u0275\u0275text"](31),x["\u0275\u0275pipe"](32,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](33,"\n    "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](34,"\n  "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](35,"\n"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](36,"\n")),2&e&&(x["\u0275\u0275advance"](7),x["\u0275\u0275textInterpolate"](x["\u0275\u0275pipeBind1"](8,6,"submission.import-external.title")),x["\u0275\u0275advance"](3),x["\u0275\u0275property"]("initExternalSourceData",t.routeData),x["\u0275\u0275advance"](7),x["\u0275\u0275property"]("ngIf",""!==t.routeData.sourceId),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",""===t.routeData.sourceId),x["\u0275\u0275advance"](9),x["\u0275\u0275property"]("routerLink",x["\u0275\u0275pureFunction0"](10,A)),x["\u0275\u0275advance"](3),x["\u0275\u0275textInterpolate1"](" ",x["\u0275\u0275pipeBind1"](32,8,"submission.import-external.back-to-my-dspace"),"\n      "))},directives:[C.a,E.u,y.j,D.a,w.a,F.a,M.a],pipes:[k.e,E.b],styles:[""],data:{animation:[h.a]}}),e})()},SCNa:function(e,t,n){"use strict";n.r(t),n.d(t,"SubmissionEditComponent",(function(){return f}));var i=n("eIep"),s=n("pLZG"),o=n("Kj3r"),a=n("J3qs"),r=n("1QIV"),c=n("7RJT"),l=n("8Y7J"),d=n("lI3o"),p=n("iInd"),u=n("iqTE"),m=n("J/vq"),b=n("TSSN"),h=n("m4Gq");let f=(()=>{class e{constructor(e,t,n,i,s,o,a){this.changeDetectorRef=e,this.notificationsService=t,this.route=n,this.router=i,this.itemDataService=s,this.submissionService=o,this.translate=a,this.subs=[],this.itemLink$=new c.BehaviorSubject(void 0)}ngOnInit(){this.subs.push(this.route.paramMap.pipe(Object(i.a)(e=>this.submissionService.retrieveSubmission(e.get("id"))),Object(s.a)(e=>Object(a.g)(e))).subscribe(e=>{e.hasSucceeded?Object(a.d)(e.payload)?(this.notificationsService.info(null,this.translate.get("submission.general.cannot_submit")),this.router.navigate(["/mydspace"])):(this.submissionId=e.payload.id.toString(),this.collectionId=e.payload.collection.id,this.selfUrl=e.payload._links.self.href,this.sections=e.payload.sections,this.itemLink$.next(e.payload._links.item.href),this.item=e.payload.item,this.submissionDefinition=e.payload.submissionDefinition):404===e.statusCode&&this.router.navigate(["/404"],{skipLocationChange:!0})}),this.itemLink$.pipe(Object(a.f)(),Object(i.a)(e=>this.itemDataService.findByHref(e)),Object(r.c)(),Object(o.a)(300)).subscribe(e=>{this.item=e.payload,this.changeDetectorRef.detectChanges()}))}ngOnDestroy(){this.subs.filter(e=>Object(a.b)(e)).forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.ChangeDetectorRef),l["\u0275\u0275directiveInject"](d.a),l["\u0275\u0275directiveInject"](p.a),l["\u0275\u0275directiveInject"](p.g),l["\u0275\u0275directiveInject"](u.a),l["\u0275\u0275directiveInject"](m.a),l["\u0275\u0275directiveInject"](b.f))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-edit"]],decls:5,vars:6,consts:[[1,"submission-submit-container"],[3,"collectionId","sections","selfUrl","submissionDefinition","item","submissionId"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275text"](1,"\n  "),l["\u0275\u0275element"](2,"ds-submission-form",1),l["\u0275\u0275text"](3,"\n"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](4,"\n")),2&e&&(l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("collectionId",t.collectionId)("sections",t.sections)("selfUrl",t.selfUrl)("submissionDefinition",t.submissionDefinition)("item",t.item)("submissionId",t.submissionId))},directives:[h.a],styles:[""]}),e})()},"T/iP":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("LRne"),s=n("SxV6"),o=n("J3qs"),a=n("oOMw"),r=n("fBXw"),c=n("8Y7J"),l=n("lI3o"),d=n("QjZv"),p=n("YJD6"),u=n("J/vq"),m=n("TSSN"),b=n("SVse"),h=n("4zj/");function f(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"ds-uploader",1),c["\u0275\u0275listener"]("onCompleteItem",(function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().onCompleteItem(t)}))("onUploadError",(function(){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().onUploadError()})),c["\u0275\u0275elementEnd"]()}if(2&e){const e=c["\u0275\u0275nextContext"]();c["\u0275\u0275property"]("dropMsg",e.dropMsg)("dropOverDocumentMsg",e.dropOverDocumentMsg)("enableDragOverDocument",e.enableDragOverDocument)("onBeforeUpload",e.onBeforeUpload)("uploadFilesOptions",e.uploadFilesOptions)}}let v=(()=>{class e{constructor(e,t,n,s,o){this.notificationsService=e,this.operationsService=t,this.sectionService=n,this.submissionService=s,this.translate=o,this.enableDragOverDocument=!0,this.dropOverDocumentMsg="submission.sections.upload.drop-message",this.dropMsg="submission.sections.upload.drop-message",this.subs=[],this.uploadEnabled=Object(i.a)(!1),this.onBeforeUpload=()=>{const e=this.operationsService.jsonPatchByResourceType(this.submissionService.getSubmissionObjectLinkName(),this.submissionId,"sections").subscribe();return this.subs.push(e),e}}ngOnChanges(){this.uploadEnabled=this.sectionService.isSectionAvailable(this.submissionId,this.sectionId)}onCompleteItem(e){this.subs.push(this.uploadEnabled.pipe(Object(s.a)()).subscribe(t=>{if(t){const{sections:t}=e,{errors:n}=e,i=Object(r.a)(n);t&&Object(o.e)(t)&&Object.keys(t).forEach(e=>{const n=Object(a.b)(t[e]),s=i[e];"upload"===e&&(Object(o.d)(s)?this.notificationsService.success(null,this.translate.get("submission.sections.upload.upload-successful")):this.notificationsService.error(null,this.translate.get("submission.sections.upload.upload-failed"))),this.sectionService.updateSectionData(this.submissionId,e,n,s)})}}))}onUploadError(){this.notificationsService.error(null,this.translate.get("submission.sections.upload.upload-failed"))}ngOnDestroy(){this.subs.filter(e=>Object(o.b)(e)).forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](l.a),c["\u0275\u0275directiveInject"](d.a),c["\u0275\u0275directiveInject"](p.a),c["\u0275\u0275directiveInject"](u.a),c["\u0275\u0275directiveInject"](m.f))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-upload-files"]],inputs:{collectionId:"collectionId",submissionId:"submissionId",sectionId:"sectionId",uploadFilesOptions:"uploadFilesOptions"},features:[c["\u0275\u0275NgOnChangesFeature"]],decls:2,vars:1,consts:[[3,"dropMsg","dropOverDocumentMsg","enableDragOverDocument","onBeforeUpload","uploadFilesOptions","onCompleteItem","onUploadError",4,"ngIf"],[3,"dropMsg","dropOverDocumentMsg","enableDragOverDocument","onBeforeUpload","uploadFilesOptions","onCompleteItem","onUploadError"]],template:function(e,t){1&e&&(c["\u0275\u0275template"](0,f,1,5,"ds-uploader",0),c["\u0275\u0275text"](1,"\n")),2&e&&c["\u0275\u0275property"]("ngIf",t.uploadFilesOptions.url)},directives:[b.u,h.a],encapsulation:2}),e})()},THnG:function(e,t,n){"use strict";n.r(t),n.d(t,"SubmissionSubmitComponent",(function(){return h}));var i=n("J3qs"),s=n("7RJT"),o=n("eIep"),a=n("Kj3r"),r=n("1QIV"),c=n("8Y7J"),l=n("lI3o"),d=n("iInd"),p=n("iqTE"),u=n("J/vq"),m=n("TSSN"),b=n("m4Gq");let h=(()=>{class e{constructor(e,t,n,i,o,a,r,c){this.changeDetectorRef=e,this.notificationsService=t,this.router=n,this.itemDataService=i,this.submissionService=o,this.translate=a,this.viewContainerRef=r,this.route=c,this.itemLink$=new s.BehaviorSubject(void 0),this.subs=[],this.route.queryParams.subscribe(e=>{this.collectionParam=e.collection})}ngOnInit(){this.subs.push(this.submissionService.createSubmission(this.collectionParam).subscribe(e=>{Object(i.g)(e)&&(Object(i.d)(e)?(this.notificationsService.info(null,this.translate.get("submission.general.cannot_submit")),this.router.navigate(["/mydspace"])):(this.collectionId=e.collection.id,this.sections=e.sections,this.selfUrl=e._links.self.href,this.submissionDefinition=e.submissionDefinition,this.submissionId=e.id,this.itemLink$.next(e._links.item.href),this.item=e.item))}),this.itemLink$.pipe(Object(i.f)(),Object(o.a)(e=>this.itemDataService.findByHref(e)),Object(r.c)(),Object(a.a)(300)).subscribe(e=>{this.item=e.payload,this.changeDetectorRef.detectChanges()}))}ngOnDestroy(){this.subs.filter(e=>Object(i.b)(e)).forEach(e=>e.unsubscribe()),this.viewContainerRef.clear(),this.changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](c.ChangeDetectorRef),c["\u0275\u0275directiveInject"](l.a),c["\u0275\u0275directiveInject"](d.g),c["\u0275\u0275directiveInject"](p.a),c["\u0275\u0275directiveInject"](u.a),c["\u0275\u0275directiveInject"](m.f),c["\u0275\u0275directiveInject"](c.ViewContainerRef),c["\u0275\u0275directiveInject"](d.a))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-submit"]],decls:8,vars:6,consts:[[1,"submission-submit-container"],[3,"collectionId","sections","selfUrl","submissionDefinition","item","submissionId"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div",0),c["\u0275\u0275text"](1,"\n  "),c["\u0275\u0275elementStart"](2,"div",0),c["\u0275\u0275text"](3,"\n    "),c["\u0275\u0275element"](4,"ds-submission-form",1),c["\u0275\u0275text"](5,"\n  "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](6,"\n"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](7,"\n")),2&e&&(c["\u0275\u0275advance"](4),c["\u0275\u0275property"]("collectionId",t.collectionId)("sections",t.sections)("selfUrl",t.selfUrl)("submissionDefinition",t.submissionDefinition)("item",t.item)("submissionId",t.submissionId))},directives:[b.a],styles:[""]}),e})()},TTdl:function(e,t,n){"use strict";var i=n("J3qs");const s=/([^\/]+)/g,o=/\/sections\/(.*)/;t.a=e=>("string"==typeof e?[e]:e).map(e=>e.match(s)&&e.match(s).length>2?{sectionId:e.match(s)[1],fieldId:e.match(s)[2],fieldIndex:Object(i.b)(e.match(s)[3])?+e.match(s)[3]:0,originalPath:e}:{sectionId:e.match(o)[1],originalPath:e})},TkMu:function(e,t,n){var i={"./custom/app/submission/submit/submission-submit.component":["cSSl",76]};function s(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],s=t[0];return n.e(t[1]).then((function(){return n(s)}))}s.keys=function(){return Object.keys(i)},s.id="TkMu",e.exports=s},"Uql/":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));const i=new Map;function s(e){return function(t){t&&i.set(e,t)}}function o(e){return i.get(e)}},YJD6:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var i=n("itXk"),s=n("lJxs"),o=n("/uUt"),a=n("pLZG"),r=n("IzEk"),c=n("LvDl"),l=n("J3qs"),d=n("4jMI"),p=n("LP5c"),u=n("drGc"),m=n("TTdl"),b=n("xvwT"),h=n("4GeW"),f=n("oOMw"),v=n("QOHy"),g=n("8Y7J"),x=n("lI3o"),S=n("nluj"),I=n("J/vq"),O=n("tqRt"),y=n("TSSN");let j=(()=>{class e{constructor(e,t,n,i,s){this.notificationsService=e,this.scrollToService=t,this.submissionService=n,this.store=i,this.translate=s}checkSectionErrors(e,t,n,i,s=[]){if(Object(l.d)(i))this.store.dispatch(new d.r(e,t)),this.store.dispatch(new b.e(n));else if(!Object(c.isEqual)(i,s)){const e=[];i.forEach(t=>{Object(m.a)(t.path).forEach(i=>{if(i.fieldId){const s=i.fieldId.replace(/\./g,"_"),o=new b.b(n,s,i.fieldIndex,t.message);this.store.dispatch(o),e.push(s)}})}),s.forEach(t=>{Object(m.a)(t.path).forEach(t=>{if(t.fieldId){const i=t.fieldId.replace(/\./g,"_");if(!e.includes(i)){const e=new b.h(n,i,t.fieldIndex);this.store.dispatch(e)}}})})}}dispatchRemoveSectionErrors(e,t){this.store.dispatch(new d.r(e,t))}dispatchSetSectionFormId(e,t,n){this.store.dispatch(new d.E(e,t,n))}getSectionData(e,t,n){return this.store.select(Object(p.d)(e,t)).pipe(Object(s.a)(e=>n===h.a.SubmissionForm?Object(f.b)(e):e),Object(o.a)())}getSectionErrors(e,t){return this.store.select(Object(p.e)(e,t)).pipe(Object(o.a)())}getSectionState(e,t,n){return this.store.select(Object(p.f)(e,t)).pipe(Object(a.a)(e=>Object(l.b)(e)),Object(s.a)(e=>e),Object(s.a)(e=>Object(l.b)(e.data)&&n===h.a.SubmissionForm?Object.assign({},e,{data:Object(f.b)(e.data)}):e),Object(o.a)())}isSectionValid(e,t){return this.store.select(Object(p.f)(e,t)).pipe(Object(a.a)(e=>Object(l.b)(e)),Object(s.a)(e=>e.isValid),Object(o.a)())}isSectionActive(e,t){return this.submissionService.getActiveSectionId(e).pipe(Object(s.a)(e=>t===e),Object(o.a)())}isSectionEnabled(e,t){return this.store.select(Object(p.f)(e,t)).pipe(Object(a.a)(e=>Object(l.b)(e)),Object(s.a)(e=>e.enabled),Object(o.a)())}isSectionReadOnly(e,t,n){return this.store.select(Object(p.f)(e,t)).pipe(Object(a.a)(e=>Object(l.b)(e)),Object(s.a)(e=>Object(l.e)(e.visibility)&&"READONLY"===e.visibility.other&&n!==u.a.WorkspaceItem),Object(o.a)())}isSectionAvailable(e,t){return this.store.select(Object(p.c)(e)).pipe(Object(a.a)(e=>Object(l.h)(e)),Object(s.a)(e=>Object(l.h)(e.sections)&&Object(l.h)(e.sections[t])),Object(o.a)())}isSectionTypeAvailable(e,t){return this.store.select(Object(p.c)(e)).pipe(Object(a.a)(e=>Object(l.h)(e)),Object(s.a)(e=>Object(l.h)(e.sections)&&Object(l.h)(Object(c.findKey)(e.sections,{sectionType:t}))),Object(o.a)())}addSection(e,t){this.store.dispatch(new d.m(e,t)),this.scrollToService.scrollTo({target:t,offset:-70})}removeSection(e,t){this.store.dispatch(new d.h(e,t))}updateSectionData(e,t,n,s=[],o){if(Object(l.e)(n)){const c=this.isSectionAvailable(e,t),l=this.isSectionEnabled(e,t);Object(i.a)(c,l).pipe(Object(r.a)(1),Object(a.a)(([e,t])=>e)).subscribe(([i,a])=>{this.store.dispatch(new d.G(e,t,n,s,o))})}}setSectionError(e,t,n){this.store.dispatch(new d.n(e,t,n))}setSectionStatus(e,t,n){this.store.dispatch(new d.C(e,t,n))}computeSectionConfiguredMetadata(e){const t=[],n="string"==typeof e?JSON.parse(e,v.S):e;return n.rows&&!Object(l.d)(n.rows)&&n.rows.forEach(e=>{e.fields&&!Object(l.d)(e.fields)&&e.fields.forEach(e=>{e.selectableMetadata&&!Object(l.d)(e.selectableMetadata)&&e.selectableMetadata.forEach(e=>{t.includes(e.metadata)||t.push(e.metadata)})})}),t}}return e.\u0275fac=function(t){return new(t||e)(g["\u0275\u0275inject"](x.a),g["\u0275\u0275inject"](S.b),g["\u0275\u0275inject"](I.a),g["\u0275\u0275inject"](O.h),g["\u0275\u0275inject"](y.f))},e.\u0275prov=g["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})()},Yfyx:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i=n("8Y7J"),s=n("Uql/"),o=n("ac5F"),a=n("b8BE"),r=n("SVse"),c=n("G0yt"),l=n("VYMa"),d=n("TSSN");const p=["sectionRef"];function u(e,t){1&e&&i["\u0275\u0275element"](0,"i",17)}function m(e,t){1&e&&i["\u0275\u0275element"](0,"i",18)}function b(e,t){1&e&&i["\u0275\u0275element"](0,"i",19)}function h(e,t){1&e&&i["\u0275\u0275element"](0,"span",20)}function f(e,t){1&e&&i["\u0275\u0275element"](0,"span",21)}function v(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"a",22),i["\u0275\u0275listener"]("click",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](3).removeSection(t)})),i["\u0275\u0275text"](1,"\n            "),i["\u0275\u0275element"](2,"i",23),i["\u0275\u0275text"](3,"\n          "),i["\u0275\u0275elementEnd"]()}}function g(e,t){if(1&e&&(i["\u0275\u0275text"](0,"\n        "),i["\u0275\u0275elementStart"](1,"span",8),i["\u0275\u0275text"](2),i["\u0275\u0275pipe"](3,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](4,"\n        "),i["\u0275\u0275elementStart"](5,"div",9),i["\u0275\u0275text"](6,"\n          "),i["\u0275\u0275template"](7,u,1,0,"i",10),i["\u0275\u0275pipe"](8,"async"),i["\u0275\u0275text"](9,"\n          "),i["\u0275\u0275template"](10,m,1,0,"i",11),i["\u0275\u0275text"](11,"\n          "),i["\u0275\u0275template"](12,b,1,0,"i",12),i["\u0275\u0275pipe"](13,"async"),i["\u0275\u0275text"](14,"\n          "),i["\u0275\u0275elementStart"](15,"a",13),i["\u0275\u0275text"](16,"\n            "),i["\u0275\u0275template"](17,h,1,0,"span",14),i["\u0275\u0275text"](18,"\n            "),i["\u0275\u0275template"](19,f,1,0,"span",15),i["\u0275\u0275text"](20,"\n          "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](21,"\n          "),i["\u0275\u0275template"](22,v,4,0,"a",16),i["\u0275\u0275text"](23,"\n        "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](24,"\n      ")),2&e){const e=i["\u0275\u0275nextContext"](2),t=i["\u0275\u0275reference"](1);i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](3,7,"submission.sections."+e.sectionData.header)),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](8,9,t.isValid())&&!t.hasErrors()),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",t.hasErrors()),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](13,11,t.isValid())&&!t.hasErrors()),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngIf",t.isOpen()),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",!t.isOpen()),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",!t.isMandatory())}}function x(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"ds-alert",28),i["\u0275\u0275listener"]("close",(function(){i["\u0275\u0275restoreView"](e);const n=t.index;return i["\u0275\u0275nextContext"](4),i["\u0275\u0275reference"](1).removeError(n)})),i["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=i["\u0275\u0275nextContext"](4);i["\u0275\u0275property"]("content",e)("dismissible",!0)("type",n.AlertTypeEnum.Error)}}function S(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",5),i["\u0275\u0275text"](1,"\n          "),i["\u0275\u0275template"](2,x,1,3,"ds-alert",27),i["\u0275\u0275text"](3,"\n        "),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"](3),t=i["\u0275\u0275reference"](1);i["\u0275\u0275propertyInterpolate1"]("id","sectionGenericError_",e.sectionData.id,""),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngForOf",t.getErrors())}}function I(e,t){1&e&&i["\u0275\u0275elementContainer"](0)}function O(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275text"](0,"\n        "),i["\u0275\u0275template"](1,S,4,2,"div",24),i["\u0275\u0275text"](2,"\n        "),i["\u0275\u0275elementStart"](3,"div",25),i["\u0275\u0275listener"]("click",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](2),i["\u0275\u0275reference"](1).setFocus(t)})),i["\u0275\u0275text"](4,"\n          "),i["\u0275\u0275template"](5,I,1,0,"ng-container",26),i["\u0275\u0275text"](6,"\n        "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](7,"\n      ")}if(2&e){const e=i["\u0275\u0275nextContext"](2),t=i["\u0275\u0275reference"](1);i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",t.hasGenericErrors()),i["\u0275\u0275advance"](2),i["\u0275\u0275propertyInterpolate1"]("id","sectionContent_",e.sectionData.id,""),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngComponentOutlet",e.getSectionContent())("ngComponentOutletInjector",e.objectInjector)}}function y(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"ngb-accordion",3,4),i["\u0275\u0275listener"]("panelChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"](),i["\u0275\u0275reference"](1).sectionChange(t)})),i["\u0275\u0275text"](2,"\n    "),i["\u0275\u0275elementStart"](3,"ngb-panel",5),i["\u0275\u0275text"](4,"\n      "),i["\u0275\u0275template"](5,g,25,13,"ng-template",6),i["\u0275\u0275text"](6,"\n      "),i["\u0275\u0275template"](7,O,8,4,"ng-template",7),i["\u0275\u0275text"](8,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](9,"\n  "),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275propertyInterpolate"]("activeIds",e.sectionData.id),i["\u0275\u0275property"]("destroyOnHide",!1),i["\u0275\u0275advance"](3),i["\u0275\u0275propertyInterpolate"]("id",e.sectionData.id)}}const j=function(e){return{"section-focus":e}};let C=(()=>{class e{constructor(e){this.injector=e,this.AlertTypeEnum=o.a}ngOnInit(){this.objectInjector=i.Injector.create({providers:[{provide:"collectionIdProvider",useFactory:()=>this.collectionId,deps:[]},{provide:"sectionDataProvider",useFactory:()=>this.sectionData,deps:[]},{provide:"submissionIdProvider",useFactory:()=>this.submissionId,deps:[]}],parent:this.injector})}removeSection(e){e.preventDefault(),e.stopPropagation(),this.sectionRef.removeSection(this.submissionId,this.sectionData.id)}getSectionContent(){return Object(s.b)(this.sectionData.sectionType)}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](i.Injector))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-section-container"]],viewQuery:function(e,t){var n;1&e&&i["\u0275\u0275viewQuery"](p,!0),2&e&&i["\u0275\u0275queryRefresh"](n=i["\u0275\u0275loadQuery"]())&&(t.sectionRef=n.first)},inputs:{collectionId:"collectionId",sectionData:"sectionData",submissionId:"submissionId"},decls:7,vars:11,consts:[["dsSection","",3,"ngClass","mandatory","submissionId","sectionType","sectionId"],["sectionRef","sectionRef"],[3,"activeIds","destroyOnHide","panelChange",4,"ngIf"],[3,"activeIds","destroyOnHide","panelChange"],["acc","ngbAccordion"],[3,"id"],["ngbPanelTitle",""],["ngbPanelContent",""],[1,"float-left"],[1,"d-inline-block","float-right"],["class","fas fa-exclamation-circle text-warning mr-3","aria-hidden","true",4,"ngIf"],["class","fas fa-exclamation-circle text-danger mr-3","aria-hidden","true",4,"ngIf"],["class","fas fa-check-circle text-success mr-3","aria-hidden","true",4,"ngIf"],["aria-label","Close",1,"close"],["class","fas fa-chevron-up fa-fw","aria-hidden","true",4,"ngIf"],["class","fas fa-chevron-down fa-fw","aria-hidden","true",4,"ngIf"],["href","#","class","close mr-3",3,"click",4,"ngIf"],["aria-hidden","true",1,"fas","fa-exclamation-circle","text-warning","mr-3"],["aria-hidden","true",1,"fas","fa-exclamation-circle","text-danger","mr-3"],["aria-hidden","true",1,"fas","fa-check-circle","text-success","mr-3"],["aria-hidden","true",1,"fas","fa-chevron-up","fa-fw"],["aria-hidden","true",1,"fas","fa-chevron-down","fa-fw"],["href","#",1,"close","mr-3",3,"click"],["aria-hidden","true",1,"fas","fa-trash-o"],[3,"id",4,"ngIf"],[3,"id","click"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[3,"content","dismissible","type","close",4,"ngFor","ngForOf"],[3,"content","dismissible","type","close"]],template:function(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",0,1),i["\u0275\u0275text"](2,"\n  "),i["\u0275\u0275template"](3,y,10,3,"ngb-accordion",2),i["\u0275\u0275pipe"](4,"async"),i["\u0275\u0275text"](5,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](6,"\n")),2&e){const e=i["\u0275\u0275reference"](1);i["\u0275\u0275property"]("ngClass",i["\u0275\u0275pureFunction1"](9,j,e.isSectionActive()))("mandatory",t.sectionData.mandatory)("submissionId",t.submissionId)("sectionType",t.sectionData.sectionType)("sectionId",t.sectionData.id),i["\u0275\u0275attribute"]("id",t.sectionData.id),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](4,7,e.isEnabled()))}},directives:[a.a,r.r,r.u,c.a,c.K,c.N,c.L,r.s,r.t,l.a],pipes:[r.b,d.e],styles:["[_nghost-%COMP%]     .card{margin-bottom:var(--ds-submission-sections-margin-bottom);overflow:unset}.section-focus[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius);-webkit-box-shadow:var(--bs-btn-focus-box-shadow);box-shadow:var(--bs-btn-focus-box-shadow)}[_nghost-%COMP%]     .card:first-of-type{border-bottom:var(--bs-card-border-width) solid var(--bs-card-border-color)!important;border-bottom-left-radius:var(--bs-card-border-radius)!important;border-bottom-right-radius:var(--bs-card-border-radius)!important}[_nghost-%COMP%]     .card-header button{-webkit-box-shadow:none!important;box-shadow:none!important;width:100%}"]}),e})()},YoQ9:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("JTKQ"),s=n("8Y7J");function o(e,t){}let a=(()=>{class e extends i.a{getComponentName(){return"SubmissionEditComponent"}importThemedComponent(e){return n("3aq+")(`./${e}/app/submission/edit/submission-edit.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(null,"SCNa"))}}return e.\u0275fac=function(t){return r(t||e)},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-themed-submission-edit"]],features:[s["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:0,consts:[["vcr",""]],template:function(e,t){1&e&&(s["\u0275\u0275template"](0,o,0,0,"ng-template",null,0,s["\u0275\u0275templateRefExtractor"]),s["\u0275\u0275text"](2,"\n"))},encapsulation:2}),e})();const r=s["\u0275\u0275getInheritedFactory"](a)},b8BE:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("lJxs"),s=n("LvDl"),o=n("J3qs"),a=n("TTdl"),r=n("8Y7J"),c=n("J/vq"),l=n("YJD6");let d=(()=>{class e{constructor(e,t,n){this.changeDetectorRef=e,this.submissionService=t,this.sectionService=n,this.mandatory=!0,this.genericSectionErrors=[],this.allSectionErrors=[],this.active=!0,this.sectionState=this.mandatory,this.subs=[]}ngOnInit(){this.valid=this.sectionService.isSectionValid(this.submissionId,this.sectionId).pipe(Object(i.a)(e=>(e&&this.resetErrors(),e))),this.subs.push(this.sectionService.getSectionState(this.submissionId,this.sectionId,this.sectionType).pipe(Object(i.a)(e=>e.errors)).subscribe(e=>{Object(o.e)(e)?e.forEach(e=>{Object(a.a)(e.path).forEach(t=>{t.fieldId?this.allSectionErrors.push(e.message):this.genericSectionErrors=Object(s.uniq)(this.genericSectionErrors.concat(e.message))})}):this.resetErrors()}),this.submissionService.getActiveSectionId(this.submissionId).subscribe(e=>{const t=this.active;this.active=e===this.sectionId,t!==this.active&&(this.changeDetectorRef.detectChanges(),!this.active&&Object(o.g)(e)&&this.submissionService.dispatchSave(this.submissionId))})),this.enabled=this.sectionService.isSectionEnabled(this.submissionId,this.sectionId)}ngOnDestroy(){this.subs.filter(e=>Object(o.b)(e)).forEach(e=>e.unsubscribe())}sectionChange(e){this.sectionState=e.nextState}isOpen(){return this.sectionState}isMandatory(){return this.mandatory}isSectionActive(){return this.active}isEnabled(){return this.enabled}isValid(){return this.valid}removeSection(e,t){this.sectionService.removeSection(e,t)}hasGenericErrors(){return this.genericSectionErrors&&this.genericSectionErrors.length>0}hasErrors(){return this.genericSectionErrors&&this.genericSectionErrors.length>0||this.allSectionErrors&&this.allSectionErrors.length>0}getErrors(){return this.genericSectionErrors}setFocus(e){this.active||this.submissionService.setActiveSection(this.submissionId,this.sectionId)}removeError(e){this.genericSectionErrors.splice(e)}resetErrors(){Object(o.e)(this.genericSectionErrors)&&this.sectionService.dispatchRemoveSectionErrors(this.submissionId,this.sectionId),this.genericSectionErrors=[],this.allSectionErrors=[]}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](r.ChangeDetectorRef),r["\u0275\u0275directiveInject"](c.a),r["\u0275\u0275directiveInject"](l.a))},e.\u0275dir=r["\u0275\u0275defineDirective"]({type:e,selectors:[["","dsSection",""]],inputs:{mandatory:"mandatory",sectionId:"sectionId",sectionType:"sectionType",submissionId:"submissionId"},exportAs:["sectionRef"]}),e})()},c3nT:function(e,t,n){"use strict";n.d(t,"a",(function(){return va}));var i=n("pKmL"),s=n("PCNd"),o=n("mrSG"),a=n("itXk"),r=n("lJxs"),c=n("vkgz"),l=n("5+tZ"),d=n("IzEk"),p=n("cBqT"),u=n("/uUt"),m=n("pLZG"),b=n("LvDl"),h=n("Q5/L"),f=n("NFsL"),v=n("JX91"),g=n("J3qs"),x=n("8Y7J");let S=(()=>{class e{constructor(e,t,n){this.injectedCollectionId=e,this.injectedSectionData=t,this.injectedSubmissionId=n,this.collectionId=e,this.sectionData=t,this.submissionId=n}ngOnInit(){this.onSectionInit(),this.updateSectionStatus()}updateSectionStatus(){this.sectionStatusSub=this.getSectionStatus().pipe(Object(m.a)(e=>Object(g.h)(e)),Object(v.a)(!0)).subscribe(e=>{this.sectionService.setSectionStatus(this.submissionId,this.sectionData.id,e)})}ngOnDestroy(){Object(g.b)(this.sectionStatusSub)&&this.sectionStatusSub.unsubscribe(),this.onSectionDestroy()}}return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275directiveInject"]("collectionIdProvider"),x["\u0275\u0275directiveInject"]("sectionDataProvider"),x["\u0275\u0275directiveInject"]("submissionIdProvider"))},e.\u0275cmp=x["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-section-model"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();var I=n("+ZI/"),O=n("0VLH");class y{constructor(e=null,t=null){this._path=e,this._value=t}get path(){return this._path}set path(e){this._path=e}get value(){return this._value}set value(e){this._value=e}delete(){this._value=null,this._path=null}isPathEqual(e){return this._path&&Object(b.isEqual)(this._path,e)}}var j=n("Uql/"),C=n("4GeW"),E=n("J/vq"),D=n("ITak"),w=n("lI3o"),F=n("YJD6"),M=n("Gx58"),k=n("1QIV"),L=n("fHtB"),B=n("mycY"),V=n("X/78"),T=n("84Zn"),R=n("AytR"),$=n("TSSN"),P=n("SVse"),_=n("Frqi"),A=n("hqmO");const N=["formRef"];function q(e,t){1&e&&x["\u0275\u0275element"](0,"ds-loading",2)}function U(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementStart"](0,"ds-form",3,4),x["\u0275\u0275listener"]("dfChange",(function(t){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"]().onChange(t)}))("dfFocus",(function(t){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"]().onFocus(t)}))("remove",(function(t){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"]().onRemove(t)}))("ngbEvent",(function(t){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"]().onCustomEvent(t)}))("removeArrayItem",(function(t){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"]().onRemove(t)})),x["\u0275\u0275elementEnd"]()}if(2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275property"]("formId",e.formId)("formModel",e.formModel)("displaySubmit",!1)("displayCancel",!1)}}let J=(()=>{let e=class extends S{constructor(e,t,n,i,s,o,a,r,c,l,d,p,u,m,b){super(u,m,b),this.cdr=e,this.formBuilderService=t,this.formOperationsService=n,this.formService=i,this.formConfigService=s,this.notificationsService=o,this.sectionService=a,this.submissionService=r,this.translate=c,this.submissionObjectService=l,this.objectCache=d,this.requestService=p,this.injectedCollectionId=u,this.injectedSectionData=m,this.injectedSubmissionId=b,this.isUpdating=!1,this.isLoading=!0,this.fieldsOnTheirWayToBeRemoved=new Map,this.formData=Object.create({}),this.previousValue=new y,this.subs=[]}onSectionInit(){this.pathCombiner=new O.a("sections",this.sectionData.id),this.formId=this.formService.getUniqueId(this.sectionData.id),this.sectionService.dispatchSetSectionFormId(this.submissionId,this.sectionData.id,this.formId),this.formConfigService.findByHref(this.sectionData.config).pipe(Object(r.a)(e=>e.payload),Object(c.a)(e=>this.formConfig=e),Object(l.a)(()=>Object(a.a)([this.sectionService.getSectionData(this.submissionId,this.sectionData.id,this.sectionData.sectionType),this.submissionObjectService.findById(this.submissionId,!0,!1,Object(T.a)("item")).pipe(Object(k.i)(),Object(k.o)())])),Object(d.a)(1)).subscribe(([e,t])=>{Object(g.j)(this.formModel)&&(this.sectionData.errors=[],this.workspaceItem=t,this.initForm(e),this.sectionData.data=e,this.subscriptions(),this.isLoading=!1,this.cdr.detectChanges())})}onSectionDestroy(){this.subs.filter(e=>Object(g.b)(e)).forEach(e=>e.unsubscribe())}getSectionStatus(){return this.formService.isValid(this.formId)}hasMetadataEnrichment(e){const t={};Object.keys(e).forEach(n=>{this.sectionMetadata&&this.sectionMetadata.includes(n)&&(t[n]=e[n])});const n=[],i=Object(M.a)(t,this.formData);return Object.keys(i).forEach(e=>{i[e].forEach(t=>{t.hasOwnProperty("value")&&Object(b.findIndex)(this.formData[e],{value:t.value})<0&&n.push(t)})}),Object(g.e)(n)}initForm(e){try{this.formModel=this.formBuilderService.modelFromConfiguration(this.submissionId,this.formConfig,this.collectionId,e,this.submissionService.getSubmissionScope());const t=this.sectionService.computeSectionConfiguredMetadata(this.formConfig);this.sectionService.updateSectionData(this.submissionId,this.sectionData.id,e,[],t)}catch(t){const e={message:this.translate.instant("error.submission.sections.init-form-error")+t.toString(),path:"/sections/"+this.sectionData.id};console.error(t.stack),this.sectionService.setSectionError(this.submissionId,this.sectionData.id,e)}}updateForm(e,t){Object(g.e)(e)&&!Object(b.isEqual)(e,this.sectionData.data)?(this.sectionData.data=e,this.hasMetadataEnrichment(e)?(this.isUpdating=!0,this.formModel=null,this.cdr.detectChanges(),this.initForm(e),this.checksForErrors(t),this.isUpdating=!1,this.cdr.detectChanges()):(Object(g.e)(t)||Object(g.e)(this.sectionData.errors))&&this.checksForErrors(t)):(Object(g.e)(t)||Object(g.e)(this.sectionData.errors))&&this.checksForErrors(t)}checksForErrors(e){this.formService.isFormInitialized(this.formId).pipe(Object(p.a)(e=>!0===e&&!this.isUpdating)).subscribe(()=>{this.sectionService.checkSectionErrors(this.submissionId,this.sectionData.id,this.formId,e,this.sectionData.errors),this.sectionData.errors=e,this.cdr.detectChanges()})}subscriptions(){this.subs.push(this.formService.getFormData(this.formId).pipe(Object(u.a)()).subscribe(e=>{this.formData=e}),this.sectionService.getSectionState(this.submissionId,this.sectionData.id,this.sectionData.sectionType).pipe(Object(m.a)(e=>Object(g.e)(e)&&(Object(g.e)(e.data)||Object(g.e)(e.errors))),Object(u.a)()).subscribe(e=>{this.fieldsOnTheirWayToBeRemoved=new Map,this.sectionMetadata=e.metadata,this.updateForm(e.data,e.errors)}))}onChange(e){this.formOperationsService.dispatchOperationsFromEvent(this.pathCombiner,e,this.previousValue,this.hasStoredValue(this.formBuilderService.getId(e.model),this.formOperationsService.getArrayIndexFromEvent(e)));const t=this.formOperationsService.getFieldPathSegmentedFromChangeEvent(e),n=this.formOperationsService.getFieldValueFromChangeEvent(e);-1!==R.a.submission.autosave.metadata.indexOf(t)&&Object(g.e)(n)&&this.submissionService.dispatchSave(this.submissionId)}onFocus(e){const t=this.formOperationsService.getFieldValueFromChangeEvent(e),n=this.formBuilderService.getPath(e.model);this.formBuilderService.hasMappedGroupValue(e.model)?(this.previousValue.path=n,this.previousValue.value=this.formOperationsService.getQualdropValueMap(e)):Object(g.e)(t)&&("object"==typeof t&&Object(g.e)(t.value)||"string"==typeof t)&&(this.previousValue.path=n,this.previousValue.value=t)}onRemove(e){const t=this.formBuilderService.getId(e.model),n=this.formOperationsService.getArrayIndexFromEvent(e);if(this.fieldsOnTheirWayToBeRemoved.has(t)){const e=this.fieldsOnTheirWayToBeRemoved.get(t);e.push(n),this.fieldsOnTheirWayToBeRemoved.set(t,e)}else this.fieldsOnTheirWayToBeRemoved.set(t,[n]);this.formOperationsService.dispatchOperationsFromEvent(this.pathCombiner,e,this.previousValue,this.hasStoredValue(t,n))}hasStoredValue(e,t){return!!Object(g.e)(this.sectionData.data)&&this.sectionData.data.hasOwnProperty(e)&&Object(g.e)(this.sectionData.data[e][t])&&!this.isFieldToRemove(e,t)}isFieldToRemove(e,t){return this.fieldsOnTheirWayToBeRemoved.has(e)&&this.fieldsOnTheirWayToBeRemoved.get(e).includes(t)}onCustomEvent(e){this.formOperationsService.dispatchOperationsFromEvent(this.pathCombiner,e,this.previousValue,null)}};return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275directiveInject"](x.ChangeDetectorRef),x["\u0275\u0275directiveInject"](h.a),x["\u0275\u0275directiveInject"](D.a),x["\u0275\u0275directiveInject"](f.a),x["\u0275\u0275directiveInject"](I.a),x["\u0275\u0275directiveInject"](w.a),x["\u0275\u0275directiveInject"](F.a),x["\u0275\u0275directiveInject"](E.a),x["\u0275\u0275directiveInject"]($.f),x["\u0275\u0275directiveInject"](L.a),x["\u0275\u0275directiveInject"](B.a),x["\u0275\u0275directiveInject"](V.a),x["\u0275\u0275directiveInject"]("collectionIdProvider"),x["\u0275\u0275directiveInject"]("sectionDataProvider"),x["\u0275\u0275directiveInject"]("submissionIdProvider"))},e.\u0275cmp=x["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-section-form"]],viewQuery:function(e,t){var n;1&e&&x["\u0275\u0275viewQuery"](N,!0),2&e&&x["\u0275\u0275queryRefresh"](n=x["\u0275\u0275loadQuery"]())&&(t.formRef=n.first)},features:[x["\u0275\u0275InheritDefinitionFeature"]],decls:4,vars:2,consts:[["message","Loading...",4,"ngIf"],[3,"formId","formModel","displaySubmit","displayCancel","dfChange","dfFocus","remove","ngbEvent","removeArrayItem",4,"ngIf"],["message","Loading..."],[3,"formId","formModel","displaySubmit","displayCancel","dfChange","dfFocus","remove","ngbEvent","removeArrayItem"],["formRef","formComponent"]],template:function(e,t){1&e&&(x["\u0275\u0275template"](0,q,1,0,"ds-loading",0),x["\u0275\u0275text"](1,"\n"),x["\u0275\u0275template"](2,U,2,4,"ds-form",1),x["\u0275\u0275text"](3,"\n")),2&e&&(x["\u0275\u0275property"]("ngIf",t.isLoading),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",!t.isLoading&&t.formModel))},directives:[P.u,_.a,A.a],styles:[""]}),e=Object(o.b)([Object(j.a)(C.a.SubmissionForm)],e),e})();var G=n("b8BE"),Q=n("wQzj"),Y=n("yAsG"),z=n("m4Gq"),H=n("ph1m"),K=n("Yfyx"),X=n("tqRt"),Z=n("7bNT"),W=n("33F9"),ee=n("Cfvw"),te=n("LRne"),ne=n("eIep"),ie=n("JIr8"),se=n("zp1y"),oe=n("fBXw"),ae=n("4jMI"),re=n("TTdl"),ce=n("QjZv");function le(e,t,n){return e?e[t.sections[n].formId]:null}function de(e,t,n,i){if(i||n!==C.a.SubmissionForm)return t;if(!e||!e.touched)return[];const s=[];return t.forEach(t=>{Object(re.a)(t.path).forEach(n=>{n.fieldId&&e.touched[n.fieldId]&&s.push(t)})}),s}const pe=[(()=>{class e{constructor(e,t,n,i,s,o,a,p){this.actions$=e,this.notificationsService=t,this.operationsService=n,this.sectionService=i,this.store$=s,this.submissionService=o,this.submissionObjectService=a,this.translate=p,this.loadForm$=this.actions$.pipe(Object(Z.f)(ae.F.INIT_SUBMISSION_FORM),Object(r.a)(e=>{const t=e.payload.submissionDefinition,n=[];return t.sections.page.forEach(t=>{const i=t._links.self.href||t._links.self,s=i.substr(i.lastIndexOf("/")+1),o=t._links.config?t._links.config.href||t._links.config:"",a=t.mandatory||Object(g.e)(e.payload.sections)&&e.payload.sections.hasOwnProperty(s);let r;r=t.sectionType!==C.a.SubmissionForm?Object(g.h)(e.payload.sections)&&Object(g.h)(e.payload.sections[s])?e.payload.sections[s]:Object.create(null):e.payload.item.metadata,n.push(new ae.o(e.payload.submissionId,s,t.header,o,t.mandatory,t.sectionType,t.visibility,a,r,null))}),{action:e,definition:t,mappedActions:n}}),Object(l.a)(e=>Object(ee.a)(e.mappedActions.concat(new ae.c(e.action.payload.submissionId))))),this.resetForm$=this.actions$.pipe(Object(Z.f)(ae.F.RESET_SUBMISSION_FORM),Object(r.a)(e=>new ae.p(e.payload.collectionId,e.payload.submissionId,e.payload.selfUrl,e.payload.submissionDefinition,e.payload.sections,e.payload.item,null))),this.saveSubmission$=this.actions$.pipe(Object(Z.f)(ae.F.SAVE_SUBMISSION_FORM),Object(ne.a)(e=>this.operationsService.jsonPatchByResourceType(this.submissionService.getSubmissionObjectLinkName(),e.payload.submissionId,"sections").pipe(Object(r.a)(t=>new ae.y(e.payload.submissionId,t,e.payload.isManual)),Object(ie.a)(()=>Object(te.a)(new ae.x(e.payload.submissionId)))))),this.saveForLaterSubmission$=this.actions$.pipe(Object(Z.f)(ae.F.SAVE_FOR_LATER_SUBMISSION_FORM),Object(ne.a)(e=>this.operationsService.jsonPatchByResourceType(this.submissionService.getSubmissionObjectLinkName(),e.payload.submissionId,"sections").pipe(Object(r.a)(t=>new ae.v(e.payload.submissionId,t)),Object(ie.a)(()=>Object(te.a)(new ae.x(e.payload.submissionId)))))),this.saveSubmissionSuccess$=this.actions$.pipe(Object(Z.f)(ae.F.SAVE_SUBMISSION_FORM_SUCCESS),Object(se.a)(this.store$),Object(r.a)(([e,t])=>this.parseSaveResponse(t.submission.objects[e.payload.submissionId],e.payload.submissionObject,e.payload.submissionId,t.forms,e.payload.notify)),Object(l.a)(e=>Object(ee.a)(e))),this.saveSubmissionSectionSuccess$=this.actions$.pipe(Object(Z.f)(ae.F.SAVE_SUBMISSION_SECTION_FORM_SUCCESS),Object(se.a)(this.store$),Object(r.a)(([e,t])=>this.parseSaveResponse(t.submission.objects[e.payload.submissionId],e.payload.submissionObject,e.payload.submissionId,t.forms,!1)),Object(l.a)(e=>Object(ee.a)(e))),this.saveSection$=this.actions$.pipe(Object(Z.f)(ae.F.SAVE_SUBMISSION_SECTION_FORM),Object(ne.a)(e=>this.operationsService.jsonPatchByResourceID(this.submissionService.getSubmissionObjectLinkName(),e.payload.submissionId,"sections",e.payload.sectionId).pipe(Object(r.a)(t=>new ae.B(e.payload.submissionId,t)),Object(ie.a)(()=>Object(te.a)(new ae.A(e.payload.submissionId)))))),this.saveError$=this.actions$.pipe(Object(Z.f)(ae.F.SAVE_SUBMISSION_FORM_ERROR,ae.F.SAVE_SUBMISSION_SECTION_FORM_ERROR),Object(se.a)(this.store$),Object(c.a)(()=>this.notificationsService.error(null,this.translate.get("submission.sections.general.save_error_notice")))),this.saveAndDeposit$=this.actions$.pipe(Object(Z.f)(ae.F.SAVE_AND_DEPOSIT_SUBMISSION),Object(se.a)(this.store$),Object(ne.a)(([e,t])=>this.operationsService.jsonPatchByResourceType(this.submissionService.getSubmissionObjectLinkName(),e.payload.submissionId,"sections").pipe(Object(r.a)(n=>this.canDeposit(n)?new ae.e(e.payload.submissionId):(this.notificationsService.warning(null,this.translate.get("submission.sections.general.sections_not_valid")),this.parseSaveResponse(t.submission.objects[e.payload.submissionId],n,e.payload.submissionId,t.forms))),Object(ie.a)(()=>Object(te.a)(new ae.x(e.payload.submissionId)))))),this.depositSubmission$=this.actions$.pipe(Object(Z.f)(ae.F.DEPOSIT_SUBMISSION),Object(se.a)(this.store$),Object(ne.a)(([e,t])=>this.submissionService.depositSubmission(t.submission.objects[e.payload.submissionId].selfUrl).pipe(Object(r.a)(()=>new ae.g(e.payload.submissionId)),Object(ie.a)(t=>(console.log("submission error",t),Object(te.a)(new ae.f(e.payload.submissionId))))))),this.saveForLaterSubmissionSuccess$=this.actions$.pipe(Object(Z.f)(ae.F.SAVE_FOR_LATER_SUBMISSION_FORM_SUCCESS),Object(c.a)(()=>this.notificationsService.success(null,this.translate.get("submission.sections.general.save_success_notice"))),Object(c.a)(()=>this.submissionService.redirectToMyDSpace())),this.depositSubmissionSuccess$=this.actions$.pipe(Object(Z.f)(ae.F.DEPOSIT_SUBMISSION_SUCCESS),Object(c.a)(()=>this.notificationsService.success(null,this.translate.get("submission.sections.general.deposit_success_notice"))),Object(c.a)(()=>this.submissionService.redirectToMyDSpace())),this.depositSubmissionError$=this.actions$.pipe(Object(Z.f)(ae.F.DEPOSIT_SUBMISSION_ERROR),Object(c.a)(()=>this.notificationsService.error(null,this.translate.get("submission.sections.general.deposit_error_notice")))),this.discardSubmission$=this.actions$.pipe(Object(Z.f)(ae.F.DISCARD_SUBMISSION),Object(ne.a)(e=>this.submissionService.discardSubmission(e.payload.submissionId).pipe(Object(r.a)(()=>new ae.k(e.payload.submissionId)),Object(ie.a)(()=>Object(te.a)(new ae.j(e.payload.submissionId)))))),this.addAllMetadataToSectionData=this.actions$.pipe(Object(Z.f)(ae.F.UPDATE_SECTION_DATA),Object(ne.a)(e=>this.sectionService.getSectionState(e.payload.submissionId,e.payload.sectionId,C.a.Upload).pipe(Object(r.a)(t=>[e,t]),Object(d.a)(1))),Object(m.a)(([e,t])=>t.sectionType===C.a.SubmissionForm),Object(ne.a)(([e,t])=>t.sectionType===C.a.SubmissionForm?this.submissionObjectService.findById(e.payload.submissionId,!0,!1,Object(T.a)("item")).pipe(Object(k.j)()).pipe(Object(ne.a)(e=>e.item.pipe(Object(k.j)()))).pipe(Object(r.a)(e=>e.metadata),Object(m.a)(t=>!Object(b.isEqual)(e.payload.data,t)),Object(r.a)(t=>new ae.G(e.payload.submissionId,e.payload.sectionId,t,e.payload.errors,e.payload.metadata))):Object(te.a)(new ae.H))),this.discardSubmissionSuccess$=this.actions$.pipe(Object(Z.f)(ae.F.DISCARD_SUBMISSION_SUCCESS),Object(c.a)(()=>this.notificationsService.success(null,this.translate.get("submission.sections.general.discard_success_notice"))),Object(c.a)(()=>this.submissionService.redirectToMyDSpace())),this.discardSubmissionError$=this.actions$.pipe(Object(Z.f)(ae.F.DISCARD_SUBMISSION_ERROR),Object(c.a)(()=>this.notificationsService.error(null,this.translate.get("submission.sections.general.discard_error_notice"))))}canDeposit(e){let t=!0;return Object(g.e)(e)&&e.forEach(e=>{const{errors:n}=e;n&&!Object(g.d)(n)&&(t=!1)}),t}parseSaveResponse(e,t,n,i,s=!0){const o=[];return Object(g.e)(t)&&(s&&this.notificationsService.success(null,this.translate.get("submission.sections.general.save_success_notice")),t.forEach(t=>{let a=Object.create({});const{errors:r}=t;r&&!Object(g.d)(r)&&(a=Object(oe.a)(r),s&&this.notificationsService.warning(null,this.translate.get("submission.sections.general.sections_not_valid")));const c=t.sections&&Object(g.e)(t.sections)?t.sections:{},l=Object(b.union)(Object.keys(c),Object.keys(a));for(const d of l){const t=a[d]||[],r=c[d]||{};if(e.sections[d].sectionType===C.a.Upload&&Object(g.d)(r.files)&&!e.sections[d].enabled)continue;s&&!e.sections[d].enabled&&this.submissionService.notifyNewSection(n,d,e.sections[d].sectionType);const l=de(le(i,e,d),t,e.sections[d].sectionType,s);o.push(new ae.G(n,d,r,l))}})),o}}return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275inject"](Z.a),x["\u0275\u0275inject"](w.a),x["\u0275\u0275inject"](ce.a),x["\u0275\u0275inject"](F.a),x["\u0275\u0275inject"](X.h),x["\u0275\u0275inject"](E.a),x["\u0275\u0275inject"](L.a),x["\u0275\u0275inject"]($.f))},e.\u0275prov=x["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"loadForm$",void 0),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"resetForm$",void 0),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"saveSubmission$",void 0),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"saveForLaterSubmission$",void 0),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"saveSubmissionSuccess$",void 0),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"saveSubmissionSectionSuccess$",void 0),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"saveSection$",void 0),Object(o.b)([Object(Z.b)({dispatch:!1}),Object(o.c)("design:type",Object)],e.prototype,"saveError$",void 0),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"saveAndDeposit$",void 0),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"depositSubmission$",void 0),Object(o.b)([Object(Z.b)({dispatch:!1}),Object(o.c)("design:type",Object)],e.prototype,"saveForLaterSubmissionSuccess$",void 0),Object(o.b)([Object(Z.b)({dispatch:!1}),Object(o.c)("design:type",Object)],e.prototype,"depositSubmissionSuccess$",void 0),Object(o.b)([Object(Z.b)({dispatch:!1}),Object(o.c)("design:type",Object)],e.prototype,"depositSubmissionError$",void 0),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"discardSubmission$",void 0),Object(o.b)([Object(Z.b)(),Object(o.c)("design:type",Object)],e.prototype,"addAllMetadataToSectionData",void 0),Object(o.b)([Object(Z.b)({dispatch:!1}),Object(o.c)("design:type",Object)],e.prototype,"discardSubmissionSuccess$",void 0),Object(o.b)([Object(Z.b)({dispatch:!1}),Object(o.c)("design:type",Object)],e.prototype,"discardSubmissionError$",void 0),e})()];var ue=n("2Vo4"),me=n("LP5c");let be=(()=>{class e{constructor(e){this.store=e}getUploadedFileList(e,t){return this.store.select(Object(me.h)(e,t)).pipe(Object(r.a)(e=>e),Object(u.a)())}getFileData(e,t,n){return this.store.select(Object(me.h)(e,t)).pipe(Object(m.a)(e=>!Object(g.j)(e)),Object(r.a)(e=>{let t;return Object.keys(e).filter(t=>e[t].uuid===n).forEach(n=>t=e[n]),t}),Object(u.a)())}getDefaultPolicies(e,t,n){return this.store.select(Object(me.g)(e,t,n)).pipe(Object(r.a)(e=>e),Object(u.a)())}addUploadedFile(e,t,n,i){this.store.dispatch(new ae.q(e,t,n,i))}updateFileData(e,t,n,i){this.store.dispatch(new ae.l(e,t,n,i))}removeUploadedFile(e,t,n){this.store.dispatch(new ae.d(e,t,n))}}return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275inject"](X.h))},e.\u0275prov=x["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();var he=n("DNva"),fe=n("YIpg"),ve=n("8a3C"),ge=n("EdIQ"),xe=n("uLZQ"),Se=n("zQ+x"),Ie=n("5HAD"),Oe=n("7vy/"),ye=n("VOnO"),je=n("IheW");let Ce=(()=>{let e=class extends ge.a{constructor(e,t,n,i,s,o,a,r){super(e,t,null,i,s,o,a,r,"submissionuploads"),this.requestService=e,this.rdbService=t,this.store=n,this.objectCache=i,this.halService=s,this.notificationsService=o,this.http=a,this.comparator=r}findByHref(e,t=!0,n=!0,...i){return super.findByHref(e,t,n,...i)}};return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275inject"](V.a),x["\u0275\u0275inject"](Oe.a),x["\u0275\u0275inject"](X.h),x["\u0275\u0275inject"](B.a),x["\u0275\u0275inject"](xe.a),x["\u0275\u0275inject"](w.a),x["\u0275\u0275inject"](je.b),x["\u0275\u0275inject"](ye.a))},e.\u0275prov=x["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e=Object(o.b)([Object(Se.d)(Ie.f)],e),e})();var Ee=n("ac5F");function De(e,t){1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n  "),x["\u0275\u0275elementStart"](2,"div",2),x["\u0275\u0275text"](3,"\n    "),x["\u0275\u0275elementStart"](4,"div",3),x["\u0275\u0275text"](5,"\n      "),x["\u0275\u0275elementStart"](6,"h3",4),x["\u0275\u0275elementStart"](7,"span",5),x["\u0275\u0275text"](8),x["\u0275\u0275pipe"](9,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](10,"\n    "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](11,"\n  "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](12,"\n"),x["\u0275\u0275elementContainerEnd"]()),2&e&&(x["\u0275\u0275advance"](8),x["\u0275\u0275textInterpolate"](x["\u0275\u0275pipeBind1"](9,1,"submission.sections.upload.no-file-uploaded")))}const we=function(e){return{collectionName:e}};function Fe(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1),x["\u0275\u0275pipe"](2,"translate"),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"](3);x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n          ",x["\u0275\u0275pipeBind2"](2,1,"submission.sections.upload.header.policy.default.nolist",x["\u0275\u0275pureFunction1"](4,we,e.collectionName)),"\n        ")}}function Me(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1),x["\u0275\u0275pipe"](2,"translate"),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"](3);x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n          ",x["\u0275\u0275pipeBind2"](2,1,"submission.sections.upload.header.policy.default.withlist",x["\u0275\u0275pureFunction1"](4,we,e.collectionName)),"\n        ")}}function ke(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"div",2),x["\u0275\u0275text"](1,"\n    "),x["\u0275\u0275elementStart"](2,"div",8),x["\u0275\u0275text"](3,"\n      "),x["\u0275\u0275elementStart"](4,"ds-alert",9),x["\u0275\u0275text"](5,"\n        "),x["\u0275\u0275template"](6,Fe,3,6,"ng-container",1),x["\u0275\u0275text"](7,"\n        "),x["\u0275\u0275template"](8,Me,3,6,"ng-container",1),x["\u0275\u0275text"](9,"\n        "),x["\u0275\u0275element"](10,"span",10),x["\u0275\u0275text"](11,"\n        "),x["\u0275\u0275element"](12,"ds-submission-section-upload-access-conditions",11),x["\u0275\u0275text"](13,"\n      "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](14,"\n    "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](15,"\n  "),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"](2);x["\u0275\u0275advance"](4),x["\u0275\u0275property"]("type",e.AlertTypeEnum.Warning),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",1===e.collectionPolicyType),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",2===e.collectionPolicyType),x["\u0275\u0275advance"](4),x["\u0275\u0275property"]("accessConditions",e.collectionDefaultAccessConditions)}}function Le(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n    "),x["\u0275\u0275element"](2,"ds-submission-upload-section-file",12),x["\u0275\u0275pipe"](3,"async"),x["\u0275\u0275text"](4,"\n    "),x["\u0275\u0275elementStart"](5,"div",2),x["\u0275\u0275text"](6,"\n      "),x["\u0275\u0275elementStart"](7,"div",3),x["\u0275\u0275text"](8,"\n        "),x["\u0275\u0275element"](9,"hr"),x["\u0275\u0275text"](10,"\n      "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](11,"\n    "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](12,"\n  "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit,n=x["\u0275\u0275nextContext"](2);x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("availableAccessConditionOptions",n.availableAccessConditionOptions)("collectionId",n.collectionId)("collectionPolicyType",n.collectionPolicyType)("configMetadataForm",x["\u0275\u0275pipeBind1"](3,9,n.configMetadataForm$))("fileId",n.fileIndexes[n.fileList.indexOf(e)])("fileIndex",n.fileList.indexOf(e))("fileName",n.fileNames[n.fileList.indexOf(e)])("sectionId",n.sectionData.id)("submissionId",n.submissionId)}}function Be(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n\n  "),x["\u0275\u0275template"](2,ke,16,4,"div",6),x["\u0275\u0275text"](3,"\n\n  "),x["\u0275\u0275template"](4,Le,13,11,"ng-container",7),x["\u0275\u0275text"](5,"\n"),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",e.collectionDefaultAccessConditions.length>0),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngForOf",e.fileList)}}let Ve=(()=>{let e=class extends S{constructor(e,t,n,i,s,o,a,r,c,l){super(void 0,c,l),this.bitstreamService=e,this.changeDetectorRef=t,this.collectionDataService=n,this.groupService=i,this.resourcePolicyService=s,this.sectionService=o,this.submissionService=a,this.uploadsConfigService=r,this.injectedSectionData=c,this.injectedSubmissionId=l,this.AlertTypeEnum=Ee.a,this.fileIndexes=[],this.fileList=[],this.fileNames=[],this.collectionDefaultAccessConditions=[],this.required$=new ue.a(!0),this.subs=[]}onSectionInit(){const e=this.uploadsConfigService.findByHref(this.sectionData.config,!0,!1,Object(T.a)("metadata")).pipe(Object(k.i)(),Object(r.a)(e=>e.payload));this.configMetadataForm$=e.pipe(Object(ne.a)(e=>e.metadata.pipe(Object(k.i)(),Object(r.a)(e=>e.payload)))),this.subs.push(this.submissionService.getSubmissionObject(this.submissionId).pipe(Object(m.a)(e=>Object(g.h)(e)&&!e.isLoading),Object(m.a)(e=>Object(g.j)(this.collectionId)||this.collectionId!==e.collection),Object(c.a)(e=>this.collectionId=e.collection),Object(l.a)(e=>this.collectionDataService.findById(e.collection)),Object(m.a)(e=>Object(g.h)(e.payload)),Object(c.a)(e=>this.collectionName=e.payload.name),Object(l.a)(()=>e)).subscribe(e=>{this.required$.next(e.required),this.availableAccessConditionOptions=Object(g.e)(e.accessConditionOptions)?e.accessConditionOptions:[],this.collectionPolicyType=this.availableAccessConditionOptions.length>0?2:1,this.changeDetectorRef.detectChanges()}),Object(a.a)(this.configMetadataForm$,this.bitstreamService.getUploadedFileList(this.submissionId,this.sectionData.id)).pipe(Object(m.a)(([e,t])=>Object(g.e)(e)&&Object(g.h)(t)),Object(u.a)()).subscribe(([e,t])=>{this.fileList=[],this.fileIndexes=[],this.fileNames=[],this.changeDetectorRef.detectChanges(),Object(g.h)(t)&&t.length>0&&t.forEach(t=>{this.fileList.push(t),this.fileIndexes.push(t.uuid),this.fileNames.push(this.getFileName(e,t))}),this.changeDetectorRef.detectChanges()}))}getFileName(e,t){const n=e.rows[0].fields[0].selectableMetadata[0].metadata;let i;return i=Object(g.e)(t.metadata)&&Object(g.e)(t.metadata[n])?t.metadata[n][0].display:t.uuid,i}getSectionStatus(){return Object(a.a)(this.required$,this.bitstreamService.getUploadedFileList(this.submissionId,this.sectionData.id),(e,t)=>!e||Object(g.h)(t)&&t.length>0)}onSectionDestroy(){this.subs.filter(e=>Object(g.b)(e)).forEach(e=>e.unsubscribe())}};return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275directiveInject"](be),x["\u0275\u0275directiveInject"](x.ChangeDetectorRef),x["\u0275\u0275directiveInject"](he.a),x["\u0275\u0275directiveInject"](fe.a),x["\u0275\u0275directiveInject"](ve.a),x["\u0275\u0275directiveInject"](F.a),x["\u0275\u0275directiveInject"](E.a),x["\u0275\u0275directiveInject"](Ce),x["\u0275\u0275directiveInject"]("sectionDataProvider"),x["\u0275\u0275directiveInject"]("submissionIdProvider"))},e.\u0275cmp=x["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-section-upload"]],features:[x["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:5,consts:[[3,"content","dismissible","type"],[4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"text-center"],[1,"text-muted"],["class","row",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"col-sm-12"],[3,"type"],[1,"clearfix"],[3,"accessConditions"],[3,"availableAccessConditionOptions","collectionId","collectionPolicyType","configMetadataForm","fileId","fileIndex","fileName","sectionId","submissionId"]],template:function(e,t){1&e&&(x["\u0275\u0275element"](0,"ds-alert",0),x["\u0275\u0275text"](1,"\n\n"),x["\u0275\u0275template"](2,De,13,3,"ng-container",1),x["\u0275\u0275text"](3,"\n\n"),x["\u0275\u0275template"](4,Be,6,2,"ng-container",1),x["\u0275\u0275text"](5,"\n")),2&e&&(x["\u0275\u0275property"]("content","submission.sections.upload.info")("dismissible",!0)("type",t.AlertTypeEnum.Info),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",0==t.fileList.length),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",t.fileList.length>0))},styles:[""]}),e=Object(o.b)([Object(j.a)(C.a.Upload)],e),e})();var Te=n("T/iP"),Re=n("BVmw");const $e={granted:{element:{container:"custom-control custom-checkbox pl-1",control:"custom-control-input",label:"custom-control-label pt-1"}}},Pe=[{id:"granted",label:"I confirm the license above",required:!0,value:!1,validators:{required:null},errorMessages:{required:"You must accept the license",notgranted:"You must accept the license"},type:"CHECKBOX"}],_e=["formRef"];function Ae(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementStart"](0,"ds-form",2,3),x["\u0275\u0275listener"]("dfChange",(function(t){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"]().onChange(t)})),x["\u0275\u0275elementEnd"]()}if(2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275property"]("formId",e.formId)("formModel",e.formModel)("formLayout",e.formLayout)("displaySubmit",e.displaySubmit)("displayCancel",!1)}}let Ne=(()=>{let e=class extends S{constructor(e,t,n,i,s,o,a,r,c,l,d){super(c,l,d),this.changeDetectorRef=e,this.collectionDataService=t,this.formBuilderService=n,this.formOperationsService=i,this.formService=s,this.operationsBuilder=o,this.sectionService=a,this.submissionService=r,this.injectedCollectionId=c,this.injectedSectionData=l,this.injectedSubmissionId=d,this.formLayout=$e,this.displaySubmit=!1,this.subs=[]}onSectionInit(){this.pathCombiner=new O.a("sections",this.sectionData.id),this.formId=this.formService.getUniqueId(this.sectionData.id),this.formModel=this.formBuilderService.fromJSON(Pe);const e=this.formBuilderService.findById("granted",this.formModel);e.value=this.sectionData.data.granted,this.licenseText$=this.collectionDataService.findById(this.collectionId,!0,!0,Object(T.a)("license")).pipe(Object(m.a)(e=>Object(g.h)(e.payload)),Object(l.a)(e=>e.payload.license),Object(p.a)(e=>Object(g.h)(e.payload)),Object(r.a)(e=>e.payload.text),Object(v.a)("")),this.subs.push(this.sectionService.isSectionReadOnly(this.submissionId,this.sectionData.id,this.submissionService.getSubmissionScope()).pipe(Object(d.a)(1),Object(m.a)(e=>e)).subscribe(()=>{e.disabled=!0}),this.sectionService.getSectionErrors(this.submissionId,this.sectionData.id).pipe(Object(m.a)(e=>Object(g.e)(e)),Object(u.a)()).subscribe(t=>{const n=t.map(t=>"/sections/license"===t.path?e.checked?null:Object.assign({},t,{path:"/sections/license/granted"}):t).filter(e=>Object(g.g)(e));Object(g.e)(n)?(this.sectionService.checkSectionErrors(this.submissionId,this.sectionData.id,this.formId,n),this.sectionData.errors=t):this.sectionService.dispatchRemoveSectionErrors(this.submissionId,this.sectionData.id),this.changeDetectorRef.detectChanges()}))}getSectionStatus(){const e=this.formBuilderService.findById("granted",this.formModel);return e.valueChanges.pipe(Object(r.a)(e=>!0===e),Object(v.a)(e.value))}onChange(e){const t=this.formOperationsService.getFieldPathSegmentedFromChangeEvent(e),n=this.formOperationsService.getFieldValueFromChangeEvent(e);n?(this.operationsBuilder.add(this.pathCombiner.getPath(t),n.value.toString(),!1,!0),this.sectionService.dispatchRemoveSectionErrors(this.submissionId,this.sectionData.id)):this.operationsBuilder.remove(this.pathCombiner.getPath(t))}onSectionDestroy(){this.subs.filter(e=>Object(g.b)(e)).forEach(e=>e.unsubscribe())}};return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275directiveInject"](x.ChangeDetectorRef),x["\u0275\u0275directiveInject"](he.a),x["\u0275\u0275directiveInject"](h.a),x["\u0275\u0275directiveInject"](D.a),x["\u0275\u0275directiveInject"](f.a),x["\u0275\u0275directiveInject"](Re.a),x["\u0275\u0275directiveInject"](F.a),x["\u0275\u0275directiveInject"](E.a),x["\u0275\u0275directiveInject"]("collectionIdProvider"),x["\u0275\u0275directiveInject"]("sectionDataProvider"),x["\u0275\u0275directiveInject"]("submissionIdProvider"))},e.\u0275cmp=x["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-section-license"]],viewQuery:function(e,t){var n;1&e&&x["\u0275\u0275viewQuery"](_e,!0),2&e&&x["\u0275\u0275queryRefresh"](n=x["\u0275\u0275loadQuery"]())&&(t.formRef=n.first)},features:[x["\u0275\u0275InheritDefinitionFeature"]],decls:9,vars:4,consts:[[1,"mb-5",3,"innerHTML"],[3,"formId","formModel","formLayout","displaySubmit","displayCancel","dfChange",4,"ngIf"],[3,"formId","formModel","formLayout","displaySubmit","displayCancel","dfChange"],["formRef","formComponent"]],template:function(e,t){1&e&&(x["\u0275\u0275element"](0,"span",0),x["\u0275\u0275pipe"](1,"async"),x["\u0275\u0275text"](2,"\n"),x["\u0275\u0275element"](3,"br"),x["\u0275\u0275text"](4," "),x["\u0275\u0275element"](5,"br"),x["\u0275\u0275text"](6,"\n"),x["\u0275\u0275template"](7,Ae,2,5,"ds-form",1),x["\u0275\u0275text"](8,"\n")),2&e&&(x["\u0275\u0275property"]("innerHTML",x["\u0275\u0275pipeBind1"](1,2,t.licenseText$),x["\u0275\u0275sanitizeHtml"]),x["\u0275\u0275advance"](7),x["\u0275\u0275property"]("ngIf",t.formModel))},directives:[P.u,A.a],pipes:[P.b],styles:[""]}),e=Object(o.b)([Object(j.a)(C.a.License)],e),e})();var qe=n("SCNa"),Ue=n("SxV6"),Je=n("fM99"),Ge=n("QOHy");const Qe={id:"metadata",group:[]},Ye={element:{container:"form-group",label:"col-form-label"},grid:{label:"col-sm-3"}},ze={id:"accessConditions",groupFactory:null},He={grid:{group:"form-row"}},Ke={id:"name",label:"submission.sections.upload.form.access-condition-label",options:[]},Xe={element:{container:"p-0",label:"col-form-label"},grid:{host:"col-md-10"}},Ze={id:"startDate",label:"submission.sections.upload.form.from-label",placeholder:"submission.sections.upload.form.from-placeholder",inline:!1,toggleIcon:"far fa-calendar-alt",relations:[{match:Ge.P,operator:Ge.Q,when:[]}],required:!0,validators:{required:null},errorMessages:{required:"submission.sections.upload.form.date-required"}},We={element:{container:"p-0",label:"col-form-label"},grid:{host:"col-md-4"}},et={id:"endDate",label:"submission.sections.upload.form.until-label",placeholder:"submission.sections.upload.form.until-placeholder",inline:!1,toggleIcon:"far fa-calendar-alt",relations:[{match:Ge.P,operator:Ge.Q,when:[]}],required:!0,validators:{required:null},errorMessages:{required:"submission.sections.upload.form.date-required"}},tt={element:{container:"p-0",label:"col-form-label"},grid:{host:"col-md-4"}},nt=["formRef"];function it(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementStart"](0,"ds-form",1,2),x["\u0275\u0275listener"]("dfChange",(function(t){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"]().onChange(t)})),x["\u0275\u0275elementEnd"]()}if(2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275property"]("formId",e.formId)("formModel",e.formModel)("displaySubmit",!1)("displayCancel",!1)}}let st=(()=>{class e{constructor(e,t,n,i){this.cdr=e,this.formBuilderService=t,this.formService=n,this.submissionService=i}ngOnChanges(){this.fileData&&this.formId&&(this.formModel=this.buildFileEditForm(),this.cdr.detectChanges())}buildFileEditForm(){const e=Object.assign({},this.configMetadataForm.rows[0].fields[0]);e.repeatable=!1;const t=Object.assign({},this.configMetadataForm,{fields:Object.assign([],this.configMetadataForm.rows[0].fields[0],[this.configMetadataForm.rows[0].fields[0],e])}),n=[],i=Object.assign({},Qe);i.group=this.formBuilderService.modelFromConfiguration(this.submissionId,t,this.collectionId,this.fileData.metadata,this.submissionService.getSubmissionScope()),n.push(new Ge.C(i,Ye));const s=Object.assign({},Ke),o=Object.assign({},ze),a=[];if(2===this.collectionPolicyType){for(const n of this.availableAccessConditionOptions)a.push({label:n.name,value:n.name});s.options=a;const e=[],t=[],i=[];this.availableAccessConditionOptions.forEach(n=>{const s=!0===n.hasStartDate,o=!0===n.hasEndDate,a=s||o;s&&e.push({id:"name",value:n.name}),o&&t.push({id:"name",value:n.name}),a&&i.push({id:"name",value:n.name})});const r={relations:[{match:Ge.P,operator:Ge.Q,when:e}]},c={relations:[{match:Ge.P,operator:Ge.Q,when:t}]};o.groupFactory=()=>{const e=new Ge.M(s,Xe),t=Object.assign({},Ze,r),n=Object.assign({},et,c);return[e,new Ge.s(t,We),new Ge.s(n,tt)]},o.initialCount=Object(g.e)(this.fileData.accessConditions)?this.fileData.accessConditions.length:1,n.push(new Ge.v(o,He))}return this.initModelData(n),n}initModelData(e){this.fileData.accessConditions.forEach((t,n)=>{Array.of("name","startDate","endDate").filter(e=>t.hasOwnProperty(e)).forEach(i=>{const s=this.formBuilderService.findById(i,e,n);if(s)if(s.type===Ge.f){const e=new Date(t[i]);s.value={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}else s.value=t[i]})})}onChange(e){"name"===e.model.id&&this.setOptions(e.model,e.control)}setOptions(e,t){let n=null;if(this.availableAccessConditionOptions.filter(e=>e.name===t.value).forEach(e=>n=e),Object(g.e)(n)){const i=!0===n.hasStartDate||!0===n.hasEndDate,s=t.parent.get("startDate"),o=t.parent.get("endDate");if(s.markAsUntouched(),o.markAsUntouched(),s.setValue(null),t.parent.markAsDirty(),o.setValue(null),i){if(n.hasStartDate){const t=this.formBuilderService.findById("startDate",e.parent.group),i=new Date(n.maxStartDate);t.max={year:i.getFullYear(),month:i.getMonth()+1,day:i.getDate()}}if(n.hasEndDate){const t=this.formBuilderService.findById("endDate",e.parent.group),i=new Date(n.maxEndDate);t.max={year:i.getFullYear(),month:i.getMonth()+1,day:i.getDate()}}}}}}return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275directiveInject"](x.ChangeDetectorRef),x["\u0275\u0275directiveInject"](h.a),x["\u0275\u0275directiveInject"](f.a),x["\u0275\u0275directiveInject"](E.a))},e.\u0275cmp=x["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-section-upload-file-edit"]],viewQuery:function(e,t){var n;1&e&&x["\u0275\u0275viewQuery"](nt,!0),2&e&&x["\u0275\u0275queryRefresh"](n=x["\u0275\u0275loadQuery"]())&&(t.formRef=n.first)},inputs:{availableAccessConditionOptions:"availableAccessConditionOptions",collectionId:"collectionId",collectionPolicyType:"collectionPolicyType",configMetadataForm:"configMetadataForm",fileData:"fileData",fileId:"fileId",fileIndex:"fileIndex",formId:"formId",sectionId:"sectionId",submissionId:"submissionId"},features:[x["\u0275\u0275NgOnChangesFeature"]],decls:5,vars:1,consts:[[3,"formId","formModel","displaySubmit","displayCancel","dfChange",4,"ngIf"],[3,"formId","formModel","displaySubmit","displayCancel","dfChange"],["formRef","formComponent"]],template:function(e,t){1&e&&(x["\u0275\u0275elementStart"](0,"div"),x["\u0275\u0275text"](1,"\n  "),x["\u0275\u0275template"](2,it,2,4,"ds-form",0),x["\u0275\u0275text"](3,"\n"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](4,"\n")),2&e&&(x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",t.formModel))},directives:[P.u,A.a],encapsulation:2}),e})();var ot=n("Oyu8"),at=n("G0yt"),rt=n("/lGE"),ct=n("/eM4");function lt(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"span",3),x["\u0275\u0275text"](1),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]().$implicit;x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate3"]("\n    ",e.name," ",e.startDate," ",e.endDate,"\n  ")}}function dt(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"span",3),x["\u0275\u0275text"](1),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]().$implicit;x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate2"]("",e.name," from ",e.endDate,"")}}function pt(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"span",4),x["\u0275\u0275text"](1),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]().$implicit;x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate2"]("",e.name," until ",e.startDate,"")}}function ut(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n  "),x["\u0275\u0275template"](2,lt,2,3,"span",1),x["\u0275\u0275text"](3,"\n  "),x["\u0275\u0275template"](4,dt,2,2,"span",1),x["\u0275\u0275text"](5,"\n  "),x["\u0275\u0275template"](6,pt,2,2,"span",2),x["\u0275\u0275text"](7,"\n  "),x["\u0275\u0275element"](8,"br"),x["\u0275\u0275text"](9,"\n"),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf","DEFAULT_BITSTREAM_READ"==e.action),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf","lease"==e.name),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf","embargo"==e.name)}}let mt=(()=>{class e{constructor(e){this.groupService=e,this.accessConditionsList=[]}ngOnInit(){this.accessConditions.forEach(e=>{Object(g.d)(e.name)?this.groupService.findByHref(e._links.group.href).pipe(Object(p.a)(e=>!e.isResponsePending&&e.hasSucceeded)).subscribe(t=>{const n=t.payload,i=Object.assign({},e);i.name=n.name,this.accessConditionsList.push(i)}):this.accessConditionsList.push(e)})}}return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275directiveInject"](fe.a))},e.\u0275cmp=x["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-section-upload-access-conditions"]],inputs:{accessConditions:"accessConditions"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["class","badge badge-primary mt-3 mr-2",4,"ngIf"],["class","badge badge-dark mt-3 mr-2",4,"ngIf"],[1,"badge","badge-primary","mt-3","mr-2"],[1,"badge","badge-dark","mt-3","mr-2"]],template:function(e,t){1&e&&(x["\u0275\u0275template"](0,ut,10,3,"ng-container",0),x["\u0275\u0275text"](1,"\n")),2&e&&x["\u0275\u0275property"]("ngForOf",t.accessConditionsList)},directives:[P.t,P.u],encapsulation:2}),e})();var bt=n("BCqK");function ht(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n        "),x["\u0275\u0275elementStart"](2,"h5"),x["\u0275\u0275text"](3),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](4,"\n      "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]().$implicit;x["\u0275\u0275advance"](3),x["\u0275\u0275textInterpolate1"]("\n          ",e.value,"\n        ")}}function ft(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"h5"),x["\u0275\u0275text"](1,"\n          "),x["\u0275\u0275elementStart"](2,"span",4),x["\u0275\u0275text"](3),x["\u0275\u0275pipe"](4,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](5,"\n        "),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"](4);x["\u0275\u0275advance"](3),x["\u0275\u0275textInterpolate2"]("",x["\u0275\u0275pipeBind1"](4,2,"submission.sections.upload.no-entry")," ",e.fileTitleKey,"")}}function vt(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n        "),x["\u0275\u0275template"](2,ft,6,4,"h5",0),x["\u0275\u0275text"](3,"\n      "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]().$implicit,t=x["\u0275\u0275nextContext"](2);x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",0===t.metadata[t.fileTitleKey].indexOf(e))}}function gt(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n      "),x["\u0275\u0275template"](2,ht,5,1,"ng-container",0),x["\u0275\u0275text"](3,"\n      "),x["\u0275\u0275template"](4,vt,4,1,"ng-container",0),x["\u0275\u0275text"](5,"\n      "),x["\u0275\u0275element"](6,"span",1),x["\u0275\u0275text"](7,"\n    "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",""!==e.value),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",""===e.value)}}const xt=function(){return["150"]};function St(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1),x["\u0275\u0275pipe"](2,"dsTruncate"),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]().$implicit;x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n          ",x["\u0275\u0275pipeBind2"](2,1,e.value,x["\u0275\u0275pureFunction0"](4,xt)),"\n      ")}}function It(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"span",4),x["\u0275\u0275text"](1),x["\u0275\u0275pipe"](2,"translate"),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"](4);x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate2"]("",x["\u0275\u0275pipeBind1"](2,2,"submission.sections.upload.no-entry")," ",e.fileDescrKey,"")}}function Ot(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n        "),x["\u0275\u0275template"](2,It,3,4,"span",5),x["\u0275\u0275text"](3,"\n      "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]().$implicit,t=x["\u0275\u0275nextContext"](2);x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",0===t.metadata[t.fileDescrKey].indexOf(e))}}function yt(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n      "),x["\u0275\u0275template"](2,St,3,5,"ng-container",0),x["\u0275\u0275text"](3,"\n      "),x["\u0275\u0275template"](4,Ot,4,1,"ng-container",0),x["\u0275\u0275text"](5,"\n      "),x["\u0275\u0275element"](6,"span",1),x["\u0275\u0275text"](7,"\n    "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",""!==e.value),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",""===e.value)}}function jt(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n    "),x["\u0275\u0275template"](2,gt,8,2,"ng-container",3),x["\u0275\u0275text"](3,"\n    "),x["\u0275\u0275template"](4,yt,8,2,"ng-container",3),x["\u0275\u0275text"](5,"\n  "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngForOf",e.getAllMetadataValue(e.fileTitleKey)),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngForOf",e.getAllMetadataValue(e.fileDescrKey))}}let Ct=(()=>{class e{constructor(){this.metadata=Object.create({}),this.fileTitleKey="Title",this.fileDescrKey="Description"}ngOnInit(){Object(g.e)(this.fileData.metadata)&&(this.metadata[this.fileTitleKey]=ct.a.all(this.fileData.metadata,"dc.title"),this.metadata[this.fileDescrKey]=ct.a.all(this.fileData.metadata,"dc.description"))}getAllMetadataValue(e){return ct.a.all(this.metadata,e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=x["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-section-upload-file-view"]],inputs:{fileData:"fileData"},decls:9,vars:2,consts:[[4,"ngIf"],[1,"clearfix"],[3,"accessConditions"],[4,"ngFor","ngForOf"],[1,"text-muted"],["class","text-muted",4,"ngIf"]],template:function(e,t){1&e&&(x["\u0275\u0275elementStart"](0,"div"),x["\u0275\u0275text"](1,"\n  "),x["\u0275\u0275template"](2,jt,6,2,"ng-container",0),x["\u0275\u0275text"](3,"\n\n  "),x["\u0275\u0275element"](4,"span",1),x["\u0275\u0275text"](5,"\n  "),x["\u0275\u0275element"](6,"ds-submission-section-upload-access-conditions",2),x["\u0275\u0275text"](7,"\n"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](8,"\n")),2&e&&(x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",t.metadata),x["\u0275\u0275advance"](4),x["\u0275\u0275property"]("accessConditions",t.fileData.accessConditions))},directives:[P.u,mt,P.t],pipes:[$.e,bt.a],encapsulation:2}),e})();var Et=n("t8/W");function Dt(e,t){1&e&&x["\u0275\u0275element"](0,"i",18)}function wt(e,t){1&e&&x["\u0275\u0275element"](0,"i",19)}function Ft(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n          "),x["\u0275\u0275elementStart"](2,"button",12),x["\u0275\u0275listener"]("click",(function(t){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"](2).downloadBitstreamFile(),t.stopPropagation()})),x["\u0275\u0275element"](3,"i",13),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](4,"\n          "),x["\u0275\u0275text"](5,"\n          "),x["\u0275\u0275elementStart"](6,"button",12),x["\u0275\u0275listener"]("click",(function(t){x["\u0275\u0275restoreView"](e);const n=x["\u0275\u0275nextContext"](2);return t.preventDefault(),n.switchMode()})),x["\u0275\u0275element"](7,"i",14),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](8,"\n          "),x["\u0275\u0275elementStart"](9,"button",15),x["\u0275\u0275listener"]("click",(function(t){x["\u0275\u0275restoreView"](e);const n=x["\u0275\u0275nextContext"](2),i=x["\u0275\u0275reference"](3);return t.preventDefault(),n.confirmDelete(i)})),x["\u0275\u0275pipe"](10,"translate"),x["\u0275\u0275pipe"](11,"async"),x["\u0275\u0275text"](12,"\n            "),x["\u0275\u0275template"](13,Dt,1,0,"i",16),x["\u0275\u0275pipe"](14,"async"),x["\u0275\u0275text"](15,"\n            "),x["\u0275\u0275template"](16,wt,1,0,"i",17),x["\u0275\u0275pipe"](17,"async"),x["\u0275\u0275text"](18,"\n          "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](19,"\n        "),x["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=x["\u0275\u0275nextContext"](2);x["\u0275\u0275advance"](9),x["\u0275\u0275propertyInterpolate"]("title",x["\u0275\u0275pipeBind1"](10,4,"submission.sections.upload.delete.confirm.title")),x["\u0275\u0275property"]("disabled",x["\u0275\u0275pipeBind1"](11,6,e.processingDelete$)),x["\u0275\u0275advance"](4),x["\u0275\u0275property"]("ngIf",x["\u0275\u0275pipeBind1"](14,8,e.processingDelete$)),x["\u0275\u0275advance"](3),x["\u0275\u0275property"]("ngIf",!x["\u0275\u0275pipeBind1"](17,10,e.processingDelete$))}}function Mt(e,t){1&e&&x["\u0275\u0275element"](0,"i",18)}function kt(e,t){1&e&&x["\u0275\u0275element"](0,"i",19)}function Lt(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n          "),x["\u0275\u0275elementStart"](2,"button",20),x["\u0275\u0275listener"]("click",(function(t){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"](2).saveBitstreamData(t)})),x["\u0275\u0275pipe"](3,"translate"),x["\u0275\u0275element"](4,"i",21),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](5,"\n          "),x["\u0275\u0275elementStart"](6,"button",20),x["\u0275\u0275listener"]("click",(function(t){x["\u0275\u0275restoreView"](e);const n=x["\u0275\u0275nextContext"](2);return t.preventDefault(),n.switchMode()})),x["\u0275\u0275pipe"](7,"translate"),x["\u0275\u0275element"](8,"i",22),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](9,"\n          "),x["\u0275\u0275elementStart"](10,"button",15),x["\u0275\u0275listener"]("click",(function(t){x["\u0275\u0275restoreView"](e);const n=x["\u0275\u0275nextContext"](2),i=x["\u0275\u0275reference"](3);return t.preventDefault(),n.confirmDelete(i)})),x["\u0275\u0275pipe"](11,"translate"),x["\u0275\u0275pipe"](12,"async"),x["\u0275\u0275text"](13,"\n            "),x["\u0275\u0275template"](14,Mt,1,0,"i",16),x["\u0275\u0275pipe"](15,"async"),x["\u0275\u0275text"](16,"\n            "),x["\u0275\u0275template"](17,kt,1,0,"i",17),x["\u0275\u0275pipe"](18,"async"),x["\u0275\u0275text"](19,"\n          "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](20,"\n        "),x["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=x["\u0275\u0275nextContext"](2);x["\u0275\u0275advance"](2),x["\u0275\u0275propertyInterpolate"]("title",x["\u0275\u0275pipeBind1"](3,6,"submission.sections.upload.save-metadata")),x["\u0275\u0275advance"](4),x["\u0275\u0275propertyInterpolate"]("title",x["\u0275\u0275pipeBind1"](7,8,"submission.sections.upload.undo")),x["\u0275\u0275advance"](4),x["\u0275\u0275propertyInterpolate"]("title",x["\u0275\u0275pipeBind1"](11,10,"submission.sections.upload.delete.confirm.title")),x["\u0275\u0275property"]("disabled",x["\u0275\u0275pipeBind1"](12,12,e.processingDelete$)),x["\u0275\u0275advance"](4),x["\u0275\u0275property"]("ngIf",x["\u0275\u0275pipeBind1"](15,14,e.processingDelete$)),x["\u0275\u0275advance"](3),x["\u0275\u0275property"]("ngIf",!x["\u0275\u0275pipeBind1"](18,16,e.processingDelete$))}}function Bt(e,t){if(1&e&&x["\u0275\u0275element"](0,"ds-submission-section-upload-file-view",23),2&e){const e=x["\u0275\u0275nextContext"](2);x["\u0275\u0275property"]("fileData",e.fileData)}}function Vt(e,t){if(1&e&&x["\u0275\u0275element"](0,"ds-submission-section-upload-file-edit",24),2&e){const e=x["\u0275\u0275nextContext"](2);x["\u0275\u0275property"]("availableAccessConditionOptions",e.availableAccessConditionOptions)("collectionId",e.collectionId)("collectionPolicyType",e.collectionPolicyType)("configMetadataForm",e.configMetadataForm)("fileData",e.fileData)("fileId",e.fileId)("fileIndex",e.fileIndex)("formId",e.formId)("sectionId",e.sectionId)}}function Tt(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n  "),x["\u0275\u0275elementStart"](2,"div",2),x["\u0275\u0275text"](3,"\n    "),x["\u0275\u0275elementStart"](4,"div",3),x["\u0275\u0275text"](5,"\n      "),x["\u0275\u0275text"](6,"\n      "),x["\u0275\u0275element"](7,"ds-thumbnail",4),x["\u0275\u0275text"](8,"\n    "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](9,"\n    "),x["\u0275\u0275elementStart"](10,"div",5),x["\u0275\u0275text"](11,"\n      "),x["\u0275\u0275elementStart"](12,"div",6),x["\u0275\u0275text"](13,"\n        "),x["\u0275\u0275elementStart"](14,"h3"),x["\u0275\u0275text"](15),x["\u0275\u0275elementStart"](16,"span",7),x["\u0275\u0275text"](17),x["\u0275\u0275pipe"](18,"dsFileSize"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](19,"\n      "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](20,"\n      "),x["\u0275\u0275elementStart"](21,"div",8),x["\u0275\u0275text"](22,"\n        "),x["\u0275\u0275template"](23,Ft,20,12,"ng-container",0),x["\u0275\u0275text"](24,"\n        "),x["\u0275\u0275template"](25,Lt,21,18,"ng-container",0),x["\u0275\u0275text"](26,"\n      "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](27,"\n      "),x["\u0275\u0275element"](28,"div",9),x["\u0275\u0275text"](29,"\n      "),x["\u0275\u0275template"](30,Bt,1,1,"ds-submission-section-upload-file-view",10),x["\u0275\u0275text"](31,"\n      "),x["\u0275\u0275template"](32,Vt,1,9,"ds-submission-section-upload-file-edit",11),x["\u0275\u0275text"](33,"\n    "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](34,"\n  "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](35,"\n"),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275advance"](7),x["\u0275\u0275property"]("thumbnail",null==e.fileData?null:e.fileData.thumbnail),x["\u0275\u0275advance"](8),x["\u0275\u0275textInterpolate1"]("",e.fileName," "),x["\u0275\u0275advance"](2),x["\u0275\u0275textInterpolate1"]("(",x["\u0275\u0275pipeBind1"](18,9,null==e.fileData?null:e.fileData.sizeBytes),")"),x["\u0275\u0275advance"](4),x["\u0275\u0275classProp"]("sticky-buttons",!e.readMode),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",e.readMode),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",!e.readMode),x["\u0275\u0275advance"](5),x["\u0275\u0275property"]("ngIf",e.readMode),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",!e.readMode)}}function Rt(e,t){1&e&&(x["\u0275\u0275text"](0,"\n  "),x["\u0275\u0275elementStart"](1,"div",25),x["\u0275\u0275text"](2,"\n    "),x["\u0275\u0275elementStart"](3,"h4",26),x["\u0275\u0275text"](4),x["\u0275\u0275pipe"](5,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](6,"\n    "),x["\u0275\u0275elementStart"](7,"button",27),x["\u0275\u0275listener"]("click",(function(){return(0,t.dismiss)("cancel")})),x["\u0275\u0275text"](8,"\n      "),x["\u0275\u0275elementStart"](9,"span",28),x["\u0275\u0275text"](10,"\xd7"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](11,"\n    "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](12,"\n  "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](13,"\n  "),x["\u0275\u0275elementStart"](14,"div",29),x["\u0275\u0275text"](15,"\n    "),x["\u0275\u0275elementStart"](16,"p"),x["\u0275\u0275text"](17),x["\u0275\u0275pipe"](18,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](19,"\n  "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](20,"\n  "),x["\u0275\u0275elementStart"](21,"div",30),x["\u0275\u0275text"](22,"\n    "),x["\u0275\u0275elementStart"](23,"button",31),x["\u0275\u0275listener"]("click",(function(){return(0,t.close)("cancel")})),x["\u0275\u0275text"](24),x["\u0275\u0275pipe"](25,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](26,"\n    "),x["\u0275\u0275elementStart"](27,"button",32),x["\u0275\u0275listener"]("click",(function(){return(0,t.close)("ok")})),x["\u0275\u0275text"](28),x["\u0275\u0275pipe"](29,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](30,"\n  "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](31,"\n")),2&e&&(x["\u0275\u0275advance"](4),x["\u0275\u0275textInterpolate"](x["\u0275\u0275pipeBind1"](5,4,"submission.sections.upload.delete.confirm.title")),x["\u0275\u0275advance"](13),x["\u0275\u0275textInterpolate"](x["\u0275\u0275pipeBind1"](18,6,"submission.sections.upload.delete.confirm.info")),x["\u0275\u0275advance"](7),x["\u0275\u0275textInterpolate"](x["\u0275\u0275pipeBind1"](25,8,"submission.sections.upload.delete.confirm.cancel")),x["\u0275\u0275advance"](4),x["\u0275\u0275textInterpolate"](x["\u0275\u0275pipeBind1"](29,10,"submission.sections.upload.delete.confirm.submit")))}let $t=(()=>{class e{constructor(e,t,n,i,s,o,a,r,c){this.cdr=e,this.fileService=t,this.formService=n,this.halService=i,this.modalService=s,this.operationsBuilder=o,this.operationsService=a,this.submissionService=r,this.uploadService=c,this.processingDelete$=new ue.a(!1),this.subscriptions=[],this.readMode=!0}ngOnChanges(){this.availableAccessConditionOptions&&this.subscriptions.push(this.uploadService.getFileData(this.submissionId,this.sectionId,this.fileId).pipe(Object(m.a)(e=>Object(g.h)(e))).subscribe(e=>{this.fileData=e}))}ngOnInit(){this.formId=this.formService.getUniqueId(this.fileId),this.pathCombiner=new O.a("sections",this.sectionId,"files",this.fileIndex)}deleteFile(){this.operationsBuilder.remove(this.pathCombiner.getPath()),this.subscriptions.push(this.operationsService.jsonPatchByResourceID(this.submissionService.getSubmissionObjectLinkName(),this.submissionId,this.pathCombiner.rootElement,this.pathCombiner.subRootElement).subscribe(()=>{this.uploadService.removeUploadedFile(this.submissionId,this.sectionId,this.fileId),this.processingDelete$.next(!1)}))}confirmDelete(e){this.modalService.open(e).result.then(e=>{"ok"===e&&(this.processingDelete$.next(!0),this.deleteFile())})}downloadBitstreamFile(){this.halService.getEndpoint("bitstreams").pipe(Object(Ue.a)()).subscribe(e=>{this.fileService.retrieveFileDownloadLink(`${e}/${this.fileData.uuid}/content`)})}saveBitstreamData(e){e.preventDefault(),this.formService.validateAllFormFields(this.fileEditComp.formRef.formGroup),this.subscriptions.push(this.formService.isValid(this.formId).pipe(Object(d.a)(1),Object(m.a)(e=>e),Object(l.a)(()=>this.formService.getFormData(this.formId)),Object(d.a)(1),Object(l.a)(e=>{Object.keys(e.metadata).filter(t=>Object(g.e)(e.metadata[t])).forEach(t=>{const n=t.replace(/_/g,".");this.operationsBuilder.add(this.pathCombiner.getPath(`metadata/${n}`),e.metadata[t],!0)});const t=[];return e.accessConditions.filter(e=>Object(g.e)(e)).forEach(e=>{let n;if(this.availableAccessConditionOptions.filter(t=>Object(g.g)(e.name)&&t.name===e.name[0].value).forEach(e=>n=e),n){if(n=Object.assign({},e),n.name=this.retrieveValueFromField(e.name),e.startDate){const t=this.retrieveValueFromField(e.startDate);n.startDate=Object(Je.a)(t)}if(e.endDate){const t=this.retrieveValueFromField(e.endDate);n.endDate=Object(Je.a)(t)}t.push(n)}}),Object(g.e)(t)&&this.operationsBuilder.add(this.pathCombiner.getPath("accessConditions"),t,!0),this.operationsService.jsonPatchByResourceID(this.submissionService.getSubmissionObjectLinkName(),this.submissionId,this.pathCombiner.rootElement,this.pathCombiner.subRootElement)})).subscribe(e=>{e[0].sections.upload&&Object.keys(e[0].sections.upload.files).filter(t=>e[0].sections.upload.files[t].uuid===this.fileId).forEach(t=>this.uploadService.updateFileData(this.submissionId,this.sectionId,this.fileId,e[0].sections.upload.files[t])),this.switchMode()}))}retrieveValueFromField(e){const t=Array.isArray(e)?e[0]:e;return t?t.value:void 0}switchMode(){this.readMode=!this.readMode,this.cdr.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275directiveInject"](x.ChangeDetectorRef),x["\u0275\u0275directiveInject"](ot.a),x["\u0275\u0275directiveInject"](f.a),x["\u0275\u0275directiveInject"](xe.a),x["\u0275\u0275directiveInject"](at.u),x["\u0275\u0275directiveInject"](Re.a),x["\u0275\u0275directiveInject"](ce.a),x["\u0275\u0275directiveInject"](E.a),x["\u0275\u0275directiveInject"](be))},e.\u0275cmp=x["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-upload-section-file"]],viewQuery:function(e,t){var n;1&e&&x["\u0275\u0275viewQuery"](st,!0),2&e&&x["\u0275\u0275queryRefresh"](n=x["\u0275\u0275loadQuery"]())&&(t.fileEditComp=n.first)},inputs:{availableAccessConditionOptions:"availableAccessConditionOptions",collectionId:"collectionId",collectionPolicyType:"collectionPolicyType",configMetadataForm:"configMetadataForm",fileId:"fileId",fileIndex:"fileIndex",fileName:"fileName",sectionId:"sectionId",submissionId:"submissionId"},features:[x["\u0275\u0275NgOnChangesFeature"]],decls:5,vars:1,consts:[[4,"ngIf"],["content",""],[1,"row"],[1,"col-md-2"],[3,"thumbnail"],[1,"col-md-10"],[1,"float-left","w-75"],[1,"text-muted"],[1,"float-right","w-15"],[1,"clearfix"],[3,"fileData",4,"ngIf"],[3,"availableAccessConditionOptions","collectionId","collectionPolicyType","configMetadataForm","fileData","fileId","fileIndex","formId","sectionId",4,"ngIf"],[1,"btn","btn-link",3,"click"],["aria-hidden","true",1,"fa","fa-download","fa-2x","text-normal"],[1,"fa","fa-edit","fa-2x","text-normal"],[1,"btn","btn-link",3,"title","disabled","click"],["class","fas fa-circle-notch fa-spin fa-2x text-danger",4,"ngIf"],["class","fa fa-trash fa-2x text-danger",4,"ngIf"],[1,"fas","fa-circle-notch","fa-spin","fa-2x","text-danger"],[1,"fa","fa-trash","fa-2x","text-danger"],[1,"btn","btn-link",3,"title","click"],[1,"fa","fa-save","fa-2x","text-success"],[1,"fa","fa-ban","fa-2x","text-warning"],[3,"fileData"],[3,"availableAccessConditionOptions","collectionId","collectionPolicyType","configMetadataForm","fileData","fileId","fileIndex","formId","sectionId"],[1,"modal-header"],[1,"modal-title","text-danger"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(e,t){1&e&&(x["\u0275\u0275template"](0,Tt,36,11,"ng-container",0),x["\u0275\u0275text"](1,"\n\n"),x["\u0275\u0275template"](2,Rt,32,12,"ng-template",null,1,x["\u0275\u0275templateRefExtractor"]),x["\u0275\u0275text"](4,"\n")),2&e&&x["\u0275\u0275property"]("ngIf",t.fileData)},directives:[P.u,rt.a,Ct,st],pipes:[Et.a,$.e,P.b],styles:[".sticky-buttons[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:calc(var(--bs-dropdown-item-padding-x) * 3);z-index:var(--ds-submission-footer-z-index);background-color:hsla(0,0%,100%,.97)}"]}),e})();var Pt=n("THnG"),_t=n("a318"),At=n("RMpN"),Nt=n("3cpT"),qt=n("20cJ"),Ut=n("6c/T"),Jt=n("8U9A"),Gt=n("UXhX"),Qt=n("8aB6"),Yt=n("O/5o");function zt(e,t){1&e&&(x["\u0275\u0275elementStart"](0,"span"),x["\u0275\u0275text"](1,"\n        "),x["\u0275\u0275element"](2,"ds-loading"),x["\u0275\u0275text"](3,"\n      "),x["\u0275\u0275elementEnd"]())}function Ht(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"span"),x["\u0275\u0275text"](1),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n        ",e.getSelectedCcLicense().name,"\n      ")}}function Kt(e,t){1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1),x["\u0275\u0275pipe"](2,"translate"),x["\u0275\u0275elementContainerEnd"]()),2&e&&(x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n          ",x["\u0275\u0275pipeBind1"](2,1,"submission.sections.ccLicense.change"),"\n        "))}function Xt(e,t){1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1),x["\u0275\u0275pipe"](2,"translate"),x["\u0275\u0275elementContainerEnd"]()),2&e&&(x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n          ",x["\u0275\u0275pipeBind1"](2,1,"submission.sections.ccLicense.select"),"\n        "))}function Zt(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"span"),x["\u0275\u0275text"](1,"\n        "),x["\u0275\u0275template"](2,Kt,3,3,"ng-container",3),x["\u0275\u0275text"](3,"\n        "),x["\u0275\u0275template"](4,Xt,3,3,"ng-container",3),x["\u0275\u0275text"](5,"\n      "),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",e.storedCcLicenseLink),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",!e.storedCcLicenseLink)}}function Wt(e,t){1&e&&(x["\u0275\u0275elementStart"](0,"button",7),x["\u0275\u0275text"](1),x["\u0275\u0275pipe"](2,"translate"),x["\u0275\u0275elementEnd"]()),2&e&&(x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n        ",x["\u0275\u0275pipeBind1"](2,1,"submission.sections.ccLicense.none"),"\n      "))}function en(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementStart"](0,"button",8),x["\u0275\u0275listener"]("click",(function(){x["\u0275\u0275restoreView"](e);const n=t.$implicit;return x["\u0275\u0275nextContext"]().selectCcLicense(n)})),x["\u0275\u0275text"](1),x["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n        ",e.name,"\n      ")}}function tn(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"div",10),x["\u0275\u0275text"](1,"\n            "),x["\u0275\u0275elementStart"](2,"h5"),x["\u0275\u0275text"](3),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](4,"\n            "),x["\u0275\u0275element"](5,"div",20),x["\u0275\u0275text"](6,"\n          "),x["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;x["\u0275\u0275advance"](3),x["\u0275\u0275textInterpolate1"]("\n              ",e.label,"\n            "),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("innerHTML",e.description,x["\u0275\u0275sanitizeHtml"])}}function nn(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275text"](0,"\n\n      "),x["\u0275\u0275elementStart"](1,"div"),x["\u0275\u0275text"](2,"\n\n        "),x["\u0275\u0275elementStart"](3,"div",15),x["\u0275\u0275text"](4,"\n          "),x["\u0275\u0275elementStart"](5,"div"),x["\u0275\u0275text"](6,"\n            "),x["\u0275\u0275elementStart"](7,"h4"),x["\u0275\u0275text"](8),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](9,"\n            "),x["\u0275\u0275element"](10,"div",16),x["\u0275\u0275text"](11,"\n          "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](12,"\n          "),x["\u0275\u0275elementStart"](13,"button",17),x["\u0275\u0275listener"]("click",(function(){return x["\u0275\u0275restoreView"](e),x["\u0275\u0275nextContext"](3).closeInfoModal()})),x["\u0275\u0275text"](14,"\n            "),x["\u0275\u0275elementStart"](15,"span",18),x["\u0275\u0275text"](16,"\xd7"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](17,"\n          "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](18,"\n        "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](19,"\n\n        "),x["\u0275\u0275elementStart"](20,"div",19),x["\u0275\u0275text"](21,"\n          "),x["\u0275\u0275template"](22,tn,7,2,"div",9),x["\u0275\u0275text"](23,"\n        "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](24,"\n\n      "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](25,"\n\n    ")}if(2&e){const e=x["\u0275\u0275nextContext"]().$implicit;x["\u0275\u0275advance"](8),x["\u0275\u0275textInterpolate1"]("\n              ",e.label,"\n            "),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("innerHTML",e.description,x["\u0275\u0275sanitizeHtml"]),x["\u0275\u0275advance"](12),x["\u0275\u0275property"]("ngForOf",e.enums)}}function sn(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"span"),x["\u0275\u0275text"](1),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]().ngVar;x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n          ",e.label,"\n        ")}}function on(e,t){1&e&&(x["\u0275\u0275elementStart"](0,"span"),x["\u0275\u0275text"](1),x["\u0275\u0275pipe"](2,"translate"),x["\u0275\u0275elementEnd"]()),2&e&&(x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n          ",x["\u0275\u0275pipeBind1"](2,1,"submission.sections.ccLicense.option.select"),"\n        "))}function an(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0,2),x["\u0275\u0275text"](1,"\n        "),x["\u0275\u0275template"](2,sn,2,1,"span",3),x["\u0275\u0275text"](3,"\n        "),x["\u0275\u0275template"](4,on,3,3,"span",3),x["\u0275\u0275text"](5,"\n      "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngVar;x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",e),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",!e)}}function rn(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementStart"](0,"button",8),x["\u0275\u0275listener"]("click",(function(){x["\u0275\u0275restoreView"](e);const n=t.$implicit,i=x["\u0275\u0275nextContext"](2).$implicit,s=x["\u0275\u0275nextContext"](2);return s.selectOption(s.getSelectedCcLicense(),i,n)})),x["\u0275\u0275text"](1),x["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n            ",e.label,"\n          ")}}function cn(e,t){if(1&e&&(x["\u0275\u0275elementStart"](0,"ds-select"),x["\u0275\u0275text"](1,"\n      "),x["\u0275\u0275template"](2,an,6,2,"ng-container",21),x["\u0275\u0275text"](3,"\n      "),x["\u0275\u0275elementContainerStart"](4,4),x["\u0275\u0275text"](5,"\n        "),x["\u0275\u0275elementStart"](6,"div",22),x["\u0275\u0275text"](7,"\n          "),x["\u0275\u0275template"](8,rn,2,1,"button",6),x["\u0275\u0275text"](9,"\n        "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](10,"\n      "),x["\u0275\u0275elementContainerEnd"](),x["\u0275\u0275text"](11,"\n    "),x["\u0275\u0275elementEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]().$implicit,t=x["\u0275\u0275nextContext"](2);x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngVar",t.getSelectedOption(t.getSelectedCcLicense(),e)),x["\u0275\u0275advance"](6),x["\u0275\u0275property"]("ngForOf",e.enums)}}function ln(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementStart"](0,"div",24),x["\u0275\u0275text"](1,"\n        "),x["\u0275\u0275elementStart"](2,"div",25),x["\u0275\u0275listener"]("click",(function(){x["\u0275\u0275restoreView"](e);const n=t.$implicit,i=x["\u0275\u0275nextContext"](2).$implicit,s=x["\u0275\u0275nextContext"](2);return s.selectOption(s.getSelectedCcLicense(),i,n)})),x["\u0275\u0275text"](3,"\n          "),x["\u0275\u0275element"](4,"input",26),x["\u0275\u0275text"](5,"\n          "),x["\u0275\u0275elementStart"](6,"span"),x["\u0275\u0275text"](7),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](8,"\n        "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](9,"\n      "),x["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=x["\u0275\u0275nextContext"](2).$implicit,i=x["\u0275\u0275nextContext"](2);x["\u0275\u0275advance"](4),x["\u0275\u0275propertyInterpolate"]("title",e.label),x["\u0275\u0275property"]("checked",i.isSelectedOption(i.getSelectedCcLicense(),n,e)),x["\u0275\u0275advance"](3),x["\u0275\u0275textInterpolate"](e.label)}}function dn(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n      "),x["\u0275\u0275template"](2,ln,10,3,"div",23),x["\u0275\u0275text"](3,"\n    "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]().$implicit;x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngForOf",e.enums)}}function pn(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementStart"](0,"div",10),x["\u0275\u0275text"](1,"\n\n    "),x["\u0275\u0275elementStart"](2,"div",11),x["\u0275\u0275text"](3,"\n      "),x["\u0275\u0275elementStart"](4,"div"),x["\u0275\u0275text"](5),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](6,"\n      "),x["\u0275\u0275elementStart"](7,"button",12),x["\u0275\u0275listener"]("click",(function(){x["\u0275\u0275restoreView"](e);const t=x["\u0275\u0275reference"](14);return x["\u0275\u0275nextContext"](2).openInfoModal(t)})),x["\u0275\u0275text"](8,"\n        "),x["\u0275\u0275element"](9,"i",13),x["\u0275\u0275text"](10,"\n      "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](11,"\n    "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](12,"\n\n    "),x["\u0275\u0275template"](13,nn,26,3,"ng-template",null,14,x["\u0275\u0275templateRefExtractor"]),x["\u0275\u0275text"](15,"\n\n    "),x["\u0275\u0275template"](16,cn,12,2,"ds-select",3),x["\u0275\u0275text"](17,"\n\n    "),x["\u0275\u0275template"](18,dn,4,1,"ng-container",3),x["\u0275\u0275text"](19,"\n\n  "),x["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;x["\u0275\u0275advance"](4),x["\u0275\u0275classMapInterpolate1"]("font-weight-bold ",e.id,""),x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n        ",e.label,"\n      "),x["\u0275\u0275advance"](11),x["\u0275\u0275property"]("ngIf",(null==e.enums?null:e.enums.length)>5),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",(null==e.enums?null:e.enums.length)<=5)}}function un(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n\n  "),x["\u0275\u0275template"](2,pn,20,6,"div",9),x["\u0275\u0275text"](3,"\n\n"),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngForOf",e.getSelectedCcLicense().fields)}}function mn(e,t){1&e&&(x["\u0275\u0275elementStart"](0,"div"),x["\u0275\u0275text"](1,"\n      "),x["\u0275\u0275element"](2,"ds-loading"),x["\u0275\u0275text"](3,"\n    "),x["\u0275\u0275elementEnd"]())}function bn(e,t){if(1&e){const e=x["\u0275\u0275getCurrentView"]();x["\u0275\u0275elementStart"](0,"div",29),x["\u0275\u0275text"](1,"\n      "),x["\u0275\u0275elementStart"](2,"div"),x["\u0275\u0275text"](3),x["\u0275\u0275pipe"](4,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](5,"\n      "),x["\u0275\u0275elementStart"](6,"a",30),x["\u0275\u0275text"](7),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](8,"\n      "),x["\u0275\u0275elementStart"](9,"div",31),x["\u0275\u0275text"](10,"\n        "),x["\u0275\u0275elementStart"](11,"div",25),x["\u0275\u0275listener"]("click",(function(){x["\u0275\u0275restoreView"](e);const t=x["\u0275\u0275nextContext"](3);return t.setAccepted(!t.accepted)})),x["\u0275\u0275text"](12,"\n          "),x["\u0275\u0275element"](13,"input",32),x["\u0275\u0275text"](14,"\n          "),x["\u0275\u0275elementStart"](15,"span"),x["\u0275\u0275text"](16),x["\u0275\u0275pipe"](17,"translate"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](18,"\n        "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](19,"\n      "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](20,"\n    "),x["\u0275\u0275elementEnd"]()}if(2&e){const e=x["\u0275\u0275nextContext"]().ngVar,t=x["\u0275\u0275nextContext"](2);x["\u0275\u0275advance"](3),x["\u0275\u0275textInterpolate1"]("\n        ",x["\u0275\u0275pipeBind1"](4,5,"submission.sections.ccLicense.link"),"\n      "),x["\u0275\u0275advance"](3),x["\u0275\u0275propertyInterpolate"]("href",e,x["\u0275\u0275sanitizeUrl"]),x["\u0275\u0275advance"](1),x["\u0275\u0275textInterpolate1"]("\n        ",e,"\n      "),x["\u0275\u0275advance"](6),x["\u0275\u0275property"]("checked",t.accepted),x["\u0275\u0275advance"](3),x["\u0275\u0275textInterpolate"](x["\u0275\u0275pipeBind1"](17,7,"submission.sections.ccLicense.confirmation"))}}function hn(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n    "),x["\u0275\u0275template"](2,mn,4,0,"div",3),x["\u0275\u0275text"](3,"\n    "),x["\u0275\u0275template"](4,bn,21,9,"div",28),x["\u0275\u0275text"](5,"\n  "),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngVar;x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",!e),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",e)}}function fn(e,t){if(1&e&&(x["\u0275\u0275elementContainerStart"](0),x["\u0275\u0275text"](1,"\n  "),x["\u0275\u0275template"](2,hn,6,2,"ng-container",27),x["\u0275\u0275pipe"](3,"async"),x["\u0275\u0275text"](4,"\n"),x["\u0275\u0275elementContainerEnd"]()),2&e){const e=x["\u0275\u0275nextContext"]();x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngVar",x["\u0275\u0275pipeBind1"](3,1,e.getCcLicenseLink$()))}}let vn=(()=>{let e=class extends S{constructor(e,t,n,i,s,o,a,r){super(o,a,r),this.modalService=e,this.sectionService=t,this.submissionCcLicensesDataService=n,this.submissionCcLicenseUrlDataService=i,this.operationsBuilder=s,this.injectedCollectionId=o,this.injectedSectionData=a,this.injectedSubmissionId=r,this.isLoading=!0,this.subscriptions=[]}get storedCcLicenseLink(){return this.data.uri}get accepted(){return void 0===this.data.accepted?!!this.data.uri:this.data.accepted}get data(){return this.sectionData.data}selectCcLicense(e){this.getSelectedCcLicense()&&this.getSelectedCcLicense().id===e.id||(this.setAccepted(!1),this.updateSectionData({ccLicense:{id:e.id,fields:{}},uri:void 0}))}getSelectedCcLicense(){return this.submissionCcLicenses&&this.data.ccLicense?this.submissionCcLicenses.filter(e=>e.id===this.data.ccLicense.id)[0]:null}selectOption(e,t,n){this.isSelectedOption(e,t,n)||this.updateSectionData({ccLicense:{id:e.id,fields:Object.assign({},this.data.ccLicense.fields,{[t.id]:n})},accepted:!1})}getSelectedOption(e,t){return this.data.ccLicense.fields[t.id]}isSelectedOption(e,t,n){return this.getSelectedOption(e,t)&&this.getSelectedOption(e,t).id===n.id}getCcLicenseLink$(){if(this.storedCcLicenseLink)return Object(te.a)(this.storedCcLicenseLink);if(!this.getSelectedCcLicense()||this.getSelectedCcLicense().fields.some(e=>!this.getSelectedOption(this.getSelectedCcLicense(),e)))return;const e=this.getSelectedCcLicense();return this.submissionCcLicenseUrlDataService.getCcLicenseLink(e,new Map(e.fields.map(t=>[t,this.getSelectedOption(e,t)])))}openInfoModal(e){this.modalRef=this.modalService.open(e)}closeInfoModal(){this.modalRef.close()}getSectionStatus(){return Object(te.a)(this.accepted)}onSectionDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}onSectionInit(){this.pathCombiner=new O.a("sections",this.sectionData.id),this.subscriptions.push(this.sectionService.getSectionState(this.submissionId,this.sectionData.id,C.a.CcLicense).pipe(Object(m.a)(e=>Object(g.e)(e)&&(Object(g.e)(e.data)||Object(g.e)(e.errors))),Object(u.a)(),Object(r.a)(e=>e.data)).subscribe(e=>{if(this.data.accepted!==e.accepted){const t=this.pathCombiner.getPath("uri");e.accepted?this.getCcLicenseLink$().pipe(Object(d.a)(1)).subscribe(e=>{this.operationsBuilder.add(t,e.toString(),!1,!0)}):this.data.uri&&this.operationsBuilder.remove(t)}this.sectionData.data=e}),this.submissionCcLicensesDataService.findAll({elementsPerPage:9999}).pipe(Object(k.i)(),Object(k.o)(),Object(r.a)(e=>e.page)).subscribe(e=>this.submissionCcLicenses=e))}setAccepted(e){this.updateSectionData({accepted:e}),this.updateSectionStatus()}updateSectionData(e){this.sectionService.updateSectionData(this.submissionId,this.sectionData.id,Object.assign({},this.data,e))}};return e.\u0275fac=function(t){return new(t||e)(x["\u0275\u0275directiveInject"](at.u),x["\u0275\u0275directiveInject"](F.a),x["\u0275\u0275directiveInject"](Jt.a),x["\u0275\u0275directiveInject"](Gt.a),x["\u0275\u0275directiveInject"](Re.a),x["\u0275\u0275directiveInject"]("collectionIdProvider"),x["\u0275\u0275directiveInject"]("sectionDataProvider"),x["\u0275\u0275directiveInject"]("submissionIdProvider"))},e.\u0275cmp=x["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-section-cc-licenses"]],features:[x["\u0275\u0275InheritDefinitionFeature"]],decls:26,vars:8,consts:[[1,"mb-4","ccLicense-select"],[3,"disabled"],[1,"selection"],[4,"ngIf"],[1,"menu"],["class","dropdown-item disabled",4,"ngIf"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"dropdown-item","disabled"],[1,"dropdown-item",3,"click"],["class","mb-4",4,"ngFor","ngForOf"],[1,"mb-4"],[1,"d-flex","flex-row"],[1,"btn","btn-outline-info","btn-sm","ml-2",3,"click"],[1,"fas","fa-question"],["infoModal",""],[1,"modal-header","mb-4"],[3,"innerHTML"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"font-weight-light",3,"innerHTML"],["class","selection",4,"ngVar"],[1,"options-select-menu","overflow-auto"],["class","d-flex flex-row m-1",4,"ngFor","ngForOf"],[1,"d-flex","flex-row","m-1"],[3,"click"],["type","radio",1,"mr-1",3,"title","checked"],[4,"ngVar"],["class","mt-2 p-4 bg-light text-dark",4,"ngIf"],[1,"mt-2","p-4","bg-light","text-dark"],["target","_blank","rel","noopener noreferrer",1,"license-link",3,"href"],[1,"m-2"],["type","checkbox","title","accepted",3,"checked"]],template:function(e,t){1&e&&(x["\u0275\u0275elementStart"](0,"div",0),x["\u0275\u0275text"](1,"\n  "),x["\u0275\u0275elementStart"](2,"ds-select",1),x["\u0275\u0275text"](3,"\n\n    "),x["\u0275\u0275elementContainerStart"](4,2),x["\u0275\u0275text"](5,"\n      "),x["\u0275\u0275template"](6,zt,4,0,"span",3),x["\u0275\u0275text"](7,"\n      "),x["\u0275\u0275template"](8,Ht,2,1,"span",3),x["\u0275\u0275text"](9,"\n      "),x["\u0275\u0275template"](10,Zt,6,2,"span",3),x["\u0275\u0275text"](11,"\n    "),x["\u0275\u0275elementContainerEnd"](),x["\u0275\u0275text"](12,"\n\n    "),x["\u0275\u0275elementContainerStart"](13,4),x["\u0275\u0275text"](14,"\n      "),x["\u0275\u0275template"](15,Wt,3,3,"button",5),x["\u0275\u0275text"](16,"\n      "),x["\u0275\u0275template"](17,en,2,1,"button",6),x["\u0275\u0275text"](18,"\n    "),x["\u0275\u0275elementContainerEnd"](),x["\u0275\u0275text"](19,"\n\n  "),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](20,"\n"),x["\u0275\u0275elementEnd"](),x["\u0275\u0275text"](21,"\n\n"),x["\u0275\u0275template"](22,un,4,1,"ng-container",3),x["\u0275\u0275text"](23,"\n\n"),x["\u0275\u0275template"](24,fn,5,3,"ng-container",3),x["\u0275\u0275text"](25,"\n")),2&e&&(x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("disabled",!t.submissionCcLicenses),x["\u0275\u0275advance"](4),x["\u0275\u0275property"]("ngIf",!t.submissionCcLicenses),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",t.getSelectedCcLicense()),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",t.submissionCcLicenses&&!t.getSelectedCcLicense()),x["\u0275\u0275advance"](5),x["\u0275\u0275property"]("ngIf",0==(null==t.submissionCcLicenses?null:t.submissionCcLicenses.length)),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngForOf",t.submissionCcLicenses),x["\u0275\u0275advance"](5),x["\u0275\u0275property"]("ngIf",t.getSelectedCcLicense()),x["\u0275\u0275advance"](2),x["\u0275\u0275property"]("ngIf",t.getCcLicenseLink$()))},directives:[Qt.a,P.u,P.t,_.a,Yt.a],pipes:[$.e,P.b],styles:[".options-select-menu[_ngcontent-%COMP%]{max-height:25vh}"]}),e=Object(o.b)([Object(j.a)(C.a.CcLicense)],e),e})();var gn=n("N0eT"),xn=n("udvk"),Sn=n("YoQ9"),In=n("Ahb/"),On=n("qK5G"),yn=n("cRUs"),jn=n("hTYz"),Cn=n("pYyI"),En=n("s7LF"),Dn=n("MNke"),wn=n("xkgV"),Fn=n("iInd"),Mn=n("3Pji"),kn=n("UVXo"),Ln=n("7KAL"),Bn=n("ltgo"),Vn=n("y7ui"),Tn=n("VYMa"),Rn=n("Xhx+"),$n=n("xEHW"),Pn=n("gLKo"),_n=n("tLeP"),An=n("nNzF"),Nn=n("SFhV"),qn=n("mXTb"),Un=n("KPLb"),Jn=n("DExz"),Gn=n("J8r5"),Qn=n("Bvcw"),Yn=n("YLfV"),zn=n("V17L"),Hn=n("S8sI"),Kn=n("NvTF"),Xn=n("ZO65"),Zn=n("0pnk"),Wn=n("sw+l"),ei=n("1Pbu"),ti=n("bPV6"),ni=n("Gu/b"),ii=n("A/iK"),si=n("KKO+"),oi=n("Ysrn"),ai=n("tqJZ"),ri=n("ZTun"),ci=n("uyTL"),li=n("HZwm"),di=n("6CLs"),pi=n("ttM+"),ui=n("845l"),mi=n("v/mu"),bi=n("4LOp"),hi=n("ZFle"),fi=n("fIR8"),vi=n("WgDD"),gi=n("jLV+"),xi=n("Exvd"),Si=n("DdXh"),Ii=n("lZVp"),Oi=n("8gmk"),yi=n("DNss"),ji=n("FExQ"),Ci=n("1a/3"),Ei=n("4zj/"),Di=n("L6kw"),wi=n("ij5K"),Fi=n("vGbP"),Mi=n("Gw2O"),ki=n("eO7r"),Li=n("tOny"),Bi=n("1I3N"),Vi=n("Nz5a"),Ti=n("0/Mm"),Ri=n("h8Z3"),$i=n("SU/f"),Pi=n("wTtK"),_i=n("y3mP"),Ai=n("3Rjm"),Ni=n("CEsD"),qi=n("fxJx"),Ui=n("93cK"),Ji=n("y/PT"),Gi=n("Ybtn"),Qi=n("MTb2"),Yi=n("3H9X"),zi=n("Xool"),Hi=n("8pnQ"),Ki=n("Kr+g"),Xi=n("BI7K"),Zi=n("kaIh"),Wi=n("uly2"),es=n("Elg+"),ts=n("0f0u"),ns=n("/ESF"),is=n("fjB9"),ss=n("83zO"),os=n("ecQD"),as=n("JYDz"),rs=n("riZU"),cs=n("6+O9"),ls=n("SJRl"),ds=n("xG+5"),ps=n("y0lz"),us=n("oEms"),ms=n("/pN5"),bs=n("i/kS"),hs=n("hIOQ"),fs=n("Qzqf"),vs=n("viO8"),gs=n("gZAJ"),xs=n("xEMa"),Ss=n("Bjvk"),Is=n("HKEE"),Os=n("pQc5"),ys=n("OgmJ"),js=n("EmA+"),Cs=n("IJQe"),Es=n("pKvA"),Ds=n("1aCu"),ws=n("PSvP"),Fs=n("oGY6"),Ms=n("iz6e"),ks=n("JYRs"),Ls=n("daFX"),Bs=n("6nfC"),Vs=n("MpTx"),Ts=n("xjoE"),Rs=n("Oupr"),$s=n("f7iX"),Ps=n("Ytjd"),_s=n("a1Jy"),As=n("zGzN"),Ns=n("3lxO"),qs=n("yXJd"),Us=n("/Vzl"),Js=n("8UYb"),Gs=n("8mI/"),Qs=n("8gBe"),Ys=n("Y9an"),zs=n("OUbH"),Hs=n("6xaB"),Ks=n("3pMV"),Xs=n("MkTI"),Zs=n("+Bs4"),Ws=n("O/Ly"),eo=n("ALMP"),to=n("EEUA"),no=n("539a"),io=n("XR30"),so=n("P2PV"),oo=n("OXP5"),ao=n("Gt6B"),ro=n("Oqsf"),co=n("Ixlc"),lo=n("Q8wr"),po=n("97Yq"),uo=n("zdyR"),mo=n("Rgmz"),bo=n("UVdL"),ho=n("rrDp"),fo=n("rT2D"),vo=n("KRdn"),go=n("qHOp"),xo=n("yc3A"),So=n("VV3J"),Io=n("uUdI"),Oo=n("K1CC"),yo=n("aZ//"),jo=n("Ui2r"),Co=n("8HnP"),Eo=n("EOhw"),Do=n("zVKZ"),wo=n("Z9xA"),Fo=n("8a1q"),Mo=n("kivT"),ko=n("bg5s"),Lo=n("4Q22"),Bo=n("uf49"),Vo=n("zCuV"),To=n("PApk"),Ro=n("vv5f"),$o=n("LMaQ"),Po=n("uVW2"),_o=n("UX6V"),Ao=n("mK1h"),No=n("Zmll"),qo=n("5qu4"),Uo=n("D1Lt"),Jo=n("N0QX"),Go=n("Y8Hs"),Qo=n("Nsr3"),Yo=n("nypr"),zo=n("jOLk"),Ho=n("awfb"),Ko=n("BIe1"),Xo=n("OWWE"),Zo=n("aojn"),Wo=n("NM6P"),ea=n("936P"),ta=n("Wm14"),na=n("cQ11"),ia=n("4Kdc"),sa=n("ozG+"),oa=n("xPuV"),aa=n("mfPM"),ra=n("oKKW"),ca=n("lawv"),la=n("AeMR"),da=n("YJCx"),pa=n("e1k8"),ua=n("7ny6"),ma=n("rfZC"),ba=n("snSO"),ha=n("pEOr"),fa=n("UGKy");let va=(()=>{class e{}return e.\u0275mod=x["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=x["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[be,F.a,Ce],imports:[[P.c,i.a.forRoot(),s.a,X.j.forFeature("submission",W.a,_t.d),Z.c.forFeature(pe),gn.a.withEntryComponents(),xn.a.withEntryComponents()]]}),e})();x["\u0275\u0275setComponentScope"](Ve,[P.r,P.s,P.t,P.u,P.B,P.x,P.y,P.z,P.A,P.v,P.w,yn.a,Ge.J,Ge.N,jn.b,jn.c,jn.d,jn.e,jn.f,jn.g,jn.h,jn.i,jn.j,jn.k,jn.l,jn.m,jn.n,jn.o,jn.p,Cn.a,Cn.b,En["\u0275angular_packages_forms_forms_y"],En.NgSelectOption,En["\u0275angular_packages_forms_forms_x"],En.DefaultValueAccessor,En.NumberValueAccessor,En.RangeValueAccessor,En.CheckboxControlValueAccessor,En.SelectControlValueAccessor,En.SelectMultipleControlValueAccessor,En.RadioControlValueAccessor,En.NgControlStatus,En.NgControlStatusGroup,En.RequiredValidator,En.MinLengthValidator,En.MaxLengthValidator,En.PatternValidator,En.CheckboxRequiredValidator,En.EmailValidator,En.NgModel,En.NgModelGroup,En.NgForm,Dn.a,at.a,at.K,at.N,at.L,at.M,at.O,at.c,at.d,at.g,at.S,at.R,at.f,at.W,at.h,at.i,at.k,at.t,at.m,at.n,at.o,at.r,at.q,at.p,at.B,at.x,at.w,at.y,at.z,at.A,at.C,at.E,at.F,at.G,at.H,at.I,at.J,at.P,at.Q,at.T,at.bb,at.eb,at.fb,at.gb,at.hb,at.s,at.ab,at.X,at.Y,at.Z,wn.c,wn.d,En.FormControlDirective,En.FormGroupDirective,En.FormControlName,En.FormGroupName,En.FormArrayName,Fn.l,Fn.h,Fn.j,Fn.i,Fn.o,Mn.a,kn.MaskedInputDirective,Ln.a,Bn.e,Bn.f,Bn.a,Bn.b,Bn.d,Bn.c,Vn.a,Vn.e,Vn.g,Vn.h,Vn.b,Vn.d,Vn.f,Tn.a,Rn.a,$n.a,Pn.a,_n.a,An.a,Nn.a,qn.a,Un.a,Jn.a,Gn.a,Qn.a,Yn.a,zn.a,Hn.a,Kn.a,Xn.a,Zn.a,Wn.a,ei.a,ti.a,ni.a,ii.a,si.a,oi.b,ai.a,ri.a,ci.a,Qt.a,li.a,A.a,di.a,_.a,pi.a,ui.a,mi.a,bi.a,hi.a,fi.a,vi.a,gi.a,xi.a,Si.a,Ii.a,Oi.a,yi.a,ji.a,rt.a,Ci.a,Ei.a,Di.a,wi.a,Fi.a,Mi.a,ki.a,Li.a,Bi.a,Vi.a,Ti.a,Ri.a,$i.a,Pi.a,_i.a,Ai.a,Ni.a,qi.a,Ui.a,Ji.a,Gi.a,Qi.a,Yi.a,zi.a,Hi.a,Ki.a,Xi.a,Zi.a,Wi.a,es.a,ts.a,ns.a,is.a,ss.a,os.a,as.a,rs.a,cs.a,ls.a,ds.a,ps.a,us.a,ms.a,bs.a,hs.a,fs.a,vs.c,gs.a,xs.a,Ss.a,Is.a,Os.a,ys.a,js.a,Cs.a,Es.a,Ds.a,ws.a,Fs.a,Ms.a,ks.a,Ls.a,Bs.a,Vs.a,Ts.a,Rs.a,$s.a,Ps.a,_s.a,As.a,Ns.a,qs.a,Us.a,Js.a,Gs.a,Qs.a,Ys.a,zs.a,Hs.a,Ks.a,Xs.a,Zs.a,Ws.a,eo.a,to.a,no.a,io.a,so.a,oo.a,ao.a,ro.a,co.a,lo.a,po.a,uo.a,mo.a,bo.a,ho.a,fo.a,vo.a,go.a,xo.a,So.a,Io.a,Oo.a,yo.a,jo.a,Co.a,Eo.a,Do.a,wo.a,Fo.a,Mo.a,ko.a,Lo.a,Bo.a,Vo.a,To.a,Ro.a,$o.a,Po.a,_o.a,Ao.a,No.a,qo.a,Uo.a,Jo.a,Go.ConfigurationSearchPageComponent,Qo.a,Yt.a,Yo.a,zo.a,Ho.a,Ko.a,Xo.a,Zo.a,Wo.a,ea.a,ta.a,na.a,ia.a,sa.a,oa.a,aa.a,ra.a,$.b,mt,Ve,J,Ne,vn,G.a,qe.SubmissionEditComponent,Sn.a,H.a,Q.a,z.a,Y.a,Pt.SubmissionSubmitComponent,In.a,Te.a,K.a,$t,st,Ct,At.SubmissionImportExternalComponent,On.a,Nt.a,qt.a,Ut.a],[P.b,P.I,P.q,P.l,P.F,P.g,P.D,P.G,P.d,P.f,P.j,P.k,P.m,wn.b,ca.a,ca.b,ca.c,ca.d,ca.e,ca.f,ca.m,ca.o,ca.p,ca.q,ca.g,ca.j,ca.k,ca.n,ca.i,ca.h,la.a,Et.a,da.a,bt.a,pa.a,ua.a,ma.a,ba.a,ha.a,fa.a,$.e])},fBXw:function(e,t,n){"use strict";var i=n("TTdl");t.a=(e=[])=>{const t=Object.create({});return e.forEach(e=>{Object(i.a)(e.paths).forEach(n=>{const i={path:n.originalPath,message:e.message};t[n.sectionId]||(t[n.sectionId]=[]),t[n.sectionId].push(i)})}),t}},m4Gq:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n("LRne"),s=n("pLZG"),o=n("lJxs"),a=n("/uUt"),r=n("eIep"),c=n("J3qs"),l=n("ao5O"),d=n("4GeW"),p=n("8Y7J"),u=n("Vurf"),m=n("uLZQ"),b=n("J/vq"),h=n("YJD6"),f=n("SVse"),v=n("wQzj"),g=n("ph1m"),x=n("T/iP"),S=n("Frqi"),I=n("Yfyx"),O=n("yAsG");function y(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div",12),p["\u0275\u0275text"](1,"\n            "),p["\u0275\u0275element"](2,"ds-submission-upload-files",13),p["\u0275\u0275text"](3,"\n            "),p["\u0275\u0275element"](4,"div",14),p["\u0275\u0275text"](5,"\n        "),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275nextContext"](2);p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("submissionId",e.submissionId)("collectionId",e.collectionId)("sectionId","upload")("uploadFilesOptions",e.uploadFilesOptions)}}function j(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",6),p["\u0275\u0275text"](1,"\n        "),p["\u0275\u0275template"](2,y,6,4,"div",7),p["\u0275\u0275pipe"](3,"async"),p["\u0275\u0275text"](4,"\n\n        "),p["\u0275\u0275elementStart"](5,"div",8),p["\u0275\u0275text"](6,"\n            "),p["\u0275\u0275elementStart"](7,"ds-submission-form-collection",9),p["\u0275\u0275listener"]("collectionChange",(function(t){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().onCollectionChange(t)})),p["\u0275\u0275text"](8,"\n            "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275text"](9,"\n        "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275text"](10,"\n        "),p["\u0275\u0275elementStart"](11,"div",10),p["\u0275\u0275text"](12,"\n            "),p["\u0275\u0275elementStart"](13,"ds-submission-form-section-add",11),p["\u0275\u0275text"](14,"\n            "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275text"](15,"\n        "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275text"](16,"\n    "),p["\u0275\u0275elementEnd"]()}if(2&e){const e=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf",p["\u0275\u0275pipeBind1"](3,6,e.uploadEnabled$)),p["\u0275\u0275advance"](5),p["\u0275\u0275property"]("currentCollectionId",e.collectionId)("currentDefinition",e.definitionId)("submissionId",e.submissionId),p["\u0275\u0275advance"](6),p["\u0275\u0275property"]("collectionId",e.collectionId)("submissionId",e.submissionId)}}function C(e,t){1&e&&p["\u0275\u0275element"](0,"ds-loading",15)}function E(e,t){if(1&e&&(p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275text"](1,"\n            "),p["\u0275\u0275element"](2,"ds-submission-section-container",16),p["\u0275\u0275text"](3,"\n        "),p["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit,n=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("collectionId",n.collectionId)("submissionId",n.submissionId)("sectionData",e)}}function D(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div",17),p["\u0275\u0275text"](1,"\n        "),p["\u0275\u0275element"](2,"ds-submission-form-footer",18),p["\u0275\u0275text"](3,"\n    "),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("submissionId",e.submissionId)}}let w=(()=>{class e{constructor(e,t,n,s,o){this.authService=e,this.changeDetectorRef=t,this.halService=n,this.submissionService=s,this.sectionsService=o,this.loading=Object(i.a)(!0),this.uploadFilesOptions=new l.a,this.subs=[],this.isActive=!0}ngOnChanges(e){this.collectionId&&this.submissionId&&(this.isActive=!0,this.submissionSections=this.submissionService.getSubmissionObject(this.submissionId).pipe(Object(s.a)(()=>this.isActive),Object(o.a)(e=>e.isLoading),Object(o.a)(e=>e),Object(a.a)(),Object(r.a)(e=>e?Object(i.a)([]):this.getSectionsList())),this.uploadEnabled$=this.sectionsService.isSectionTypeAvailable(this.submissionId,d.a.Upload),this.loading=this.submissionService.getSubmissionObject(this.submissionId).pipe(Object(s.a)(()=>this.isActive),Object(o.a)(e=>e.isLoading),Object(o.a)(e=>e),Object(a.a)()),this.subs.push(this.halService.getEndpoint("workspaceitems").pipe(Object(s.a)(e=>Object(c.e)(e)),Object(a.a)()).subscribe(e=>{this.uploadFilesOptions.authToken=this.authService.buildAuthHeader(),this.uploadFilesOptions.url=e.concat(`/${this.submissionId}`),this.definitionId=this.submissionDefinition.name,this.submissionService.dispatchInit(this.collectionId,this.submissionId,this.selfUrl,this.submissionDefinition,this.sections,this.item,null),this.changeDetectorRef.detectChanges()})),this.submissionService.startAutoSave(this.submissionId))}ngOnDestroy(){this.isActive=!1,this.submissionService.stopAutoSave(),this.submissionService.resetAllSubmissionObjects(),this.subs.filter(e=>Object(c.b)(e)).forEach(e=>e.unsubscribe())}onCollectionChange(e){this.collectionId=e.collection.id,this.definitionId!==e.submissionDefinition.name?(this.sections=e.sections,this.submissionDefinition=e.submissionDefinition,this.definitionId=this.submissionDefinition.name,this.submissionService.resetSubmissionObject(this.collectionId,this.submissionId,e._links.self.href,this.submissionDefinition,this.sections,this.item)):this.changeDetectorRef.detectChanges()}isLoading(){return this.loading}getSectionsList(){return this.submissionService.getSubmissionSections(this.submissionId).pipe(Object(s.a)(e=>Object(c.e)(e)),Object(o.a)(e=>e))}}return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275directiveInject"](u.a),p["\u0275\u0275directiveInject"](p.ChangeDetectorRef),p["\u0275\u0275directiveInject"](m.a),p["\u0275\u0275directiveInject"](b.a),p["\u0275\u0275directiveInject"](h.a))},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-form"]],inputs:{collectionId:"collectionId",item:"item",sections:"sections",selfUrl:"selfUrl",submissionDefinition:"submissionDefinition",submissionId:"submissionId"},features:[p["\u0275\u0275NgOnChangesFeature"]],decls:18,vars:12,consts:[[1,"container-fluid"],["class","submission-form-header mb-3 d-flex flex-wrap position-sticky",4,"ngIf"],[1,"submission-form-content"],["message","Loading...",4,"ngIf"],[4,"ngFor","ngForOf"],["class","submission-form-footer mt-3 mb-3 position-sticky",4,"ngIf"],[1,"submission-form-header","mb-3","d-flex","flex-wrap","position-sticky"],["class","w-100",4,"ngIf"],[1,"submission-form-header-item","mb-3","mb-sm-0","flex-sm-grow-1","flex-md-grow-0"],[3,"currentCollectionId","currentDefinition","submissionId","collectionChange"],[1,"submission-form-header-item","text-right"],[3,"collectionId","submissionId"],[1,"w-100"],[3,"submissionId","collectionId","sectionId","uploadFilesOptions"],[1,"clearfix"],["message","Loading..."],[3,"collectionId","submissionId","sectionData"],[1,"submission-form-footer","mt-3","mb-3","position-sticky"],[3,"submissionId"]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"div",0),p["\u0275\u0275text"](1,"\n    "),p["\u0275\u0275template"](2,j,17,8,"div",1),p["\u0275\u0275pipe"](3,"async"),p["\u0275\u0275text"](4,"\n\n    "),p["\u0275\u0275elementStart"](5,"div",2),p["\u0275\u0275text"](6,"\n        "),p["\u0275\u0275template"](7,C,1,0,"ds-loading",3),p["\u0275\u0275pipe"](8,"async"),p["\u0275\u0275text"](9,"\n        "),p["\u0275\u0275template"](10,E,4,3,"ng-container",4),p["\u0275\u0275pipe"](11,"async"),p["\u0275\u0275text"](12,"\n    "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275text"](13,"\n    "),p["\u0275\u0275template"](14,D,4,1,"div",5),p["\u0275\u0275pipe"](15,"async"),p["\u0275\u0275text"](16,"\n"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275text"](17,"\n")),2&e&&(p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf",!p["\u0275\u0275pipeBind1"](3,4,t.isLoading())),p["\u0275\u0275advance"](5),p["\u0275\u0275property"]("ngIf",p["\u0275\u0275pipeBind1"](8,6,t.isLoading())),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngForOf",p["\u0275\u0275pipeBind1"](11,8,t.submissionSections)),p["\u0275\u0275advance"](4),p["\u0275\u0275property"]("ngIf",!p["\u0275\u0275pipeBind1"](15,10,t.isLoading())))},directives:[f.u,f.t,v.a,g.a,x.a,S.a,I.a,O.a],pipes:[f.b],styles:[".submission-form-header[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.97);padding:calc(var(--bs-spacer) / 2) 0 calc(var(--bs-spacer) / 2) 0;top:0;z-index:var(--ds-submission-header-z-index)}.submission-form-header-item[_ngcontent-%COMP%]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.submission-form-footer[_ngcontent-%COMP%]{border-radius:var(--bs-card-border-radius);bottom:0;background-color:var(--bs-gray-400);padding:calc(var(--bs-spacer) / 2);z-index:var(--ds-submission-footer-z-index)}"]}),e})()},ph1m:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("lJxs"),s=n("8Y7J"),o=n("YJD6"),a=n("J/vq"),r=n("14tD"),c=n("G0yt"),l=n("SVse"),d=n("TSSN");function p(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"button",7),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"]("\n      ",s["\u0275\u0275pipeBind1"](2,1,"submission.sections.general.no-sections"),"\n    "))}function u(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"button",8),s["\u0275\u0275listener"]("click",(function(){s["\u0275\u0275restoreView"](e);const n=t.$implicit;return s["\u0275\u0275nextContext"]().addSection(n.id)})),s["\u0275\u0275text"](1),s["\u0275\u0275pipe"](2,"translate"),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275textInterpolate1"]("\n      ",s["\u0275\u0275pipeBind1"](2,1,"submission.sections."+e.header),"\n    ")}}const m=function(e){return{"w-100":e}};let b=(()=>{class e{constructor(e,t,n){this.sectionService=e,this.submissionService=t,this.windowService=n}ngOnInit(){this.sectionList$=this.submissionService.getDisabledSectionsList(this.submissionId),this.hasSections$=this.sectionList$.pipe(Object(i.a)(e=>e.length>0))}addSection(e){this.sectionService.addSection(this.submissionId,e)}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](o.a),s["\u0275\u0275directiveInject"](a.a),s["\u0275\u0275directiveInject"](r.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-form-section-add"]],inputs:{collectionId:"collectionId",submissionId:"submissionId"},decls:22,vars:25,consts:[["ngbDropdown","","placement","bottom-right",1,"d-inline-block",3,"ngClass"],["sectionAdd","ngbDropdown"],["id","sectionControls","ngbDropdownToggle","",1,"btn","btn-outline-primary","dropdown-toggle",3,"disabled","ngClass"],["aria-hidden","true",1,"fa","fa-plus"],["ngbDropdownMenu","","aria-labelledby","sectionControls",1,"sections-dropdown-menu",3,"ngClass"],["class","dropdown-item disabled",4,"ngIf"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"dropdown-item","disabled"],[1,"dropdown-item",3,"click"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",0,1),s["\u0275\u0275text"](2,"\n  "),s["\u0275\u0275elementStart"](3,"button",2),s["\u0275\u0275pipe"](4,"async"),s["\u0275\u0275pipe"](5,"async"),s["\u0275\u0275text"](6),s["\u0275\u0275pipe"](7,"translate"),s["\u0275\u0275element"](8,"i",3),s["\u0275\u0275text"](9,"\n  "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](10,"\n  "),s["\u0275\u0275elementStart"](11,"div",4),s["\u0275\u0275pipe"](12,"async"),s["\u0275\u0275text"](13,"\n    "),s["\u0275\u0275template"](14,p,3,3,"button",5),s["\u0275\u0275pipe"](15,"async"),s["\u0275\u0275text"](16,"\n    "),s["\u0275\u0275template"](17,u,3,3,"button",6),s["\u0275\u0275pipe"](18,"async"),s["\u0275\u0275text"](19,"\n  "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](20,"\n"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275text"](21,"\n")),2&e&&(s["\u0275\u0275property"]("ngClass",s["\u0275\u0275pureFunction1"](19,m,t.windowService.isXs())),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("disabled",!s["\u0275\u0275pipeBind1"](4,7,t.hasSections$))("ngClass",s["\u0275\u0275pureFunction1"](21,m,s["\u0275\u0275pipeBind1"](5,9,t.windowService.isXs()))),s["\u0275\u0275advance"](3),s["\u0275\u0275textInterpolate1"]("\n          ",s["\u0275\u0275pipeBind1"](7,11,"submission.sections.general.add-more")," "),s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("ngClass",s["\u0275\u0275pureFunction1"](23,m,s["\u0275\u0275pipeBind1"](12,13,t.windowService.isXs()))),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngIf",!s["\u0275\u0275pipeBind1"](15,15,t.hasSections$)),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngForOf",s["\u0275\u0275pipeBind1"](18,17,t.sectionList$)))},directives:[c.n,l.r,c.r,c.q,l.u,l.t],pipes:[l.b,d.e],styles:[".dropdown-toggle[_ngcontent-%COMP%]:after{display:none}.sections-dropdown-menu[_ngcontent-%COMP%]{z-index:var(--ds-submission-header-z-index)}"]}),e})()},qK5G:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("JTKQ"),s=n("8Y7J");function o(e,t){}let a=(()=>{class e extends i.a{getComponentName(){return"SubmissionImportExternalComponent"}importThemedComponent(e){return n("JHLN")(`./${e}/app/submission/import-external/submission-import-external.component`)}importUnthemedComponent(){return Promise.resolve().then(n.bind(null,"RMpN"))}}return e.\u0275fac=function(t){return r(t||e)},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-themed-submission-import-external"]],features:[s["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:0,consts:[["vcr",""]],template:function(e,t){1&e&&(s["\u0275\u0275template"](0,o,0,0,"ng-template",null,0,s["\u0275\u0275templateRefExtractor"]),s["\u0275\u0275text"](2,"\n"))},encapsulation:2}),e})();const r=s["\u0275\u0275getInheritedFactory"](a)},wQzj:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("8Y7J"),s=n("2Vo4"),o=n("LRne"),a=n("cBqT"),r=n("lJxs"),c=n("J3qs"),l=n("0VLH"),d=n("Oqsf"),p=n("DNva"),u=n("BVmw"),m=n("QjZv"),b=n("J/vq"),h=n("YJD6"),f=n("SVse"),v=n("G0yt"),g=n("TSSN");function x(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",2),i["\u0275\u0275text"](1,"\n    "),i["\u0275\u0275elementStart"](2,"div",3),i["\u0275\u0275text"](3,"\n      "),i["\u0275\u0275elementStart"](4,"span",4),i["\u0275\u0275text"](5),i["\u0275\u0275pipe"](6,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](7,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](8,"\n    "),i["\u0275\u0275elementStart"](9,"div",5),i["\u0275\u0275text"](10,"\n      "),i["\u0275\u0275elementStart"](11,"span",4),i["\u0275\u0275text"](12),i["\u0275\u0275pipe"](13,"async"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](14,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](15,"\n  "),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](5),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](6,2,"submission.sections.general.collection")),i["\u0275\u0275advance"](7),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](13,4,e.selectedCollectionName$))}}function S(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"span"),i["\u0275\u0275element"](1,"i",13),i["\u0275\u0275elementEnd"]())}function I(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"span"),i["\u0275\u0275text"](1),i["\u0275\u0275pipe"](2,"async"),i["\u0275\u0275elementEnd"]()),2&e){const e=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](2,1,e.selectedCollectionName$))}}function O(e,t){if(1&e){const e=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",6,7),i["\u0275\u0275listener"]("openChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().toggled(t)})),i["\u0275\u0275text"](2,"\n    "),i["\u0275\u0275elementStart"](3,"div",3),i["\u0275\u0275text"](4,"\n      "),i["\u0275\u0275elementStart"](5,"span",8),i["\u0275\u0275text"](6),i["\u0275\u0275pipe"](7,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](8,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](9,"\n    "),i["\u0275\u0275elementStart"](10,"button",9),i["\u0275\u0275listener"]("blur",(function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().onClose()}))("click",(function(){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().onClose()})),i["\u0275\u0275pipe"](11,"async"),i["\u0275\u0275text"](12,"\n      "),i["\u0275\u0275template"](13,S,2,0,"span",10),i["\u0275\u0275pipe"](14,"async"),i["\u0275\u0275text"](15,"\n      "),i["\u0275\u0275template"](16,I,3,3,"span",10),i["\u0275\u0275pipe"](17,"async"),i["\u0275\u0275text"](18,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](19,"\n\n    "),i["\u0275\u0275elementStart"](20,"div",11),i["\u0275\u0275text"](21,"\n      "),i["\u0275\u0275elementStart"](22,"ds-collection-dropdown",12),i["\u0275\u0275listener"]("selectionChange",(function(t){return i["\u0275\u0275restoreView"](e),i["\u0275\u0275nextContext"]().onSelect(t)})),i["\u0275\u0275text"](23,"\n      "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](24,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](25,"\n  "),i["\u0275\u0275elementEnd"]()}if(2&e){const e=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](6),i["\u0275\u0275textInterpolate1"]("\n        ",i["\u0275\u0275pipeBind1"](7,4,"submission.sections.general.collection"),"\n      "),i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("disabled",i["\u0275\u0275pipeBind1"](11,6,e.processingChange$)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](14,8,e.processingChange$)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](17,10,e.processingChange$))}}let y=(()=>{class e{constructor(e,t,n,o,a,r){this.cdr=e,this.collectionDataService=t,this.operationsBuilder=n,this.operationsService=o,this.submissionService=a,this.sectionsService=r,this.collectionChange=new i.EventEmitter,this.processingChange$=new s.a(!1),this.subs=[]}ngOnChanges(e){Object(c.b)(e.currentCollectionId)&&Object(c.b)(e.currentCollectionId.currentValue)&&(this.selectedCollectionId=this.currentCollectionId,this.selectedCollectionName$=this.collectionDataService.findById(this.currentCollectionId).pipe(Object(a.a)(e=>Object(c.e)(e.payload)),Object(r.a)(e=>e.payload.name)))}ngOnInit(){this.pathCombiner=new l.a("sections","collection"),this.available$=this.sectionsService.isSectionAvailable(this.submissionId,"collection")}ngOnDestroy(){this.subs.filter(e=>Object(c.b)(e)).forEach(e=>e.unsubscribe())}onSelect(e){this.processingChange$.next(!0),this.operationsBuilder.replace(this.pathCombiner.getPath(),e.collection.id,!0),this.subs.push(this.operationsService.jsonPatchByResourceID(this.submissionService.getSubmissionObjectLinkName(),this.submissionId,"sections","collection").subscribe(t=>{this.selectedCollectionId=e.collection.id,this.selectedCollectionName$=Object(o.a)(e.collection.name),this.collectionChange.emit(t[0]),this.submissionService.changeSubmissionCollection(this.submissionId,e.collection.id),this.processingChange$.next(!1),this.cdr.detectChanges()}))}onClose(){this.collectionDropdown.reset()}toggled(e){e||this.collectionDropdown.reset()}}return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](i.ChangeDetectorRef),i["\u0275\u0275directiveInject"](p.a),i["\u0275\u0275directiveInject"](u.a),i["\u0275\u0275directiveInject"](m.a),i["\u0275\u0275directiveInject"](b.a),i["\u0275\u0275directiveInject"](h.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-form-collection"]],viewQuery:function(e,t){var n;1&e&&i["\u0275\u0275viewQuery"](d.a,!0),2&e&&i["\u0275\u0275queryRefresh"](n=i["\u0275\u0275loadQuery"]())&&(t.collectionDropdown=n.first)},inputs:{currentCollectionId:"currentCollectionId",currentDefinition:"currentDefinition",submissionId:"submissionId"},outputs:{collectionChange:"collectionChange"},features:[i["\u0275\u0275NgOnChangesFeature"]],decls:9,vars:6,consts:[["class","input-group mb-3",4,"ngIf"],["ngbDropdown","","class","btn-group input-group",3,"openChange",4,"ngIf"],[1,"input-group","mb-3"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"input-group-append"],["ngbDropdown","",1,"btn-group","input-group",3,"openChange"],["collectionControls","ngbDropdown"],["id","collectionControlsMenuLabel",1,"input-group-text"],["aria-describedby","collectionControlsMenuLabel","id","collectionControlsMenuButton","ngbDropdownToggle","",1,"btn","btn-outline-primary",3,"disabled","blur","click"],[4,"ngIf"],["ngbDropdownMenu","","id","collectionControlsDropdownMenu","aria-labelledby","collectionControlsMenuButton",1,"dropdown-menu"],[3,"selectionChange"],[1,"fas","fa-circle-notch","fa-spin"]],template:function(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275text"](1,"\n  "),i["\u0275\u0275template"](2,x,16,6,"div",0),i["\u0275\u0275pipe"](3,"async"),i["\u0275\u0275text"](4,"\n  "),i["\u0275\u0275template"](5,O,26,12,"div",1),i["\u0275\u0275pipe"](6,"async"),i["\u0275\u0275text"](7,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](8,"\n")),2&e&&(i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](3,2,t.available$)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](6,4,t.available$)))},directives:[f.u,v.n,v.r,v.q,d.a],pipes:[f.b,g.e],styles:[".scrollable-menu[_ngcontent-%COMP%]{height:auto;max-height:var(--ds-dropdown-menu-max-height);overflow-x:hidden}.collection-item[_ngcontent-%COMP%]{border-bottom:var(--bs-dropdown-border-width) solid var(--bs-dropdown-border-color)}#collectionControlsDropdownMenu[_ngcontent-%COMP%]{outline:0;left:0!important;-webkit-box-shadow:var(--bs-btn-focus-box-shadow);box-shadow:var(--bs-btn-focus-box-shadow)}"]}),e})()},yAsG:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var i=n("LRne"),s=n("lJxs"),o=n("drGc"),a=n("J3qs"),r=n("8Y7J"),c=n("G0yt"),l=n("8nsN"),d=n("J/vq"),p=n("SVse"),u=n("TSSN");function m(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"div",9),r["\u0275\u0275text"](1,"Saving..."),r["\u0275\u0275elementEnd"]()),2&e&&r["\u0275\u0275styleProp"]("width","100%")}function b(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"div",9),r["\u0275\u0275text"](1,"Depositing..."),r["\u0275\u0275elementEnd"]()),2&e&&r["\u0275\u0275styleProp"]("width","100%")}function h(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div",6),r["\u0275\u0275text"](1,"\n    "),r["\u0275\u0275elementStart"](2,"div",7),r["\u0275\u0275text"](3,"\n      "),r["\u0275\u0275template"](4,m,2,2,"div",8),r["\u0275\u0275pipe"](5,"async"),r["\u0275\u0275text"](6,"\n      "),r["\u0275\u0275template"](7,b,2,2,"div",8),r["\u0275\u0275pipe"](8,"async"),r["\u0275\u0275text"](9,"\n    "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](10,"\n  "),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"](2);r["\u0275\u0275advance"](4),r["\u0275\u0275property"]("ngIf",r["\u0275\u0275pipeBind1"](5,2,e.processingSaveStatus)),r["\u0275\u0275advance"](3),r["\u0275\u0275property"]("ngIf",r["\u0275\u0275pipeBind1"](8,4,e.processingDepositStatus))}}function f(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"button",16),r["\u0275\u0275listener"]("click",(function(t){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"](3).deposit(t)})),r["\u0275\u0275pipe"](1,"async"),r["\u0275\u0275text"](2,"\n      "),r["\u0275\u0275elementStart"](3,"span"),r["\u0275\u0275element"](4,"i",17),r["\u0275\u0275text"](5),r["\u0275\u0275pipe"](6,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](7,"\n    "),r["\u0275\u0275elementEnd"]()}if(2&e){const e=r["\u0275\u0275nextContext"](3);r["\u0275\u0275property"]("disabled",r["\u0275\u0275pipeBind1"](1,2,e.submissionIsInvalid)),r["\u0275\u0275advance"](5),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](6,4,"submission.general.deposit"),"")}}function v(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"button",18),r["\u0275\u0275listener"]("click",(function(t){r["\u0275\u0275restoreView"](e);const n=r["\u0275\u0275nextContext"](3),i=r["\u0275\u0275reference"](3);return t.preventDefault(),n.confirmDiscard(i)})),r["\u0275\u0275text"](1,"\n      "),r["\u0275\u0275element"](2,"i",19),r["\u0275\u0275text"](3),r["\u0275\u0275pipe"](4,"translate"),r["\u0275\u0275elementEnd"]()}2&e&&(r["\u0275\u0275advance"](3),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](4,1,"submission.general.discard.submit"),"\n    "))}function g(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"div",10),r["\u0275\u0275text"](1,"\n    "),r["\u0275\u0275elementStart"](2,"button",11),r["\u0275\u0275listener"]("click",(function(t){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"](2).save(t)})),r["\u0275\u0275pipe"](3,"async"),r["\u0275\u0275pipe"](4,"async"),r["\u0275\u0275text"](5,"\n      "),r["\u0275\u0275elementStart"](6,"span"),r["\u0275\u0275element"](7,"i",12),r["\u0275\u0275text"](8),r["\u0275\u0275pipe"](9,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](10,"\n    "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](11,"\n    "),r["\u0275\u0275elementStart"](12,"button",13),r["\u0275\u0275listener"]("click",(function(t){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"](2).saveLater(t)})),r["\u0275\u0275pipe"](13,"async"),r["\u0275\u0275pipe"](14,"async"),r["\u0275\u0275pipe"](15,"async"),r["\u0275\u0275text"](16,"\n      "),r["\u0275\u0275elementStart"](17,"span"),r["\u0275\u0275element"](18,"i",12),r["\u0275\u0275text"](19),r["\u0275\u0275pipe"](20,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](21,"\n    "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](22,"\n    "),r["\u0275\u0275template"](23,f,8,6,"button",14),r["\u0275\u0275pipe"](24,"async"),r["\u0275\u0275text"](25,"\n    "),r["\u0275\u0275template"](26,v,5,3,"button",15),r["\u0275\u0275pipe"](27,"async"),r["\u0275\u0275text"](28,"\n  "),r["\u0275\u0275elementEnd"]()}if(2&e){const e=r["\u0275\u0275nextContext"](2);r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("disabled",r["\u0275\u0275pipeBind1"](3,10,e.processingSaveStatus)||!r["\u0275\u0275pipeBind1"](4,12,e.hasUnsavedModification)),r["\u0275\u0275advance"](6),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](9,14,"submission.general.save"),""),r["\u0275\u0275advance"](4),r["\u0275\u0275classProp"]("btn-primary",!r["\u0275\u0275pipeBind1"](13,16,e.showDepositAndDiscard))("btn-secondary",r["\u0275\u0275pipeBind1"](14,18,e.showDepositAndDiscard)),r["\u0275\u0275property"]("disabled",r["\u0275\u0275pipeBind1"](15,20,e.processingSaveStatus)),r["\u0275\u0275advance"](7),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](20,22,"submission.general.save-later"),""),r["\u0275\u0275advance"](4),r["\u0275\u0275property"]("ngIf",r["\u0275\u0275pipeBind1"](24,24,e.showDepositAndDiscard)),r["\u0275\u0275advance"](3),r["\u0275\u0275property"]("ngIf",r["\u0275\u0275pipeBind1"](27,26,e.showDepositAndDiscard))}}function x(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div",2),r["\u0275\u0275text"](1,"\n  "),r["\u0275\u0275elementStart"](2,"div",3),r["\u0275\u0275text"](3,"\n    "),r["\u0275\u0275text"](4,"\n  "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](5,"\n  "),r["\u0275\u0275template"](6,h,11,6,"div",4),r["\u0275\u0275pipe"](7,"async"),r["\u0275\u0275pipe"](8,"async"),r["\u0275\u0275text"](9,"\n  "),r["\u0275\u0275template"](10,g,29,28,"div",5),r["\u0275\u0275pipe"](11,"async"),r["\u0275\u0275pipe"](12,"async"),r["\u0275\u0275text"](13,"\n"),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275advance"](6),r["\u0275\u0275property"]("ngIf",r["\u0275\u0275pipeBind1"](7,2,e.processingSaveStatus)||r["\u0275\u0275pipeBind1"](8,4,e.processingDepositStatus)),r["\u0275\u0275advance"](4),r["\u0275\u0275property"]("ngIf",!r["\u0275\u0275pipeBind1"](11,6,e.processingSaveStatus)&&!r["\u0275\u0275pipeBind1"](12,8,e.processingDepositStatus))}}function S(e,t){1&e&&(r["\u0275\u0275text"](0,"\n  "),r["\u0275\u0275elementStart"](1,"div",20),r["\u0275\u0275text"](2,"\n    "),r["\u0275\u0275elementStart"](3,"h4",21),r["\u0275\u0275text"](4),r["\u0275\u0275pipe"](5,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](6,"\n    "),r["\u0275\u0275elementStart"](7,"button",22),r["\u0275\u0275listener"]("click",(function(){return(0,t.dismiss)("cancel")})),r["\u0275\u0275text"](8,"\n      "),r["\u0275\u0275elementStart"](9,"span",23),r["\u0275\u0275text"](10,"\xd7"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](11,"\n    "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](12,"\n  "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](13,"\n  "),r["\u0275\u0275elementStart"](14,"div",24),r["\u0275\u0275text"](15,"\n    "),r["\u0275\u0275elementStart"](16,"p"),r["\u0275\u0275text"](17),r["\u0275\u0275pipe"](18,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](19,"\n  "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](20,"\n  "),r["\u0275\u0275elementStart"](21,"div",25),r["\u0275\u0275text"](22,"\n    "),r["\u0275\u0275elementStart"](23,"button",26),r["\u0275\u0275listener"]("click",(function(){return(0,t.close)("cancel")})),r["\u0275\u0275text"](24),r["\u0275\u0275pipe"](25,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](26,"\n    "),r["\u0275\u0275elementStart"](27,"button",18),r["\u0275\u0275listener"]("click",(function(){return(0,t.close)("ok")})),r["\u0275\u0275text"](28),r["\u0275\u0275pipe"](29,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](30,"\n  "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](31,"\n")),2&e&&(r["\u0275\u0275advance"](4),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](5,4,"submission.general.discard.confirm.title")),r["\u0275\u0275advance"](13),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](18,6,"submission.general.discard.confirm.info")),r["\u0275\u0275advance"](7),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](25,8,"submission.general.discard.confirm.cancel")),r["\u0275\u0275advance"](4),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](29,10,"submission.general.discard.confirm.submit")))}let I=(()=>{class e{constructor(e,t,n){this.modalService=e,this.restService=t,this.submissionService=n,this.submissionIsInvalid=Object(i.a)(!0)}ngOnChanges(e){Object(a.e)(this.submissionId)&&(this.submissionIsInvalid=this.submissionService.getSubmissionStatus(this.submissionId).pipe(Object(s.a)(e=>!1===e)),this.processingSaveStatus=this.submissionService.getSubmissionSaveProcessingStatus(this.submissionId),this.processingDepositStatus=this.submissionService.getSubmissionDepositProcessingStatus(this.submissionId),this.showDepositAndDiscard=Object(i.a)(this.submissionService.getSubmissionScope()===o.a.WorkspaceItem),this.hasUnsavedModification=this.submissionService.hasUnsavedModification())}save(e){this.submissionService.dispatchSave(this.submissionId,!0)}saveLater(e){this.submissionService.dispatchSaveForLater(this.submissionId)}deposit(e){this.submissionService.dispatchDeposit(this.submissionId)}confirmDiscard(e){this.modalService.open(e).result.then(e=>{"ok"===e&&this.submissionService.dispatchDiscard(this.submissionId)})}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](c.u),r["\u0275\u0275directiveInject"](l.a),r["\u0275\u0275directiveInject"](d.a))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-form-footer"]],inputs:{submissionId:"submissionId"},features:[r["\u0275\u0275NgOnChangesFeature"]],decls:5,vars:1,consts:[["class","row",4,"ngIf"],["content",""],[1,"row"],[1,"col"],["class","col d-flex justify-content-end align-items-center",4,"ngIf"],["class","col text-right",4,"ngIf"],[1,"col","d-flex","justify-content-end","align-items-center"],[1,"progress","w-75"],["class","progress-bar progress-bar-striped progress-bar-animated bg-info","role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",3,"width",4,"ngIf"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-info"],[1,"col","text-right"],["type","button","id","save",1,"btn","btn-secondary",3,"disabled","click"],[1,"fas","fa-save"],["type","button","id","saveForLater",1,"btn",3,"disabled","click"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-plus"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"modal-header"],[1,"modal-title","text-danger"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(e,t){1&e&&(r["\u0275\u0275template"](0,x,14,10,"div",0),r["\u0275\u0275text"](1,"\n\n"),r["\u0275\u0275template"](2,S,32,12,"ng-template",null,1,r["\u0275\u0275templateRefExtractor"]),r["\u0275\u0275text"](4,"\n")),2&e&&r["\u0275\u0275property"]("ngIf",!!t.submissionId)},directives:[p.u],pipes:[p.b,u.e],styles:[""]}),e})()}}]);
//# sourceMappingURL=3-es2015.83b94385e4c0deb9bdef.js.map