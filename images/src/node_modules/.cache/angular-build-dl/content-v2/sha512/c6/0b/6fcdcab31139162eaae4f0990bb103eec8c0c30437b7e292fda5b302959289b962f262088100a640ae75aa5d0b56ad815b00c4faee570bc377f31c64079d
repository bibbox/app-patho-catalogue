!function(){function e(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n,i){return(t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(n):a.value}})(e,n,i||e)}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=o(e);if(t){var a=o(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return r(this,n)}}function r(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,a=!1,r=void 0;try{for(var o,c=e[Symbol.iterator]();!(i=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){a=!0,r=l}finally{try{i||null==c.return||c.return()}finally{if(a)throw r}}return n}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{wAxY:function(i,r,l){"use strict";l.r(r),l.d(r,"EditCollectionPageModule",(function(){return pt}));var s=l("SVse"),p=l("PCNd"),m=l("iInd"),f=l("2Vo4"),v=l("itXk"),h=l("mEo1"),b=l("lJxs"),y=l("eIep"),S=l("JX91"),x=l("IzEk"),g=l("1QIV"),I=l("QhmN"),j=l("qc8P"),C=l("J3qs"),O=l("ztnu"),E=l("joI/"),w=l("g7AC"),k=l("84Zn"),T=l("8Y7J"),B=l("gWc+"),R=l("lI3o"),D=l("iqTE"),$=l("DNva"),F=l("TSSN"),M=l("C765"),N=l("G0yt"),V=l("Oupr"),P=l("DdXh"),L=["tabs"];function _(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275text"](0,"\n            "),T["\u0275\u0275elementStart"](1,"div",9),T["\u0275\u0275text"](2,"\n              "),T["\u0275\u0275elementStart"](3,"ds-item-select",10),T["\u0275\u0275listener"]("confirm",(function(e){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"]().mapItems(e,!0)}))("cancel",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"]().onCancel()})),T["\u0275\u0275pipe"](4,"async"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](5,"\n            "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](6,"\n          ")}if(2&e){var i,a=T["\u0275\u0275nextContext"]();T["\u0275\u0275advance"](3),T["\u0275\u0275property"]("key","browse")("dsoRD$",a.collectionItemsRD$)("paginationOptions",null==(i=T["\u0275\u0275pipeBind1"](4,7,a.searchOptions$))?null:i.pagination)("confirmButton","collection.edit.item-mapper.remove")("cancelButton","collection.edit.item-mapper.cancel")("dangerConfirm",!0)("hideCollection",!0)}}function H(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275elementStart"](0,"div"),T["\u0275\u0275text"](1,"\n              "),T["\u0275\u0275elementStart"](2,"ds-item-select",16),T["\u0275\u0275listener"]("confirm",(function(e){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"](2).mapItems(e)}))("cancel",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"](2).onCancel()})),T["\u0275\u0275pipe"](3,"async"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](4,"\n            "),T["\u0275\u0275elementEnd"]()}if(2&e){var i,a=T["\u0275\u0275nextContext"](2);T["\u0275\u0275advance"](2),T["\u0275\u0275property"]("key","map")("dsoRD$",a.mappedItemsRD$)("paginationOptions",null==(i=T["\u0275\u0275pipeBind1"](3,5,a.searchOptions$))?null:i.pagination)("confirmButton","collection.edit.item-mapper.confirm")("cancelButton","collection.edit.item-mapper.cancel")}}function A(e,t){1&e&&(T["\u0275\u0275elementStart"](0,"div",17),T["\u0275\u0275text"](1),T["\u0275\u0275pipe"](2,"translate"),T["\u0275\u0275elementEnd"]()),2&e&&(T["\u0275\u0275advance"](1),T["\u0275\u0275textInterpolate1"]("\n              ",T["\u0275\u0275pipeBind1"](2,1,"collection.edit.item-mapper.no-search"),"\n            "))}function U(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275text"](0,"\n            "),T["\u0275\u0275elementStart"](1,"div",11),T["\u0275\u0275text"](2,"\n              "),T["\u0275\u0275elementStart"](3,"div",12),T["\u0275\u0275text"](4,"\n                "),T["\u0275\u0275elementStart"](5,"ds-search-form",13),T["\u0275\u0275listener"]("submitSearch",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"]().performedSearch=!0})),T["\u0275\u0275pipe"](6,"async"),T["\u0275\u0275pipe"](7,"async"),T["\u0275\u0275pipe"](8,"translate"),T["\u0275\u0275text"](9,"\n                "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](10,"\n              "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](11,"\n            "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](12,"\n\n            "),T["\u0275\u0275template"](13,H,5,7,"div",14),T["\u0275\u0275text"](14,"\n            "),T["\u0275\u0275template"](15,A,3,3,"div",15),T["\u0275\u0275text"](16,"\n          ")}if(2&e){var i,a,r=T["\u0275\u0275nextContext"]();T["\u0275\u0275advance"](5),T["\u0275\u0275property"]("query",null==(i=T["\u0275\u0275pipeBind1"](6,7,r.searchOptions$))?null:i.query)("scope",null==(a=T["\u0275\u0275pipeBind1"](7,9,r.searchOptions$))?null:a.scope)("currentUrl","./")("inPlaceSearch",!0)("searchPlaceholder",T["\u0275\u0275pipeBind1"](8,11,"collection.edit.item-mapper.search-form.placeholder")),T["\u0275\u0275advance"](8),T["\u0275\u0275property"]("ngIf",r.performedSearch),T["\u0275\u0275advance"](2),T["\u0275\u0275property"]("ngIf",!r.performedSearch)}}var q,G=function(e){return{name:e}},z=((q=function(){function e(t,n,i,a,r,o,c,l,s){u(this,e),this.route=t,this.router=n,this.searchConfigService=i,this.searchService=a,this.notificationsService=r,this.itemDataService=o,this.collectionDataService=c,this.translateService=l,this.dsoNameService=s,this.defaultSortOptions=new j.b("dc.title",j.a.ASC),this.performedSearch=!1}return d(e,[{key:"ngOnInit",value:function(){var e=this;this.collectionRD$=this.route.parent.data.pipe(Object(b.a)((function(e){return e.dso})),Object(g.i)()),this.collectionName$=this.collectionRD$.pipe(Object(b.a)((function(t){return e.dsoNameService.getName(t.payload)}))),this.searchOptions$=this.searchConfigService.paginatedSearchOptions,this.loadItemLists()}},{key:"loadItemLists",value:function(){var e=this;this.shouldUpdate$=new f.a(!0);var t=Object(v.a)(this.collectionRD$,this.searchOptions$,this.shouldUpdate$);this.collectionItemsRD$=t.pipe(Object(y.a)((function(t){var n=c(t,3),i=n[0],a=n[1],r=n[2];return!0===r&&e.shouldUpdate$.next(!1),e.itemDataService.findAllByHref(i.payload._links.mappedItems.href,Object.assign(a,{sort:e.defaultSortOptions}),!r,!1,Object(k.a)("owningCollection")).pipe(Object(g.c)())}))),this.mappedItemsRD$=t.pipe(Object(y.a)((function(t){var n=c(t,3),i=n[0],a=n[1];return n[2],e.searchService.search(Object.assign(new w.a(a),{query:e.buildQuery(i.payload.id,a.query),scope:void 0,dsoTypes:[I.a.ITEM],sort:e.defaultSortOptions}),1e4).pipe(Object(g.y)(),Object(S.a)(void 0))})))}},{key:"mapItems",value:function(e,t){var n=this,i=this.collectionRD$.pipe(Object(g.i)(),Object(b.a)((function(e){return e.payload})),Object(y.a)((function(i){return Object(v.a)(e.map((function(e){return t?n.itemDataService.removeMappingFromCollection(e,i.id).pipe(Object(g.g)()):n.itemDataService.mapToCollection(e,i._links.self.href).pipe(Object(g.g)())})))})));this.showNotifications(i,t)}},{key:"showNotifications",value:function(e,t){var n=this,i=t?"unmap":"map";e.subscribe((function(e){var t=e.filter((function(e){return e.hasSucceeded})),a=e.filter((function(e){return e.hasFailed}));t.length>0&&(Object(v.a)(n.translateService.get("collection.edit.item-mapper.notifications.".concat(i,".success.head")),n.translateService.get("collection.edit.item-mapper.notifications.".concat(i,".success.content"),{amount:t.length})).subscribe((function(e){var t=c(e,2),i=t[0],a=t[1];n.notificationsService.success(i,a)})),n.shouldUpdate$.next(!0)),a.length>0&&Object(v.a)(n.translateService.get("collection.edit.item-mapper.notifications.".concat(i,".error.head")),n.translateService.get("collection.edit.item-mapper.notifications.".concat(i,".error.content"),{amount:a.length})).subscribe((function(e){var t=c(e,2),i=t[0],a=t[1];n.notificationsService.error(i,a)})),n.switchToFirstTab()}))}},{key:"tabChange",value:function(e){this.performedSearch=!1,this.router.navigateByUrl(this.getCurrentUrl())}},{key:"getCurrentUrl",value:function(){return this.router.url.indexOf("?")>-1?this.router.url.substring(0,this.router.url.indexOf("?")):this.router.url}},{key:"buildQuery",value:function(e,t){var n='-location.coll:"'.concat(e,'"');return Object(C.e)(t)?"".concat(n," AND ").concat(t):n}},{key:"switchToFirstTab",value:function(){this.tabs.select("browseTab")}},{key:"onCancel",value:function(){var e=this;this.collectionRD$.pipe(Object(g.i)(),Object(g.o)(),Object(x.a)(1)).subscribe((function(t){e.router.navigate(["/collections/",t.id])}))}}]),e}()).\u0275fac=function(e){return new(e||q)(T["\u0275\u0275directiveInject"](m.a),T["\u0275\u0275directiveInject"](m.g),T["\u0275\u0275directiveInject"](O.SEARCH_CONFIG_SERVICE),T["\u0275\u0275directiveInject"](B.a),T["\u0275\u0275directiveInject"](R.a),T["\u0275\u0275directiveInject"](D.a),T["\u0275\u0275directiveInject"]($.a),T["\u0275\u0275directiveInject"](F.f),T["\u0275\u0275directiveInject"](M.a))},q.\u0275cmp=T["\u0275\u0275defineComponent"]({type:q,selectors:[["ds-collection-item-mapper"]],viewQuery:function(e,t){var n;1&e&&T["\u0275\u0275viewQuery"](L,!0),2&e&&T["\u0275\u0275queryRefresh"](n=T["\u0275\u0275loadQuery"]())&&(t.tabs=n.first)},features:[T["\u0275\u0275ProvidersFeature"]([{provide:O.SEARCH_CONFIG_SERVICE,useClass:E.a}])],decls:37,vars:21,consts:[[1,"container"],[1,"row"],[1,"col-12"],["id","collection-name",3,"innerHTML"],[3,"destroyOnHide","tabChange"],["tabs","ngbTabset"],["id","browseTab",3,"title"],["ngbTabContent",""],["id","mapTab",3,"title"],[1,"mt-2"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","confirmButton","cancelButton","dangerConfirm","hideCollection","confirm","cancel"],[1,"row","mt-2"],[1,"col-12","col-lg-6"],["id","search-form",3,"query","scope","currentUrl","inPlaceSearch","searchPlaceholder","submitSearch"],[4,"ngIf"],["class","alert alert-info w-100","role","alert",4,"ngIf"],[1,"mt-2",3,"key","dsoRD$","paginationOptions","confirmButton","cancelButton","confirm","cancel"],["role","alert",1,"alert","alert-info","w-100"]],template:function(e,t){1&e&&(T["\u0275\u0275elementStart"](0,"div",0),T["\u0275\u0275text"](1,"\n  "),T["\u0275\u0275elementStart"](2,"div",1),T["\u0275\u0275text"](3,"\n    "),T["\u0275\u0275elementStart"](4,"div",2),T["\u0275\u0275text"](5,"\n      "),T["\u0275\u0275elementStart"](6,"h2"),T["\u0275\u0275text"](7),T["\u0275\u0275pipe"](8,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](9,"\n      "),T["\u0275\u0275element"](10,"p",3),T["\u0275\u0275pipe"](11,"translate"),T["\u0275\u0275pipe"](12,"async"),T["\u0275\u0275text"](13,"\n      "),T["\u0275\u0275elementStart"](14,"p"),T["\u0275\u0275text"](15),T["\u0275\u0275pipe"](16,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](17,"\n\n      "),T["\u0275\u0275elementStart"](18,"ngb-tabset",4,5),T["\u0275\u0275listener"]("tabChange",(function(e){return t.tabChange(e)})),T["\u0275\u0275text"](20,"\n        "),T["\u0275\u0275elementStart"](21,"ngb-tab",6),T["\u0275\u0275pipe"](22,"translate"),T["\u0275\u0275text"](23,"\n          "),T["\u0275\u0275template"](24,_,7,9,"ng-template",7),T["\u0275\u0275text"](25,"\n        "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](26,"\n        "),T["\u0275\u0275elementStart"](27,"ngb-tab",8),T["\u0275\u0275pipe"](28,"translate"),T["\u0275\u0275text"](29,"\n          "),T["\u0275\u0275template"](30,U,17,13,"ng-template",7),T["\u0275\u0275text"](31,"\n        "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](32,"\n      "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](33,"\n    "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](34,"\n  "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](35,"\n"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](36,"\n")),2&e&&(T["\u0275\u0275advance"](7),T["\u0275\u0275textInterpolate"](T["\u0275\u0275pipeBind1"](8,6,"collection.edit.item-mapper.head")),T["\u0275\u0275advance"](3),T["\u0275\u0275property"]("innerHTML",T["\u0275\u0275pipeBind2"](11,8,"collection.edit.item-mapper.collection",T["\u0275\u0275pureFunction1"](19,G,T["\u0275\u0275pipeBind1"](12,11,t.collectionName$))),T["\u0275\u0275sanitizeHtml"]),T["\u0275\u0275advance"](5),T["\u0275\u0275textInterpolate"](T["\u0275\u0275pipeBind1"](16,13,"collection.edit.item-mapper.description")),T["\u0275\u0275advance"](3),T["\u0275\u0275property"]("destroyOnHide",!0),T["\u0275\u0275advance"](3),T["\u0275\u0275propertyInterpolate"]("title",T["\u0275\u0275pipeBind1"](22,15,"collection.edit.item-mapper.tabs.browse")),T["\u0275\u0275advance"](6),T["\u0275\u0275propertyInterpolate"]("title",T["\u0275\u0275pipeBind1"](28,17,"collection.edit.item-mapper.tabs.map")))},directives:[N.ab,N.X,N.Y,V.a,P.a,s.u],pipes:[F.e,s.b],styles:[""],data:{animation:[h.a,h.c]},changeDetection:0}),q),X=l("J8r5"),Y=l("HaPv"),K=function(e){return{active:e}},Q=function(e){return[e]};function J(e,t){if(1&e&&(T["\u0275\u0275elementStart"](0,"li",13),T["\u0275\u0275text"](1,"\n            "),T["\u0275\u0275elementStart"](2,"a",14),T["\u0275\u0275text"](3),T["\u0275\u0275pipe"](4,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](5,"\n          "),T["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=T["\u0275\u0275nextContext"]();T["\u0275\u0275advance"](2),T["\u0275\u0275property"]("ngClass",T["\u0275\u0275pureFunction1"](5,K,n===i.currentPage))("routerLink",T["\u0275\u0275pureFunction1"](7,Q,"./"+n)),T["\u0275\u0275advance"](1),T["\u0275\u0275textInterpolate1"]("\n              ",T["\u0275\u0275pipeBind1"](4,3,i.type+".edit.tabs."+n+".head"),"\n            ")}}function Z(e,t){if(1&e&&(T["\u0275\u0275elementStart"](0,"a",15),T["\u0275\u0275pipe"](1,"async"),T["\u0275\u0275text"](2,"\n              "),T["\u0275\u0275element"](3,"i",16),T["\u0275\u0275text"](4),T["\u0275\u0275pipe"](5,"translate"),T["\u0275\u0275elementEnd"]()),2&e){var n,i=T["\u0275\u0275nextContext"]();T["\u0275\u0275property"]("routerLink",i.getPageUrl(null==(n=T["\u0275\u0275pipeBind1"](1,2,i.dsoRD$))?null:n.payload)),T["\u0275\u0275advance"](4),T["\u0275\u0275textInterpolate1"](" ",T["\u0275\u0275pipeBind1"](5,4,i.type+".edit.return"),"\n            ")}}var W,ee=((W=function(e){n(i,e);var t=a(i);function i(e,n){var a;return u(this,i),(a=t.call(this,e,n)).router=e,a.route=n,a.type="collection",a}return d(i,[{key:"getPageUrl",value:function(e){return Object(Y.j)(e.id)}}]),i}(X.a)).\u0275fac=function(e){return new(e||W)(T["\u0275\u0275directiveInject"](m.g),T["\u0275\u0275directiveInject"](m.a))},W.\u0275cmp=T["\u0275\u0275defineComponent"]({type:W,selectors:[["ds-edit-collection"]],features:[T["\u0275\u0275InheritDefinitionFeature"]],decls:47,vars:11,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom"],[1,"btn","btn-danger",3,"routerLink"],[1,"fas","fa-trash"],[1,"pt-2"],[1,"nav","nav-tabs","justify-content-start","mb-2"],["class","nav-item",4,"ngFor","ngForOf"],[1,"tab-pane","active"],[1,"mb-4"],[1,"col-12","text-right"],["class","btn btn-outline-secondary",3,"routerLink",4,"ngIf"],[1,"nav-item"],[1,"nav-link",3,"ngClass","routerLink"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-arrow-left"]],template:function(e,t){var n;1&e&&(T["\u0275\u0275elementStart"](0,"div",0),T["\u0275\u0275text"](1,"\n  "),T["\u0275\u0275elementStart"](2,"div",1),T["\u0275\u0275text"](3,"\n    "),T["\u0275\u0275elementStart"](4,"div",2),T["\u0275\u0275text"](5,"\n      "),T["\u0275\u0275elementStart"](6,"div",3),T["\u0275\u0275text"](7,"\n        "),T["\u0275\u0275elementStart"](8,"h2"),T["\u0275\u0275text"](9),T["\u0275\u0275pipe"](10,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](11,"\n        "),T["\u0275\u0275elementStart"](12,"div"),T["\u0275\u0275text"](13,"\n          "),T["\u0275\u0275elementStart"](14,"a",4),T["\u0275\u0275pipe"](15,"async"),T["\u0275\u0275text"](16,"\n            "),T["\u0275\u0275element"](17,"i",5),T["\u0275\u0275text"](18),T["\u0275\u0275pipe"](19,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](20,"\n        "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](21,"\n      "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](22,"\n      "),T["\u0275\u0275elementStart"](23,"div",6),T["\u0275\u0275text"](24,"\n        "),T["\u0275\u0275elementStart"](25,"ul",7),T["\u0275\u0275text"](26,"\n          "),T["\u0275\u0275template"](27,J,6,9,"li",8),T["\u0275\u0275text"](28,"\n        "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](29,"\n        "),T["\u0275\u0275elementStart"](30,"div",9),T["\u0275\u0275text"](31,"\n          "),T["\u0275\u0275elementStart"](32,"div",10),T["\u0275\u0275text"](33,"\n            "),T["\u0275\u0275element"](34,"router-outlet"),T["\u0275\u0275text"](35,"\n          "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](36,"\n          "),T["\u0275\u0275elementStart"](37,"div",11),T["\u0275\u0275text"](38,"\n            "),T["\u0275\u0275template"](39,Z,6,6,"a",12),T["\u0275\u0275text"](40,"\n          "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](41,"\n        "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](42,"\n      "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](43,"\n    "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](44,"\n  "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](45,"\n"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](46,"\n")),2&e&&(T["\u0275\u0275advance"](9),T["\u0275\u0275textInterpolate"](T["\u0275\u0275pipeBind1"](10,5,t.type+".edit.head")),T["\u0275\u0275advance"](5),T["\u0275\u0275property"]("routerLink",("community"===t.type?"/communities/":"/collections/")+(null==(n=T["\u0275\u0275pipeBind1"](15,7,t.dsoRD$))?null:n.payload.uuid)+"/delete"),T["\u0275\u0275advance"](4),T["\u0275\u0275textInterpolate1"](" ",T["\u0275\u0275pipeBind1"](19,9,t.type+".edit.delete"),""),T["\u0275\u0275advance"](9),T["\u0275\u0275property"]("ngForOf",t.pages),T["\u0275\u0275advance"](12),T["\u0275\u0275property"]("ngIf",!t.hideReturnButton))},directives:[m.j,s.t,m.l,s.u,s.r],pipes:[F.e,s.b],encapsulation:2}),W),te=l("6nfC"),ne=l("ye/0"),ie=l("PN+Z"),ae=l("vkgz"),re=l("lP90"),oe=l("mycY"),ce=l("X/78"),le=l("O/5o"),se=l("njH3");function ue(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275elementStart"](0,"button",7),T["\u0275\u0275listener"]("click",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"](2).addItemTemplate()})),T["\u0275\u0275text"](1,"\n      "),T["\u0275\u0275element"](2,"i",8),T["\u0275\u0275text"](3,"\n      "),T["\u0275\u0275elementStart"](4,"span",9),T["\u0275\u0275text"](5),T["\u0275\u0275pipe"](6,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](7,"\n    "),T["\u0275\u0275elementEnd"]()}2&e&&(T["\u0275\u0275advance"](5),T["\u0275\u0275textInterpolate1"]("\xa0",T["\u0275\u0275pipeBind1"](6,1,"collection.edit.template.add-button"),""))}function pe(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275elementStart"](0,"button",10),T["\u0275\u0275listener"]("click",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"](2).deleteItemTemplate()})),T["\u0275\u0275text"](1,"\n      "),T["\u0275\u0275element"](2,"i",11),T["\u0275\u0275text"](3,"\n      "),T["\u0275\u0275elementStart"](4,"span",9),T["\u0275\u0275text"](5),T["\u0275\u0275pipe"](6,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](7,"\n    "),T["\u0275\u0275elementEnd"]()}2&e&&(T["\u0275\u0275advance"](5),T["\u0275\u0275textInterpolate1"]("\xa0",T["\u0275\u0275pipeBind1"](6,1,"collection.edit.template.delete-button"),""))}function de(e,t){if(1&e&&(T["\u0275\u0275elementStart"](0,"button",12),T["\u0275\u0275pipe"](1,"async"),T["\u0275\u0275text"](2,"\n      "),T["\u0275\u0275element"](3,"i",13),T["\u0275\u0275text"](4,"\n      "),T["\u0275\u0275elementStart"](5,"span",9),T["\u0275\u0275text"](6),T["\u0275\u0275pipe"](7,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](8,"\n    "),T["\u0275\u0275elementEnd"]()),2&e){var n,i=T["\u0275\u0275nextContext"](2);T["\u0275\u0275property"]("routerLink","/collections/"+(null==(n=T["\u0275\u0275pipeBind1"](1,2,i.dsoRD$))?null:n.payload.uuid)+"/itemtemplate"),T["\u0275\u0275advance"](6),T["\u0275\u0275textInterpolate1"]("\xa0",T["\u0275\u0275pipeBind1"](7,4,"collection.edit.template.edit-button"),"")}}function me(e,t){if(1&e&&(T["\u0275\u0275elementStart"](0,"div",2),T["\u0275\u0275text"](1,"\n  "),T["\u0275\u0275elementStart"](2,"label"),T["\u0275\u0275text"](3),T["\u0275\u0275pipe"](4,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](5,"\n  "),T["\u0275\u0275elementStart"](6,"div",3),T["\u0275\u0275text"](7,"\n    "),T["\u0275\u0275template"](8,ue,8,3,"button",4),T["\u0275\u0275text"](9,"\n    "),T["\u0275\u0275template"](10,pe,8,3,"button",5),T["\u0275\u0275text"](11,"\n    "),T["\u0275\u0275template"](12,de,9,6,"button",6),T["\u0275\u0275text"](13,"\n  "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](14,"\n"),T["\u0275\u0275elementEnd"]()),2&e){var n=t.ngVar;T["\u0275\u0275advance"](3),T["\u0275\u0275textInterpolate"](T["\u0275\u0275pipeBind1"](4,4,"collection.edit.template.label")),T["\u0275\u0275advance"](5),T["\u0275\u0275property"]("ngIf",!(null!=n&&n.payload)),T["\u0275\u0275advance"](2),T["\u0275\u0275property"]("ngIf",null==n?null:n.payload),T["\u0275\u0275advance"](2),T["\u0275\u0275property"]("ngIf",null==n?null:n.payload)}}var fe,ve=((fe=function(e){n(r,e);var i=a(r);function r(e,t,n,a,o,c,l,s){var p;return u(this,r),(p=i.call(this,e,n,a,o,c)).collectionDataService=e,p.itemTemplateService=t,p.router=n,p.route=a,p.notificationsService=o,p.translate=c,p.objectCache=l,p.requestService=s,p.frontendURL="/collections/",p.type=ne.a.type,p}return d(r,[{key:"ngOnInit",value:function(){t(o(r.prototype),"ngOnInit",this).call(this),this.initTemplateItem()}},{key:"initTemplateItem",value:function(){var e=this;this.itemTemplateRD$=this.dsoRD$.pipe(Object(g.j)(),Object(y.a)((function(t){return e.itemTemplateService.findByCollectionID(t.uuid)})))}},{key:"addItemTemplate",value:function(){var e=this,t=this.dsoRD$.pipe(Object(g.j)()),n=t.pipe(Object(y.a)((function(t){return e.itemTemplateService.create(new ie.a,t.uuid).pipe(Object(g.j)())}))),i=t.pipe(Object(y.a)((function(t){return e.itemTemplateService.getCollectionEndpoint(t.id)})));Object(v.a)(t,n,i).subscribe((function(t){var n=c(t,3),i=n[0],a=(n[1],n[2]);e.requestService.setStaleByHrefSubstring(a),e.router.navigate([Object(Y.i)(i.uuid)])}))}},{key:"deleteItemTemplate",value:function(){var e=this,t=this.dsoRD$.pipe(Object(g.j)()),n=t.pipe(Object(y.a)((function(t){return e.itemTemplateService.findByCollectionID(t.uuid).pipe(Object(g.j)())}))),i=t.pipe(Object(y.a)((function(t){return e.itemTemplateService.getCollectionEndpoint(t.id)})));Object(v.a)(t,n,i).pipe(Object(y.a)((function(t){var n=c(t,3),i=n[0],a=n[1],r=n[2];return e.itemTemplateService.deleteByCollectionID(a,i.uuid).pipe(Object(ae.a)((function(t){t&&(e.objectCache.remove(r),e.objectCache.remove(a.self),e.requestService.setStaleByHrefSubstring(a.self),e.requestService.setStaleByHrefSubstring(r),e.requestService.setStaleByHrefSubstring(i.self))})))}))).subscribe((function(t){t?e.notificationsService.success(null,e.translate.get("collection.edit.template.notifications.delete.success")):e.notificationsService.error(null,e.translate.get("collection.edit.template.notifications.delete.error")),e.initTemplateItem()}))}}]),r}(te.a)).\u0275fac=function(e){return new(e||fe)(T["\u0275\u0275directiveInject"]($.a),T["\u0275\u0275directiveInject"](re.a),T["\u0275\u0275directiveInject"](m.g),T["\u0275\u0275directiveInject"](m.a),T["\u0275\u0275directiveInject"](R.a),T["\u0275\u0275directiveInject"](F.f),T["\u0275\u0275directiveInject"](oe.a),T["\u0275\u0275directiveInject"](ce.a))},fe.\u0275cmp=T["\u0275\u0275defineComponent"]({type:fe,selectors:[["ds-collection-metadata"]],features:[T["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:6,consts:[["class","container-fluid mb-2",4,"ngVar"],[3,"dso","submitForm","back","finish"],[1,"container-fluid","mb-2"],[1,"button-row"],["class","btn btn-success",3,"click",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],["class","btn btn-primary",3,"routerLink",4,"ngIf"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash-alt"],[1,"btn","btn-primary",3,"routerLink"],[1,"fas","fa-edit"]],template:function(e,t){var n;1&e&&(T["\u0275\u0275template"](0,me,15,6,"div",0),T["\u0275\u0275pipe"](1,"async"),T["\u0275\u0275text"](2,"\n"),T["\u0275\u0275elementStart"](3,"ds-collection-form",1),T["\u0275\u0275listener"]("submitForm",(function(e){return t.onSubmit(e)}))("back",(function(){return t.navigateToHomePage()}))("finish",(function(){return t.navigateToHomePage()})),T["\u0275\u0275pipe"](4,"async"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](5,"\n")),2&e&&(T["\u0275\u0275property"]("ngVar",T["\u0275\u0275pipeBind1"](1,2,t.itemTemplateRD$)),T["\u0275\u0275advance"](3),T["\u0275\u0275property"]("dso",null==(n=T["\u0275\u0275pipeBind1"](4,4,t.dsoRD$))?null:n.payload))},directives:[le.a,se.a,s.u,m.h],pipes:[s.b,F.e],encapsulation:2}),fe),he=l("SxV6"),be=l("V17L");function ye(e,t){if(1&e&&(T["\u0275\u0275elementStart"](0,"ds-comcol-role",1),T["\u0275\u0275pipe"](1,"async"),T["\u0275\u0275text"](2,"\n"),T["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,i=T["\u0275\u0275nextContext"]();T["\u0275\u0275property"]("dso",T["\u0275\u0275pipeBind1"](1,2,i.collection$))("comcolRole",n)}}var Se,xe=((Se=function(){function t(e){u(this,t),this.route=e}return d(t,[{key:"ngOnInit",value:function(){this.dsoRD$=this.route.parent.data.pipe(Object(he.a)(),Object(b.a)((function(e){return e.dso}))),this.collection$=this.dsoRD$.pipe(Object(g.i)(),Object(g.o)()),this.comcolRoles$=this.collection$.pipe(Object(b.a)((function(t){return[{name:"collection-admin",href:t._links.adminGroup.href},{name:"submitters",href:t._links.submittersGroup.href},{name:"item_read",href:t._links.itemReadGroup.href},{name:"bitstream_read",href:t._links.bitstreamReadGroup.href}].concat(e(t._links.workflowGroups))})))}}]),t}()).\u0275fac=function(e){return new(e||Se)(T["\u0275\u0275directiveInject"](m.a))},Se.\u0275cmp=T["\u0275\u0275defineComponent"]({type:Se,selectors:[["ds-collection-roles"]],decls:3,vars:3,consts:[[3,"dso","comcolRole",4,"ngFor","ngForOf"],[3,"dso","comcolRole"]],template:function(e,t){1&e&&(T["\u0275\u0275template"](0,ye,3,4,"ds-comcol-role",0),T["\u0275\u0275pipe"](1,"async"),T["\u0275\u0275text"](2,"\n")),2&e&&T["\u0275\u0275property"]("ngForOf",T["\u0275\u0275pipeBind1"](1,1,t.comcolRoles$))},directives:[s.t,be.a],pipes:[s.b],encapsulation:2}),Se),ge=l("daFX"),Ie=l("QOHy"),je=l("q7s5"),Ce=l("LvDl"),Oe=l("AytR"),Ee=l("loKC"),we=l("Frqi"),ke=l("hqmO"),Te=l("s7LF");function Be(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275elementStart"](0,"button",12),T["\u0275\u0275listener"]("click",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"]().discard()})),T["\u0275\u0275pipe"](1,"async"),T["\u0275\u0275element"](2,"i",13),T["\u0275\u0275text"](3,"\n      "),T["\u0275\u0275elementStart"](4,"span",6),T["\u0275\u0275text"](5),T["\u0275\u0275pipe"](6,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](7,"\n    "),T["\u0275\u0275elementEnd"]()}if(2&e){var i=T["\u0275\u0275nextContext"]();T["\u0275\u0275property"]("disabled",!T["\u0275\u0275pipeBind1"](1,2,i.hasChanges())),T["\u0275\u0275advance"](5),T["\u0275\u0275textInterpolate1"]("\xa0",T["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function Re(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275elementStart"](0,"button",14),T["\u0275\u0275listener"]("click",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"]().reinstate()})),T["\u0275\u0275element"](1,"i",15),T["\u0275\u0275text"](2,"\n      "),T["\u0275\u0275elementStart"](3,"span",6),T["\u0275\u0275text"](4),T["\u0275\u0275pipe"](5,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](6,"\n    "),T["\u0275\u0275elementEnd"]()}2&e&&(T["\u0275\u0275advance"](4),T["\u0275\u0275textInterpolate1"]("\xa0",T["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function De(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275elementStart"](0,"div",16),T["\u0275\u0275text"](1,"\n    "),T["\u0275\u0275elementStart"](2,"input",17),T["\u0275\u0275listener"]("change",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"]().changeExternalSource()})),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](3,"\n    "),T["\u0275\u0275elementStart"](4,"label",18),T["\u0275\u0275text"](5),T["\u0275\u0275pipe"](6,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](7,"\n  "),T["\u0275\u0275elementEnd"]()}if(2&e){var i=T["\u0275\u0275nextContext"]();T["\u0275\u0275advance"](2),T["\u0275\u0275property"]("checked",(null==i.contentSource?null:i.contentSource.harvestType)!==i.harvestTypeNone),T["\u0275\u0275advance"](3),T["\u0275\u0275textInterpolate"](T["\u0275\u0275pipeBind1"](6,2,"collection.edit.tabs.source.external"))}}function $e(e,t){1&e&&(T["\u0275\u0275element"](0,"ds-loading",19),T["\u0275\u0275pipe"](1,"translate")),2&e&&T["\u0275\u0275property"]("message",T["\u0275\u0275pipeBind1"](1,1,"loading.content-source"))}function Fe(e,t){1&e&&(T["\u0275\u0275elementStart"](0,"h4"),T["\u0275\u0275text"](1),T["\u0275\u0275pipe"](2,"translate"),T["\u0275\u0275elementEnd"]()),2&e&&(T["\u0275\u0275advance"](1),T["\u0275\u0275textInterpolate"](T["\u0275\u0275pipeBind1"](2,1,"collection.edit.tabs.source.form.head")))}function Me(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275elementStart"](0,"ds-form",20),T["\u0275\u0275listener"]("dfChange",(function(e){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"]().onChange(e)}))("submitForm",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"]().onSubmit()}))("cancel",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"]().onCancel()})),T["\u0275\u0275elementEnd"]()}if(2&e){var i=T["\u0275\u0275nextContext"]();T["\u0275\u0275property"]("formId","collection-source-form-id")("formGroup",i.formGroup)("formModel",i.formModel)("formLayout",i.formLayout)("displaySubmit",!1)("displayCancel",!1)}}function Ne(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275elementStart"](0,"button",12),T["\u0275\u0275listener"]("click",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"](2).discard()})),T["\u0275\u0275pipe"](1,"async"),T["\u0275\u0275element"](2,"i",13),T["\u0275\u0275text"](3,"\n      "),T["\u0275\u0275elementStart"](4,"span",6),T["\u0275\u0275text"](5),T["\u0275\u0275pipe"](6,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](7,"\n    "),T["\u0275\u0275elementEnd"]()}if(2&e){var i=T["\u0275\u0275nextContext"](2);T["\u0275\u0275property"]("disabled",!T["\u0275\u0275pipeBind1"](1,2,i.hasChanges())),T["\u0275\u0275advance"](5),T["\u0275\u0275textInterpolate1"]("\xa0",T["\u0275\u0275pipeBind1"](6,4,"item.edit.metadata.discard-button"),"")}}function Ve(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275elementStart"](0,"button",14),T["\u0275\u0275listener"]("click",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"](2).reinstate()})),T["\u0275\u0275element"](1,"i",15),T["\u0275\u0275text"](2,"\n      "),T["\u0275\u0275elementStart"](3,"span",6),T["\u0275\u0275text"](4),T["\u0275\u0275pipe"](5,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](6,"\n    "),T["\u0275\u0275elementEnd"]()}2&e&&(T["\u0275\u0275advance"](4),T["\u0275\u0275textInterpolate1"]("\xa0",T["\u0275\u0275pipeBind1"](5,1,"item.edit.metadata.reinstate-button"),""))}function Pe(e,t){if(1&e){var n=T["\u0275\u0275getCurrentView"]();T["\u0275\u0275elementStart"](0,"div",0),T["\u0275\u0275text"](1,"\n  "),T["\u0275\u0275elementStart"](2,"div",1),T["\u0275\u0275text"](3,"\n    "),T["\u0275\u0275template"](4,Ne,8,6,"button",2),T["\u0275\u0275pipe"](5,"async"),T["\u0275\u0275text"](6,"\n    "),T["\u0275\u0275template"](7,Ve,7,3,"button",3),T["\u0275\u0275pipe"](8,"async"),T["\u0275\u0275text"](9,"\n    "),T["\u0275\u0275elementStart"](10,"button",4),T["\u0275\u0275listener"]("click",(function(){return T["\u0275\u0275restoreView"](n),T["\u0275\u0275nextContext"]().onSubmit()})),T["\u0275\u0275pipe"](11,"async"),T["\u0275\u0275element"](12,"i",5),T["\u0275\u0275text"](13,"\n      "),T["\u0275\u0275elementStart"](14,"span",6),T["\u0275\u0275text"](15),T["\u0275\u0275pipe"](16,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](17,"\n    "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](18,"\n  "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](19,"\n"),T["\u0275\u0275elementEnd"]()}if(2&e){var i=T["\u0275\u0275nextContext"]();T["\u0275\u0275advance"](4),T["\u0275\u0275property"]("ngIf",!T["\u0275\u0275pipeBind1"](5,4,i.isReinstatable())),T["\u0275\u0275advance"](3),T["\u0275\u0275property"]("ngIf",T["\u0275\u0275pipeBind1"](8,6,i.isReinstatable())),T["\u0275\u0275advance"](3),T["\u0275\u0275property"]("disabled",!T["\u0275\u0275pipeBind1"](11,8,i.hasChanges())||!i.isValid()||i.initialHarvestType===i.harvestTypeNone&&i.contentSource.harvestType===i.initialHarvestType),T["\u0275\u0275advance"](5),T["\u0275\u0275textInterpolate1"]("\xa0",T["\u0275\u0275pipeBind1"](16,10,"item.edit.metadata.save-button"),"")}}var Le,_e,He,Ae,Ue,qe,Ge=((Le=function(e){n(i,e);var t=a(i);function i(e,n,a,r,o,c,l,s,p){var d;return u(this,i),(d=t.call(this,e,n,o)).objectUpdatesService=e,d.notificationsService=n,d.location=a,d.formService=r,d.translate=o,d.route=c,d.router=l,d.collectionService=s,d.requestService=p,d.LABEL_KEY_PREFIX="collection.edit.tabs.source.form.",d.ERROR_KEY_PREFIX="collection.edit.tabs.source.form.errors.",d.OPTIONS_KEY_PREFIX="collection.edit.tabs.source.form.options.",d.oaiSourceModel=new Ie.I({id:"oaiSource",name:"oaiSource",required:!0,validators:{required:null},errorMessages:{required:"You must provide a set id of the target collection."}}),d.oaiSetIdModel=new Ie.I({id:"oaiSetId",name:"oaiSetId"}),d.metadataConfigIdModel=new Ie.M({id:"metadataConfigId",name:"metadataConfigId"}),d.harvestTypeModel=new Ie.L({id:"harvestType",name:"harvestType",options:[{value:je.b.Metadata},{value:je.b.MetadataAndRef},{value:je.b.MetadataAndBitstreams}]}),d.inputModels=[d.oaiSourceModel,d.oaiSetIdModel,d.metadataConfigIdModel,d.harvestTypeModel],d.formModel=[new Ie.C({id:"oaiSourceContainer",group:[d.oaiSourceModel]}),new Ie.C({id:"oaiSetContainer",group:[d.oaiSetIdModel,d.metadataConfigIdModel]}),new Ie.C({id:"harvestTypeContainer",group:[d.harvestTypeModel]})],d.formLayout={oaiSource:{grid:{host:"col-12 d-inline-block"}},oaiSetId:{grid:{host:"col col-sm-6 d-inline-block"}},metadataConfigId:{grid:{host:"col col-sm-6 d-inline-block"}},harvestType:{grid:{host:"col-12",option:"btn-outline-secondary"}},oaiSetContainer:{grid:{host:"row"}},oaiSourceContainer:{grid:{host:"row"}},harvestTypeContainer:{grid:{host:"row"}}},d.harvestTypeNone=je.b.None,d.previouslySelectedHarvestType=je.b.Metadata,d.displayedNotifications=[],d}return d(i,[{key:"ngOnInit",value:function(){var e=this;this.notificationsPrefix="collection.edit.tabs.source.notifications.",this.discardTimeOut=Oe.a.collection.edit.undoTimeout,this.url=this.router.url,this.url.indexOf("?")>0&&(this.url=this.url.substr(0,this.url.indexOf("?"))),this.formGroup=this.formService.createFormGroup(this.formModel),this.collectionRD$=this.route.parent.data.pipe(Object(he.a)(),Object(b.a)((function(e){return e.dso}))),this.collectionRD$.pipe(Object(g.i)(),Object(b.a)((function(e){return e.payload.uuid})),Object(y.a)((function(t){return e.collectionService.getContentSource(t)})),Object(g.g)()).subscribe((function(t){e.initializeOriginalContentSource(t.payload)})),this.updateFieldTranslations(),this.translate.onLangChange.subscribe((function(){e.updateFieldTranslations()}))}},{key:"initializeOriginalContentSource",value:function(e){var t=this;this.contentSource=e,this.initialHarvestType=e.harvestType,this.initializeMetadataConfigs();var n=Object(Ce.cloneDeep)(this.contentSource);this.objectUpdatesService.initialize(this.url,[n],new Date),this.update$=this.objectUpdatesService.getFieldUpdates(this.url,[n]).pipe(Object(b.a)((function(e){return e[n.uuid]}))),this.updateSub=this.update$.subscribe((function(e){if(e){var n,i=e.field;Object(C.b)(t.contentSource)&&Object(C.e)(t.contentSource.metadataConfigs)&&(n=t.contentSource.metadataConfigs[0].id),Object(C.b)(i)&&Object(C.b)(i.metadataConfigId)&&(n=i.metadataConfigId),Object(C.b)(i)&&(t.formGroup.patchValue({oaiSourceContainer:{oaiSource:i.oaiSource},oaiSetContainer:{oaiSetId:i.oaiSetId,metadataConfigId:n},harvestTypeContainer:{harvestType:i.harvestType}}),t.contentSource=Object(Ce.cloneDeep)(i)),t.contentSource.metadataConfigId=n}}))}},{key:"initializeMetadataConfigs",value:function(){this.metadataConfigIdModel.options=this.contentSource.metadataConfigs.map((function(e){return Object.assign({value:e.id,label:e.label})})),this.metadataConfigIdModel.options.length>0&&this.formGroup.patchValue({oaiSetContainer:{metadataConfigId:this.metadataConfigIdModel.options[0].value}})}},{key:"updateFieldTranslations",value:function(){var e=this;this.inputModels.forEach((function(t){e.updateFieldTranslation(t)}))}},{key:"updateFieldTranslation",value:function(e){var t=this;e.label=this.translate.instant(this.LABEL_KEY_PREFIX+e.id),Object(C.e)(e.validators)&&(e.errorMessages={},Object.keys(e.validators).forEach((function(n){e.errorMessages[n]=t.translate.instant(t.ERROR_KEY_PREFIX+e.id+"."+n)}))),e instanceof Ie.K&&Object(C.e)(e.options)&&e.options.forEach((function(n){Object(C.a)(n.label)&&(n.label=t.translate.instant(t.OPTIONS_KEY_PREFIX+e.id+"."+n.value))}))}},{key:"onChange",value:function(e){this.updateContentSourceField(e.model,!0),this.saveFieldUpdate()}},{key:"onSubmit",value:function(){var e=this;this.collectionRD$.pipe(Object(g.i)(),Object(b.a)((function(e){return e.payload.uuid})),Object(y.a)((function(t){return e.collectionService.getHarvesterEndpoint(t)})),Object(x.a)(1)).subscribe((function(t){return e.requestService.removeByHrefSubstring(t)})),this.collectionRD$.pipe(Object(g.i)(),Object(b.a)((function(e){return e.payload.uuid})),Object(y.a)((function(t){return e.collectionService.updateContentSource(t,e.contentSource)})),Object(x.a)(1)).subscribe((function(t){Object(C.b)(t.harvestType)?(e.clearNotifications(),e.initializeOriginalContentSource(t),e.displayedNotifications.push(e.notificationsService.success(e.getNotificationTitle("saved"),e.getNotificationContent("saved")))):e.displayedNotifications.push(t)}))}},{key:"onCancel",value:function(){this.location.back()}},{key:"isValid",value:function(){return this.contentSource.harvestType===je.b.None||this.formGroup.valid}},{key:"changeExternalSource",value:function(){this.contentSource.harvestType===je.b.None?this.contentSource.harvestType=this.previouslySelectedHarvestType:(this.previouslySelectedHarvestType=this.contentSource.harvestType,this.contentSource.harvestType=je.b.None),this.updateContentSource(!1)}},{key:"updateContentSource",value:function(e){var t=this;this.inputModels.forEach((function(n){t.updateContentSourceField(n,e)})),this.saveFieldUpdate()}},{key:"updateContentSourceField",value:function(e,t){Object(C.b)(e.value)&&(e.id!==this.harvestTypeModel.id||t)&&(this.contentSource[e.id]=e.value)}},{key:"saveFieldUpdate",value:function(){this.objectUpdatesService.saveAddFieldUpdate(this.url,Object(Ce.cloneDeep)(this.contentSource))}},{key:"clearNotifications",value:function(){var e=this;this.displayedNotifications.forEach((function(t){e.notificationsService.remove(t)})),this.displayedNotifications=[]}},{key:"ngOnDestroy",value:function(){this.updateSub&&this.updateSub.unsubscribe()}}]),i}(ge.a)).\u0275fac=function(e){return new(e||Le)(T["\u0275\u0275directiveInject"](Ee.a),T["\u0275\u0275directiveInject"](R.a),T["\u0275\u0275directiveInject"](s.o),T["\u0275\u0275directiveInject"](Ie.F),T["\u0275\u0275directiveInject"](F.f),T["\u0275\u0275directiveInject"](m.a),T["\u0275\u0275directiveInject"](m.g),T["\u0275\u0275directiveInject"]($.a),T["\u0275\u0275directiveInject"](ce.a))},Le.\u0275cmp=T["\u0275\u0275defineComponent"]({type:Le,selectors:[["ds-collection-source"]],features:[T["\u0275\u0275InheritDefinitionFeature"]],decls:35,vars:20,consts:[[1,"container-fluid"],[1,"d-inline-block","float-right"],["class"," btn btn-danger",3,"disabled","click",4,"ngIf"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-save"],[1,"d-none","d-sm-inline"],["class","form-check mb-4",4,"ngIf"],[3,"message",4,"ngIf"],[4,"ngIf"],[3,"formId","formGroup","formModel","formLayout","displaySubmit","displayCancel","dfChange","submitForm","cancel",4,"ngIf"],["class","container-fluid",4,"ngIf"],[1,"btn","btn-danger",3,"disabled","click"],[1,"fas","fa-times"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-undo-alt"],[1,"form-check","mb-4"],["type","checkbox","id","externalSourceCheck",1,"form-check-input",3,"checked","change"],["for","externalSourceCheck",1,"form-check-label"],[3,"message"],[3,"formId","formGroup","formModel","formLayout","displaySubmit","displayCancel","dfChange","submitForm","cancel"]],template:function(e,t){1&e&&(T["\u0275\u0275elementStart"](0,"div",0),T["\u0275\u0275text"](1,"\n  "),T["\u0275\u0275elementStart"](2,"div",1),T["\u0275\u0275text"](3,"\n    "),T["\u0275\u0275template"](4,Be,8,6,"button",2),T["\u0275\u0275pipe"](5,"async"),T["\u0275\u0275text"](6,"\n    "),T["\u0275\u0275template"](7,Re,7,3,"button",3),T["\u0275\u0275pipe"](8,"async"),T["\u0275\u0275text"](9,"\n    "),T["\u0275\u0275elementStart"](10,"button",4),T["\u0275\u0275listener"]("click",(function(){return t.onSubmit()})),T["\u0275\u0275pipe"](11,"async"),T["\u0275\u0275element"](12,"i",5),T["\u0275\u0275text"](13,"\n      "),T["\u0275\u0275elementStart"](14,"span",6),T["\u0275\u0275text"](15),T["\u0275\u0275pipe"](16,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](17,"\n    "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](18,"\n  "),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](19,"\n  "),T["\u0275\u0275elementStart"](20,"h4"),T["\u0275\u0275text"](21),T["\u0275\u0275pipe"](22,"translate"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](23,"\n  "),T["\u0275\u0275template"](24,De,8,4,"div",7),T["\u0275\u0275text"](25,"\n  "),T["\u0275\u0275template"](26,$e,2,3,"ds-loading",8),T["\u0275\u0275text"](27,"\n  "),T["\u0275\u0275template"](28,Fe,3,3,"h4",9),T["\u0275\u0275text"](29,"\n"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](30,"\n"),T["\u0275\u0275template"](31,Me,1,6,"ds-form",10),T["\u0275\u0275text"](32,"\n"),T["\u0275\u0275template"](33,Pe,20,12,"div",11),T["\u0275\u0275text"](34,"\n")),2&e&&(T["\u0275\u0275advance"](4),T["\u0275\u0275property"]("ngIf",!T["\u0275\u0275pipeBind1"](5,10,t.isReinstatable())),T["\u0275\u0275advance"](3),T["\u0275\u0275property"]("ngIf",T["\u0275\u0275pipeBind1"](8,12,t.isReinstatable())),T["\u0275\u0275advance"](3),T["\u0275\u0275property"]("disabled",!T["\u0275\u0275pipeBind1"](11,14,t.hasChanges())||!t.isValid()||t.initialHarvestType===t.harvestTypeNone&&t.contentSource.harvestType===t.initialHarvestType),T["\u0275\u0275advance"](5),T["\u0275\u0275textInterpolate1"]("\xa0",T["\u0275\u0275pipeBind1"](16,16,"item.edit.metadata.save-button"),""),T["\u0275\u0275advance"](6),T["\u0275\u0275textInterpolate"](T["\u0275\u0275pipeBind1"](22,18,"collection.edit.tabs.source.head")),T["\u0275\u0275advance"](3),T["\u0275\u0275property"]("ngIf",t.contentSource),T["\u0275\u0275advance"](2),T["\u0275\u0275property"]("ngIf",!t.contentSource),T["\u0275\u0275advance"](2),T["\u0275\u0275property"]("ngIf",t.contentSource&&(null==t.contentSource?null:t.contentSource.harvestType)!==t.harvestTypeNone),T["\u0275\u0275advance"](3),T["\u0275\u0275property"]("ngIf",t.formGroup&&t.contentSource&&(null==t.contentSource?null:t.contentSource.harvestType)!==t.harvestTypeNone),T["\u0275\u0275advance"](2),T["\u0275\u0275property"]("ngIf",(null==t.contentSource?null:t.contentSource.harvestType)!==t.harvestTypeNone))},directives:[s.u,we.a,ke.a,Te.NgControlStatusGroup,Te.FormGroupDirective],pipes:[s.b,F.e],encapsulation:2}),Le),ze=l("pLZG"),Xe=l("Rgmz"),Ye=function(e){return{collection:e}},Ke=((_e=function(){function e(t,n){u(this,e),this.route=t,this.dsoNameService=n}return d(e,[{key:"ngOnInit",value:function(){var e=this;this.dsoRD$=this.route.parent.data.pipe(Object(x.a)(1),Object(b.a)((function(e){return e.dso}))),this.collectionName$=this.dsoRD$.pipe(Object(ze.a)((function(e){return Object(C.b)(e)})),Object(b.a)((function(t){return e.dsoNameService.getName(t.payload)})))}}]),e}()).\u0275fac=function(e){return new(e||_e)(T["\u0275\u0275directiveInject"](m.a),T["\u0275\u0275directiveInject"](M.a))},_e.\u0275cmp=T["\u0275\u0275defineComponent"]({type:_e,selectors:[["ds-collection-curate"]],decls:11,vars:11,consts:[[1,"container"],[3,"dsoHandle"]],template:function(e,t){var n;1&e&&(T["\u0275\u0275elementStart"](0,"div",0),T["\u0275\u0275text"](1,"\n    "),T["\u0275\u0275elementStart"](2,"h3"),T["\u0275\u0275text"](3),T["\u0275\u0275pipe"](4,"translate"),T["\u0275\u0275pipe"](5,"async"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](6,"\n    "),T["\u0275\u0275element"](7,"ds-curation-form",1),T["\u0275\u0275pipe"](8,"async"),T["\u0275\u0275text"](9,"\n"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](10,"\n")),2&e&&(T["\u0275\u0275advance"](3),T["\u0275\u0275textInterpolate"](T["\u0275\u0275pipeBind2"](4,2,"collection.curate.header",T["\u0275\u0275pureFunction1"](9,Ye,T["\u0275\u0275pipeBind1"](5,5,t.collectionName$)))),T["\u0275\u0275advance"](4),T["\u0275\u0275property"]("dsoHandle",null==(n=T["\u0275\u0275pipeBind1"](8,7,t.dsoRD$))?null:n.payload.handle))},directives:[Xe.a],pipes:[F.e,s.b],encapsulation:2}),_e),Qe=l("+Bs4"),Je=((He=function(){function e(t){u(this,e),this.route=t}return d(e,[{key:"ngOnInit",value:function(){this.dsoRD$=this.route.parent.parent.data.pipe(Object(he.a)(),Object(b.a)((function(e){return e.dso})))}}]),e}()).\u0275fac=function(e){return new(e||He)(T["\u0275\u0275directiveInject"](m.a))},He.\u0275cmp=T["\u0275\u0275defineComponent"]({type:He,selectors:[["ds-collection-authorizations"]],decls:6,vars:4,consts:[[1,"container"],[3,"resourceType","resourceUUID"]],template:function(e,t){var n;1&e&&(T["\u0275\u0275elementStart"](0,"div",0),T["\u0275\u0275text"](1,"\n  "),T["\u0275\u0275element"](2,"ds-resource-policies",1),T["\u0275\u0275pipe"](3,"async"),T["\u0275\u0275text"](4,"\n"),T["\u0275\u0275elementEnd"](),T["\u0275\u0275text"](5,"\n")),2&e&&(T["\u0275\u0275advance"](2),T["\u0275\u0275property"]("resourceType","collection")("resourceUUID",null==(n=T["\u0275\u0275pipeBind1"](3,2,t.dsoRD$))||null==n.payload?null:n.payload.id))},directives:[Qe.a],pipes:[s.b],encapsulation:2}),He),Ze=l("A0IO"),We=l("n1Qy"),et=l("EEUA"),tt=l("G5zm"),nt=l("ALMP"),it=l("rdLr"),at=l("LRne"),rt=l("FU+A"),ot=l("1mcE"),ct=l("Vurf"),lt=((Ue=function(e){n(i,e);var t=a(i);function i(e,n,a){var r;return u(this,i),(r=t.call(this,e,n,a)).authorizationService=e,r.router=n,r.authService=a,r}return d(i,[{key:"getFeatureID",value:function(e,t){return Object(at.a)(rt.a.IsCollectionAdmin)}}]),i}(it.a)).\u0275fac=function(e){return new(e||Ue)(T["\u0275\u0275inject"](ot.a),T["\u0275\u0275inject"](m.g),T["\u0275\u0275inject"](ct.a))},Ue.\u0275prov=T["\u0275\u0275defineInjectable"]({token:Ue,factory:Ue.\u0275fac,providedIn:"root"}),Ue),st=((Ae=function e(){u(this,e)}).\u0275mod=T["\u0275\u0275defineNgModule"]({type:Ae}),Ae.\u0275inj=T["\u0275\u0275defineInjector"]({factory:function(e){return new(e||Ae)},providers:[tt.a,We.a],imports:[[m.k.forChild([{path:"",resolve:{breadcrumb:Ze.a},data:{breadcrumbKey:"collection.edit"},component:ee,canActivate:[lt],children:[{path:"",redirectTo:"metadata",pathMatch:"full"},{path:"metadata",component:ve,data:{title:"collection.edit.tabs.metadata.title",hideReturnButton:!0,showBreadcrumbs:!0}},{path:"roles",component:xe,data:{title:"collection.edit.tabs.roles.title",showBreadcrumbs:!0}},{path:"source",component:Ge,data:{title:"collection.edit.tabs.source.title",showBreadcrumbs:!0}},{path:"curate",component:Ke,data:{title:"collection.edit.tabs.curate.title",showBreadcrumbs:!0}},{path:"authorizations",data:{showBreadcrumbs:!0},children:[{path:"create",resolve:{resourcePolicyTarget:We.a},component:et.a,data:{title:"resource-policies.create.page.title"}},{path:"edit",resolve:{resourcePolicy:tt.a},component:nt.a,data:{title:"resource-policies.edit.page.title"}},{path:"",component:Je,data:{title:"collection.edit.tabs.authorizations.title",showBreadcrumbs:!0}}]},{path:"mapper",component:z,data:{title:"collection.edit.tabs.item-mapper.title",hideReturnButton:!0,showBreadcrumbs:!0}}]}])]]}),Ae),ut=l("yBEL"),pt=((qe=function e(){u(this,e)}).\u0275mod=T["\u0275\u0275defineNgModule"]({type:qe}),qe.\u0275inj=T["\u0275\u0275defineInjector"]({factory:function(e){return new(e||qe)},imports:[[s.c,p.a,st,ut.a]]}),qe)}}])}();
//# sourceMappingURL=38-es5.ba1ce9abb15892b5f2f8.js.map