!function(){function e(t,n,i){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(t,n,i||t)}function t(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return r=e.done,e},e:function(e){c=!0,s=e},f:function(){try{r||null==n.return||n.return()}finally{if(c)throw s}}}}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,o=!1,a=void 0;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(c){o=!0,a=c}finally{try{i||null==r.return||r.return()}finally{if(o)throw a}}return n}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"0VLH":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("J3qs"),o=function(e){c(n,e);var t=u(n);function n(e){var i;a(this,n);for(var o=arguments.length,s=new Array(o>1?o-1:0),r=1;r<o;r++)s[r-1]=arguments[r];return(i=t.call.apply(t,[this,e].concat(s)))._rootElement=e,i._subRootElement=s.join("/"),i}return r(n,[{key:"getPath",value:function(e){Object(i.h)(e)&&Array.isArray(e)&&(e=e.join("/"));var t="/"+this.toString();return Object(i.h)(e)&&(t+="/"+e),{rootElement:this._rootElement,subRootElement:this._subRootElement,path:t}}},{key:"rootElement",get:function(){return this._rootElement}},{key:"subRootElement",get:function(){return this._subRootElement}}]),n}(n("zZO8").a)},"20cJ":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("/eM4"),o=n("5+tZ"),s=n("6c/T"),c=n("8Y7J"),l=n("G0yt"),u=n("J/vq"),d=n("iInd"),p=n("lI3o"),m=n("SVse"),f=n("TSSN");function b(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"div",5),c["\u0275\u0275text"](1,"\n      "),c["\u0275\u0275elementStart"](2,"div",6),c["\u0275\u0275text"](3,"\n        "),c["\u0275\u0275elementStart"](4,"strong"),c["\u0275\u0275text"](5),c["\u0275\u0275pipe"](6,"translate"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](7,"\n        "),c["\u0275\u0275elementStart"](8,"p"),c["\u0275\u0275text"](9),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](10,"\n      "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](11,"\n    "),c["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;c["\u0275\u0275advance"](5),c["\u0275\u0275textInterpolate"](c["\u0275\u0275pipeBind1"](6,2,"item.preview."+n.key)),c["\u0275\u0275advance"](4),c["\u0275\u0275textInterpolate"](n.value.value)}}var v=function(){var e=function(){function e(t,n,i,o,s){a(this,e),this.activeModal=t,this.submissionService=n,this.modalService=i,this.router=o,this.notificationService=s}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.metadataList=[],Object.keys(this.externalSourceEntry.metadata).forEach((function(t){e.metadataList.push({key:t,value:i.a.first(e.externalSourceEntry.metadata,t)})}))}},{key:"closeMetadataModal",value:function(){this.activeModal.dismiss(!1)}},{key:"import",value:function(){var e=this;this.modalRef=this.modalService.open(s.a,{size:"lg"}),this.closeMetadataModal(),this.modalRef.componentInstance.selectedEvent.pipe(Object(o.a)((function(t){return e.submissionService.createSubmissionFromExternalSource(e.externalSourceEntry._links.self.href,t.collection.id)}))).subscribe((function(t){var n=!1;1===t.length&&null!==t[0]&&(n=!0,e.router.navigateByUrl("/workspaceitems/"+t[0].id+"/edit")),n||e.notificationService.error("submission.import-external.preview.error.import.title","submission.import-external.preview.error.import.body"),e.modalRef.close()}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](l.b),c["\u0275\u0275directiveInject"](u.a),c["\u0275\u0275directiveInject"](l.u),c["\u0275\u0275directiveInject"](d.g),c["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-import-external-preview"]],inputs:{externalSourceEntry:"externalSourceEntry"},decls:59,vars:10,consts:[[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"container"],[1,"row"],[1,"col-md-12"],["class","row",4,"ngFor","ngForOf"],[1,"col-md-12","text-right"],["role","button",1,"btn","btn-success",3,"click"],["aria-hidden","true",1,"fa","fa-file-import"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div",0),c["\u0275\u0275text"](1,"\n  "),c["\u0275\u0275elementStart"](2,"h2"),c["\u0275\u0275text"](3),c["\u0275\u0275pipe"](4,"translate"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](5,"\n  "),c["\u0275\u0275elementStart"](6,"button",1),c["\u0275\u0275listener"]("click",(function(){return t.closeMetadataModal()})),c["\u0275\u0275text"](7,"\n      "),c["\u0275\u0275elementStart"](8,"span",2),c["\u0275\u0275text"](9,"\xd7"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](10,"\n  "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](11,"\n"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](12,"\n"),c["\u0275\u0275elementStart"](13,"div",3),c["\u0275\u0275text"](14,"\n  "),c["\u0275\u0275elementStart"](15,"div",4),c["\u0275\u0275text"](16,"\n    "),c["\u0275\u0275elementStart"](17,"div",5),c["\u0275\u0275text"](18,"\n      "),c["\u0275\u0275elementStart"](19,"div",6),c["\u0275\u0275text"](20,"\n        "),c["\u0275\u0275elementStart"](21,"p"),c["\u0275\u0275text"](22),c["\u0275\u0275pipe"](23,"translate"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](24,"\n      "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](25,"\n    "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](26,"\n    "),c["\u0275\u0275elementStart"](27,"div",5),c["\u0275\u0275text"](28,"\n      "),c["\u0275\u0275elementStart"](29,"div",6),c["\u0275\u0275text"](30,"\n        "),c["\u0275\u0275element"](31,"hr"),c["\u0275\u0275text"](32,"\n      "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](33,"\n    "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](34,"\n    "),c["\u0275\u0275template"](35,b,12,4,"div",7),c["\u0275\u0275text"](36,"\n    "),c["\u0275\u0275elementStart"](37,"div",5),c["\u0275\u0275text"](38,"\n      "),c["\u0275\u0275elementStart"](39,"div",6),c["\u0275\u0275text"](40,"\n        "),c["\u0275\u0275element"](41,"hr"),c["\u0275\u0275text"](42,"\n      "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](43,"\n    "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](44,"\n    "),c["\u0275\u0275elementStart"](45,"div",5),c["\u0275\u0275text"](46,"\n      "),c["\u0275\u0275elementStart"](47,"div",8),c["\u0275\u0275text"](48,"\n        "),c["\u0275\u0275elementStart"](49,"button",9),c["\u0275\u0275listener"]("click",(function(){return t.import()})),c["\u0275\u0275text"](50,"\n          "),c["\u0275\u0275element"](51,"i",10),c["\u0275\u0275text"](52),c["\u0275\u0275pipe"](53,"translate"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](54,"\n      "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](55,"\n    "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](56,"\n  "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](57,"\n"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](58,"\n")),2&e&&(c["\u0275\u0275advance"](3),c["\u0275\u0275textInterpolate"](c["\u0275\u0275pipeBind1"](4,4,"submission.import-external.preview.title")),c["\u0275\u0275advance"](19),c["\u0275\u0275textInterpolate"](c["\u0275\u0275pipeBind1"](23,6,"submission.import-external.preview.subtitle")),c["\u0275\u0275advance"](13),c["\u0275\u0275property"]("ngForOf",t.metadataList),c["\u0275\u0275advance"](17),c["\u0275\u0275textInterpolate1"](" ",c["\u0275\u0275pipeBind1"](53,8,"submission.import-external.preview.button.import"),"\n        "))},directives:[m.t],pipes:[f.e],styles:[".close[_ngcontent-%COMP%]:focus{outline:none!important}"]}),e}()},"3aq+":function(e,t,n){var i={"./custom/app/submission/edit/submission-edit.component":["OutP",74]};function o(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],o=t[0];return n.e(t[1]).then((function(){return n(o)}))}o.keys=function(){return Object.keys(i)},o.id="3aq+",e.exports=o},"3cpT":function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var i=n("8Y7J"),o=n("LRne"),s=n("JIr8"),c=n("vkgz"),l=n("f+Ev"),u=n("oBfO"),d=n("GG8d"),p=n("B/au"),m=n("1QIV"),f=n("J3qs"),b=n("dHui"),v=n("14tD"),h=n("SVse"),g=n("G0yt"),x=n("MNke"),S=n("s7LF"),y=n("TSSN");function I(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",10),i["\u0275\u0275text"](1,"\n  "),i["\u0275\u0275elementStart"](2,"input",11),i["\u0275\u0275listener"]("keyup.enter",(function(){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275nextContext"]();return""===e.searchString?null:e.search()}))("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().searchString=e})),i["\u0275\u0275pipe"](3,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](4,"\n"),i["\u0275\u0275elementEnd"]()}if(2&e){var o=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](2),i["\u0275\u0275propertyInterpolate"]("placeholder",i["\u0275\u0275pipeBind1"](3,2,"submission.import-external.search.placeholder")),i["\u0275\u0275property"]("ngModel",o.searchString)}}function O(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"input",11),i["\u0275\u0275listener"]("keyup.enter",(function(){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275nextContext"]();return""===e.searchString?null:e.search()}))("ngModelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().searchString=e})),i["\u0275\u0275pipe"](1,"translate"),i["\u0275\u0275elementEnd"]()}if(2&e){var o=i["\u0275\u0275nextContext"]();i["\u0275\u0275propertyInterpolate"]("placeholder",i["\u0275\u0275pipeBind1"](1,2,"submission.import-external.search.placeholder")),i["\u0275\u0275property"]("ngModel",o.searchString)}}function j(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"button",12),i["\u0275\u0275listener"]("click",(function(){i["\u0275\u0275restoreView"](n);var e=t.$implicit;return i["\u0275\u0275nextContext"]().makeSourceSelection(e)})),i["\u0275\u0275pipe"](1,"translate"),i["\u0275\u0275text"](2),i["\u0275\u0275pipe"](3,"translate"),i["\u0275\u0275elementEnd"]()}if(2&e){var o=t.$implicit;i["\u0275\u0275propertyInterpolate"]("title",i["\u0275\u0275pipeBind1"](1,2,"submission.import-external.source."+(null==o?null:o.name))),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](3,4,"submission.import-external.source."+(null==o?null:o.name)))}}function C(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div",13),i["\u0275\u0275elementStart"](1,"p"),i["\u0275\u0275text"](2),i["\u0275\u0275pipe"](3,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e&&(i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](3,1,"submission.import-external.source.loading")))}var E=function(e){return{"input-group-append":e}},D=function(){var e=function(){function e(t,n,o){a(this,e),this.externalService=t,this.cdr=n,this.windowService=o,this.sourceListLoading=!1,this.externalSourceData=new i.EventEmitter}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.selectedElement={id:"",name:"loading"},this.searchString="",this.sourceList=[],this.findListOptions=Object.assign({},new p.f,{elementsPerPage:5,currentPage:1}),this.externalService.findAll(this.findListOptions).pipe(Object(s.a)((function(){var e=new u.a,t=Object(l.b)(e,[]),n=Object(d.c)(t);return Object(o.a)(n)})),Object(m.j)()).subscribe((function(t){t.page.forEach((function(t){e.sourceList.push({id:t.id,name:t.name}),e.initExternalSourceData.sourceId===t.id&&(e.selectedElement={id:t.id,name:t.name},e.searchString=e.initExternalSourceData.query)})),""===e.selectedElement.id&&(e.selectedElement=e.sourceList[0]),e.pageInfo=t.pageInfo,e.cdr.detectChanges()})),this.isXsOrSm$=this.windowService.isXsOrSm()}},{key:"makeSourceSelection",value:function(e){this.selectedElement=e}},{key:"onScroll",value:function(){var e=this;!this.sourceListLoading&&this.pageInfo.currentPage+1<=this.pageInfo.totalPages&&(this.sourceListLoading=!0,this.findListOptions=Object.assign({},new p.f,{elementsPerPage:5,currentPage:this.findListOptions.currentPage+1}),this.sub=this.externalService.findAll(this.findListOptions).pipe(Object(s.a)((function(){var e=new u.a,t=Object(l.b)(e,[]),n=Object(d.c)(t);return Object(o.a)(n)})),Object(m.i)(),Object(c.a)((function(){return e.sourceListLoading=!1}))).subscribe((function(t){t.payload.page.forEach((function(t){e.sourceList.push({id:t.id,name:t.name})})),e.pageInfo=t.payload.pageInfo,e.cdr.detectChanges()})))}},{key:"search",value:function(){this.externalSourceData.emit({sourceId:this.selectedElement.id,query:this.searchString})}},{key:"ngOnDestroy",value:function(){Object(f.b)(this.sub)&&this.sub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](b.a),i["\u0275\u0275directiveInject"](i.ChangeDetectorRef),i["\u0275\u0275directiveInject"](v.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-import-external-searchbar"]],inputs:{initExternalSourceData:"initExternalSourceData"},outputs:{externalSourceData:"externalSourceData"},decls:34,vars:31,consts:[["class","input-group mb-2",4,"ngIf"],[1,"input-group","mb-5"],["type","text","class","form-control","aria-label","","aria-describedby","",3,"ngModel","placeholder","keyup.enter","ngModelChange",4,"ngIf"],["ngbDropdown","","role","group","aria-label","",3,"ngClass"],["ngbDropdownToggle","",1,"btn","btn-outline-secondary","w-fx",3,"title"],["ngbDropdownMenu","","aria-haspopup","true","aria-expanded","false","aria-labelledby","scrollableDropdownMenuButton",1,"dropdown-menu","scrollable-dropdown-menu","w-100"],["aria-labelledby","scrollableDropdownMenuButton","infiniteScroll","",1,"scrollable-menu",3,"infiniteScrollDistance","infiniteScrollThrottle","scrollWindow","scrolled"],["ngbDropdownItem","","class","dropdown-item text-truncate",3,"title","click",4,"ngFor","ngForOf"],["ngbDropdownItem","","class","scrollable-dropdown-loading text-center",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"title","disabled","click"],[1,"input-group","mb-2"],["type","text","aria-label","","aria-describedby","",1,"form-control",3,"ngModel","placeholder","keyup.enter","ngModelChange"],["ngbDropdownItem","",1,"dropdown-item","text-truncate",3,"title","click"],["ngbDropdownItem","",1,"scrollable-dropdown-loading","text-center"]],template:function(e,t){1&e&&(i["\u0275\u0275template"](0,I,5,4,"div",0),i["\u0275\u0275pipe"](1,"async"),i["\u0275\u0275text"](2,"\n"),i["\u0275\u0275elementStart"](3,"div",1),i["\u0275\u0275text"](4,"\n  "),i["\u0275\u0275template"](5,O,2,4,"input",2),i["\u0275\u0275pipe"](6,"async"),i["\u0275\u0275text"](7,"\n  "),i["\u0275\u0275elementStart"](8,"div",3),i["\u0275\u0275pipe"](9,"async"),i["\u0275\u0275text"](10,"\n    "),i["\u0275\u0275elementStart"](11,"button",4),i["\u0275\u0275pipe"](12,"translate"),i["\u0275\u0275text"](13),i["\u0275\u0275pipe"](14,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](15,"\n    "),i["\u0275\u0275elementStart"](16,"div",5),i["\u0275\u0275text"](17,"\n      "),i["\u0275\u0275elementStart"](18,"div",6),i["\u0275\u0275listener"]("scrolled",(function(){return t.onScroll()})),i["\u0275\u0275text"](19,"\n        "),i["\u0275\u0275template"](20,j,4,6,"button",7),i["\u0275\u0275text"](21,"\n        "),i["\u0275\u0275template"](22,C,4,3,"div",8),i["\u0275\u0275text"](23,"\n      "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](24,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](25,"\n    "),i["\u0275\u0275elementStart"](26,"button",9),i["\u0275\u0275listener"]("click",(function(){return t.search()})),i["\u0275\u0275pipe"](27,"translate"),i["\u0275\u0275pipe"](28,"translate"),i["\u0275\u0275text"](29),i["\u0275\u0275pipe"](30,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](31,"\n  "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](32,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](33,"\n")),2&e&&(i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](1,13,t.isXsOrSm$)),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](6,15,t.isXsOrSm$)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngClass",i["\u0275\u0275pureFunction1"](29,E,!i["\u0275\u0275pipeBind1"](9,17,t.isXsOrSm$))),i["\u0275\u0275advance"](3),i["\u0275\u0275propertyInterpolate"]("title",i["\u0275\u0275pipeBind1"](12,19,"submission.import-external.search.source.hint")),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](14,21,"submission.import-external.source."+(null==t.selectedElement?null:t.selectedElement.name))),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("infiniteScrollDistance",2)("infiniteScrollThrottle",50)("scrollWindow",!1),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngForOf",t.sourceList),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",t.sourceListLoading),i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("title",""===t.searchString?i["\u0275\u0275pipeBind1"](27,23,"submission.import-external.search.button.hint"):i["\u0275\u0275pipeBind1"](28,25,"submission.import-external.search.button"))("disabled",""===t.searchString),i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](30,27,"submission.import-external.search.button")))},directives:[h.u,g.n,h.r,g.r,g.q,x.a,h.t,S.DefaultValueAccessor,S.NgControlStatus,S.NgModel,g.p],pipes:[h.b,y.e],styles:[".input-group-append[_ngcontent-%COMP%]:last-child > .btn[_ngcontent-%COMP%]:not(:last-child):not(.dropdown-toggle){margin-left:-1px;border-radius:0 .25rem .25rem 0}.input-group-append[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]{border-radius:0}.w-fx[_ngcontent-%COMP%]{min-width:200px}.scrollable-menu[_ngcontent-%COMP%]{height:auto;max-height:calc(var(--ds-dropdown-menu-max-height) / 2);overflow-x:hidden}.scrollable-dropdown-loading[_ngcontent-%COMP%]{background-color:var(--bs-primary);color:#fff;height:calc(var(--bs-spacer) * 2)!important;line-height:calc(var(--bs-spacer) * 2);position:-webkit-sticky;position:sticky;bottom:0}"]}),e}()},"4GeW":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.Relationships="relationships",e.SubmissionForm="submission-form",e.Upload="upload",e.License="license",e.CcLicense="cclicense",e.collection="collection",e}({})},"6c/T":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("8Y7J"),o=n("G0yt"),s=n("Oqsf"),c=n("TSSN"),l=function(){var e=function(){function e(t){a(this,e),this.activeModal=t,this.selectedEvent=new i.EventEmitter}return r(e,[{key:"selectObject",value:function(e){this.selectedEvent.emit(e)}},{key:"closeCollectionModal",value:function(){this.activeModal.dismiss(!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](o.b))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-import-external-collection"]],outputs:{selectedEvent:"selectedEvent"},decls:19,vars:3,consts:[[1,"modal-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"selectionChange"]],template:function(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275text"](1,"\n  "),i["\u0275\u0275elementStart"](2,"div",0),i["\u0275\u0275text"](3),i["\u0275\u0275pipe"](4,"translate"),i["\u0275\u0275elementStart"](5,"button",1),i["\u0275\u0275listener"]("click",(function(){return t.closeCollectionModal()})),i["\u0275\u0275text"](6,"\n      "),i["\u0275\u0275elementStart"](7,"span",2),i["\u0275\u0275text"](8,"\xd7"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](9,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](10,"\n  "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](11,"\n  "),i["\u0275\u0275elementStart"](12,"div",3),i["\u0275\u0275text"](13,"\n    "),i["\u0275\u0275elementStart"](14,"ds-collection-dropdown",4),i["\u0275\u0275listener"]("selectionChange",(function(e){return t.selectObject(e)})),i["\u0275\u0275text"](15,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](16,"\n  "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](17,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](18,"\n")),2&e&&(i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate1"]("",i["\u0275\u0275pipeBind1"](4,1,"dso-selector.create.collection.head"),"\n    "))},directives:[s.a],pipes:[c.e],styles:[".close[_ngcontent-%COMP%]:focus{outline:none!important}"]}),e}()},"Ahb/":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("JTKQ"),o=n("8Y7J");function s(e,t){}var l=function(){var e=function(e){c(i,e);var t=u(i);function i(){return a(this,i),t.apply(this,arguments)}return r(i,[{key:"getComponentName",value:function(){return"SubmissionSubmitComponent"}},{key:"importThemedComponent",value:function(e){return n("TkMu")("./".concat(e,"/app/submission/submit/submission-submit.component"))}},{key:"importUnthemedComponent",value:function(){return Promise.resolve().then(n.bind(null,"THnG"))}}]),i}(i.a);return e.\u0275fac=function(t){return d(t||e)},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-themed-submission-submit"]],features:[o["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:0,consts:[["vcr",""]],template:function(e,t){1&e&&(o["\u0275\u0275template"](0,s,0,0,"ng-template",null,0,o["\u0275\u0275templateRefExtractor"]),o["\u0275\u0275text"](2,"\n"))},encapsulation:2}),e}(),d=o["\u0275\u0275getInheritedFactory"](l)},JHLN:function(e,t,n){var i={"./custom/app/submission/import-external/submission-import-external.component":["mVFA",75]};function o(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],o=t[0];return n.e(t[1]).then((function(){return n(o)}))}o.keys=function(){return Object.keys(i)},o.id="JHLN",e.exports=o},RMpN:function(e,t,i){"use strict";i.r(t),i.d(t,"SubmissionImportExternalComponent",(function(){return J}));var o=i("2Vo4"),s=i("itXk"),c=i("IzEk"),l=i("pLZG"),u=i("eIep"),d=i("vkgz"),p=i("5+tZ"),m=i("f+Ev"),f=i("ynxc"),b=i("7DXY"),v=i("GG8d"),h=i("20cJ"),g=i("mEo1"),x=i("oBfO"),S=i("J3qs"),y=i("1QIV"),I=i("8Y7J"),O=i("joI/"),j=i("dHui"),C=i("ppE2"),E=i("iInd"),D=i("G0yt"),w=i("3cpT"),k=i("SVse"),F=i("O/5o"),M=i("jLV+"),L=i("Frqi"),B=i("VYMa"),V=i("TSSN");function T(e,t){if(1&e&&(I["\u0275\u0275elementStart"](0,"h3"),I["\u0275\u0275text"](1),I["\u0275\u0275pipe"](2,"translate"),I["\u0275\u0275elementEnd"]()),2&e){var n=I["\u0275\u0275nextContext"](3);I["\u0275\u0275advance"](1),I["\u0275\u0275textInterpolate"](I["\u0275\u0275pipeBind1"](2,1,"submission.sections.describe.relationship-lookup.selection-tab.title."+n.routeData.sourceId))}}var R=function(e,t){return{repeatable:e,listId:t}};function P(e,t){if(1&e){var n=I["\u0275\u0275getCurrentView"]();I["\u0275\u0275elementStart"](0,"ds-viewable-collection",13),I["\u0275\u0275listener"]("importObject",(function(e){return I["\u0275\u0275restoreView"](n),I["\u0275\u0275nextContext"](3).import(e)})),I["\u0275\u0275text"](1,"\n        "),I["\u0275\u0275elementEnd"]()}if(2&e){var i=I["\u0275\u0275nextContext"]().ngVar,o=I["\u0275\u0275nextContext"](2);I["\u0275\u0275property"]("@fadeIn",void 0)("objects",i)("selectionConfig",I["\u0275\u0275pureFunction2"](8,R,o.repeatable,o.listId))("config",o.initialPagination)("hideGear",!0)("context",o.context)("importable",!0)("importConfig",o.importConfig)}}function $(e,t){1&e&&(I["\u0275\u0275element"](0,"ds-loading",14),I["\u0275\u0275pipe"](1,"translate")),2&e&&I["\u0275\u0275propertyInterpolate"]("message",I["\u0275\u0275pipeBind1"](1,1,"loading.search-results"))}function A(e,t){1&e&&(I["\u0275\u0275elementStart"](0,"div",15),I["\u0275\u0275text"](1),I["\u0275\u0275pipe"](2,"translate"),I["\u0275\u0275elementEnd"]()),2&e&&(I["\u0275\u0275advance"](1),I["\u0275\u0275textInterpolate1"]("\n          ",I["\u0275\u0275pipeBind1"](2,1,"search.results.empty"),"\n        "))}function _(e,t){if(1&e&&(I["\u0275\u0275elementContainerStart"](0),I["\u0275\u0275text"](1,"\n        "),I["\u0275\u0275template"](2,T,3,3,"h3",9),I["\u0275\u0275text"](3,"\n        "),I["\u0275\u0275template"](4,P,2,11,"ds-viewable-collection",10),I["\u0275\u0275pipe"](5,"async"),I["\u0275\u0275text"](6,"\n        "),I["\u0275\u0275template"](7,$,2,3,"ds-loading",11),I["\u0275\u0275pipe"](8,"async"),I["\u0275\u0275text"](9,"\n        "),I["\u0275\u0275template"](10,A,3,3,"div",12),I["\u0275\u0275pipe"](11,"async"),I["\u0275\u0275text"](12,"\n      "),I["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar,i=I["\u0275\u0275nextContext"](2);I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("ngIf",n&&0!==(null==n||null==n.payload||null==n.payload.page?null:n.payload.page.length)),I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("ngIf",(null==n?null:n.hasSucceeded)&&!I["\u0275\u0275pipeBind1"](5,4,i.isLoading$)&&(null==n||null==n.payload||null==n.payload.page?null:n.payload.page.length)>0),I["\u0275\u0275advance"](3),I["\u0275\u0275property"]("ngIf",I["\u0275\u0275pipeBind1"](8,6,i.isLoading$)),I["\u0275\u0275advance"](3),I["\u0275\u0275property"]("ngIf",!I["\u0275\u0275pipeBind1"](11,8,i.isLoading$)&&0===(null==n||null==n.payload||null==n.payload.page?null:n.payload.page.length))}}function N(e,t){if(1&e&&(I["\u0275\u0275elementStart"](0,"div",2),I["\u0275\u0275text"](1,"\n      "),I["\u0275\u0275template"](2,_,13,10,"ng-container",8),I["\u0275\u0275pipe"](3,"async"),I["\u0275\u0275text"](4,"\n    "),I["\u0275\u0275elementEnd"]()),2&e){var n=I["\u0275\u0275nextContext"]();I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("ngVar",I["\u0275\u0275pipeBind1"](3,1,n.entriesRD$))}}function q(e,t){1&e&&(I["\u0275\u0275elementStart"](0,"div",2),I["\u0275\u0275text"](1,"\n      "),I["\u0275\u0275elementStart"](2,"ds-alert",16),I["\u0275\u0275text"](3,"\n        "),I["\u0275\u0275elementStart"](4,"p",17),I["\u0275\u0275text"](5),I["\u0275\u0275pipe"](6,"translate"),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](7,"\n      "),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](8,"\n    "),I["\u0275\u0275elementEnd"]()),2&e&&(I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("type","alert-info"),I["\u0275\u0275advance"](3),I["\u0275\u0275textInterpolate"](I["\u0275\u0275pipeBind1"](6,2,"submission.import-external.page.hint")))}var U=function(){return["/mydspace"]},J=function(){var e=function(){function e(t,n,i,s,r){a(this,e),this.searchConfigService=t,this.externalService=n,this.routeService=i,this.router=s,this.modalService=r,this.entriesRD$=new o.a(null),this.isLoading$=new o.a(!1),this.reload$=new o.a({query:"",source:""}),this.initialPagination=Object.assign(new b.a,{id:"spc",pageSize:10}),this.subs=[]}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.label="Journal",this.listId="list-submission-external-sources",this.context=f.a.EntitySearchModalWithNameVariants,this.repeatable=!1,this.routeData={sourceId:"",query:""},this.importConfig={buttonLabel:"submission.sections.describe.relationship-lookup.external-source.import-button-title."+this.label},this.entriesRD$=new o.a(Object(v.c)(Object(m.b)(new x.a,[]))),this.isLoading$=new o.a(!1),this.subs.push(Object(s.a)([this.routeService.getQueryParameterValue("source"),this.routeService.getQueryParameterValue("query")]).pipe(Object(c.a)(1)).subscribe((function(t){var i=n(t,2),o=i[0],a=i[1];e.reload$.next({query:a,source:o}),e.retrieveExternalSources()})))}},{key:"getExternalSourceData",value:function(e){var t=this;this.router.navigate([],{queryParams:{source:e.sourceId,query:e.query},replaceUrl:!0}).then((function(){t.reload$.next({source:e.sourceId,query:e.query}),t.retrieveExternalSources()}))}},{key:"import",value:function(e){this.modalRef=this.modalService.open(h.a,{size:"lg"}),this.modalRef.componentInstance.externalSourceEntry=e}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(S.b)(e)})).forEach((function(e){return e.unsubscribe()})),Object(S.b)(this.retrieveExternalSourcesSub)&&this.retrieveExternalSourcesSub.unsubscribe()}},{key:"retrieveExternalSources",value:function(){var e=this;Object(S.b)(this.retrieveExternalSourcesSub)&&this.retrieveExternalSourcesSub.unsubscribe(),this.retrieveExternalSourcesSub=this.reload$.pipe(Object(l.a)((function(e){return Object(S.e)(e.source)&&Object(S.e)(e.query)})),Object(u.a)((function(t){var n=t.query;return e.routeData.sourceId=t.source,e.routeData.query=n,e.searchConfigService.paginatedSearchOptions.pipe(Object(d.a)((function(t){return e.isLoading$.next(!0)})),Object(l.a)((function(e){return e.query===n})),Object(p.a)((function(t){return e.externalService.getExternalSourceEntries(e.routeData.sourceId,t).pipe(Object(y.f)())})))}))).subscribe((function(t){e.entriesRD$.next(t),e.isLoading$.next(!1)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(I["\u0275\u0275directiveInject"](O.a),I["\u0275\u0275directiveInject"](j.a),I["\u0275\u0275directiveInject"](C.a),I["\u0275\u0275directiveInject"](E.g),I["\u0275\u0275directiveInject"](D.u))},e.\u0275cmp=I["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-import-external"]],decls:37,vars:11,consts:[[1,"container"],[1,"row"],[1,"col-md-12"],["id","header",1,"pb-2"],[3,"initExternalSourceData","externalSourceData"],["class","col-md-12",4,"ngIf"],["role","button",1,"btn","btn-outline-secondary",3,"routerLink"],["aria-hidden","true",1,"fa","fa-chevron-left"],[4,"ngVar"],[4,"ngIf"],[3,"objects","selectionConfig","config","hideGear","context","importable","importConfig","importObject",4,"ngIf"],[3,"message",4,"ngIf"],["id","empty-external-entry-list",4,"ngIf"],[3,"objects","selectionConfig","config","hideGear","context","importable","importConfig","importObject"],[3,"message"],["id","empty-external-entry-list"],[3,"type"],[1,"lead","mb-0"]],template:function(e,t){1&e&&(I["\u0275\u0275elementStart"](0,"div",0),I["\u0275\u0275text"](1,"\n  "),I["\u0275\u0275elementStart"](2,"div",1),I["\u0275\u0275text"](3,"\n    "),I["\u0275\u0275elementStart"](4,"div",2),I["\u0275\u0275text"](5,"\n      "),I["\u0275\u0275elementStart"](6,"h2",3),I["\u0275\u0275text"](7),I["\u0275\u0275pipe"](8,"translate"),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](9,"\n      "),I["\u0275\u0275elementStart"](10,"ds-submission-import-external-searchbar",4),I["\u0275\u0275listener"]("externalSourceData",(function(e){return t.getExternalSourceData(e)})),I["\u0275\u0275text"](11,"\n      "),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](12,"\n    "),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](13,"\n  "),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](14,"\n  "),I["\u0275\u0275elementStart"](15,"div",1),I["\u0275\u0275text"](16,"\n    "),I["\u0275\u0275template"](17,N,5,3,"div",5),I["\u0275\u0275text"](18,"\n    "),I["\u0275\u0275template"](19,q,9,4,"div",5),I["\u0275\u0275text"](20,"\n  "),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](21,"\n  "),I["\u0275\u0275elementStart"](22,"div",1),I["\u0275\u0275text"](23,"\n    "),I["\u0275\u0275elementStart"](24,"div",2),I["\u0275\u0275text"](25,"\n      "),I["\u0275\u0275element"](26,"hr"),I["\u0275\u0275text"](27,"\n      "),I["\u0275\u0275elementStart"](28,"a",6),I["\u0275\u0275text"](29,"\n        "),I["\u0275\u0275element"](30,"i",7),I["\u0275\u0275text"](31),I["\u0275\u0275pipe"](32,"translate"),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](33,"\n    "),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](34,"\n  "),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](35,"\n"),I["\u0275\u0275elementEnd"](),I["\u0275\u0275text"](36,"\n")),2&e&&(I["\u0275\u0275advance"](7),I["\u0275\u0275textInterpolate"](I["\u0275\u0275pipeBind1"](8,6,"submission.import-external.title")),I["\u0275\u0275advance"](3),I["\u0275\u0275property"]("initExternalSourceData",t.routeData),I["\u0275\u0275advance"](7),I["\u0275\u0275property"]("ngIf",""!==t.routeData.sourceId),I["\u0275\u0275advance"](2),I["\u0275\u0275property"]("ngIf",""===t.routeData.sourceId),I["\u0275\u0275advance"](9),I["\u0275\u0275property"]("routerLink",I["\u0275\u0275pureFunction0"](10,U)),I["\u0275\u0275advance"](3),I["\u0275\u0275textInterpolate1"](" ",I["\u0275\u0275pipeBind1"](32,8,"submission.import-external.back-to-my-dspace"),"\n      "))},directives:[w.a,k.u,E.j,F.a,M.a,L.a,B.a],pipes:[V.e,k.b],styles:[""],data:{animation:[g.a]}}),e}()},SCNa:function(e,t,n){"use strict";n.r(t),n.d(t,"SubmissionEditComponent",(function(){return g}));var i=n("eIep"),o=n("pLZG"),s=n("Kj3r"),c=n("J3qs"),l=n("1QIV"),u=n("7RJT"),d=n("8Y7J"),p=n("lI3o"),m=n("iInd"),f=n("iqTE"),b=n("J/vq"),v=n("TSSN"),h=n("m4Gq"),g=function(){var e=function(){function e(t,n,i,o,s,r,c){a(this,e),this.changeDetectorRef=t,this.notificationsService=n,this.route=i,this.router=o,this.itemDataService=s,this.submissionService=r,this.translate=c,this.subs=[],this.itemLink$=new u.BehaviorSubject(void 0)}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.subs.push(this.route.paramMap.pipe(Object(i.a)((function(t){return e.submissionService.retrieveSubmission(t.get("id"))})),Object(o.a)((function(e){return Object(c.g)(e)}))).subscribe((function(t){t.hasSucceeded?Object(c.d)(t.payload)?(e.notificationsService.info(null,e.translate.get("submission.general.cannot_submit")),e.router.navigate(["/mydspace"])):(e.submissionId=t.payload.id.toString(),e.collectionId=t.payload.collection.id,e.selfUrl=t.payload._links.self.href,e.sections=t.payload.sections,e.itemLink$.next(t.payload._links.item.href),e.item=t.payload.item,e.submissionDefinition=t.payload.submissionDefinition):404===t.statusCode&&e.router.navigate(["/404"],{skipLocationChange:!0})})),this.itemLink$.pipe(Object(c.f)(),Object(i.a)((function(t){return e.itemDataService.findByHref(t)})),Object(l.c)(),Object(s.a)(300)).subscribe((function(t){e.item=t.payload,e.changeDetectorRef.detectChanges()})))}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(c.b)(e)})).forEach((function(e){return e.unsubscribe()}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d["\u0275\u0275directiveInject"](d.ChangeDetectorRef),d["\u0275\u0275directiveInject"](p.a),d["\u0275\u0275directiveInject"](m.a),d["\u0275\u0275directiveInject"](m.g),d["\u0275\u0275directiveInject"](f.a),d["\u0275\u0275directiveInject"](b.a),d["\u0275\u0275directiveInject"](v.f))},e.\u0275cmp=d["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-edit"]],decls:5,vars:6,consts:[[1,"submission-submit-container"],[3,"collectionId","sections","selfUrl","submissionDefinition","item","submissionId"]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275text"](1,"\n  "),d["\u0275\u0275element"](2,"ds-submission-form",1),d["\u0275\u0275text"](3,"\n"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275text"](4,"\n")),2&e&&(d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("collectionId",t.collectionId)("sections",t.sections)("selfUrl",t.selfUrl)("submissionDefinition",t.submissionDefinition)("item",t.item)("submissionId",t.submissionId))},directives:[h.a],styles:[""]}),e}()},"T/iP":function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var i=n("LRne"),o=n("SxV6"),s=n("J3qs"),c=n("oOMw"),l=n("fBXw"),u=n("8Y7J"),d=n("lI3o"),p=n("QjZv"),m=n("YJD6"),f=n("J/vq"),b=n("TSSN"),v=n("SVse"),h=n("4zj/");function g(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"ds-uploader",1),u["\u0275\u0275listener"]("onCompleteItem",(function(e){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().onCompleteItem(e)}))("onUploadError",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().onUploadError()})),u["\u0275\u0275elementEnd"]()}if(2&e){var i=u["\u0275\u0275nextContext"]();u["\u0275\u0275property"]("dropMsg",i.dropMsg)("dropOverDocumentMsg",i.dropOverDocumentMsg)("enableDragOverDocument",i.enableDragOverDocument)("onBeforeUpload",i.onBeforeUpload)("uploadFilesOptions",i.uploadFilesOptions)}}var x=function(){var e=function(){function e(t,n,o,s,r){var c=this;a(this,e),this.notificationsService=t,this.operationsService=n,this.sectionService=o,this.submissionService=s,this.translate=r,this.enableDragOverDocument=!0,this.dropOverDocumentMsg="submission.sections.upload.drop-message",this.dropMsg="submission.sections.upload.drop-message",this.subs=[],this.uploadEnabled=Object(i.a)(!1),this.onBeforeUpload=function(){var e=c.operationsService.jsonPatchByResourceType(c.submissionService.getSubmissionObjectLinkName(),c.submissionId,"sections").subscribe();return c.subs.push(e),e}}return r(e,[{key:"ngOnChanges",value:function(){this.uploadEnabled=this.sectionService.isSectionAvailable(this.submissionId,this.sectionId)}},{key:"onCompleteItem",value:function(e){var t=this;this.subs.push(this.uploadEnabled.pipe(Object(o.a)()).subscribe((function(n){if(n){var i=e.sections,o=e.errors,a=Object(l.a)(o);i&&Object(s.e)(i)&&Object.keys(i).forEach((function(e){var n=Object(c.b)(i[e]),o=a[e];"upload"===e&&(Object(s.d)(o)?t.notificationsService.success(null,t.translate.get("submission.sections.upload.upload-successful")):t.notificationsService.error(null,t.translate.get("submission.sections.upload.upload-failed"))),t.sectionService.updateSectionData(t.submissionId,e,n,o)}))}})))}},{key:"onUploadError",value:function(){this.notificationsService.error(null,this.translate.get("submission.sections.upload.upload-failed"))}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(s.b)(e)})).forEach((function(e){return e.unsubscribe()}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](d.a),u["\u0275\u0275directiveInject"](p.a),u["\u0275\u0275directiveInject"](m.a),u["\u0275\u0275directiveInject"](f.a),u["\u0275\u0275directiveInject"](b.f))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-upload-files"]],inputs:{collectionId:"collectionId",submissionId:"submissionId",sectionId:"sectionId",uploadFilesOptions:"uploadFilesOptions"},features:[u["\u0275\u0275NgOnChangesFeature"]],decls:2,vars:1,consts:[[3,"dropMsg","dropOverDocumentMsg","enableDragOverDocument","onBeforeUpload","uploadFilesOptions","onCompleteItem","onUploadError",4,"ngIf"],[3,"dropMsg","dropOverDocumentMsg","enableDragOverDocument","onBeforeUpload","uploadFilesOptions","onCompleteItem","onUploadError"]],template:function(e,t){1&e&&(u["\u0275\u0275template"](0,g,1,5,"ds-uploader",0),u["\u0275\u0275text"](1,"\n")),2&e&&u["\u0275\u0275property"]("ngIf",t.uploadFilesOptions.url)},directives:[v.u,h.a],encapsulation:2}),e}()},THnG:function(e,t,n){"use strict";n.r(t),n.d(t,"SubmissionSubmitComponent",(function(){return h}));var i=n("J3qs"),o=n("7RJT"),s=n("eIep"),c=n("Kj3r"),l=n("1QIV"),u=n("8Y7J"),d=n("lI3o"),p=n("iInd"),m=n("iqTE"),f=n("J/vq"),b=n("TSSN"),v=n("m4Gq"),h=function(){var e=function(){function e(t,n,i,s,r,c,l,u){var d=this;a(this,e),this.changeDetectorRef=t,this.notificationsService=n,this.router=i,this.itemDataService=s,this.submissionService=r,this.translate=c,this.viewContainerRef=l,this.route=u,this.itemLink$=new o.BehaviorSubject(void 0),this.subs=[],this.route.queryParams.subscribe((function(e){d.collectionParam=e.collection}))}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.subs.push(this.submissionService.createSubmission(this.collectionParam).subscribe((function(t){Object(i.g)(t)&&(Object(i.d)(t)?(e.notificationsService.info(null,e.translate.get("submission.general.cannot_submit")),e.router.navigate(["/mydspace"])):(e.collectionId=t.collection.id,e.sections=t.sections,e.selfUrl=t._links.self.href,e.submissionDefinition=t.submissionDefinition,e.submissionId=t.id,e.itemLink$.next(t._links.item.href),e.item=t.item))})),this.itemLink$.pipe(Object(i.f)(),Object(s.a)((function(t){return e.itemDataService.findByHref(t)})),Object(l.c)(),Object(c.a)(300)).subscribe((function(t){e.item=t.payload,e.changeDetectorRef.detectChanges()})))}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(i.b)(e)})).forEach((function(e){return e.unsubscribe()})),this.viewContainerRef.clear(),this.changeDetectorRef.markForCheck()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](u.ChangeDetectorRef),u["\u0275\u0275directiveInject"](d.a),u["\u0275\u0275directiveInject"](p.g),u["\u0275\u0275directiveInject"](m.a),u["\u0275\u0275directiveInject"](f.a),u["\u0275\u0275directiveInject"](b.f),u["\u0275\u0275directiveInject"](u.ViewContainerRef),u["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-submit"]],decls:8,vars:6,consts:[[1,"submission-submit-container"],[3,"collectionId","sections","selfUrl","submissionDefinition","item","submissionId"]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275text"](1,"\n  "),u["\u0275\u0275elementStart"](2,"div",0),u["\u0275\u0275text"](3,"\n    "),u["\u0275\u0275element"](4,"ds-submission-form",1),u["\u0275\u0275text"](5,"\n  "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](6,"\n"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275text"](7,"\n")),2&e&&(u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("collectionId",t.collectionId)("sections",t.sections)("selfUrl",t.selfUrl)("submissionDefinition",t.submissionDefinition)("item",t.item)("submissionId",t.submissionId))},directives:[v.a],styles:[""]}),e}()},TTdl:function(e,t,n){"use strict";var i=n("J3qs"),o=/([^\/]+)/g,a=/\/sections\/(.*)/;t.a=function(e){return("string"==typeof e?[e]:e).map((function(e){return e.match(o)&&e.match(o).length>2?{sectionId:e.match(o)[1],fieldId:e.match(o)[2],fieldIndex:Object(i.b)(e.match(o)[3])?+e.match(o)[3]:0,originalPath:e}:{sectionId:e.match(a)[1],originalPath:e}}))}},TkMu:function(e,t,n){var i={"./custom/app/submission/submit/submission-submit.component":["cSSl",76]};function o(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],o=t[0];return n.e(t[1]).then((function(){return n(o)}))}o.keys=function(){return Object.keys(i)},o.id="TkMu",e.exports=o},"Uql/":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var i=new Map;function o(e){return function(t){t&&i.set(e,t)}}function a(e){return i.get(e)}},YJD6:function(e,t,i){"use strict";i.d(t,"a",(function(){return D}));var o=i("itXk"),s=i("lJxs"),c=i("/uUt"),l=i("pLZG"),u=i("IzEk"),d=i("LvDl"),p=i("J3qs"),m=i("4jMI"),f=i("LP5c"),b=i("drGc"),v=i("TTdl"),h=i("xvwT"),g=i("4GeW"),x=i("oOMw"),S=i("QOHy"),y=i("8Y7J"),I=i("lI3o"),O=i("nluj"),j=i("J/vq"),C=i("tqRt"),E=i("TSSN"),D=function(){var e=function(){function e(t,n,i,o,s){a(this,e),this.notificationsService=t,this.scrollToService=n,this.submissionService=i,this.store=o,this.translate=s}return r(e,[{key:"checkSectionErrors",value:function(e,t,n,i){var o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(Object(p.d)(i))this.store.dispatch(new m.r(e,t)),this.store.dispatch(new h.e(n));else if(!Object(d.isEqual)(i,a)){var s=[];i.forEach((function(e){Object(v.a)(e.path).forEach((function(t){if(t.fieldId){var i=t.fieldId.replace(/\./g,"_"),a=new h.b(n,i,t.fieldIndex,e.message);o.store.dispatch(a),s.push(i)}}))})),a.forEach((function(e){Object(v.a)(e.path).forEach((function(e){if(e.fieldId){var t=e.fieldId.replace(/\./g,"_");if(!s.includes(t)){var i=new h.h(n,t,e.fieldIndex);o.store.dispatch(i)}}}))}))}}},{key:"dispatchRemoveSectionErrors",value:function(e,t){this.store.dispatch(new m.r(e,t))}},{key:"dispatchSetSectionFormId",value:function(e,t,n){this.store.dispatch(new m.E(e,t,n))}},{key:"getSectionData",value:function(e,t,n){return this.store.select(Object(f.d)(e,t)).pipe(Object(s.a)((function(e){return n===g.a.SubmissionForm?Object(x.b)(e):e})),Object(c.a)())}},{key:"getSectionErrors",value:function(e,t){return this.store.select(Object(f.e)(e,t)).pipe(Object(c.a)())}},{key:"getSectionState",value:function(e,t,n){return this.store.select(Object(f.f)(e,t)).pipe(Object(l.a)((function(e){return Object(p.b)(e)})),Object(s.a)((function(e){return e})),Object(s.a)((function(e){return Object(p.b)(e.data)&&n===g.a.SubmissionForm?Object.assign({},e,{data:Object(x.b)(e.data)}):e})),Object(c.a)())}},{key:"isSectionValid",value:function(e,t){return this.store.select(Object(f.f)(e,t)).pipe(Object(l.a)((function(e){return Object(p.b)(e)})),Object(s.a)((function(e){return e.isValid})),Object(c.a)())}},{key:"isSectionActive",value:function(e,t){return this.submissionService.getActiveSectionId(e).pipe(Object(s.a)((function(e){return t===e})),Object(c.a)())}},{key:"isSectionEnabled",value:function(e,t){return this.store.select(Object(f.f)(e,t)).pipe(Object(l.a)((function(e){return Object(p.b)(e)})),Object(s.a)((function(e){return e.enabled})),Object(c.a)())}},{key:"isSectionReadOnly",value:function(e,t,n){return this.store.select(Object(f.f)(e,t)).pipe(Object(l.a)((function(e){return Object(p.b)(e)})),Object(s.a)((function(e){return Object(p.e)(e.visibility)&&"READONLY"===e.visibility.other&&n!==b.a.WorkspaceItem})),Object(c.a)())}},{key:"isSectionAvailable",value:function(e,t){return this.store.select(Object(f.c)(e)).pipe(Object(l.a)((function(e){return Object(p.h)(e)})),Object(s.a)((function(e){return Object(p.h)(e.sections)&&Object(p.h)(e.sections[t])})),Object(c.a)())}},{key:"isSectionTypeAvailable",value:function(e,t){return this.store.select(Object(f.c)(e)).pipe(Object(l.a)((function(e){return Object(p.h)(e)})),Object(s.a)((function(e){return Object(p.h)(e.sections)&&Object(p.h)(Object(d.findKey)(e.sections,{sectionType:t}))})),Object(c.a)())}},{key:"addSection",value:function(e,t){this.store.dispatch(new m.m(e,t)),this.scrollToService.scrollTo({target:t,offset:-70})}},{key:"removeSection",value:function(e,t){this.store.dispatch(new m.h(e,t))}},{key:"updateSectionData",value:function(e,t,i){var a=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4?arguments[4]:void 0;if(Object(p.e)(i)){var c=this.isSectionAvailable(e,t),d=this.isSectionEnabled(e,t);Object(o.a)(c,d).pipe(Object(u.a)(1),Object(l.a)((function(e){var t=n(e,2),i=t[0];t[1];return i}))).subscribe((function(o){var c=n(o,2);c[0],c[1];a.store.dispatch(new m.G(e,t,i,s,r))}))}}},{key:"setSectionError",value:function(e,t,n){this.store.dispatch(new m.n(e,t,n))}},{key:"setSectionStatus",value:function(e,t,n){this.store.dispatch(new m.C(e,t,n))}},{key:"computeSectionConfiguredMetadata",value:function(e){var t=[],n="string"==typeof e?JSON.parse(e,S.S):e;return n.rows&&!Object(p.d)(n.rows)&&n.rows.forEach((function(e){e.fields&&!Object(p.d)(e.fields)&&e.fields.forEach((function(e){e.selectableMetadata&&!Object(p.d)(e.selectableMetadata)&&e.selectableMetadata.forEach((function(e){t.includes(e.metadata)||t.push(e.metadata)}))}))})),t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(y["\u0275\u0275inject"](I.a),y["\u0275\u0275inject"](O.b),y["\u0275\u0275inject"](j.a),y["\u0275\u0275inject"](C.h),y["\u0275\u0275inject"](E.f))},e.\u0275prov=y["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}()},Yfyx:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var i=n("8Y7J"),o=n("Uql/"),s=n("ac5F"),c=n("b8BE"),l=n("SVse"),u=n("G0yt"),d=n("VYMa"),p=n("TSSN"),m=["sectionRef"];function f(e,t){1&e&&i["\u0275\u0275element"](0,"i",17)}function b(e,t){1&e&&i["\u0275\u0275element"](0,"i",18)}function v(e,t){1&e&&i["\u0275\u0275element"](0,"i",19)}function h(e,t){1&e&&i["\u0275\u0275element"](0,"span",20)}function g(e,t){1&e&&i["\u0275\u0275element"](0,"span",21)}function x(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"a",22),i["\u0275\u0275listener"]("click",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](3).removeSection(e)})),i["\u0275\u0275text"](1,"\n            "),i["\u0275\u0275element"](2,"i",23),i["\u0275\u0275text"](3,"\n          "),i["\u0275\u0275elementEnd"]()}}function S(e,t){if(1&e&&(i["\u0275\u0275text"](0,"\n        "),i["\u0275\u0275elementStart"](1,"span",8),i["\u0275\u0275text"](2),i["\u0275\u0275pipe"](3,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](4,"\n        "),i["\u0275\u0275elementStart"](5,"div",9),i["\u0275\u0275text"](6,"\n          "),i["\u0275\u0275template"](7,f,1,0,"i",10),i["\u0275\u0275pipe"](8,"async"),i["\u0275\u0275text"](9,"\n          "),i["\u0275\u0275template"](10,b,1,0,"i",11),i["\u0275\u0275text"](11,"\n          "),i["\u0275\u0275template"](12,v,1,0,"i",12),i["\u0275\u0275pipe"](13,"async"),i["\u0275\u0275text"](14,"\n          "),i["\u0275\u0275elementStart"](15,"a",13),i["\u0275\u0275text"](16,"\n            "),i["\u0275\u0275template"](17,h,1,0,"span",14),i["\u0275\u0275text"](18,"\n            "),i["\u0275\u0275template"](19,g,1,0,"span",15),i["\u0275\u0275text"](20,"\n          "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](21,"\n          "),i["\u0275\u0275template"](22,x,4,0,"a",16),i["\u0275\u0275text"](23,"\n        "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](24,"\n      ")),2&e){var n=i["\u0275\u0275nextContext"](2),o=i["\u0275\u0275reference"](1);i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](3,7,"submission.sections."+n.sectionData.header)),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](8,9,o.isValid())&&!o.hasErrors()),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",o.hasErrors()),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](13,11,o.isValid())&&!o.hasErrors()),i["\u0275\u0275advance"](5),i["\u0275\u0275property"]("ngIf",o.isOpen()),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",!o.isOpen()),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",!o.isMandatory())}}function y(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"ds-alert",28),i["\u0275\u0275listener"]("close",(function(){i["\u0275\u0275restoreView"](n);var e=t.index;return i["\u0275\u0275nextContext"](4),i["\u0275\u0275reference"](1).removeError(e)})),i["\u0275\u0275elementEnd"]()}if(2&e){var o=t.$implicit,a=i["\u0275\u0275nextContext"](4);i["\u0275\u0275property"]("content",o)("dismissible",!0)("type",a.AlertTypeEnum.Error)}}function I(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",5),i["\u0275\u0275text"](1,"\n          "),i["\u0275\u0275template"](2,y,1,3,"ds-alert",27),i["\u0275\u0275text"](3,"\n        "),i["\u0275\u0275elementEnd"]()),2&e){var n=i["\u0275\u0275nextContext"](3),o=i["\u0275\u0275reference"](1);i["\u0275\u0275propertyInterpolate1"]("id","sectionGenericError_",n.sectionData.id,""),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngForOf",o.getErrors())}}function O(e,t){1&e&&i["\u0275\u0275elementContainer"](0)}function j(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275text"](0,"\n        "),i["\u0275\u0275template"](1,I,4,2,"div",24),i["\u0275\u0275text"](2,"\n        "),i["\u0275\u0275elementStart"](3,"div",25),i["\u0275\u0275listener"]("click",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](2),i["\u0275\u0275reference"](1).setFocus(e)})),i["\u0275\u0275text"](4,"\n          "),i["\u0275\u0275template"](5,O,1,0,"ng-container",26),i["\u0275\u0275text"](6,"\n        "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](7,"\n      ")}if(2&e){var o=i["\u0275\u0275nextContext"](2),a=i["\u0275\u0275reference"](1);i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",a.hasGenericErrors()),i["\u0275\u0275advance"](2),i["\u0275\u0275propertyInterpolate1"]("id","sectionContent_",o.sectionData.id,""),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngComponentOutlet",o.getSectionContent())("ngComponentOutletInjector",o.objectInjector)}}function C(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"ngb-accordion",3,4),i["\u0275\u0275listener"]("panelChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](),i["\u0275\u0275reference"](1).sectionChange(e)})),i["\u0275\u0275text"](2,"\n    "),i["\u0275\u0275elementStart"](3,"ngb-panel",5),i["\u0275\u0275text"](4,"\n      "),i["\u0275\u0275template"](5,S,25,13,"ng-template",6),i["\u0275\u0275text"](6,"\n      "),i["\u0275\u0275template"](7,j,8,4,"ng-template",7),i["\u0275\u0275text"](8,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](9,"\n  "),i["\u0275\u0275elementEnd"]()}if(2&e){var o=i["\u0275\u0275nextContext"]();i["\u0275\u0275propertyInterpolate"]("activeIds",o.sectionData.id),i["\u0275\u0275property"]("destroyOnHide",!1),i["\u0275\u0275advance"](3),i["\u0275\u0275propertyInterpolate"]("id",o.sectionData.id)}}var E=function(e){return{"section-focus":e}},D=function(){var e=function(){function e(t){a(this,e),this.injector=t,this.AlertTypeEnum=s.a}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.objectInjector=i.Injector.create({providers:[{provide:"collectionIdProvider",useFactory:function(){return e.collectionId},deps:[]},{provide:"sectionDataProvider",useFactory:function(){return e.sectionData},deps:[]},{provide:"submissionIdProvider",useFactory:function(){return e.submissionId},deps:[]}],parent:this.injector})}},{key:"removeSection",value:function(e){e.preventDefault(),e.stopPropagation(),this.sectionRef.removeSection(this.submissionId,this.sectionData.id)}},{key:"getSectionContent",value:function(){return Object(o.b)(this.sectionData.sectionType)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](i.Injector))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-section-container"]],viewQuery:function(e,t){var n;1&e&&i["\u0275\u0275viewQuery"](m,!0),2&e&&i["\u0275\u0275queryRefresh"](n=i["\u0275\u0275loadQuery"]())&&(t.sectionRef=n.first)},inputs:{collectionId:"collectionId",sectionData:"sectionData",submissionId:"submissionId"},decls:7,vars:11,consts:[["dsSection","",3,"ngClass","mandatory","submissionId","sectionType","sectionId"],["sectionRef","sectionRef"],[3,"activeIds","destroyOnHide","panelChange",4,"ngIf"],[3,"activeIds","destroyOnHide","panelChange"],["acc","ngbAccordion"],[3,"id"],["ngbPanelTitle",""],["ngbPanelContent",""],[1,"float-left"],[1,"d-inline-block","float-right"],["class","fas fa-exclamation-circle text-warning mr-3","aria-hidden","true",4,"ngIf"],["class","fas fa-exclamation-circle text-danger mr-3","aria-hidden","true",4,"ngIf"],["class","fas fa-check-circle text-success mr-3","aria-hidden","true",4,"ngIf"],["aria-label","Close",1,"close"],["class","fas fa-chevron-up fa-fw","aria-hidden","true",4,"ngIf"],["class","fas fa-chevron-down fa-fw","aria-hidden","true",4,"ngIf"],["href","#","class","close mr-3",3,"click",4,"ngIf"],["aria-hidden","true",1,"fas","fa-exclamation-circle","text-warning","mr-3"],["aria-hidden","true",1,"fas","fa-exclamation-circle","text-danger","mr-3"],["aria-hidden","true",1,"fas","fa-check-circle","text-success","mr-3"],["aria-hidden","true",1,"fas","fa-chevron-up","fa-fw"],["aria-hidden","true",1,"fas","fa-chevron-down","fa-fw"],["href","#",1,"close","mr-3",3,"click"],["aria-hidden","true",1,"fas","fa-trash-o"],[3,"id",4,"ngIf"],[3,"id","click"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[3,"content","dismissible","type","close",4,"ngFor","ngForOf"],[3,"content","dismissible","type","close"]],template:function(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",0,1),i["\u0275\u0275text"](2,"\n  "),i["\u0275\u0275template"](3,C,10,3,"ngb-accordion",2),i["\u0275\u0275pipe"](4,"async"),i["\u0275\u0275text"](5,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](6,"\n")),2&e){var n=i["\u0275\u0275reference"](1);i["\u0275\u0275property"]("ngClass",i["\u0275\u0275pureFunction1"](9,E,n.isSectionActive()))("mandatory",t.sectionData.mandatory)("submissionId",t.submissionId)("sectionType",t.sectionData.sectionType)("sectionId",t.sectionData.id),i["\u0275\u0275attribute"]("id",t.sectionData.id),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](4,7,n.isEnabled()))}},directives:[c.a,l.r,l.u,u.a,u.K,u.N,u.L,l.s,l.t,d.a],pipes:[l.b,p.e],styles:["[_nghost-%COMP%]     .card{margin-bottom:var(--ds-submission-sections-margin-bottom);overflow:unset}.section-focus[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius);-webkit-box-shadow:var(--bs-btn-focus-box-shadow);box-shadow:var(--bs-btn-focus-box-shadow)}[_nghost-%COMP%]     .card:first-of-type{border-bottom:var(--bs-card-border-width) solid var(--bs-card-border-color)!important;border-bottom-left-radius:var(--bs-card-border-radius)!important;border-bottom-right-radius:var(--bs-card-border-radius)!important}[_nghost-%COMP%]     .card-header button{-webkit-box-shadow:none!important;box-shadow:none!important;width:100%}"]}),e}()},YoQ9:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("JTKQ"),o=n("8Y7J");function s(e,t){}var l=function(){var e=function(e){c(i,e);var t=u(i);function i(){return a(this,i),t.apply(this,arguments)}return r(i,[{key:"getComponentName",value:function(){return"SubmissionEditComponent"}},{key:"importThemedComponent",value:function(e){return n("3aq+")("./".concat(e,"/app/submission/edit/submission-edit.component"))}},{key:"importUnthemedComponent",value:function(){return Promise.resolve().then(n.bind(null,"SCNa"))}}]),i}(i.a);return e.\u0275fac=function(t){return d(t||e)},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-themed-submission-edit"]],features:[o["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:0,consts:[["vcr",""]],template:function(e,t){1&e&&(o["\u0275\u0275template"](0,s,0,0,"ng-template",null,0,o["\u0275\u0275templateRefExtractor"]),o["\u0275\u0275text"](2,"\n"))},encapsulation:2}),e}(),d=o["\u0275\u0275getInheritedFactory"](l)},b8BE:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("lJxs"),o=n("LvDl"),s=n("J3qs"),c=n("TTdl"),l=n("8Y7J"),u=n("J/vq"),d=n("YJD6"),p=function(){var e=function(){function e(t,n,i){a(this,e),this.changeDetectorRef=t,this.submissionService=n,this.sectionService=i,this.mandatory=!0,this.genericSectionErrors=[],this.allSectionErrors=[],this.active=!0,this.sectionState=this.mandatory,this.subs=[]}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.valid=this.sectionService.isSectionValid(this.submissionId,this.sectionId).pipe(Object(i.a)((function(t){return t&&e.resetErrors(),t}))),this.subs.push(this.sectionService.getSectionState(this.submissionId,this.sectionId,this.sectionType).pipe(Object(i.a)((function(e){return e.errors}))).subscribe((function(t){Object(s.e)(t)?t.forEach((function(t){Object(c.a)(t.path).forEach((function(n){n.fieldId?e.allSectionErrors.push(t.message):e.genericSectionErrors=Object(o.uniq)(e.genericSectionErrors.concat(t.message))}))})):e.resetErrors()})),this.submissionService.getActiveSectionId(this.submissionId).subscribe((function(t){var n=e.active;e.active=t===e.sectionId,n!==e.active&&(e.changeDetectorRef.detectChanges(),!e.active&&Object(s.g)(t)&&e.submissionService.dispatchSave(e.submissionId))}))),this.enabled=this.sectionService.isSectionEnabled(this.submissionId,this.sectionId)}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(s.b)(e)})).forEach((function(e){return e.unsubscribe()}))}},{key:"sectionChange",value:function(e){this.sectionState=e.nextState}},{key:"isOpen",value:function(){return this.sectionState}},{key:"isMandatory",value:function(){return this.mandatory}},{key:"isSectionActive",value:function(){return this.active}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isValid",value:function(){return this.valid}},{key:"removeSection",value:function(e,t){this.sectionService.removeSection(e,t)}},{key:"hasGenericErrors",value:function(){return this.genericSectionErrors&&this.genericSectionErrors.length>0}},{key:"hasErrors",value:function(){return this.genericSectionErrors&&this.genericSectionErrors.length>0||this.allSectionErrors&&this.allSectionErrors.length>0}},{key:"getErrors",value:function(){return this.genericSectionErrors}},{key:"setFocus",value:function(e){this.active||this.submissionService.setActiveSection(this.submissionId,this.sectionId)}},{key:"removeError",value:function(e){this.genericSectionErrors.splice(e)}},{key:"resetErrors",value:function(){Object(s.e)(this.genericSectionErrors)&&this.sectionService.dispatchRemoveSectionErrors(this.submissionId,this.sectionId),this.genericSectionErrors=[],this.allSectionErrors=[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.ChangeDetectorRef),l["\u0275\u0275directiveInject"](u.a),l["\u0275\u0275directiveInject"](d.a))},e.\u0275dir=l["\u0275\u0275defineDirective"]({type:e,selectors:[["","dsSection",""]],inputs:{mandatory:"mandatory",sectionId:"sectionId",sectionType:"sectionType",submissionId:"submissionId"},exportAs:["sectionRef"]}),e}()},c3nT:function(i,o,s){"use strict";s.d(o,"a",(function(){return $s}));var l,d=s("pKmL"),m=s("PCNd"),f=s("mrSG"),b=s("itXk"),v=s("lJxs"),h=s("vkgz"),g=s("5+tZ"),x=s("IzEk"),S=s("cBqT"),y=s("/uUt"),I=s("pLZG"),O=s("LvDl"),j=s("Q5/L"),C=s("NFsL"),E=s("JX91"),D=s("J3qs"),w=s("8Y7J"),k=((l=function(){function e(t,n,i){a(this,e),this.injectedCollectionId=t,this.injectedSectionData=n,this.injectedSubmissionId=i,this.collectionId=t,this.sectionData=n,this.submissionId=i}return r(e,[{key:"ngOnInit",value:function(){this.onSectionInit(),this.updateSectionStatus()}},{key:"updateSectionStatus",value:function(){var e=this;this.sectionStatusSub=this.getSectionStatus().pipe(Object(I.a)((function(e){return Object(D.h)(e)})),Object(E.a)(!0)).subscribe((function(t){e.sectionService.setSectionStatus(e.submissionId,e.sectionData.id,t)}))}},{key:"ngOnDestroy",value:function(){Object(D.b)(this.sectionStatusSub)&&this.sectionStatusSub.unsubscribe(),this.onSectionDestroy()}}]),e}()).\u0275fac=function(e){return new(e||l)(w["\u0275\u0275directiveInject"]("collectionIdProvider"),w["\u0275\u0275directiveInject"]("sectionDataProvider"),w["\u0275\u0275directiveInject"]("submissionIdProvider"))},l.\u0275cmp=w["\u0275\u0275defineComponent"]({type:l,selectors:[["ds-section-model"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),l),F=s("+ZI/"),M=s("0VLH"),L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;a(this,e),this._path=t,this._value=n}return r(e,[{key:"delete",value:function(){this._value=null,this._path=null}},{key:"isPathEqual",value:function(e){return this._path&&Object(O.isEqual)(this._path,e)}},{key:"path",get:function(){return this._path},set:function(e){this._path=e}},{key:"value",get:function(){return this._value},set:function(e){this._value=e}}]),e}(),B=s("Uql/"),V=s("4GeW"),T=s("J/vq"),R=s("ITak"),P=s("lI3o"),$=s("YJD6"),A=s("Gx58"),_=s("1QIV"),N=s("fHtB"),q=s("mycY"),U=s("X/78"),J=s("84Zn"),G=s("AytR"),Q=s("TSSN"),Y=s("SVse"),z=s("Frqi"),H=s("hqmO"),K=["formRef"];function X(e,t){1&e&&w["\u0275\u0275element"](0,"ds-loading",2)}function Z(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"ds-form",3,4),w["\u0275\u0275listener"]("dfChange",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().onChange(e)}))("dfFocus",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().onFocus(e)}))("remove",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().onRemove(e)}))("ngbEvent",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().onCustomEvent(e)}))("removeArrayItem",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().onRemove(e)})),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]();w["\u0275\u0275property"]("formId",i.formId)("formModel",i.formModel)("displaySubmit",!1)("displayCancel",!1)}}var W,ee=((W=function(e){c(i,e);var t=u(i);function i(e,n,o,s,r,c,l,u,d,p,m,f,b,v,h){var g;return a(this,i),(g=t.call(this,b,v,h)).cdr=e,g.formBuilderService=n,g.formOperationsService=o,g.formService=s,g.formConfigService=r,g.notificationsService=c,g.sectionService=l,g.submissionService=u,g.translate=d,g.submissionObjectService=p,g.objectCache=m,g.requestService=f,g.injectedCollectionId=b,g.injectedSectionData=v,g.injectedSubmissionId=h,g.isUpdating=!1,g.isLoading=!0,g.fieldsOnTheirWayToBeRemoved=new Map,g.formData=Object.create({}),g.previousValue=new L,g.subs=[],g}return r(i,[{key:"onSectionInit",value:function(){var e=this;this.pathCombiner=new M.a("sections",this.sectionData.id),this.formId=this.formService.getUniqueId(this.sectionData.id),this.sectionService.dispatchSetSectionFormId(this.submissionId,this.sectionData.id,this.formId),this.formConfigService.findByHref(this.sectionData.config).pipe(Object(v.a)((function(e){return e.payload})),Object(h.a)((function(t){return e.formConfig=t})),Object(g.a)((function(){return Object(b.a)([e.sectionService.getSectionData(e.submissionId,e.sectionData.id,e.sectionData.sectionType),e.submissionObjectService.findById(e.submissionId,!0,!1,Object(J.a)("item")).pipe(Object(_.i)(),Object(_.o)())])})),Object(x.a)(1)).subscribe((function(t){var i=n(t,2),o=i[0],a=i[1];Object(D.j)(e.formModel)&&(e.sectionData.errors=[],e.workspaceItem=a,e.initForm(o),e.sectionData.data=o,e.subscriptions(),e.isLoading=!1,e.cdr.detectChanges())}))}},{key:"onSectionDestroy",value:function(){this.subs.filter((function(e){return Object(D.b)(e)})).forEach((function(e){return e.unsubscribe()}))}},{key:"getSectionStatus",value:function(){return this.formService.isValid(this.formId)}},{key:"hasMetadataEnrichment",value:function(e){var t=this,n={};Object.keys(e).forEach((function(i){t.sectionMetadata&&t.sectionMetadata.includes(i)&&(n[i]=e[i])}));var i=[],o=Object(A.a)(n,this.formData);return Object.keys(o).forEach((function(e){o[e].forEach((function(n){n.hasOwnProperty("value")&&Object(O.findIndex)(t.formData[e],{value:n.value})<0&&i.push(n)}))})),Object(D.e)(i)}},{key:"initForm",value:function(e){try{this.formModel=this.formBuilderService.modelFromConfiguration(this.submissionId,this.formConfig,this.collectionId,e,this.submissionService.getSubmissionScope());var t=this.sectionService.computeSectionConfiguredMetadata(this.formConfig);this.sectionService.updateSectionData(this.submissionId,this.sectionData.id,e,[],t)}catch(i){var n={message:this.translate.instant("error.submission.sections.init-form-error")+i.toString(),path:"/sections/"+this.sectionData.id};console.error(i.stack),this.sectionService.setSectionError(this.submissionId,this.sectionData.id,n)}}},{key:"updateForm",value:function(e,t){Object(D.e)(e)&&!Object(O.isEqual)(e,this.sectionData.data)?(this.sectionData.data=e,this.hasMetadataEnrichment(e)?(this.isUpdating=!0,this.formModel=null,this.cdr.detectChanges(),this.initForm(e),this.checksForErrors(t),this.isUpdating=!1,this.cdr.detectChanges()):(Object(D.e)(t)||Object(D.e)(this.sectionData.errors))&&this.checksForErrors(t)):(Object(D.e)(t)||Object(D.e)(this.sectionData.errors))&&this.checksForErrors(t)}},{key:"checksForErrors",value:function(e){var t=this;this.formService.isFormInitialized(this.formId).pipe(Object(S.a)((function(e){return!0===e&&!t.isUpdating}))).subscribe((function(){t.sectionService.checkSectionErrors(t.submissionId,t.sectionData.id,t.formId,e,t.sectionData.errors),t.sectionData.errors=e,t.cdr.detectChanges()}))}},{key:"subscriptions",value:function(){var e=this;this.subs.push(this.formService.getFormData(this.formId).pipe(Object(y.a)()).subscribe((function(t){e.formData=t})),this.sectionService.getSectionState(this.submissionId,this.sectionData.id,this.sectionData.sectionType).pipe(Object(I.a)((function(e){return Object(D.e)(e)&&(Object(D.e)(e.data)||Object(D.e)(e.errors))})),Object(y.a)()).subscribe((function(t){e.fieldsOnTheirWayToBeRemoved=new Map,e.sectionMetadata=t.metadata,e.updateForm(t.data,t.errors)})))}},{key:"onChange",value:function(e){this.formOperationsService.dispatchOperationsFromEvent(this.pathCombiner,e,this.previousValue,this.hasStoredValue(this.formBuilderService.getId(e.model),this.formOperationsService.getArrayIndexFromEvent(e)));var t=this.formOperationsService.getFieldPathSegmentedFromChangeEvent(e),n=this.formOperationsService.getFieldValueFromChangeEvent(e);-1!==G.a.submission.autosave.metadata.indexOf(t)&&Object(D.e)(n)&&this.submissionService.dispatchSave(this.submissionId)}},{key:"onFocus",value:function(e){var t=this.formOperationsService.getFieldValueFromChangeEvent(e),n=this.formBuilderService.getPath(e.model);this.formBuilderService.hasMappedGroupValue(e.model)?(this.previousValue.path=n,this.previousValue.value=this.formOperationsService.getQualdropValueMap(e)):Object(D.e)(t)&&("object"==typeof t&&Object(D.e)(t.value)||"string"==typeof t)&&(this.previousValue.path=n,this.previousValue.value=t)}},{key:"onRemove",value:function(e){var t=this.formBuilderService.getId(e.model),n=this.formOperationsService.getArrayIndexFromEvent(e);if(this.fieldsOnTheirWayToBeRemoved.has(t)){var i=this.fieldsOnTheirWayToBeRemoved.get(t);i.push(n),this.fieldsOnTheirWayToBeRemoved.set(t,i)}else this.fieldsOnTheirWayToBeRemoved.set(t,[n]);this.formOperationsService.dispatchOperationsFromEvent(this.pathCombiner,e,this.previousValue,this.hasStoredValue(t,n))}},{key:"hasStoredValue",value:function(e,t){return!!Object(D.e)(this.sectionData.data)&&this.sectionData.data.hasOwnProperty(e)&&Object(D.e)(this.sectionData.data[e][t])&&!this.isFieldToRemove(e,t)}},{key:"isFieldToRemove",value:function(e,t){return this.fieldsOnTheirWayToBeRemoved.has(e)&&this.fieldsOnTheirWayToBeRemoved.get(e).includes(t)}},{key:"onCustomEvent",value:function(e){this.formOperationsService.dispatchOperationsFromEvent(this.pathCombiner,e,this.previousValue,null)}}]),i}(k)).\u0275fac=function(e){return new(e||W)(w["\u0275\u0275directiveInject"](w.ChangeDetectorRef),w["\u0275\u0275directiveInject"](j.a),w["\u0275\u0275directiveInject"](R.a),w["\u0275\u0275directiveInject"](C.a),w["\u0275\u0275directiveInject"](F.a),w["\u0275\u0275directiveInject"](P.a),w["\u0275\u0275directiveInject"]($.a),w["\u0275\u0275directiveInject"](T.a),w["\u0275\u0275directiveInject"](Q.f),w["\u0275\u0275directiveInject"](N.a),w["\u0275\u0275directiveInject"](q.a),w["\u0275\u0275directiveInject"](U.a),w["\u0275\u0275directiveInject"]("collectionIdProvider"),w["\u0275\u0275directiveInject"]("sectionDataProvider"),w["\u0275\u0275directiveInject"]("submissionIdProvider"))},W.\u0275cmp=w["\u0275\u0275defineComponent"]({type:W,selectors:[["ds-submission-section-form"]],viewQuery:function(e,t){var n;1&e&&w["\u0275\u0275viewQuery"](K,!0),2&e&&w["\u0275\u0275queryRefresh"](n=w["\u0275\u0275loadQuery"]())&&(t.formRef=n.first)},features:[w["\u0275\u0275InheritDefinitionFeature"]],decls:4,vars:2,consts:[["message","Loading...",4,"ngIf"],[3,"formId","formModel","displaySubmit","displayCancel","dfChange","dfFocus","remove","ngbEvent","removeArrayItem",4,"ngIf"],["message","Loading..."],[3,"formId","formModel","displaySubmit","displayCancel","dfChange","dfFocus","remove","ngbEvent","removeArrayItem"],["formRef","formComponent"]],template:function(e,t){1&e&&(w["\u0275\u0275template"](0,X,1,0,"ds-loading",0),w["\u0275\u0275text"](1,"\n"),w["\u0275\u0275template"](2,Z,2,4,"ds-form",1),w["\u0275\u0275text"](3,"\n")),2&e&&(w["\u0275\u0275property"]("ngIf",t.isLoading),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",!t.isLoading&&t.formModel))},directives:[Y.u,z.a,H.a],styles:[""]}),W=Object(f.b)([Object(B.a)(V.a.SubmissionForm)],W)),te=s("b8BE"),ne=s("wQzj"),ie=s("yAsG"),oe=s("m4Gq"),ae=s("ph1m"),se=s("Yfyx"),re=s("tqRt"),ce=s("7bNT"),le=s("33F9"),ue=s("Cfvw"),de=s("LRne"),pe=s("eIep"),me=s("JIr8"),fe=s("zp1y"),be=s("fBXw"),ve=s("4jMI"),he=s("TTdl"),ge=s("QjZv");function xe(e,t,n){return e?e[t.sections[n].formId]:null}function Se(e,t,n,i){if(i||n!==V.a.SubmissionForm)return t;if(!e||!e.touched)return[];var o=[];return t.forEach((function(t){Object(he.a)(t.path).forEach((function(n){n.fieldId&&e.touched[n.fieldId]&&o.push(t)}))})),o}var ye,Ie,Oe,je=[(ye=function(){function e(t,i,o,s,r,c,l,u){var d=this;a(this,e),this.actions$=t,this.notificationsService=i,this.operationsService=o,this.sectionService=s,this.store$=r,this.submissionService=c,this.submissionObjectService=l,this.translate=u,this.loadForm$=this.actions$.pipe(Object(ce.f)(ve.F.INIT_SUBMISSION_FORM),Object(v.a)((function(e){var t=e.payload.submissionDefinition,n=[];return t.sections.page.forEach((function(t){var i,o=t._links.self.href||t._links.self,a=o.substr(o.lastIndexOf("/")+1),s=t._links.config?t._links.config.href||t._links.config:"",r=t.mandatory||Object(D.e)(e.payload.sections)&&e.payload.sections.hasOwnProperty(a);i=t.sectionType!==V.a.SubmissionForm?Object(D.h)(e.payload.sections)&&Object(D.h)(e.payload.sections[a])?e.payload.sections[a]:Object.create(null):e.payload.item.metadata,n.push(new ve.o(e.payload.submissionId,a,t.header,s,t.mandatory,t.sectionType,t.visibility,r,i,null))})),{action:e,definition:t,mappedActions:n}})),Object(g.a)((function(e){return Object(ue.a)(e.mappedActions.concat(new ve.c(e.action.payload.submissionId)))}))),this.resetForm$=this.actions$.pipe(Object(ce.f)(ve.F.RESET_SUBMISSION_FORM),Object(v.a)((function(e){return new ve.p(e.payload.collectionId,e.payload.submissionId,e.payload.selfUrl,e.payload.submissionDefinition,e.payload.sections,e.payload.item,null)}))),this.saveSubmission$=this.actions$.pipe(Object(ce.f)(ve.F.SAVE_SUBMISSION_FORM),Object(pe.a)((function(e){return d.operationsService.jsonPatchByResourceType(d.submissionService.getSubmissionObjectLinkName(),e.payload.submissionId,"sections").pipe(Object(v.a)((function(t){return new ve.y(e.payload.submissionId,t,e.payload.isManual)})),Object(me.a)((function(){return Object(de.a)(new ve.x(e.payload.submissionId))})))}))),this.saveForLaterSubmission$=this.actions$.pipe(Object(ce.f)(ve.F.SAVE_FOR_LATER_SUBMISSION_FORM),Object(pe.a)((function(e){return d.operationsService.jsonPatchByResourceType(d.submissionService.getSubmissionObjectLinkName(),e.payload.submissionId,"sections").pipe(Object(v.a)((function(t){return new ve.v(e.payload.submissionId,t)})),Object(me.a)((function(){return Object(de.a)(new ve.x(e.payload.submissionId))})))}))),this.saveSubmissionSuccess$=this.actions$.pipe(Object(ce.f)(ve.F.SAVE_SUBMISSION_FORM_SUCCESS),Object(fe.a)(this.store$),Object(v.a)((function(e){var t=n(e,2),i=t[0],o=t[1];return d.parseSaveResponse(o.submission.objects[i.payload.submissionId],i.payload.submissionObject,i.payload.submissionId,o.forms,i.payload.notify)})),Object(g.a)((function(e){return Object(ue.a)(e)}))),this.saveSubmissionSectionSuccess$=this.actions$.pipe(Object(ce.f)(ve.F.SAVE_SUBMISSION_SECTION_FORM_SUCCESS),Object(fe.a)(this.store$),Object(v.a)((function(e){var t=n(e,2),i=t[0],o=t[1];return d.parseSaveResponse(o.submission.objects[i.payload.submissionId],i.payload.submissionObject,i.payload.submissionId,o.forms,!1)})),Object(g.a)((function(e){return Object(ue.a)(e)}))),this.saveSection$=this.actions$.pipe(Object(ce.f)(ve.F.SAVE_SUBMISSION_SECTION_FORM),Object(pe.a)((function(e){return d.operationsService.jsonPatchByResourceID(d.submissionService.getSubmissionObjectLinkName(),e.payload.submissionId,"sections",e.payload.sectionId).pipe(Object(v.a)((function(t){return new ve.B(e.payload.submissionId,t)})),Object(me.a)((function(){return Object(de.a)(new ve.A(e.payload.submissionId))})))}))),this.saveError$=this.actions$.pipe(Object(ce.f)(ve.F.SAVE_SUBMISSION_FORM_ERROR,ve.F.SAVE_SUBMISSION_SECTION_FORM_ERROR),Object(fe.a)(this.store$),Object(h.a)((function(){return d.notificationsService.error(null,d.translate.get("submission.sections.general.save_error_notice"))}))),this.saveAndDeposit$=this.actions$.pipe(Object(ce.f)(ve.F.SAVE_AND_DEPOSIT_SUBMISSION),Object(fe.a)(this.store$),Object(pe.a)((function(e){var t=n(e,2),i=t[0],o=t[1];return d.operationsService.jsonPatchByResourceType(d.submissionService.getSubmissionObjectLinkName(),i.payload.submissionId,"sections").pipe(Object(v.a)((function(e){return d.canDeposit(e)?new ve.e(i.payload.submissionId):(d.notificationsService.warning(null,d.translate.get("submission.sections.general.sections_not_valid")),d.parseSaveResponse(o.submission.objects[i.payload.submissionId],e,i.payload.submissionId,o.forms))})),Object(me.a)((function(){return Object(de.a)(new ve.x(i.payload.submissionId))})))}))),this.depositSubmission$=this.actions$.pipe(Object(ce.f)(ve.F.DEPOSIT_SUBMISSION),Object(fe.a)(this.store$),Object(pe.a)((function(e){var t=n(e,2),i=t[0],o=t[1];return d.submissionService.depositSubmission(o.submission.objects[i.payload.submissionId].selfUrl).pipe(Object(v.a)((function(){return new ve.g(i.payload.submissionId)})),Object(me.a)((function(e){return console.log("submission error",e),Object(de.a)(new ve.f(i.payload.submissionId))})))}))),this.saveForLaterSubmissionSuccess$=this.actions$.pipe(Object(ce.f)(ve.F.SAVE_FOR_LATER_SUBMISSION_FORM_SUCCESS),Object(h.a)((function(){return d.notificationsService.success(null,d.translate.get("submission.sections.general.save_success_notice"))})),Object(h.a)((function(){return d.submissionService.redirectToMyDSpace()}))),this.depositSubmissionSuccess$=this.actions$.pipe(Object(ce.f)(ve.F.DEPOSIT_SUBMISSION_SUCCESS),Object(h.a)((function(){return d.notificationsService.success(null,d.translate.get("submission.sections.general.deposit_success_notice"))})),Object(h.a)((function(){return d.submissionService.redirectToMyDSpace()}))),this.depositSubmissionError$=this.actions$.pipe(Object(ce.f)(ve.F.DEPOSIT_SUBMISSION_ERROR),Object(h.a)((function(){return d.notificationsService.error(null,d.translate.get("submission.sections.general.deposit_error_notice"))}))),this.discardSubmission$=this.actions$.pipe(Object(ce.f)(ve.F.DISCARD_SUBMISSION),Object(pe.a)((function(e){return d.submissionService.discardSubmission(e.payload.submissionId).pipe(Object(v.a)((function(){return new ve.k(e.payload.submissionId)})),Object(me.a)((function(){return Object(de.a)(new ve.j(e.payload.submissionId))})))}))),this.addAllMetadataToSectionData=this.actions$.pipe(Object(ce.f)(ve.F.UPDATE_SECTION_DATA),Object(pe.a)((function(e){return d.sectionService.getSectionState(e.payload.submissionId,e.payload.sectionId,V.a.Upload).pipe(Object(v.a)((function(t){return[e,t]})),Object(x.a)(1))})),Object(I.a)((function(e){var t=n(e,2);return t[0],t[1].sectionType===V.a.SubmissionForm})),Object(pe.a)((function(e){var t=n(e,2),i=t[0];return t[1].sectionType===V.a.SubmissionForm?d.submissionObjectService.findById(i.payload.submissionId,!0,!1,Object(J.a)("item")).pipe(Object(_.j)()).pipe(Object(pe.a)((function(e){return e.item.pipe(Object(_.j)())}))).pipe(Object(v.a)((function(e){return e.metadata})),Object(I.a)((function(e){return!Object(O.isEqual)(i.payload.data,e)})),Object(v.a)((function(e){return new ve.G(i.payload.submissionId,i.payload.sectionId,e,i.payload.errors,i.payload.metadata)}))):Object(de.a)(new ve.H)}))),this.discardSubmissionSuccess$=this.actions$.pipe(Object(ce.f)(ve.F.DISCARD_SUBMISSION_SUCCESS),Object(h.a)((function(){return d.notificationsService.success(null,d.translate.get("submission.sections.general.discard_success_notice"))})),Object(h.a)((function(){return d.submissionService.redirectToMyDSpace()}))),this.discardSubmissionError$=this.actions$.pipe(Object(ce.f)(ve.F.DISCARD_SUBMISSION_ERROR),Object(h.a)((function(){return d.notificationsService.error(null,d.translate.get("submission.sections.general.discard_error_notice"))})))}return r(e,[{key:"canDeposit",value:function(e){var t=!0;return Object(D.e)(e)&&e.forEach((function(e){var n=e.errors;n&&!Object(D.d)(n)&&(t=!1)})),t}},{key:"parseSaveResponse",value:function(e,n,i,o){var a=this,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=[];return Object(D.e)(n)&&(s&&this.notificationsService.success(null,this.translate.get("submission.sections.general.save_success_notice")),n.forEach((function(n){var c=Object.create({}),l=n.errors;l&&!Object(D.d)(l)&&(c=Object(be.a)(l),s&&a.notificationsService.warning(null,a.translate.get("submission.sections.general.sections_not_valid")));var u,d=n.sections&&Object(D.e)(n.sections)?n.sections:{},p=t(Object(O.union)(Object.keys(d),Object.keys(c)));try{for(p.s();!(u=p.n()).done;){var m=u.value,f=c[m]||[],b=d[m]||{};if(e.sections[m].sectionType!==V.a.Upload||!Object(D.d)(b.files)||e.sections[m].enabled){s&&!e.sections[m].enabled&&a.submissionService.notifyNewSection(i,m,e.sections[m].sectionType);var v=Se(xe(o,e,m),f,e.sections[m].sectionType,s);r.push(new ve.G(i,m,b,v))}}}catch(h){p.e(h)}finally{p.f()}}))),r}}]),e}(),ye.\u0275fac=function(e){return new(e||ye)(w["\u0275\u0275inject"](ce.a),w["\u0275\u0275inject"](P.a),w["\u0275\u0275inject"](ge.a),w["\u0275\u0275inject"]($.a),w["\u0275\u0275inject"](re.h),w["\u0275\u0275inject"](T.a),w["\u0275\u0275inject"](N.a),w["\u0275\u0275inject"](Q.f))},ye.\u0275prov=w["\u0275\u0275defineInjectable"]({token:ye,factory:ye.\u0275fac}),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"loadForm$",void 0),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"resetForm$",void 0),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"saveSubmission$",void 0),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"saveForLaterSubmission$",void 0),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"saveSubmissionSuccess$",void 0),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"saveSubmissionSectionSuccess$",void 0),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"saveSection$",void 0),Object(f.b)([Object(ce.b)({dispatch:!1}),Object(f.c)("design:type",Object)],ye.prototype,"saveError$",void 0),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"saveAndDeposit$",void 0),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"depositSubmission$",void 0),Object(f.b)([Object(ce.b)({dispatch:!1}),Object(f.c)("design:type",Object)],ye.prototype,"saveForLaterSubmissionSuccess$",void 0),Object(f.b)([Object(ce.b)({dispatch:!1}),Object(f.c)("design:type",Object)],ye.prototype,"depositSubmissionSuccess$",void 0),Object(f.b)([Object(ce.b)({dispatch:!1}),Object(f.c)("design:type",Object)],ye.prototype,"depositSubmissionError$",void 0),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"discardSubmission$",void 0),Object(f.b)([Object(ce.b)(),Object(f.c)("design:type",Object)],ye.prototype,"addAllMetadataToSectionData",void 0),Object(f.b)([Object(ce.b)({dispatch:!1}),Object(f.c)("design:type",Object)],ye.prototype,"discardSubmissionSuccess$",void 0),Object(f.b)([Object(ce.b)({dispatch:!1}),Object(f.c)("design:type",Object)],ye.prototype,"discardSubmissionError$",void 0),ye)],Ce=s("2Vo4"),Ee=s("LP5c"),De=((Ie=function(){function e(t){a(this,e),this.store=t}return r(e,[{key:"getUploadedFileList",value:function(e,t){return this.store.select(Object(Ee.h)(e,t)).pipe(Object(v.a)((function(e){return e})),Object(y.a)())}},{key:"getFileData",value:function(e,t,n){return this.store.select(Object(Ee.h)(e,t)).pipe(Object(I.a)((function(e){return!Object(D.j)(e)})),Object(v.a)((function(e){var t;return Object.keys(e).filter((function(t){return e[t].uuid===n})).forEach((function(n){return t=e[n]})),t})),Object(y.a)())}},{key:"getDefaultPolicies",value:function(e,t,n){return this.store.select(Object(Ee.g)(e,t,n)).pipe(Object(v.a)((function(e){return e})),Object(y.a)())}},{key:"addUploadedFile",value:function(e,t,n,i){this.store.dispatch(new ve.q(e,t,n,i))}},{key:"updateFileData",value:function(e,t,n,i){this.store.dispatch(new ve.l(e,t,n,i))}},{key:"removeUploadedFile",value:function(e,t,n){this.store.dispatch(new ve.d(e,t,n))}}]),e}()).\u0275fac=function(e){return new(e||Ie)(w["\u0275\u0275inject"](re.h))},Ie.\u0275prov=w["\u0275\u0275defineInjectable"]({token:Ie,factory:Ie.\u0275fac}),Ie),we=s("DNva"),ke=s("YIpg"),Fe=s("8a3C"),Me=s("EdIQ"),Le=s("uLZQ"),Be=s("zQ+x"),Ve=s("5HAD"),Te=s("7vy/"),Re=s("VOnO"),Pe=s("IheW"),$e=((Oe=function(t){c(i,t);var n=u(i);function i(e,t,o,s,r,c,l,u){var d;return a(this,i),(d=n.call(this,e,t,null,s,r,c,l,u,"submissionuploads")).requestService=e,d.rdbService=t,d.store=o,d.objectCache=s,d.halService=r,d.notificationsService=c,d.http=l,d.comparator=u,d}return r(i,[{key:"findByHref",value:function(t){for(var n,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length,r=new Array(s>3?s-3:0),c=3;c<s;c++)r[c-3]=arguments[c];return(n=e(p(i.prototype),"findByHref",this)).call.apply(n,[this,t,o,a].concat(r))}}]),i}(Me.a)).\u0275fac=function(e){return new(e||Oe)(w["\u0275\u0275inject"](U.a),w["\u0275\u0275inject"](Te.a),w["\u0275\u0275inject"](re.h),w["\u0275\u0275inject"](q.a),w["\u0275\u0275inject"](Le.a),w["\u0275\u0275inject"](P.a),w["\u0275\u0275inject"](Pe.b),w["\u0275\u0275inject"](Re.a))},Oe.\u0275prov=w["\u0275\u0275defineInjectable"]({token:Oe,factory:Oe.\u0275fac}),Oe=Object(f.b)([Object(Be.d)(Ve.f)],Oe)),Ae=s("ac5F");function _e(e,t){1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n  "),w["\u0275\u0275elementStart"](2,"div",2),w["\u0275\u0275text"](3,"\n    "),w["\u0275\u0275elementStart"](4,"div",3),w["\u0275\u0275text"](5,"\n      "),w["\u0275\u0275elementStart"](6,"h3",4),w["\u0275\u0275elementStart"](7,"span",5),w["\u0275\u0275text"](8),w["\u0275\u0275pipe"](9,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](10,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](11,"\n  "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](12,"\n"),w["\u0275\u0275elementContainerEnd"]()),2&e&&(w["\u0275\u0275advance"](8),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](9,1,"submission.sections.upload.no-file-uploaded")))}var Ne=function(e){return{collectionName:e}};function qe(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1),w["\u0275\u0275pipe"](2,"translate"),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"](3);w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n          ",w["\u0275\u0275pipeBind2"](2,1,"submission.sections.upload.header.policy.default.nolist",w["\u0275\u0275pureFunction1"](4,Ne,n.collectionName)),"\n        ")}}function Ue(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1),w["\u0275\u0275pipe"](2,"translate"),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"](3);w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n          ",w["\u0275\u0275pipeBind2"](2,1,"submission.sections.upload.header.policy.default.withlist",w["\u0275\u0275pureFunction1"](4,Ne,n.collectionName)),"\n        ")}}function Je(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"div",2),w["\u0275\u0275text"](1,"\n    "),w["\u0275\u0275elementStart"](2,"div",8),w["\u0275\u0275text"](3,"\n      "),w["\u0275\u0275elementStart"](4,"ds-alert",9),w["\u0275\u0275text"](5,"\n        "),w["\u0275\u0275template"](6,qe,3,6,"ng-container",1),w["\u0275\u0275text"](7,"\n        "),w["\u0275\u0275template"](8,Ue,3,6,"ng-container",1),w["\u0275\u0275text"](9,"\n        "),w["\u0275\u0275element"](10,"span",10),w["\u0275\u0275text"](11,"\n        "),w["\u0275\u0275element"](12,"ds-submission-section-upload-access-conditions",11),w["\u0275\u0275text"](13,"\n      "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](14,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](15,"\n  "),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"](2);w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("type",n.AlertTypeEnum.Warning),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",1===n.collectionPolicyType),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",2===n.collectionPolicyType),w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("accessConditions",n.collectionDefaultAccessConditions)}}function Ge(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n    "),w["\u0275\u0275element"](2,"ds-submission-upload-section-file",12),w["\u0275\u0275pipe"](3,"async"),w["\u0275\u0275text"](4,"\n    "),w["\u0275\u0275elementStart"](5,"div",2),w["\u0275\u0275text"](6,"\n      "),w["\u0275\u0275elementStart"](7,"div",3),w["\u0275\u0275text"](8,"\n        "),w["\u0275\u0275element"](9,"hr"),w["\u0275\u0275text"](10,"\n      "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](11,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](12,"\n  "),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit,i=w["\u0275\u0275nextContext"](2);w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("availableAccessConditionOptions",i.availableAccessConditionOptions)("collectionId",i.collectionId)("collectionPolicyType",i.collectionPolicyType)("configMetadataForm",w["\u0275\u0275pipeBind1"](3,9,i.configMetadataForm$))("fileId",i.fileIndexes[i.fileList.indexOf(n)])("fileIndex",i.fileList.indexOf(n))("fileName",i.fileNames[i.fileList.indexOf(n)])("sectionId",i.sectionData.id)("submissionId",i.submissionId)}}function Qe(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n\n  "),w["\u0275\u0275template"](2,Je,16,4,"div",6),w["\u0275\u0275text"](3,"\n\n  "),w["\u0275\u0275template"](4,Ge,13,11,"ng-container",7),w["\u0275\u0275text"](5,"\n"),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",n.collectionDefaultAccessConditions.length>0),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngForOf",n.fileList)}}var Ye,ze=((Ye=function(e){c(i,e);var t=u(i);function i(e,n,o,s,r,c,l,u,d,p){var m;return a(this,i),(m=t.call(this,void 0,d,p)).bitstreamService=e,m.changeDetectorRef=n,m.collectionDataService=o,m.groupService=s,m.resourcePolicyService=r,m.sectionService=c,m.submissionService=l,m.uploadsConfigService=u,m.injectedSectionData=d,m.injectedSubmissionId=p,m.AlertTypeEnum=Ae.a,m.fileIndexes=[],m.fileList=[],m.fileNames=[],m.collectionDefaultAccessConditions=[],m.required$=new Ce.a(!0),m.subs=[],m}return r(i,[{key:"onSectionInit",value:function(){var e=this,t=this.uploadsConfigService.findByHref(this.sectionData.config,!0,!1,Object(J.a)("metadata")).pipe(Object(_.i)(),Object(v.a)((function(e){return e.payload})));this.configMetadataForm$=t.pipe(Object(pe.a)((function(e){return e.metadata.pipe(Object(_.i)(),Object(v.a)((function(e){return e.payload})))}))),this.subs.push(this.submissionService.getSubmissionObject(this.submissionId).pipe(Object(I.a)((function(e){return Object(D.h)(e)&&!e.isLoading})),Object(I.a)((function(t){return Object(D.j)(e.collectionId)||e.collectionId!==t.collection})),Object(h.a)((function(t){return e.collectionId=t.collection})),Object(g.a)((function(t){return e.collectionDataService.findById(t.collection)})),Object(I.a)((function(e){return Object(D.h)(e.payload)})),Object(h.a)((function(t){return e.collectionName=t.payload.name})),Object(g.a)((function(){return t}))).subscribe((function(t){e.required$.next(t.required),e.availableAccessConditionOptions=Object(D.e)(t.accessConditionOptions)?t.accessConditionOptions:[],e.collectionPolicyType=e.availableAccessConditionOptions.length>0?2:1,e.changeDetectorRef.detectChanges()})),Object(b.a)(this.configMetadataForm$,this.bitstreamService.getUploadedFileList(this.submissionId,this.sectionData.id)).pipe(Object(I.a)((function(e){var t=n(e,2),i=t[0],o=t[1];return Object(D.e)(i)&&Object(D.h)(o)})),Object(y.a)()).subscribe((function(t){var i=n(t,2),o=i[0],a=i[1];e.fileList=[],e.fileIndexes=[],e.fileNames=[],e.changeDetectorRef.detectChanges(),Object(D.h)(a)&&a.length>0&&a.forEach((function(t){e.fileList.push(t),e.fileIndexes.push(t.uuid),e.fileNames.push(e.getFileName(o,t))})),e.changeDetectorRef.detectChanges()})))}},{key:"getFileName",value:function(e,t){var n=e.rows[0].fields[0].selectableMetadata[0].metadata;return Object(D.e)(t.metadata)&&Object(D.e)(t.metadata[n])?t.metadata[n][0].display:t.uuid}},{key:"getSectionStatus",value:function(){return Object(b.a)(this.required$,this.bitstreamService.getUploadedFileList(this.submissionId,this.sectionData.id),(function(e,t){return!e||Object(D.h)(t)&&t.length>0}))}},{key:"onSectionDestroy",value:function(){this.subs.filter((function(e){return Object(D.b)(e)})).forEach((function(e){return e.unsubscribe()}))}}]),i}(k)).\u0275fac=function(e){return new(e||Ye)(w["\u0275\u0275directiveInject"](De),w["\u0275\u0275directiveInject"](w.ChangeDetectorRef),w["\u0275\u0275directiveInject"](we.a),w["\u0275\u0275directiveInject"](ke.a),w["\u0275\u0275directiveInject"](Fe.a),w["\u0275\u0275directiveInject"]($.a),w["\u0275\u0275directiveInject"](T.a),w["\u0275\u0275directiveInject"]($e),w["\u0275\u0275directiveInject"]("sectionDataProvider"),w["\u0275\u0275directiveInject"]("submissionIdProvider"))},Ye.\u0275cmp=w["\u0275\u0275defineComponent"]({type:Ye,selectors:[["ds-submission-section-upload"]],features:[w["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:5,consts:[[3,"content","dismissible","type"],[4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"text-center"],[1,"text-muted"],["class","row",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"col-sm-12"],[3,"type"],[1,"clearfix"],[3,"accessConditions"],[3,"availableAccessConditionOptions","collectionId","collectionPolicyType","configMetadataForm","fileId","fileIndex","fileName","sectionId","submissionId"]],template:function(e,t){1&e&&(w["\u0275\u0275element"](0,"ds-alert",0),w["\u0275\u0275text"](1,"\n\n"),w["\u0275\u0275template"](2,_e,13,3,"ng-container",1),w["\u0275\u0275text"](3,"\n\n"),w["\u0275\u0275template"](4,Qe,6,2,"ng-container",1),w["\u0275\u0275text"](5,"\n")),2&e&&(w["\u0275\u0275property"]("content","submission.sections.upload.info")("dismissible",!0)("type",t.AlertTypeEnum.Info),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",0==t.fileList.length),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",t.fileList.length>0))},styles:[""]}),Ye=Object(f.b)([Object(B.a)(V.a.Upload)],Ye)),He=s("T/iP"),Ke=s("BVmw"),Xe={granted:{element:{container:"custom-control custom-checkbox pl-1",control:"custom-control-input",label:"custom-control-label pt-1"}}},Ze=[{id:"granted",label:"I confirm the license above",required:!0,value:!1,validators:{required:null},errorMessages:{required:"You must accept the license",notgranted:"You must accept the license"},type:"CHECKBOX"}],We=["formRef"];function et(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"ds-form",2,3),w["\u0275\u0275listener"]("dfChange",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().onChange(e)})),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]();w["\u0275\u0275property"]("formId",i.formId)("formModel",i.formModel)("formLayout",i.formLayout)("displaySubmit",i.displaySubmit)("displayCancel",!1)}}var tt,nt=((tt=function(e){c(n,e);var t=u(n);function n(e,i,o,s,r,c,l,u,d,p,m){var f;return a(this,n),(f=t.call(this,d,p,m)).changeDetectorRef=e,f.collectionDataService=i,f.formBuilderService=o,f.formOperationsService=s,f.formService=r,f.operationsBuilder=c,f.sectionService=l,f.submissionService=u,f.injectedCollectionId=d,f.injectedSectionData=p,f.injectedSubmissionId=m,f.formLayout=Xe,f.displaySubmit=!1,f.subs=[],f}return r(n,[{key:"onSectionInit",value:function(){var e=this;this.pathCombiner=new M.a("sections",this.sectionData.id),this.formId=this.formService.getUniqueId(this.sectionData.id),this.formModel=this.formBuilderService.fromJSON(Ze);var t=this.formBuilderService.findById("granted",this.formModel);t.value=this.sectionData.data.granted,this.licenseText$=this.collectionDataService.findById(this.collectionId,!0,!0,Object(J.a)("license")).pipe(Object(I.a)((function(e){return Object(D.h)(e.payload)})),Object(g.a)((function(e){return e.payload.license})),Object(S.a)((function(e){return Object(D.h)(e.payload)})),Object(v.a)((function(e){return e.payload.text})),Object(E.a)("")),this.subs.push(this.sectionService.isSectionReadOnly(this.submissionId,this.sectionData.id,this.submissionService.getSubmissionScope()).pipe(Object(x.a)(1),Object(I.a)((function(e){return e}))).subscribe((function(){t.disabled=!0})),this.sectionService.getSectionErrors(this.submissionId,this.sectionData.id).pipe(Object(I.a)((function(e){return Object(D.e)(e)})),Object(y.a)()).subscribe((function(n){var i=n.map((function(e){return"/sections/license"===e.path?t.checked?null:Object.assign({},e,{path:"/sections/license/granted"}):e})).filter((function(e){return Object(D.g)(e)}));Object(D.e)(i)?(e.sectionService.checkSectionErrors(e.submissionId,e.sectionData.id,e.formId,i),e.sectionData.errors=n):e.sectionService.dispatchRemoveSectionErrors(e.submissionId,e.sectionData.id),e.changeDetectorRef.detectChanges()})))}},{key:"getSectionStatus",value:function(){var e=this.formBuilderService.findById("granted",this.formModel);return e.valueChanges.pipe(Object(v.a)((function(e){return!0===e})),Object(E.a)(e.value))}},{key:"onChange",value:function(e){var t=this.formOperationsService.getFieldPathSegmentedFromChangeEvent(e),n=this.formOperationsService.getFieldValueFromChangeEvent(e);n?(this.operationsBuilder.add(this.pathCombiner.getPath(t),n.value.toString(),!1,!0),this.sectionService.dispatchRemoveSectionErrors(this.submissionId,this.sectionData.id)):this.operationsBuilder.remove(this.pathCombiner.getPath(t))}},{key:"onSectionDestroy",value:function(){this.subs.filter((function(e){return Object(D.b)(e)})).forEach((function(e){return e.unsubscribe()}))}}]),n}(k)).\u0275fac=function(e){return new(e||tt)(w["\u0275\u0275directiveInject"](w.ChangeDetectorRef),w["\u0275\u0275directiveInject"](we.a),w["\u0275\u0275directiveInject"](j.a),w["\u0275\u0275directiveInject"](R.a),w["\u0275\u0275directiveInject"](C.a),w["\u0275\u0275directiveInject"](Ke.a),w["\u0275\u0275directiveInject"]($.a),w["\u0275\u0275directiveInject"](T.a),w["\u0275\u0275directiveInject"]("collectionIdProvider"),w["\u0275\u0275directiveInject"]("sectionDataProvider"),w["\u0275\u0275directiveInject"]("submissionIdProvider"))},tt.\u0275cmp=w["\u0275\u0275defineComponent"]({type:tt,selectors:[["ds-submission-section-license"]],viewQuery:function(e,t){var n;1&e&&w["\u0275\u0275viewQuery"](We,!0),2&e&&w["\u0275\u0275queryRefresh"](n=w["\u0275\u0275loadQuery"]())&&(t.formRef=n.first)},features:[w["\u0275\u0275InheritDefinitionFeature"]],decls:9,vars:4,consts:[[1,"mb-5",3,"innerHTML"],[3,"formId","formModel","formLayout","displaySubmit","displayCancel","dfChange",4,"ngIf"],[3,"formId","formModel","formLayout","displaySubmit","displayCancel","dfChange"],["formRef","formComponent"]],template:function(e,t){1&e&&(w["\u0275\u0275element"](0,"span",0),w["\u0275\u0275pipe"](1,"async"),w["\u0275\u0275text"](2,"\n"),w["\u0275\u0275element"](3,"br"),w["\u0275\u0275text"](4," "),w["\u0275\u0275element"](5,"br"),w["\u0275\u0275text"](6,"\n"),w["\u0275\u0275template"](7,et,2,5,"ds-form",1),w["\u0275\u0275text"](8,"\n")),2&e&&(w["\u0275\u0275property"]("innerHTML",w["\u0275\u0275pipeBind1"](1,2,t.licenseText$),w["\u0275\u0275sanitizeHtml"]),w["\u0275\u0275advance"](7),w["\u0275\u0275property"]("ngIf",t.formModel))},directives:[Y.u,H.a],pipes:[Y.b],styles:[""]}),tt=Object(f.b)([Object(B.a)(V.a.License)],tt)),it=s("SCNa"),ot=s("SxV6"),at=s("fM99"),st=s("QOHy"),rt={id:"metadata",group:[]},ct={element:{container:"form-group",label:"col-form-label"},grid:{label:"col-sm-3"}},lt={id:"accessConditions",groupFactory:null},ut={grid:{group:"form-row"}},dt={id:"name",label:"submission.sections.upload.form.access-condition-label",options:[]},pt={element:{container:"p-0",label:"col-form-label"},grid:{host:"col-md-10"}},mt={id:"startDate",label:"submission.sections.upload.form.from-label",placeholder:"submission.sections.upload.form.from-placeholder",inline:!1,toggleIcon:"far fa-calendar-alt",relations:[{match:st.P,operator:st.Q,when:[]}],required:!0,validators:{required:null},errorMessages:{required:"submission.sections.upload.form.date-required"}},ft={element:{container:"p-0",label:"col-form-label"},grid:{host:"col-md-4"}},bt={id:"endDate",label:"submission.sections.upload.form.until-label",placeholder:"submission.sections.upload.form.until-placeholder",inline:!1,toggleIcon:"far fa-calendar-alt",relations:[{match:st.P,operator:st.Q,when:[]}],required:!0,validators:{required:null},errorMessages:{required:"submission.sections.upload.form.date-required"}},vt={element:{container:"p-0",label:"col-form-label"},grid:{host:"col-md-4"}},ht=["formRef"];function gt(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"ds-form",1,2),w["\u0275\u0275listener"]("dfChange",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"]().onChange(e)})),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]();w["\u0275\u0275property"]("formId",i.formId)("formModel",i.formModel)("displaySubmit",!1)("displayCancel",!1)}}var xt,St=((xt=function(){function e(t,n,i,o){a(this,e),this.cdr=t,this.formBuilderService=n,this.formService=i,this.submissionService=o}return r(e,[{key:"ngOnChanges",value:function(){this.fileData&&this.formId&&(this.formModel=this.buildFileEditForm(),this.cdr.detectChanges())}},{key:"buildFileEditForm",value:function(){var e=Object.assign({},this.configMetadataForm.rows[0].fields[0]);e.repeatable=!1;var n=Object.assign({},this.configMetadataForm,{fields:Object.assign([],this.configMetadataForm.rows[0].fields[0],[this.configMetadataForm.rows[0].fields[0],e])}),i=[],o=Object.assign({},rt);o.group=this.formBuilderService.modelFromConfiguration(this.submissionId,n,this.collectionId,this.fileData.metadata,this.submissionService.getSubmissionScope()),i.push(new st.C(o,ct));var a=Object.assign({},dt),s=Object.assign({},lt),r=[];if(2===this.collectionPolicyType){var c,l=t(this.availableAccessConditionOptions);try{for(l.s();!(c=l.n()).done;){var u=c.value;r.push({label:u.name,value:u.name})}}catch(v){l.e(v)}finally{l.f()}a.options=r;var d=[],p=[],m=[];this.availableAccessConditionOptions.forEach((function(e){var t=!0===e.hasStartDate,n=!0===e.hasEndDate,i=t||n;t&&d.push({id:"name",value:e.name}),n&&p.push({id:"name",value:e.name}),i&&m.push({id:"name",value:e.name})}));var f={relations:[{match:st.P,operator:st.Q,when:d}]},b={relations:[{match:st.P,operator:st.Q,when:p}]};s.groupFactory=function(){var e=new st.M(a,pt),t=Object.assign({},mt,f),n=Object.assign({},bt,b);return[e,new st.s(t,ft),new st.s(n,vt)]},s.initialCount=Object(D.e)(this.fileData.accessConditions)?this.fileData.accessConditions.length:1,i.push(new st.v(s,ut))}return this.initModelData(i),i}},{key:"initModelData",value:function(e){var t=this;this.fileData.accessConditions.forEach((function(n,i){Array.of("name","startDate","endDate").filter((function(e){return n.hasOwnProperty(e)})).forEach((function(o){var a=t.formBuilderService.findById(o,e,i);if(a)if(a.type===st.f){var s=new Date(n[o]);a.value={year:s.getFullYear(),month:s.getMonth()+1,day:s.getDate()}}else a.value=n[o]}))}))}},{key:"onChange",value:function(e){"name"===e.model.id&&this.setOptions(e.model,e.control)}},{key:"setOptions",value:function(e,t){var n=null;if(this.availableAccessConditionOptions.filter((function(e){return e.name===t.value})).forEach((function(e){return n=e})),Object(D.e)(n)){var i=!0===n.hasStartDate||!0===n.hasEndDate,o=t.parent.get("startDate"),a=t.parent.get("endDate");if(o.markAsUntouched(),a.markAsUntouched(),o.setValue(null),t.parent.markAsDirty(),a.setValue(null),i){if(n.hasStartDate){var s=this.formBuilderService.findById("startDate",e.parent.group),r=new Date(n.maxStartDate);s.max={year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()}}if(n.hasEndDate){var c=this.formBuilderService.findById("endDate",e.parent.group),l=new Date(n.maxEndDate);c.max={year:l.getFullYear(),month:l.getMonth()+1,day:l.getDate()}}}}}}]),e}()).\u0275fac=function(e){return new(e||xt)(w["\u0275\u0275directiveInject"](w.ChangeDetectorRef),w["\u0275\u0275directiveInject"](j.a),w["\u0275\u0275directiveInject"](C.a),w["\u0275\u0275directiveInject"](T.a))},xt.\u0275cmp=w["\u0275\u0275defineComponent"]({type:xt,selectors:[["ds-submission-section-upload-file-edit"]],viewQuery:function(e,t){var n;1&e&&w["\u0275\u0275viewQuery"](ht,!0),2&e&&w["\u0275\u0275queryRefresh"](n=w["\u0275\u0275loadQuery"]())&&(t.formRef=n.first)},inputs:{availableAccessConditionOptions:"availableAccessConditionOptions",collectionId:"collectionId",collectionPolicyType:"collectionPolicyType",configMetadataForm:"configMetadataForm",fileData:"fileData",fileId:"fileId",fileIndex:"fileIndex",formId:"formId",sectionId:"sectionId",submissionId:"submissionId"},features:[w["\u0275\u0275NgOnChangesFeature"]],decls:5,vars:1,consts:[[3,"formId","formModel","displaySubmit","displayCancel","dfChange",4,"ngIf"],[3,"formId","formModel","displaySubmit","displayCancel","dfChange"],["formRef","formComponent"]],template:function(e,t){1&e&&(w["\u0275\u0275elementStart"](0,"div"),w["\u0275\u0275text"](1,"\n  "),w["\u0275\u0275template"](2,gt,2,4,"ds-form",0),w["\u0275\u0275text"](3,"\n"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](4,"\n")),2&e&&(w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",t.formModel))},directives:[Y.u,H.a],encapsulation:2}),xt),yt=s("Oyu8"),It=s("G0yt"),Ot=s("/lGE"),jt=s("/eM4");function Ct(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"span",3),w["\u0275\u0275text"](1),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]().$implicit;w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate3"]("\n    ",n.name," ",n.startDate," ",n.endDate,"\n  ")}}function Et(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"span",3),w["\u0275\u0275text"](1),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]().$implicit;w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate2"]("",n.name," from ",n.endDate,"")}}function Dt(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"span",4),w["\u0275\u0275text"](1),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]().$implicit;w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate2"]("",n.name," until ",n.startDate,"")}}function wt(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n  "),w["\u0275\u0275template"](2,Ct,2,3,"span",1),w["\u0275\u0275text"](3,"\n  "),w["\u0275\u0275template"](4,Et,2,2,"span",1),w["\u0275\u0275text"](5,"\n  "),w["\u0275\u0275template"](6,Dt,2,2,"span",2),w["\u0275\u0275text"](7,"\n  "),w["\u0275\u0275element"](8,"br"),w["\u0275\u0275text"](9,"\n"),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit;w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf","DEFAULT_BITSTREAM_READ"==n.action),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf","lease"==n.name),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf","embargo"==n.name)}}var kt,Ft=((kt=function(){function e(t){a(this,e),this.groupService=t,this.accessConditionsList=[]}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.accessConditions.forEach((function(t){Object(D.d)(t.name)?e.groupService.findByHref(t._links.group.href).pipe(Object(S.a)((function(e){return!e.isResponsePending&&e.hasSucceeded}))).subscribe((function(n){var i=n.payload,o=Object.assign({},t);o.name=i.name,e.accessConditionsList.push(o)})):e.accessConditionsList.push(t)}))}}]),e}()).\u0275fac=function(e){return new(e||kt)(w["\u0275\u0275directiveInject"](ke.a))},kt.\u0275cmp=w["\u0275\u0275defineComponent"]({type:kt,selectors:[["ds-submission-section-upload-access-conditions"]],inputs:{accessConditions:"accessConditions"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["class","badge badge-primary mt-3 mr-2",4,"ngIf"],["class","badge badge-dark mt-3 mr-2",4,"ngIf"],[1,"badge","badge-primary","mt-3","mr-2"],[1,"badge","badge-dark","mt-3","mr-2"]],template:function(e,t){1&e&&(w["\u0275\u0275template"](0,wt,10,3,"ng-container",0),w["\u0275\u0275text"](1,"\n")),2&e&&w["\u0275\u0275property"]("ngForOf",t.accessConditionsList)},directives:[Y.t,Y.u],encapsulation:2}),kt),Mt=s("BCqK");function Lt(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n        "),w["\u0275\u0275elementStart"](2,"h5"),w["\u0275\u0275text"](3),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](4,"\n      "),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]().$implicit;w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate1"]("\n          ",n.value,"\n        ")}}function Bt(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"h5"),w["\u0275\u0275text"](1,"\n          "),w["\u0275\u0275elementStart"](2,"span",4),w["\u0275\u0275text"](3),w["\u0275\u0275pipe"](4,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](5,"\n        "),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"](4);w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate2"]("",w["\u0275\u0275pipeBind1"](4,2,"submission.sections.upload.no-entry")," ",n.fileTitleKey,"")}}function Vt(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n        "),w["\u0275\u0275template"](2,Bt,6,4,"h5",0),w["\u0275\u0275text"](3,"\n      "),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]().$implicit,i=w["\u0275\u0275nextContext"](2);w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",0===i.metadata[i.fileTitleKey].indexOf(n))}}function Tt(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n      "),w["\u0275\u0275template"](2,Lt,5,1,"ng-container",0),w["\u0275\u0275text"](3,"\n      "),w["\u0275\u0275template"](4,Vt,4,1,"ng-container",0),w["\u0275\u0275text"](5,"\n      "),w["\u0275\u0275element"](6,"span",1),w["\u0275\u0275text"](7,"\n    "),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit;w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",""!==n.value),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",""===n.value)}}var Rt=function(){return["150"]};function Pt(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1),w["\u0275\u0275pipe"](2,"dsTruncate"),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]().$implicit;w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n          ",w["\u0275\u0275pipeBind2"](2,1,n.value,w["\u0275\u0275pureFunction0"](4,Rt)),"\n      ")}}function $t(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"span",4),w["\u0275\u0275text"](1),w["\u0275\u0275pipe"](2,"translate"),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"](4);w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate2"]("",w["\u0275\u0275pipeBind1"](2,2,"submission.sections.upload.no-entry")," ",n.fileDescrKey,"")}}function At(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n        "),w["\u0275\u0275template"](2,$t,3,4,"span",5),w["\u0275\u0275text"](3,"\n      "),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]().$implicit,i=w["\u0275\u0275nextContext"](2);w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",0===i.metadata[i.fileDescrKey].indexOf(n))}}function _t(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n      "),w["\u0275\u0275template"](2,Pt,3,5,"ng-container",0),w["\u0275\u0275text"](3,"\n      "),w["\u0275\u0275template"](4,At,4,1,"ng-container",0),w["\u0275\u0275text"](5,"\n      "),w["\u0275\u0275element"](6,"span",1),w["\u0275\u0275text"](7,"\n    "),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit;w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",""!==n.value),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",""===n.value)}}function Nt(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n    "),w["\u0275\u0275template"](2,Tt,8,2,"ng-container",3),w["\u0275\u0275text"](3,"\n    "),w["\u0275\u0275template"](4,_t,8,2,"ng-container",3),w["\u0275\u0275text"](5,"\n  "),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngForOf",n.getAllMetadataValue(n.fileTitleKey)),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngForOf",n.getAllMetadataValue(n.fileDescrKey))}}var qt,Ut=((qt=function(){function e(){a(this,e),this.metadata=Object.create({}),this.fileTitleKey="Title",this.fileDescrKey="Description"}return r(e,[{key:"ngOnInit",value:function(){Object(D.e)(this.fileData.metadata)&&(this.metadata[this.fileTitleKey]=jt.a.all(this.fileData.metadata,"dc.title"),this.metadata[this.fileDescrKey]=jt.a.all(this.fileData.metadata,"dc.description"))}},{key:"getAllMetadataValue",value:function(e){return jt.a.all(this.metadata,e)}}]),e}()).\u0275fac=function(e){return new(e||qt)},qt.\u0275cmp=w["\u0275\u0275defineComponent"]({type:qt,selectors:[["ds-submission-section-upload-file-view"]],inputs:{fileData:"fileData"},decls:9,vars:2,consts:[[4,"ngIf"],[1,"clearfix"],[3,"accessConditions"],[4,"ngFor","ngForOf"],[1,"text-muted"],["class","text-muted",4,"ngIf"]],template:function(e,t){1&e&&(w["\u0275\u0275elementStart"](0,"div"),w["\u0275\u0275text"](1,"\n  "),w["\u0275\u0275template"](2,Nt,6,2,"ng-container",0),w["\u0275\u0275text"](3,"\n\n  "),w["\u0275\u0275element"](4,"span",1),w["\u0275\u0275text"](5,"\n  "),w["\u0275\u0275element"](6,"ds-submission-section-upload-access-conditions",2),w["\u0275\u0275text"](7,"\n"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](8,"\n")),2&e&&(w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",t.metadata),w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("accessConditions",t.fileData.accessConditions))},directives:[Y.u,Ft,Y.t],pipes:[Q.e,Mt.a],encapsulation:2}),qt),Jt=s("t8/W");function Gt(e,t){1&e&&w["\u0275\u0275element"](0,"i",18)}function Qt(e,t){1&e&&w["\u0275\u0275element"](0,"i",19)}function Yt(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n          "),w["\u0275\u0275elementStart"](2,"button",12),w["\u0275\u0275listener"]("click",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"](2).downloadBitstreamFile(),e.stopPropagation()})),w["\u0275\u0275element"](3,"i",13),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](4,"\n          "),w["\u0275\u0275text"](5,"\n          "),w["\u0275\u0275elementStart"](6,"button",12),w["\u0275\u0275listener"]("click",(function(e){w["\u0275\u0275restoreView"](n);var t=w["\u0275\u0275nextContext"](2);return e.preventDefault(),t.switchMode()})),w["\u0275\u0275element"](7,"i",14),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](8,"\n          "),w["\u0275\u0275elementStart"](9,"button",15),w["\u0275\u0275listener"]("click",(function(e){w["\u0275\u0275restoreView"](n);var t=w["\u0275\u0275nextContext"](2),i=w["\u0275\u0275reference"](3);return e.preventDefault(),t.confirmDelete(i)})),w["\u0275\u0275pipe"](10,"translate"),w["\u0275\u0275pipe"](11,"async"),w["\u0275\u0275text"](12,"\n            "),w["\u0275\u0275template"](13,Gt,1,0,"i",16),w["\u0275\u0275pipe"](14,"async"),w["\u0275\u0275text"](15,"\n            "),w["\u0275\u0275template"](16,Qt,1,0,"i",17),w["\u0275\u0275pipe"](17,"async"),w["\u0275\u0275text"](18,"\n          "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](19,"\n        "),w["\u0275\u0275elementContainerEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"](2);w["\u0275\u0275advance"](9),w["\u0275\u0275propertyInterpolate"]("title",w["\u0275\u0275pipeBind1"](10,4,"submission.sections.upload.delete.confirm.title")),w["\u0275\u0275property"]("disabled",w["\u0275\u0275pipeBind1"](11,6,i.processingDelete$)),w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("ngIf",w["\u0275\u0275pipeBind1"](14,8,i.processingDelete$)),w["\u0275\u0275advance"](3),w["\u0275\u0275property"]("ngIf",!w["\u0275\u0275pipeBind1"](17,10,i.processingDelete$))}}function zt(e,t){1&e&&w["\u0275\u0275element"](0,"i",18)}function Ht(e,t){1&e&&w["\u0275\u0275element"](0,"i",19)}function Kt(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n          "),w["\u0275\u0275elementStart"](2,"button",20),w["\u0275\u0275listener"]("click",(function(e){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"](2).saveBitstreamData(e)})),w["\u0275\u0275pipe"](3,"translate"),w["\u0275\u0275element"](4,"i",21),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](5,"\n          "),w["\u0275\u0275elementStart"](6,"button",20),w["\u0275\u0275listener"]("click",(function(e){w["\u0275\u0275restoreView"](n);var t=w["\u0275\u0275nextContext"](2);return e.preventDefault(),t.switchMode()})),w["\u0275\u0275pipe"](7,"translate"),w["\u0275\u0275element"](8,"i",22),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](9,"\n          "),w["\u0275\u0275elementStart"](10,"button",15),w["\u0275\u0275listener"]("click",(function(e){w["\u0275\u0275restoreView"](n);var t=w["\u0275\u0275nextContext"](2),i=w["\u0275\u0275reference"](3);return e.preventDefault(),t.confirmDelete(i)})),w["\u0275\u0275pipe"](11,"translate"),w["\u0275\u0275pipe"](12,"async"),w["\u0275\u0275text"](13,"\n            "),w["\u0275\u0275template"](14,zt,1,0,"i",16),w["\u0275\u0275pipe"](15,"async"),w["\u0275\u0275text"](16,"\n            "),w["\u0275\u0275template"](17,Ht,1,0,"i",17),w["\u0275\u0275pipe"](18,"async"),w["\u0275\u0275text"](19,"\n          "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](20,"\n        "),w["\u0275\u0275elementContainerEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"](2);w["\u0275\u0275advance"](2),w["\u0275\u0275propertyInterpolate"]("title",w["\u0275\u0275pipeBind1"](3,6,"submission.sections.upload.save-metadata")),w["\u0275\u0275advance"](4),w["\u0275\u0275propertyInterpolate"]("title",w["\u0275\u0275pipeBind1"](7,8,"submission.sections.upload.undo")),w["\u0275\u0275advance"](4),w["\u0275\u0275propertyInterpolate"]("title",w["\u0275\u0275pipeBind1"](11,10,"submission.sections.upload.delete.confirm.title")),w["\u0275\u0275property"]("disabled",w["\u0275\u0275pipeBind1"](12,12,i.processingDelete$)),w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("ngIf",w["\u0275\u0275pipeBind1"](15,14,i.processingDelete$)),w["\u0275\u0275advance"](3),w["\u0275\u0275property"]("ngIf",!w["\u0275\u0275pipeBind1"](18,16,i.processingDelete$))}}function Xt(e,t){if(1&e&&w["\u0275\u0275element"](0,"ds-submission-section-upload-file-view",23),2&e){var n=w["\u0275\u0275nextContext"](2);w["\u0275\u0275property"]("fileData",n.fileData)}}function Zt(e,t){if(1&e&&w["\u0275\u0275element"](0,"ds-submission-section-upload-file-edit",24),2&e){var n=w["\u0275\u0275nextContext"](2);w["\u0275\u0275property"]("availableAccessConditionOptions",n.availableAccessConditionOptions)("collectionId",n.collectionId)("collectionPolicyType",n.collectionPolicyType)("configMetadataForm",n.configMetadataForm)("fileData",n.fileData)("fileId",n.fileId)("fileIndex",n.fileIndex)("formId",n.formId)("sectionId",n.sectionId)}}function Wt(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n  "),w["\u0275\u0275elementStart"](2,"div",2),w["\u0275\u0275text"](3,"\n    "),w["\u0275\u0275elementStart"](4,"div",3),w["\u0275\u0275text"](5,"\n      "),w["\u0275\u0275text"](6,"\n      "),w["\u0275\u0275element"](7,"ds-thumbnail",4),w["\u0275\u0275text"](8,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](9,"\n    "),w["\u0275\u0275elementStart"](10,"div",5),w["\u0275\u0275text"](11,"\n      "),w["\u0275\u0275elementStart"](12,"div",6),w["\u0275\u0275text"](13,"\n        "),w["\u0275\u0275elementStart"](14,"h3"),w["\u0275\u0275text"](15),w["\u0275\u0275elementStart"](16,"span",7),w["\u0275\u0275text"](17),w["\u0275\u0275pipe"](18,"dsFileSize"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](19,"\n      "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](20,"\n      "),w["\u0275\u0275elementStart"](21,"div",8),w["\u0275\u0275text"](22,"\n        "),w["\u0275\u0275template"](23,Yt,20,12,"ng-container",0),w["\u0275\u0275text"](24,"\n        "),w["\u0275\u0275template"](25,Kt,21,18,"ng-container",0),w["\u0275\u0275text"](26,"\n      "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](27,"\n      "),w["\u0275\u0275element"](28,"div",9),w["\u0275\u0275text"](29,"\n      "),w["\u0275\u0275template"](30,Xt,1,1,"ds-submission-section-upload-file-view",10),w["\u0275\u0275text"](31,"\n      "),w["\u0275\u0275template"](32,Zt,1,9,"ds-submission-section-upload-file-edit",11),w["\u0275\u0275text"](33,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](34,"\n  "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](35,"\n"),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](7),w["\u0275\u0275property"]("thumbnail",null==n.fileData?null:n.fileData.thumbnail),w["\u0275\u0275advance"](8),w["\u0275\u0275textInterpolate1"]("",n.fileName," "),w["\u0275\u0275advance"](2),w["\u0275\u0275textInterpolate1"]("(",w["\u0275\u0275pipeBind1"](18,9,null==n.fileData?null:n.fileData.sizeBytes),")"),w["\u0275\u0275advance"](4),w["\u0275\u0275classProp"]("sticky-buttons",!n.readMode),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",n.readMode),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",!n.readMode),w["\u0275\u0275advance"](5),w["\u0275\u0275property"]("ngIf",n.readMode),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",!n.readMode)}}function en(e,t){1&e&&(w["\u0275\u0275text"](0,"\n  "),w["\u0275\u0275elementStart"](1,"div",25),w["\u0275\u0275text"](2,"\n    "),w["\u0275\u0275elementStart"](3,"h4",26),w["\u0275\u0275text"](4),w["\u0275\u0275pipe"](5,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](6,"\n    "),w["\u0275\u0275elementStart"](7,"button",27),w["\u0275\u0275listener"]("click",(function(){return(0,t.dismiss)("cancel")})),w["\u0275\u0275text"](8,"\n      "),w["\u0275\u0275elementStart"](9,"span",28),w["\u0275\u0275text"](10,"\xd7"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](11,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](12,"\n  "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](13,"\n  "),w["\u0275\u0275elementStart"](14,"div",29),w["\u0275\u0275text"](15,"\n    "),w["\u0275\u0275elementStart"](16,"p"),w["\u0275\u0275text"](17),w["\u0275\u0275pipe"](18,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](19,"\n  "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](20,"\n  "),w["\u0275\u0275elementStart"](21,"div",30),w["\u0275\u0275text"](22,"\n    "),w["\u0275\u0275elementStart"](23,"button",31),w["\u0275\u0275listener"]("click",(function(){return(0,t.close)("cancel")})),w["\u0275\u0275text"](24),w["\u0275\u0275pipe"](25,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](26,"\n    "),w["\u0275\u0275elementStart"](27,"button",32),w["\u0275\u0275listener"]("click",(function(){return(0,t.close)("ok")})),w["\u0275\u0275text"](28),w["\u0275\u0275pipe"](29,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](30,"\n  "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](31,"\n")),2&e&&(w["\u0275\u0275advance"](4),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](5,4,"submission.sections.upload.delete.confirm.title")),w["\u0275\u0275advance"](13),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](18,6,"submission.sections.upload.delete.confirm.info")),w["\u0275\u0275advance"](7),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](25,8,"submission.sections.upload.delete.confirm.cancel")),w["\u0275\u0275advance"](4),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](29,10,"submission.sections.upload.delete.confirm.submit")))}var tn,nn=((tn=function(){function e(t,n,i,o,s,r,c,l,u){a(this,e),this.cdr=t,this.fileService=n,this.formService=i,this.halService=o,this.modalService=s,this.operationsBuilder=r,this.operationsService=c,this.submissionService=l,this.uploadService=u,this.processingDelete$=new Ce.a(!1),this.subscriptions=[],this.readMode=!0}return r(e,[{key:"ngOnChanges",value:function(){var e=this;this.availableAccessConditionOptions&&this.subscriptions.push(this.uploadService.getFileData(this.submissionId,this.sectionId,this.fileId).pipe(Object(I.a)((function(e){return Object(D.h)(e)}))).subscribe((function(t){e.fileData=t})))}},{key:"ngOnInit",value:function(){this.formId=this.formService.getUniqueId(this.fileId),this.pathCombiner=new M.a("sections",this.sectionId,"files",this.fileIndex)}},{key:"deleteFile",value:function(){var e=this;this.operationsBuilder.remove(this.pathCombiner.getPath()),this.subscriptions.push(this.operationsService.jsonPatchByResourceID(this.submissionService.getSubmissionObjectLinkName(),this.submissionId,this.pathCombiner.rootElement,this.pathCombiner.subRootElement).subscribe((function(){e.uploadService.removeUploadedFile(e.submissionId,e.sectionId,e.fileId),e.processingDelete$.next(!1)})))}},{key:"confirmDelete",value:function(e){var t=this;this.modalService.open(e).result.then((function(e){"ok"===e&&(t.processingDelete$.next(!0),t.deleteFile())}))}},{key:"downloadBitstreamFile",value:function(){var e=this;this.halService.getEndpoint("bitstreams").pipe(Object(ot.a)()).subscribe((function(t){e.fileService.retrieveFileDownloadLink("".concat(t,"/").concat(e.fileData.uuid,"/content"))}))}},{key:"saveBitstreamData",value:function(e){var t=this;e.preventDefault(),this.formService.validateAllFormFields(this.fileEditComp.formRef.formGroup),this.subscriptions.push(this.formService.isValid(this.formId).pipe(Object(x.a)(1),Object(I.a)((function(e){return e})),Object(g.a)((function(){return t.formService.getFormData(t.formId)})),Object(x.a)(1),Object(g.a)((function(e){Object.keys(e.metadata).filter((function(t){return Object(D.e)(e.metadata[t])})).forEach((function(n){var i=n.replace(/_/g,".");t.operationsBuilder.add(t.pathCombiner.getPath("metadata/".concat(i)),e.metadata[n],!0)}));var n=[];return e.accessConditions.filter((function(e){return Object(D.e)(e)})).forEach((function(e){var i;if(t.availableAccessConditionOptions.filter((function(t){return Object(D.g)(e.name)&&t.name===e.name[0].value})).forEach((function(e){return i=e})),i){if((i=Object.assign({},e)).name=t.retrieveValueFromField(e.name),e.startDate){var o=t.retrieveValueFromField(e.startDate);i.startDate=Object(at.a)(o)}if(e.endDate){var a=t.retrieveValueFromField(e.endDate);i.endDate=Object(at.a)(a)}n.push(i)}})),Object(D.e)(n)&&t.operationsBuilder.add(t.pathCombiner.getPath("accessConditions"),n,!0),t.operationsService.jsonPatchByResourceID(t.submissionService.getSubmissionObjectLinkName(),t.submissionId,t.pathCombiner.rootElement,t.pathCombiner.subRootElement)}))).subscribe((function(e){e[0].sections.upload&&Object.keys(e[0].sections.upload.files).filter((function(n){return e[0].sections.upload.files[n].uuid===t.fileId})).forEach((function(n){return t.uploadService.updateFileData(t.submissionId,t.sectionId,t.fileId,e[0].sections.upload.files[n])})),t.switchMode()})))}},{key:"retrieveValueFromField",value:function(e){var t=Array.isArray(e)?e[0]:e;return t?t.value:void 0}},{key:"switchMode",value:function(){this.readMode=!this.readMode,this.cdr.detectChanges()}}]),e}()).\u0275fac=function(e){return new(e||tn)(w["\u0275\u0275directiveInject"](w.ChangeDetectorRef),w["\u0275\u0275directiveInject"](yt.a),w["\u0275\u0275directiveInject"](C.a),w["\u0275\u0275directiveInject"](Le.a),w["\u0275\u0275directiveInject"](It.u),w["\u0275\u0275directiveInject"](Ke.a),w["\u0275\u0275directiveInject"](ge.a),w["\u0275\u0275directiveInject"](T.a),w["\u0275\u0275directiveInject"](De))},tn.\u0275cmp=w["\u0275\u0275defineComponent"]({type:tn,selectors:[["ds-submission-upload-section-file"]],viewQuery:function(e,t){var n;1&e&&w["\u0275\u0275viewQuery"](St,!0),2&e&&w["\u0275\u0275queryRefresh"](n=w["\u0275\u0275loadQuery"]())&&(t.fileEditComp=n.first)},inputs:{availableAccessConditionOptions:"availableAccessConditionOptions",collectionId:"collectionId",collectionPolicyType:"collectionPolicyType",configMetadataForm:"configMetadataForm",fileId:"fileId",fileIndex:"fileIndex",fileName:"fileName",sectionId:"sectionId",submissionId:"submissionId"},features:[w["\u0275\u0275NgOnChangesFeature"]],decls:5,vars:1,consts:[[4,"ngIf"],["content",""],[1,"row"],[1,"col-md-2"],[3,"thumbnail"],[1,"col-md-10"],[1,"float-left","w-75"],[1,"text-muted"],[1,"float-right","w-15"],[1,"clearfix"],[3,"fileData",4,"ngIf"],[3,"availableAccessConditionOptions","collectionId","collectionPolicyType","configMetadataForm","fileData","fileId","fileIndex","formId","sectionId",4,"ngIf"],[1,"btn","btn-link",3,"click"],["aria-hidden","true",1,"fa","fa-download","fa-2x","text-normal"],[1,"fa","fa-edit","fa-2x","text-normal"],[1,"btn","btn-link",3,"title","disabled","click"],["class","fas fa-circle-notch fa-spin fa-2x text-danger",4,"ngIf"],["class","fa fa-trash fa-2x text-danger",4,"ngIf"],[1,"fas","fa-circle-notch","fa-spin","fa-2x","text-danger"],[1,"fa","fa-trash","fa-2x","text-danger"],[1,"btn","btn-link",3,"title","click"],[1,"fa","fa-save","fa-2x","text-success"],[1,"fa","fa-ban","fa-2x","text-warning"],[3,"fileData"],[3,"availableAccessConditionOptions","collectionId","collectionPolicyType","configMetadataForm","fileData","fileId","fileIndex","formId","sectionId"],[1,"modal-header"],[1,"modal-title","text-danger"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(e,t){1&e&&(w["\u0275\u0275template"](0,Wt,36,11,"ng-container",0),w["\u0275\u0275text"](1,"\n\n"),w["\u0275\u0275template"](2,en,32,12,"ng-template",null,1,w["\u0275\u0275templateRefExtractor"]),w["\u0275\u0275text"](4,"\n")),2&e&&w["\u0275\u0275property"]("ngIf",t.fileData)},directives:[Y.u,Ot.a,Ut,St],pipes:[Jt.a,Q.e,Y.b],styles:[".sticky-buttons[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:calc(var(--bs-dropdown-item-padding-x) * 3);z-index:var(--ds-submission-footer-z-index);background-color:hsla(0,0%,100%,.97)}"]}),tn),on=s("THnG"),an=s("a318"),sn=s("RMpN"),rn=s("3cpT"),cn=s("20cJ"),ln=s("6c/T"),un=s("8U9A"),dn=s("UXhX"),pn=s("8aB6"),mn=s("O/5o");function fn(e,t){1&e&&(w["\u0275\u0275elementStart"](0,"span"),w["\u0275\u0275text"](1,"\n        "),w["\u0275\u0275element"](2,"ds-loading"),w["\u0275\u0275text"](3,"\n      "),w["\u0275\u0275elementEnd"]())}function bn(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"span"),w["\u0275\u0275text"](1),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n        ",n.getSelectedCcLicense().name,"\n      ")}}function vn(e,t){1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1),w["\u0275\u0275pipe"](2,"translate"),w["\u0275\u0275elementContainerEnd"]()),2&e&&(w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n          ",w["\u0275\u0275pipeBind1"](2,1,"submission.sections.ccLicense.change"),"\n        "))}function hn(e,t){1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1),w["\u0275\u0275pipe"](2,"translate"),w["\u0275\u0275elementContainerEnd"]()),2&e&&(w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n          ",w["\u0275\u0275pipeBind1"](2,1,"submission.sections.ccLicense.select"),"\n        "))}function gn(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"span"),w["\u0275\u0275text"](1,"\n        "),w["\u0275\u0275template"](2,vn,3,3,"ng-container",3),w["\u0275\u0275text"](3,"\n        "),w["\u0275\u0275template"](4,hn,3,3,"ng-container",3),w["\u0275\u0275text"](5,"\n      "),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",n.storedCcLicenseLink),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",!n.storedCcLicenseLink)}}function xn(e,t){1&e&&(w["\u0275\u0275elementStart"](0,"button",7),w["\u0275\u0275text"](1),w["\u0275\u0275pipe"](2,"translate"),w["\u0275\u0275elementEnd"]()),2&e&&(w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n        ",w["\u0275\u0275pipeBind1"](2,1,"submission.sections.ccLicense.none"),"\n      "))}function Sn(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"button",8),w["\u0275\u0275listener"]("click",(function(){w["\u0275\u0275restoreView"](n);var e=t.$implicit;return w["\u0275\u0275nextContext"]().selectCcLicense(e)})),w["\u0275\u0275text"](1),w["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n        ",i.name,"\n      ")}}function yn(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"div",10),w["\u0275\u0275text"](1,"\n            "),w["\u0275\u0275elementStart"](2,"h5"),w["\u0275\u0275text"](3),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](4,"\n            "),w["\u0275\u0275element"](5,"div",20),w["\u0275\u0275text"](6,"\n          "),w["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate1"]("\n              ",n.label,"\n            "),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("innerHTML",n.description,w["\u0275\u0275sanitizeHtml"])}}function In(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275text"](0,"\n\n      "),w["\u0275\u0275elementStart"](1,"div"),w["\u0275\u0275text"](2,"\n\n        "),w["\u0275\u0275elementStart"](3,"div",15),w["\u0275\u0275text"](4,"\n          "),w["\u0275\u0275elementStart"](5,"div"),w["\u0275\u0275text"](6,"\n            "),w["\u0275\u0275elementStart"](7,"h4"),w["\u0275\u0275text"](8),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](9,"\n            "),w["\u0275\u0275element"](10,"div",16),w["\u0275\u0275text"](11,"\n          "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](12,"\n          "),w["\u0275\u0275elementStart"](13,"button",17),w["\u0275\u0275listener"]("click",(function(){return w["\u0275\u0275restoreView"](n),w["\u0275\u0275nextContext"](3).closeInfoModal()})),w["\u0275\u0275text"](14,"\n            "),w["\u0275\u0275elementStart"](15,"span",18),w["\u0275\u0275text"](16,"\xd7"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](17,"\n          "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](18,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](19,"\n\n        "),w["\u0275\u0275elementStart"](20,"div",19),w["\u0275\u0275text"](21,"\n          "),w["\u0275\u0275template"](22,yn,7,2,"div",9),w["\u0275\u0275text"](23,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](24,"\n\n      "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](25,"\n\n    ")}if(2&e){var i=w["\u0275\u0275nextContext"]().$implicit;w["\u0275\u0275advance"](8),w["\u0275\u0275textInterpolate1"]("\n              ",i.label,"\n            "),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("innerHTML",i.description,w["\u0275\u0275sanitizeHtml"]),w["\u0275\u0275advance"](12),w["\u0275\u0275property"]("ngForOf",i.enums)}}function On(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"span"),w["\u0275\u0275text"](1),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]().ngVar;w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n          ",n.label,"\n        ")}}function jn(e,t){1&e&&(w["\u0275\u0275elementStart"](0,"span"),w["\u0275\u0275text"](1),w["\u0275\u0275pipe"](2,"translate"),w["\u0275\u0275elementEnd"]()),2&e&&(w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n          ",w["\u0275\u0275pipeBind1"](2,1,"submission.sections.ccLicense.option.select"),"\n        "))}function Cn(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0,2),w["\u0275\u0275text"](1,"\n        "),w["\u0275\u0275template"](2,On,2,1,"span",3),w["\u0275\u0275text"](3,"\n        "),w["\u0275\u0275template"](4,jn,3,3,"span",3),w["\u0275\u0275text"](5,"\n      "),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar;w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",n),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",!n)}}function En(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"button",8),w["\u0275\u0275listener"]("click",(function(){w["\u0275\u0275restoreView"](n);var e=t.$implicit,i=w["\u0275\u0275nextContext"](2).$implicit,o=w["\u0275\u0275nextContext"](2);return o.selectOption(o.getSelectedCcLicense(),i,e)})),w["\u0275\u0275text"](1),w["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n            ",i.label,"\n          ")}}function Dn(e,t){if(1&e&&(w["\u0275\u0275elementStart"](0,"ds-select"),w["\u0275\u0275text"](1,"\n      "),w["\u0275\u0275template"](2,Cn,6,2,"ng-container",21),w["\u0275\u0275text"](3,"\n      "),w["\u0275\u0275elementContainerStart"](4,4),w["\u0275\u0275text"](5,"\n        "),w["\u0275\u0275elementStart"](6,"div",22),w["\u0275\u0275text"](7,"\n          "),w["\u0275\u0275template"](8,En,2,1,"button",6),w["\u0275\u0275text"](9,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](10,"\n      "),w["\u0275\u0275elementContainerEnd"](),w["\u0275\u0275text"](11,"\n    "),w["\u0275\u0275elementEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]().$implicit,i=w["\u0275\u0275nextContext"](2);w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngVar",i.getSelectedOption(i.getSelectedCcLicense(),n)),w["\u0275\u0275advance"](6),w["\u0275\u0275property"]("ngForOf",n.enums)}}function wn(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"div",24),w["\u0275\u0275text"](1,"\n        "),w["\u0275\u0275elementStart"](2,"div",25),w["\u0275\u0275listener"]("click",(function(){w["\u0275\u0275restoreView"](n);var e=t.$implicit,i=w["\u0275\u0275nextContext"](2).$implicit,o=w["\u0275\u0275nextContext"](2);return o.selectOption(o.getSelectedCcLicense(),i,e)})),w["\u0275\u0275text"](3,"\n          "),w["\u0275\u0275element"](4,"input",26),w["\u0275\u0275text"](5,"\n          "),w["\u0275\u0275elementStart"](6,"span"),w["\u0275\u0275text"](7),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](8,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](9,"\n      "),w["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,o=w["\u0275\u0275nextContext"](2).$implicit,a=w["\u0275\u0275nextContext"](2);w["\u0275\u0275advance"](4),w["\u0275\u0275propertyInterpolate"]("title",i.label),w["\u0275\u0275property"]("checked",a.isSelectedOption(a.getSelectedCcLicense(),o,i)),w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate"](i.label)}}function kn(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n      "),w["\u0275\u0275template"](2,wn,10,3,"div",23),w["\u0275\u0275text"](3,"\n    "),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]().$implicit;w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngForOf",n.enums)}}function Fn(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"div",10),w["\u0275\u0275text"](1,"\n\n    "),w["\u0275\u0275elementStart"](2,"div",11),w["\u0275\u0275text"](3,"\n      "),w["\u0275\u0275elementStart"](4,"div"),w["\u0275\u0275text"](5),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](6,"\n      "),w["\u0275\u0275elementStart"](7,"button",12),w["\u0275\u0275listener"]("click",(function(){w["\u0275\u0275restoreView"](n);var e=w["\u0275\u0275reference"](14);return w["\u0275\u0275nextContext"](2).openInfoModal(e)})),w["\u0275\u0275text"](8,"\n        "),w["\u0275\u0275element"](9,"i",13),w["\u0275\u0275text"](10,"\n      "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](11,"\n    "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](12,"\n\n    "),w["\u0275\u0275template"](13,In,26,3,"ng-template",null,14,w["\u0275\u0275templateRefExtractor"]),w["\u0275\u0275text"](15,"\n\n    "),w["\u0275\u0275template"](16,Dn,12,2,"ds-select",3),w["\u0275\u0275text"](17,"\n\n    "),w["\u0275\u0275template"](18,kn,4,1,"ng-container",3),w["\u0275\u0275text"](19,"\n\n  "),w["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;w["\u0275\u0275advance"](4),w["\u0275\u0275classMapInterpolate1"]("font-weight-bold ",i.id,""),w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n        ",i.label,"\n      "),w["\u0275\u0275advance"](11),w["\u0275\u0275property"]("ngIf",(null==i.enums?null:i.enums.length)>5),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",(null==i.enums?null:i.enums.length)<=5)}}function Mn(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n\n  "),w["\u0275\u0275template"](2,Fn,20,6,"div",9),w["\u0275\u0275text"](3,"\n\n"),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngForOf",n.getSelectedCcLicense().fields)}}function Ln(e,t){1&e&&(w["\u0275\u0275elementStart"](0,"div"),w["\u0275\u0275text"](1,"\n      "),w["\u0275\u0275element"](2,"ds-loading"),w["\u0275\u0275text"](3,"\n    "),w["\u0275\u0275elementEnd"]())}function Bn(e,t){if(1&e){var n=w["\u0275\u0275getCurrentView"]();w["\u0275\u0275elementStart"](0,"div",29),w["\u0275\u0275text"](1,"\n      "),w["\u0275\u0275elementStart"](2,"div"),w["\u0275\u0275text"](3),w["\u0275\u0275pipe"](4,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](5,"\n      "),w["\u0275\u0275elementStart"](6,"a",30),w["\u0275\u0275text"](7),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](8,"\n      "),w["\u0275\u0275elementStart"](9,"div",31),w["\u0275\u0275text"](10,"\n        "),w["\u0275\u0275elementStart"](11,"div",25),w["\u0275\u0275listener"]("click",(function(){w["\u0275\u0275restoreView"](n);var e=w["\u0275\u0275nextContext"](3);return e.setAccepted(!e.accepted)})),w["\u0275\u0275text"](12,"\n          "),w["\u0275\u0275element"](13,"input",32),w["\u0275\u0275text"](14,"\n          "),w["\u0275\u0275elementStart"](15,"span"),w["\u0275\u0275text"](16),w["\u0275\u0275pipe"](17,"translate"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](18,"\n        "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](19,"\n      "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](20,"\n    "),w["\u0275\u0275elementEnd"]()}if(2&e){var i=w["\u0275\u0275nextContext"]().ngVar,o=w["\u0275\u0275nextContext"](2);w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate1"]("\n        ",w["\u0275\u0275pipeBind1"](4,5,"submission.sections.ccLicense.link"),"\n      "),w["\u0275\u0275advance"](3),w["\u0275\u0275propertyInterpolate"]("href",i,w["\u0275\u0275sanitizeUrl"]),w["\u0275\u0275advance"](1),w["\u0275\u0275textInterpolate1"]("\n        ",i,"\n      "),w["\u0275\u0275advance"](6),w["\u0275\u0275property"]("checked",o.accepted),w["\u0275\u0275advance"](3),w["\u0275\u0275textInterpolate"](w["\u0275\u0275pipeBind1"](17,7,"submission.sections.ccLicense.confirmation"))}}function Vn(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n    "),w["\u0275\u0275template"](2,Ln,4,0,"div",3),w["\u0275\u0275text"](3,"\n    "),w["\u0275\u0275template"](4,Bn,21,9,"div",28),w["\u0275\u0275text"](5,"\n  "),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.ngVar;w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",!n),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",n)}}function Tn(e,t){if(1&e&&(w["\u0275\u0275elementContainerStart"](0),w["\u0275\u0275text"](1,"\n  "),w["\u0275\u0275template"](2,Vn,6,2,"ng-container",27),w["\u0275\u0275pipe"](3,"async"),w["\u0275\u0275text"](4,"\n"),w["\u0275\u0275elementContainerEnd"]()),2&e){var n=w["\u0275\u0275nextContext"]();w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngVar",w["\u0275\u0275pipeBind1"](3,1,n.getCcLicenseLink$()))}}var Rn,Pn,$n=(Rn=function(e){c(n,e);var t=u(n);function n(e,i,o,s,r,c,l,u){var d;return a(this,n),(d=t.call(this,c,l,u)).modalService=e,d.sectionService=i,d.submissionCcLicensesDataService=o,d.submissionCcLicenseUrlDataService=s,d.operationsBuilder=r,d.injectedCollectionId=c,d.injectedSectionData=l,d.injectedSubmissionId=u,d.isLoading=!0,d.subscriptions=[],d}return r(n,[{key:"selectCcLicense",value:function(e){this.getSelectedCcLicense()&&this.getSelectedCcLicense().id===e.id||(this.setAccepted(!1),this.updateSectionData({ccLicense:{id:e.id,fields:{}},uri:void 0}))}},{key:"getSelectedCcLicense",value:function(){var e=this;return this.submissionCcLicenses&&this.data.ccLicense?this.submissionCcLicenses.filter((function(t){return t.id===e.data.ccLicense.id}))[0]:null}},{key:"selectOption",value:function(e,t,n){var i,o,a;this.isSelectedOption(e,t,n)||this.updateSectionData({ccLicense:{id:e.id,fields:Object.assign({},this.data.ccLicense.fields,(i={},o=t.id,a=n,o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,i))},accepted:!1})}},{key:"getSelectedOption",value:function(e,t){return this.data.ccLicense.fields[t.id]}},{key:"isSelectedOption",value:function(e,t,n){return this.getSelectedOption(e,t)&&this.getSelectedOption(e,t).id===n.id}},{key:"getCcLicenseLink$",value:function(){var e=this;if(this.storedCcLicenseLink)return Object(de.a)(this.storedCcLicenseLink);if(this.getSelectedCcLicense()&&!this.getSelectedCcLicense().fields.some((function(t){return!e.getSelectedOption(e.getSelectedCcLicense(),t)}))){var t=this.getSelectedCcLicense();return this.submissionCcLicenseUrlDataService.getCcLicenseLink(t,new Map(t.fields.map((function(n){return[n,e.getSelectedOption(t,n)]}))))}}},{key:"openInfoModal",value:function(e){this.modalRef=this.modalService.open(e)}},{key:"closeInfoModal",value:function(){this.modalRef.close()}},{key:"getSectionStatus",value:function(){return Object(de.a)(this.accepted)}},{key:"onSectionDestroy",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"onSectionInit",value:function(){var e=this;this.pathCombiner=new M.a("sections",this.sectionData.id),this.subscriptions.push(this.sectionService.getSectionState(this.submissionId,this.sectionData.id,V.a.CcLicense).pipe(Object(I.a)((function(e){return Object(D.e)(e)&&(Object(D.e)(e.data)||Object(D.e)(e.errors))})),Object(y.a)(),Object(v.a)((function(e){return e.data}))).subscribe((function(t){if(e.data.accepted!==t.accepted){var n=e.pathCombiner.getPath("uri");t.accepted?e.getCcLicenseLink$().pipe(Object(x.a)(1)).subscribe((function(t){e.operationsBuilder.add(n,t.toString(),!1,!0)})):e.data.uri&&e.operationsBuilder.remove(n)}e.sectionData.data=t})),this.submissionCcLicensesDataService.findAll({elementsPerPage:9999}).pipe(Object(_.i)(),Object(_.o)(),Object(v.a)((function(e){return e.page}))).subscribe((function(t){return e.submissionCcLicenses=t})))}},{key:"setAccepted",value:function(e){this.updateSectionData({accepted:e}),this.updateSectionStatus()}},{key:"updateSectionData",value:function(e){this.sectionService.updateSectionData(this.submissionId,this.sectionData.id,Object.assign({},this.data,e))}},{key:"storedCcLicenseLink",get:function(){return this.data.uri}},{key:"accepted",get:function(){return void 0===this.data.accepted?!!this.data.uri:this.data.accepted}},{key:"data",get:function(){return this.sectionData.data}}]),n}(k),Rn.\u0275fac=function(e){return new(e||Rn)(w["\u0275\u0275directiveInject"](It.u),w["\u0275\u0275directiveInject"]($.a),w["\u0275\u0275directiveInject"](un.a),w["\u0275\u0275directiveInject"](dn.a),w["\u0275\u0275directiveInject"](Ke.a),w["\u0275\u0275directiveInject"]("collectionIdProvider"),w["\u0275\u0275directiveInject"]("sectionDataProvider"),w["\u0275\u0275directiveInject"]("submissionIdProvider"))},Rn.\u0275cmp=w["\u0275\u0275defineComponent"]({type:Rn,selectors:[["ds-submission-section-cc-licenses"]],features:[w["\u0275\u0275InheritDefinitionFeature"]],decls:26,vars:8,consts:[[1,"mb-4","ccLicense-select"],[3,"disabled"],[1,"selection"],[4,"ngIf"],[1,"menu"],["class","dropdown-item disabled",4,"ngIf"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"dropdown-item","disabled"],[1,"dropdown-item",3,"click"],["class","mb-4",4,"ngFor","ngForOf"],[1,"mb-4"],[1,"d-flex","flex-row"],[1,"btn","btn-outline-info","btn-sm","ml-2",3,"click"],[1,"fas","fa-question"],["infoModal",""],[1,"modal-header","mb-4"],[3,"innerHTML"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"font-weight-light",3,"innerHTML"],["class","selection",4,"ngVar"],[1,"options-select-menu","overflow-auto"],["class","d-flex flex-row m-1",4,"ngFor","ngForOf"],[1,"d-flex","flex-row","m-1"],[3,"click"],["type","radio",1,"mr-1",3,"title","checked"],[4,"ngVar"],["class","mt-2 p-4 bg-light text-dark",4,"ngIf"],[1,"mt-2","p-4","bg-light","text-dark"],["target","_blank","rel","noopener noreferrer",1,"license-link",3,"href"],[1,"m-2"],["type","checkbox","title","accepted",3,"checked"]],template:function(e,t){1&e&&(w["\u0275\u0275elementStart"](0,"div",0),w["\u0275\u0275text"](1,"\n  "),w["\u0275\u0275elementStart"](2,"ds-select",1),w["\u0275\u0275text"](3,"\n\n    "),w["\u0275\u0275elementContainerStart"](4,2),w["\u0275\u0275text"](5,"\n      "),w["\u0275\u0275template"](6,fn,4,0,"span",3),w["\u0275\u0275text"](7,"\n      "),w["\u0275\u0275template"](8,bn,2,1,"span",3),w["\u0275\u0275text"](9,"\n      "),w["\u0275\u0275template"](10,gn,6,2,"span",3),w["\u0275\u0275text"](11,"\n    "),w["\u0275\u0275elementContainerEnd"](),w["\u0275\u0275text"](12,"\n\n    "),w["\u0275\u0275elementContainerStart"](13,4),w["\u0275\u0275text"](14,"\n      "),w["\u0275\u0275template"](15,xn,3,3,"button",5),w["\u0275\u0275text"](16,"\n      "),w["\u0275\u0275template"](17,Sn,2,1,"button",6),w["\u0275\u0275text"](18,"\n    "),w["\u0275\u0275elementContainerEnd"](),w["\u0275\u0275text"](19,"\n\n  "),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](20,"\n"),w["\u0275\u0275elementEnd"](),w["\u0275\u0275text"](21,"\n\n"),w["\u0275\u0275template"](22,Mn,4,1,"ng-container",3),w["\u0275\u0275text"](23,"\n\n"),w["\u0275\u0275template"](24,Tn,5,3,"ng-container",3),w["\u0275\u0275text"](25,"\n")),2&e&&(w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("disabled",!t.submissionCcLicenses),w["\u0275\u0275advance"](4),w["\u0275\u0275property"]("ngIf",!t.submissionCcLicenses),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",t.getSelectedCcLicense()),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",t.submissionCcLicenses&&!t.getSelectedCcLicense()),w["\u0275\u0275advance"](5),w["\u0275\u0275property"]("ngIf",0==(null==t.submissionCcLicenses?null:t.submissionCcLicenses.length)),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngForOf",t.submissionCcLicenses),w["\u0275\u0275advance"](5),w["\u0275\u0275property"]("ngIf",t.getSelectedCcLicense()),w["\u0275\u0275advance"](2),w["\u0275\u0275property"]("ngIf",t.getCcLicenseLink$()))},directives:[pn.a,Y.u,Y.t,z.a,mn.a],pipes:[Q.e,Y.b],styles:[".options-select-menu[_ngcontent-%COMP%]{max-height:25vh}"]}),Rn=Object(f.b)([Object(B.a)(V.a.CcLicense)],Rn)),An=s("N0eT"),_n=s("udvk"),Nn=s("YoQ9"),qn=s("Ahb/"),Un=s("qK5G"),Jn=s("cRUs"),Gn=s("hTYz"),Qn=s("pYyI"),Yn=s("s7LF"),zn=s("MNke"),Hn=s("xkgV"),Kn=s("iInd"),Xn=s("3Pji"),Zn=s("UVXo"),Wn=s("7KAL"),ei=s("ltgo"),ti=s("y7ui"),ni=s("VYMa"),ii=s("Xhx+"),oi=s("xEHW"),ai=s("gLKo"),si=s("tLeP"),ri=s("nNzF"),ci=s("SFhV"),li=s("mXTb"),ui=s("KPLb"),di=s("DExz"),pi=s("J8r5"),mi=s("Bvcw"),fi=s("YLfV"),bi=s("V17L"),vi=s("S8sI"),hi=s("NvTF"),gi=s("ZO65"),xi=s("0pnk"),Si=s("sw+l"),yi=s("1Pbu"),Ii=s("bPV6"),Oi=s("Gu/b"),ji=s("A/iK"),Ci=s("KKO+"),Ei=s("Ysrn"),Di=s("tqJZ"),wi=s("ZTun"),ki=s("uyTL"),Fi=s("HZwm"),Mi=s("6CLs"),Li=s("ttM+"),Bi=s("845l"),Vi=s("v/mu"),Ti=s("4LOp"),Ri=s("ZFle"),Pi=s("fIR8"),$i=s("WgDD"),Ai=s("jLV+"),_i=s("Exvd"),Ni=s("DdXh"),qi=s("lZVp"),Ui=s("8gmk"),Ji=s("DNss"),Gi=s("FExQ"),Qi=s("1a/3"),Yi=s("4zj/"),zi=s("L6kw"),Hi=s("ij5K"),Ki=s("vGbP"),Xi=s("Gw2O"),Zi=s("eO7r"),Wi=s("tOny"),eo=s("1I3N"),to=s("Nz5a"),no=s("0/Mm"),io=s("h8Z3"),oo=s("SU/f"),ao=s("wTtK"),so=s("y3mP"),ro=s("3Rjm"),co=s("CEsD"),lo=s("fxJx"),uo=s("93cK"),po=s("y/PT"),mo=s("Ybtn"),fo=s("MTb2"),bo=s("3H9X"),vo=s("Xool"),ho=s("8pnQ"),go=s("Kr+g"),xo=s("BI7K"),So=s("kaIh"),yo=s("uly2"),Io=s("Elg+"),Oo=s("0f0u"),jo=s("/ESF"),Co=s("fjB9"),Eo=s("83zO"),Do=s("ecQD"),wo=s("JYDz"),ko=s("riZU"),Fo=s("6+O9"),Mo=s("SJRl"),Lo=s("xG+5"),Bo=s("y0lz"),Vo=s("oEms"),To=s("/pN5"),Ro=s("i/kS"),Po=s("hIOQ"),$o=s("Qzqf"),Ao=s("viO8"),_o=s("gZAJ"),No=s("xEMa"),qo=s("Bjvk"),Uo=s("HKEE"),Jo=s("pQc5"),Go=s("OgmJ"),Qo=s("EmA+"),Yo=s("IJQe"),zo=s("pKvA"),Ho=s("1aCu"),Ko=s("PSvP"),Xo=s("oGY6"),Zo=s("iz6e"),Wo=s("JYRs"),ea=s("daFX"),ta=s("6nfC"),na=s("MpTx"),ia=s("xjoE"),oa=s("Oupr"),aa=s("f7iX"),sa=s("Ytjd"),ra=s("a1Jy"),ca=s("zGzN"),la=s("3lxO"),ua=s("yXJd"),da=s("/Vzl"),pa=s("8UYb"),ma=s("8mI/"),fa=s("8gBe"),ba=s("Y9an"),va=s("OUbH"),ha=s("6xaB"),ga=s("3pMV"),xa=s("MkTI"),Sa=s("+Bs4"),ya=s("O/Ly"),Ia=s("ALMP"),Oa=s("EEUA"),ja=s("539a"),Ca=s("XR30"),Ea=s("P2PV"),Da=s("OXP5"),wa=s("Gt6B"),ka=s("Oqsf"),Fa=s("Ixlc"),Ma=s("Q8wr"),La=s("97Yq"),Ba=s("zdyR"),Va=s("Rgmz"),Ta=s("UVdL"),Ra=s("rrDp"),Pa=s("rT2D"),$a=s("KRdn"),Aa=s("qHOp"),_a=s("yc3A"),Na=s("VV3J"),qa=s("uUdI"),Ua=s("K1CC"),Ja=s("aZ//"),Ga=s("Ui2r"),Qa=s("8HnP"),Ya=s("EOhw"),za=s("zVKZ"),Ha=s("Z9xA"),Ka=s("8a1q"),Xa=s("kivT"),Za=s("bg5s"),Wa=s("4Q22"),es=s("uf49"),ts=s("zCuV"),ns=s("PApk"),is=s("vv5f"),os=s("LMaQ"),as=s("uVW2"),ss=s("UX6V"),rs=s("mK1h"),cs=s("Zmll"),ls=s("5qu4"),us=s("D1Lt"),ds=s("N0QX"),ps=s("Y8Hs"),ms=s("Nsr3"),fs=s("nypr"),bs=s("jOLk"),vs=s("awfb"),hs=s("BIe1"),gs=s("OWWE"),xs=s("aojn"),Ss=s("NM6P"),ys=s("936P"),Is=s("Wm14"),Os=s("cQ11"),js=s("4Kdc"),Cs=s("ozG+"),Es=s("xPuV"),Ds=s("mfPM"),ws=s("oKKW"),ks=s("lawv"),Fs=s("AeMR"),Ms=s("YJCx"),Ls=s("e1k8"),Bs=s("7ny6"),Vs=s("rfZC"),Ts=s("snSO"),Rs=s("pEOr"),Ps=s("UGKy"),$s=((Pn=function e(){a(this,e)}).\u0275mod=w["\u0275\u0275defineNgModule"]({type:Pn}),Pn.\u0275inj=w["\u0275\u0275defineInjector"]({factory:function(e){return new(e||Pn)},providers:[De,$.a,$e],imports:[[Y.c,d.a.forRoot(),m.a,re.j.forFeature("submission",le.a,an.d),ce.c.forFeature(je),An.a.withEntryComponents(),_n.a.withEntryComponents()]]}),Pn);w["\u0275\u0275setComponentScope"](ze,[Y.r,Y.s,Y.t,Y.u,Y.B,Y.x,Y.y,Y.z,Y.A,Y.v,Y.w,Jn.a,st.J,st.N,Gn.b,Gn.c,Gn.d,Gn.e,Gn.f,Gn.g,Gn.h,Gn.i,Gn.j,Gn.k,Gn.l,Gn.m,Gn.n,Gn.o,Gn.p,Qn.a,Qn.b,Yn["\u0275angular_packages_forms_forms_y"],Yn.NgSelectOption,Yn["\u0275angular_packages_forms_forms_x"],Yn.DefaultValueAccessor,Yn.NumberValueAccessor,Yn.RangeValueAccessor,Yn.CheckboxControlValueAccessor,Yn.SelectControlValueAccessor,Yn.SelectMultipleControlValueAccessor,Yn.RadioControlValueAccessor,Yn.NgControlStatus,Yn.NgControlStatusGroup,Yn.RequiredValidator,Yn.MinLengthValidator,Yn.MaxLengthValidator,Yn.PatternValidator,Yn.CheckboxRequiredValidator,Yn.EmailValidator,Yn.NgModel,Yn.NgModelGroup,Yn.NgForm,zn.a,It.a,It.K,It.N,It.L,It.M,It.O,It.c,It.d,It.g,It.S,It.R,It.f,It.W,It.h,It.i,It.k,It.t,It.m,It.n,It.o,It.r,It.q,It.p,It.B,It.x,It.w,It.y,It.z,It.A,It.C,It.E,It.F,It.G,It.H,It.I,It.J,It.P,It.Q,It.T,It.bb,It.eb,It.fb,It.gb,It.hb,It.s,It.ab,It.X,It.Y,It.Z,Hn.c,Hn.d,Yn.FormControlDirective,Yn.FormGroupDirective,Yn.FormControlName,Yn.FormGroupName,Yn.FormArrayName,Kn.l,Kn.h,Kn.j,Kn.i,Kn.o,Xn.a,Zn.MaskedInputDirective,Wn.a,ei.e,ei.f,ei.a,ei.b,ei.d,ei.c,ti.a,ti.e,ti.g,ti.h,ti.b,ti.d,ti.f,ni.a,ii.a,oi.a,ai.a,si.a,ri.a,ci.a,li.a,ui.a,di.a,pi.a,mi.a,fi.a,bi.a,vi.a,hi.a,gi.a,xi.a,Si.a,yi.a,Ii.a,Oi.a,ji.a,Ci.a,Ei.b,Di.a,wi.a,ki.a,pn.a,Fi.a,H.a,Mi.a,z.a,Li.a,Bi.a,Vi.a,Ti.a,Ri.a,Pi.a,$i.a,Ai.a,_i.a,Ni.a,qi.a,Ui.a,Ji.a,Gi.a,Ot.a,Qi.a,Yi.a,zi.a,Hi.a,Ki.a,Xi.a,Zi.a,Wi.a,eo.a,to.a,no.a,io.a,oo.a,ao.a,so.a,ro.a,co.a,lo.a,uo.a,po.a,mo.a,fo.a,bo.a,vo.a,ho.a,go.a,xo.a,So.a,yo.a,Io.a,Oo.a,jo.a,Co.a,Eo.a,Do.a,wo.a,ko.a,Fo.a,Mo.a,Lo.a,Bo.a,Vo.a,To.a,Ro.a,Po.a,$o.a,Ao.c,_o.a,No.a,qo.a,Uo.a,Jo.a,Go.a,Qo.a,Yo.a,zo.a,Ho.a,Ko.a,Xo.a,Zo.a,Wo.a,ea.a,ta.a,na.a,ia.a,oa.a,aa.a,sa.a,ra.a,ca.a,la.a,ua.a,da.a,pa.a,ma.a,fa.a,ba.a,va.a,ha.a,ga.a,xa.a,Sa.a,ya.a,Ia.a,Oa.a,ja.a,Ca.a,Ea.a,Da.a,wa.a,ka.a,Fa.a,Ma.a,La.a,Ba.a,Va.a,Ta.a,Ra.a,Pa.a,$a.a,Aa.a,_a.a,Na.a,qa.a,Ua.a,Ja.a,Ga.a,Qa.a,Ya.a,za.a,Ha.a,Ka.a,Xa.a,Za.a,Wa.a,es.a,ts.a,ns.a,is.a,os.a,as.a,ss.a,rs.a,cs.a,ls.a,us.a,ds.a,ps.ConfigurationSearchPageComponent,ms.a,mn.a,fs.a,bs.a,vs.a,hs.a,gs.a,xs.a,Ss.a,ys.a,Is.a,Os.a,js.a,Cs.a,Es.a,Ds.a,ws.a,Q.b,Ft,ze,ee,nt,$n,te.a,it.SubmissionEditComponent,Nn.a,ae.a,ne.a,oe.a,ie.a,on.SubmissionSubmitComponent,qn.a,He.a,se.a,nn,St,Ut,sn.SubmissionImportExternalComponent,Un.a,rn.a,cn.a,ln.a],[Y.b,Y.I,Y.q,Y.l,Y.F,Y.g,Y.D,Y.G,Y.d,Y.f,Y.j,Y.k,Y.m,Hn.b,ks.a,ks.b,ks.c,ks.d,ks.e,ks.f,ks.m,ks.o,ks.p,ks.q,ks.g,ks.j,ks.k,ks.n,ks.i,ks.h,Fs.a,Jt.a,Ms.a,Mt.a,Ls.a,Bs.a,Vs.a,Ts.a,Rs.a,Ps.a,Q.e])},fBXw:function(e,t,n){"use strict";var i=n("TTdl");t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object.create({});return e.forEach((function(e){Object(i.a)(e.paths).forEach((function(n){var i={path:n.originalPath,message:e.message};t[n.sectionId]||(t[n.sectionId]=[]),t[n.sectionId].push(i)}))})),t}},m4Gq:function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var i=n("LRne"),o=n("pLZG"),s=n("lJxs"),c=n("/uUt"),l=n("eIep"),u=n("J3qs"),d=n("ao5O"),p=n("4GeW"),m=n("8Y7J"),f=n("Vurf"),b=n("uLZQ"),v=n("J/vq"),h=n("YJD6"),g=n("SVse"),x=n("wQzj"),S=n("ph1m"),y=n("T/iP"),I=n("Frqi"),O=n("Yfyx"),j=n("yAsG");function C(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"div",12),m["\u0275\u0275text"](1,"\n            "),m["\u0275\u0275element"](2,"ds-submission-upload-files",13),m["\u0275\u0275text"](3,"\n            "),m["\u0275\u0275element"](4,"div",14),m["\u0275\u0275text"](5,"\n        "),m["\u0275\u0275elementEnd"]()),2&e){var n=m["\u0275\u0275nextContext"](2);m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("submissionId",n.submissionId)("collectionId",n.collectionId)("sectionId","upload")("uploadFilesOptions",n.uploadFilesOptions)}}function E(e,t){if(1&e){var n=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"div",6),m["\u0275\u0275text"](1,"\n        "),m["\u0275\u0275template"](2,C,6,4,"div",7),m["\u0275\u0275pipe"](3,"async"),m["\u0275\u0275text"](4,"\n\n        "),m["\u0275\u0275elementStart"](5,"div",8),m["\u0275\u0275text"](6,"\n            "),m["\u0275\u0275elementStart"](7,"ds-submission-form-collection",9),m["\u0275\u0275listener"]("collectionChange",(function(e){return m["\u0275\u0275restoreView"](n),m["\u0275\u0275nextContext"]().onCollectionChange(e)})),m["\u0275\u0275text"](8,"\n            "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275text"](9,"\n        "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275text"](10,"\n        "),m["\u0275\u0275elementStart"](11,"div",10),m["\u0275\u0275text"](12,"\n            "),m["\u0275\u0275elementStart"](13,"ds-submission-form-section-add",11),m["\u0275\u0275text"](14,"\n            "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275text"](15,"\n        "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275text"](16,"\n    "),m["\u0275\u0275elementEnd"]()}if(2&e){var i=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("ngIf",m["\u0275\u0275pipeBind1"](3,6,i.uploadEnabled$)),m["\u0275\u0275advance"](5),m["\u0275\u0275property"]("currentCollectionId",i.collectionId)("currentDefinition",i.definitionId)("submissionId",i.submissionId),m["\u0275\u0275advance"](6),m["\u0275\u0275property"]("collectionId",i.collectionId)("submissionId",i.submissionId)}}function D(e,t){1&e&&m["\u0275\u0275element"](0,"ds-loading",15)}function w(e,t){if(1&e&&(m["\u0275\u0275elementContainerStart"](0),m["\u0275\u0275text"](1,"\n            "),m["\u0275\u0275element"](2,"ds-submission-section-container",16),m["\u0275\u0275text"](3,"\n        "),m["\u0275\u0275elementContainerEnd"]()),2&e){var n=t.$implicit,i=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("collectionId",i.collectionId)("submissionId",i.submissionId)("sectionData",n)}}function k(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"div",17),m["\u0275\u0275text"](1,"\n        "),m["\u0275\u0275element"](2,"ds-submission-form-footer",18),m["\u0275\u0275text"](3,"\n    "),m["\u0275\u0275elementEnd"]()),2&e){var n=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("submissionId",n.submissionId)}}var F=function(){var e=function(){function e(t,n,o,s,r){a(this,e),this.authService=t,this.changeDetectorRef=n,this.halService=o,this.submissionService=s,this.sectionsService=r,this.loading=Object(i.a)(!0),this.uploadFilesOptions=new d.a,this.subs=[],this.isActive=!0}return r(e,[{key:"ngOnChanges",value:function(e){var t=this;this.collectionId&&this.submissionId&&(this.isActive=!0,this.submissionSections=this.submissionService.getSubmissionObject(this.submissionId).pipe(Object(o.a)((function(){return t.isActive})),Object(s.a)((function(e){return e.isLoading})),Object(s.a)((function(e){return e})),Object(c.a)(),Object(l.a)((function(e){return e?Object(i.a)([]):t.getSectionsList()}))),this.uploadEnabled$=this.sectionsService.isSectionTypeAvailable(this.submissionId,p.a.Upload),this.loading=this.submissionService.getSubmissionObject(this.submissionId).pipe(Object(o.a)((function(){return t.isActive})),Object(s.a)((function(e){return e.isLoading})),Object(s.a)((function(e){return e})),Object(c.a)()),this.subs.push(this.halService.getEndpoint("workspaceitems").pipe(Object(o.a)((function(e){return Object(u.e)(e)})),Object(c.a)()).subscribe((function(e){t.uploadFilesOptions.authToken=t.authService.buildAuthHeader(),t.uploadFilesOptions.url=e.concat("/".concat(t.submissionId)),t.definitionId=t.submissionDefinition.name,t.submissionService.dispatchInit(t.collectionId,t.submissionId,t.selfUrl,t.submissionDefinition,t.sections,t.item,null),t.changeDetectorRef.detectChanges()}))),this.submissionService.startAutoSave(this.submissionId))}},{key:"ngOnDestroy",value:function(){this.isActive=!1,this.submissionService.stopAutoSave(),this.submissionService.resetAllSubmissionObjects(),this.subs.filter((function(e){return Object(u.b)(e)})).forEach((function(e){return e.unsubscribe()}))}},{key:"onCollectionChange",value:function(e){this.collectionId=e.collection.id,this.definitionId!==e.submissionDefinition.name?(this.sections=e.sections,this.submissionDefinition=e.submissionDefinition,this.definitionId=this.submissionDefinition.name,this.submissionService.resetSubmissionObject(this.collectionId,this.submissionId,e._links.self.href,this.submissionDefinition,this.sections,this.item)):this.changeDetectorRef.detectChanges()}},{key:"isLoading",value:function(){return this.loading}},{key:"getSectionsList",value:function(){return this.submissionService.getSubmissionSections(this.submissionId).pipe(Object(o.a)((function(e){return Object(u.e)(e)})),Object(s.a)((function(e){return e})))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](f.a),m["\u0275\u0275directiveInject"](m.ChangeDetectorRef),m["\u0275\u0275directiveInject"](b.a),m["\u0275\u0275directiveInject"](v.a),m["\u0275\u0275directiveInject"](h.a))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-form"]],inputs:{collectionId:"collectionId",item:"item",sections:"sections",selfUrl:"selfUrl",submissionDefinition:"submissionDefinition",submissionId:"submissionId"},features:[m["\u0275\u0275NgOnChangesFeature"]],decls:18,vars:12,consts:[[1,"container-fluid"],["class","submission-form-header mb-3 d-flex flex-wrap position-sticky",4,"ngIf"],[1,"submission-form-content"],["message","Loading...",4,"ngIf"],[4,"ngFor","ngForOf"],["class","submission-form-footer mt-3 mb-3 position-sticky",4,"ngIf"],[1,"submission-form-header","mb-3","d-flex","flex-wrap","position-sticky"],["class","w-100",4,"ngIf"],[1,"submission-form-header-item","mb-3","mb-sm-0","flex-sm-grow-1","flex-md-grow-0"],[3,"currentCollectionId","currentDefinition","submissionId","collectionChange"],[1,"submission-form-header-item","text-right"],[3,"collectionId","submissionId"],[1,"w-100"],[3,"submissionId","collectionId","sectionId","uploadFilesOptions"],[1,"clearfix"],["message","Loading..."],[3,"collectionId","submissionId","sectionData"],[1,"submission-form-footer","mt-3","mb-3","position-sticky"],[3,"submissionId"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"div",0),m["\u0275\u0275text"](1,"\n    "),m["\u0275\u0275template"](2,E,17,8,"div",1),m["\u0275\u0275pipe"](3,"async"),m["\u0275\u0275text"](4,"\n\n    "),m["\u0275\u0275elementStart"](5,"div",2),m["\u0275\u0275text"](6,"\n        "),m["\u0275\u0275template"](7,D,1,0,"ds-loading",3),m["\u0275\u0275pipe"](8,"async"),m["\u0275\u0275text"](9,"\n        "),m["\u0275\u0275template"](10,w,4,3,"ng-container",4),m["\u0275\u0275pipe"](11,"async"),m["\u0275\u0275text"](12,"\n    "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275text"](13,"\n    "),m["\u0275\u0275template"](14,k,4,1,"div",5),m["\u0275\u0275pipe"](15,"async"),m["\u0275\u0275text"](16,"\n"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275text"](17,"\n")),2&e&&(m["\u0275\u0275advance"](2),m["\u0275\u0275property"]("ngIf",!m["\u0275\u0275pipeBind1"](3,4,t.isLoading())),m["\u0275\u0275advance"](5),m["\u0275\u0275property"]("ngIf",m["\u0275\u0275pipeBind1"](8,6,t.isLoading())),m["\u0275\u0275advance"](3),m["\u0275\u0275property"]("ngForOf",m["\u0275\u0275pipeBind1"](11,8,t.submissionSections)),m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("ngIf",!m["\u0275\u0275pipeBind1"](15,10,t.isLoading())))},directives:[g.u,g.t,x.a,S.a,y.a,I.a,O.a,j.a],pipes:[g.b],styles:[".submission-form-header[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.97);padding:calc(var(--bs-spacer) / 2) 0 calc(var(--bs-spacer) / 2) 0;top:0;z-index:var(--ds-submission-header-z-index)}.submission-form-header-item[_ngcontent-%COMP%]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.submission-form-footer[_ngcontent-%COMP%]{border-radius:var(--bs-card-border-radius);bottom:0;background-color:var(--bs-gray-400);padding:calc(var(--bs-spacer) / 2);z-index:var(--ds-submission-footer-z-index)}"]}),e}()},ph1m:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("lJxs"),o=n("8Y7J"),s=n("YJD6"),c=n("J/vq"),l=n("14tD"),u=n("G0yt"),d=n("SVse"),p=n("TSSN");function m(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"button",7),o["\u0275\u0275text"](1),o["\u0275\u0275pipe"](2,"translate"),o["\u0275\u0275elementEnd"]()),2&e&&(o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"]("\n      ",o["\u0275\u0275pipeBind1"](2,1,"submission.sections.general.no-sections"),"\n    "))}function f(e,t){if(1&e){var n=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"button",8),o["\u0275\u0275listener"]("click",(function(){o["\u0275\u0275restoreView"](n);var e=t.$implicit;return o["\u0275\u0275nextContext"]().addSection(e.id)})),o["\u0275\u0275text"](1),o["\u0275\u0275pipe"](2,"translate"),o["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"]("\n      ",o["\u0275\u0275pipeBind1"](2,1,"submission.sections."+i.header),"\n    ")}}var b=function(e){return{"w-100":e}},v=function(){var e=function(){function e(t,n,i){a(this,e),this.sectionService=t,this.submissionService=n,this.windowService=i}return r(e,[{key:"ngOnInit",value:function(){this.sectionList$=this.submissionService.getDisabledSectionsList(this.submissionId),this.hasSections$=this.sectionList$.pipe(Object(i.a)((function(e){return e.length>0})))}},{key:"addSection",value:function(e){this.sectionService.addSection(this.submissionId,e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](s.a),o["\u0275\u0275directiveInject"](c.a),o["\u0275\u0275directiveInject"](l.a))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-form-section-add"]],inputs:{collectionId:"collectionId",submissionId:"submissionId"},decls:22,vars:25,consts:[["ngbDropdown","","placement","bottom-right",1,"d-inline-block",3,"ngClass"],["sectionAdd","ngbDropdown"],["id","sectionControls","ngbDropdownToggle","",1,"btn","btn-outline-primary","dropdown-toggle",3,"disabled","ngClass"],["aria-hidden","true",1,"fa","fa-plus"],["ngbDropdownMenu","","aria-labelledby","sectionControls",1,"sections-dropdown-menu",3,"ngClass"],["class","dropdown-item disabled",4,"ngIf"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"dropdown-item","disabled"],[1,"dropdown-item",3,"click"]],template:function(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"div",0,1),o["\u0275\u0275text"](2,"\n  "),o["\u0275\u0275elementStart"](3,"button",2),o["\u0275\u0275pipe"](4,"async"),o["\u0275\u0275pipe"](5,"async"),o["\u0275\u0275text"](6),o["\u0275\u0275pipe"](7,"translate"),o["\u0275\u0275element"](8,"i",3),o["\u0275\u0275text"](9,"\n  "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](10,"\n  "),o["\u0275\u0275elementStart"](11,"div",4),o["\u0275\u0275pipe"](12,"async"),o["\u0275\u0275text"](13,"\n    "),o["\u0275\u0275template"](14,m,3,3,"button",5),o["\u0275\u0275pipe"](15,"async"),o["\u0275\u0275text"](16,"\n    "),o["\u0275\u0275template"](17,f,3,3,"button",6),o["\u0275\u0275pipe"](18,"async"),o["\u0275\u0275text"](19,"\n  "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](20,"\n"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275text"](21,"\n")),2&e&&(o["\u0275\u0275property"]("ngClass",o["\u0275\u0275pureFunction1"](19,b,t.windowService.isXs())),o["\u0275\u0275advance"](3),o["\u0275\u0275property"]("disabled",!o["\u0275\u0275pipeBind1"](4,7,t.hasSections$))("ngClass",o["\u0275\u0275pureFunction1"](21,b,o["\u0275\u0275pipeBind1"](5,9,t.windowService.isXs()))),o["\u0275\u0275advance"](3),o["\u0275\u0275textInterpolate1"]("\n          ",o["\u0275\u0275pipeBind1"](7,11,"submission.sections.general.add-more")," "),o["\u0275\u0275advance"](5),o["\u0275\u0275property"]("ngClass",o["\u0275\u0275pureFunction1"](23,b,o["\u0275\u0275pipeBind1"](12,13,t.windowService.isXs()))),o["\u0275\u0275advance"](3),o["\u0275\u0275property"]("ngIf",!o["\u0275\u0275pipeBind1"](15,15,t.hasSections$)),o["\u0275\u0275advance"](3),o["\u0275\u0275property"]("ngForOf",o["\u0275\u0275pipeBind1"](18,17,t.sectionList$)))},directives:[u.n,d.r,u.r,u.q,d.u,d.t],pipes:[d.b,p.e],styles:[".dropdown-toggle[_ngcontent-%COMP%]:after{display:none}.sections-dropdown-menu[_ngcontent-%COMP%]{z-index:var(--ds-submission-header-z-index)}"]}),e}()},qK5G:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("JTKQ"),o=n("8Y7J");function s(e,t){}var l=function(){var e=function(e){c(i,e);var t=u(i);function i(){return a(this,i),t.apply(this,arguments)}return r(i,[{key:"getComponentName",value:function(){return"SubmissionImportExternalComponent"}},{key:"importThemedComponent",value:function(e){return n("JHLN")("./".concat(e,"/app/submission/import-external/submission-import-external.component"))}},{key:"importUnthemedComponent",value:function(){return Promise.resolve().then(n.bind(null,"RMpN"))}}]),i}(i.a);return e.\u0275fac=function(t){return d(t||e)},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-themed-submission-import-external"]],features:[o["\u0275\u0275InheritDefinitionFeature"]],decls:3,vars:0,consts:[["vcr",""]],template:function(e,t){1&e&&(o["\u0275\u0275template"](0,s,0,0,"ng-template",null,0,o["\u0275\u0275templateRefExtractor"]),o["\u0275\u0275text"](2,"\n"))},encapsulation:2}),e}(),d=o["\u0275\u0275getInheritedFactory"](l)},wQzj:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i=n("8Y7J"),o=n("2Vo4"),s=n("LRne"),c=n("cBqT"),l=n("lJxs"),u=n("J3qs"),d=n("0VLH"),p=n("Oqsf"),m=n("DNva"),f=n("BVmw"),b=n("QjZv"),v=n("J/vq"),h=n("YJD6"),g=n("SVse"),x=n("G0yt"),S=n("TSSN");function y(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",2),i["\u0275\u0275text"](1,"\n    "),i["\u0275\u0275elementStart"](2,"div",3),i["\u0275\u0275text"](3,"\n      "),i["\u0275\u0275elementStart"](4,"span",4),i["\u0275\u0275text"](5),i["\u0275\u0275pipe"](6,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](7,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](8,"\n    "),i["\u0275\u0275elementStart"](9,"div",5),i["\u0275\u0275text"](10,"\n      "),i["\u0275\u0275elementStart"](11,"span",4),i["\u0275\u0275text"](12),i["\u0275\u0275pipe"](13,"async"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](14,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](15,"\n  "),i["\u0275\u0275elementEnd"]()),2&e){var n=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](5),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](6,2,"submission.sections.general.collection")),i["\u0275\u0275advance"](7),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](13,4,n.selectedCollectionName$))}}function I(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"span"),i["\u0275\u0275element"](1,"i",13),i["\u0275\u0275elementEnd"]())}function O(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"span"),i["\u0275\u0275text"](1),i["\u0275\u0275pipe"](2,"async"),i["\u0275\u0275elementEnd"]()),2&e){var n=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate"](i["\u0275\u0275pipeBind1"](2,1,n.selectedCollectionName$))}}function j(e,t){if(1&e){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",6,7),i["\u0275\u0275listener"]("openChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().toggled(e)})),i["\u0275\u0275text"](2,"\n    "),i["\u0275\u0275elementStart"](3,"div",3),i["\u0275\u0275text"](4,"\n      "),i["\u0275\u0275elementStart"](5,"span",8),i["\u0275\u0275text"](6),i["\u0275\u0275pipe"](7,"translate"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](8,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](9,"\n    "),i["\u0275\u0275elementStart"](10,"button",9),i["\u0275\u0275listener"]("blur",(function(){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().onClose()}))("click",(function(){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().onClose()})),i["\u0275\u0275pipe"](11,"async"),i["\u0275\u0275text"](12,"\n      "),i["\u0275\u0275template"](13,I,2,0,"span",10),i["\u0275\u0275pipe"](14,"async"),i["\u0275\u0275text"](15,"\n      "),i["\u0275\u0275template"](16,O,3,3,"span",10),i["\u0275\u0275pipe"](17,"async"),i["\u0275\u0275text"](18,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](19,"\n\n    "),i["\u0275\u0275elementStart"](20,"div",11),i["\u0275\u0275text"](21,"\n      "),i["\u0275\u0275elementStart"](22,"ds-collection-dropdown",12),i["\u0275\u0275listener"]("selectionChange",(function(e){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().onSelect(e)})),i["\u0275\u0275text"](23,"\n      "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](24,"\n    "),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](25,"\n  "),i["\u0275\u0275elementEnd"]()}if(2&e){var o=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](6),i["\u0275\u0275textInterpolate1"]("\n        ",i["\u0275\u0275pipeBind1"](7,4,"submission.sections.general.collection"),"\n      "),i["\u0275\u0275advance"](4),i["\u0275\u0275property"]("disabled",i["\u0275\u0275pipeBind1"](11,6,o.processingChange$)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](14,8,o.processingChange$)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](17,10,o.processingChange$))}}var C=function(){var e=function(){function e(t,n,s,r,c,l){a(this,e),this.cdr=t,this.collectionDataService=n,this.operationsBuilder=s,this.operationsService=r,this.submissionService=c,this.sectionsService=l,this.collectionChange=new i.EventEmitter,this.processingChange$=new o.a(!1),this.subs=[]}return r(e,[{key:"ngOnChanges",value:function(e){Object(u.b)(e.currentCollectionId)&&Object(u.b)(e.currentCollectionId.currentValue)&&(this.selectedCollectionId=this.currentCollectionId,this.selectedCollectionName$=this.collectionDataService.findById(this.currentCollectionId).pipe(Object(c.a)((function(e){return Object(u.e)(e.payload)})),Object(l.a)((function(e){return e.payload.name}))))}},{key:"ngOnInit",value:function(){this.pathCombiner=new d.a("sections","collection"),this.available$=this.sectionsService.isSectionAvailable(this.submissionId,"collection")}},{key:"ngOnDestroy",value:function(){this.subs.filter((function(e){return Object(u.b)(e)})).forEach((function(e){return e.unsubscribe()}))}},{key:"onSelect",value:function(e){var t=this;this.processingChange$.next(!0),this.operationsBuilder.replace(this.pathCombiner.getPath(),e.collection.id,!0),this.subs.push(this.operationsService.jsonPatchByResourceID(this.submissionService.getSubmissionObjectLinkName(),this.submissionId,"sections","collection").subscribe((function(n){t.selectedCollectionId=e.collection.id,t.selectedCollectionName$=Object(s.a)(e.collection.name),t.collectionChange.emit(n[0]),t.submissionService.changeSubmissionCollection(t.submissionId,e.collection.id),t.processingChange$.next(!1),t.cdr.detectChanges()})))}},{key:"onClose",value:function(){this.collectionDropdown.reset()}},{key:"toggled",value:function(e){e||this.collectionDropdown.reset()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i["\u0275\u0275directiveInject"](i.ChangeDetectorRef),i["\u0275\u0275directiveInject"](m.a),i["\u0275\u0275directiveInject"](f.a),i["\u0275\u0275directiveInject"](b.a),i["\u0275\u0275directiveInject"](v.a),i["\u0275\u0275directiveInject"](h.a))},e.\u0275cmp=i["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-form-collection"]],viewQuery:function(e,t){var n;1&e&&i["\u0275\u0275viewQuery"](p.a,!0),2&e&&i["\u0275\u0275queryRefresh"](n=i["\u0275\u0275loadQuery"]())&&(t.collectionDropdown=n.first)},inputs:{currentCollectionId:"currentCollectionId",currentDefinition:"currentDefinition",submissionId:"submissionId"},outputs:{collectionChange:"collectionChange"},features:[i["\u0275\u0275NgOnChangesFeature"]],decls:9,vars:6,consts:[["class","input-group mb-3",4,"ngIf"],["ngbDropdown","","class","btn-group input-group",3,"openChange",4,"ngIf"],[1,"input-group","mb-3"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"input-group-append"],["ngbDropdown","",1,"btn-group","input-group",3,"openChange"],["collectionControls","ngbDropdown"],["id","collectionControlsMenuLabel",1,"input-group-text"],["aria-describedby","collectionControlsMenuLabel","id","collectionControlsMenuButton","ngbDropdownToggle","",1,"btn","btn-outline-primary",3,"disabled","blur","click"],[4,"ngIf"],["ngbDropdownMenu","","id","collectionControlsDropdownMenu","aria-labelledby","collectionControlsMenuButton",1,"dropdown-menu"],[3,"selectionChange"],[1,"fas","fa-circle-notch","fa-spin"]],template:function(e,t){1&e&&(i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275text"](1,"\n  "),i["\u0275\u0275template"](2,y,16,6,"div",0),i["\u0275\u0275pipe"](3,"async"),i["\u0275\u0275text"](4,"\n  "),i["\u0275\u0275template"](5,j,26,12,"div",1),i["\u0275\u0275pipe"](6,"async"),i["\u0275\u0275text"](7,"\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](8,"\n")),2&e&&(i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngIf",!i["\u0275\u0275pipeBind1"](3,2,t.available$)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngIf",i["\u0275\u0275pipeBind1"](6,4,t.available$)))},directives:[g.u,x.n,x.r,x.q,p.a],pipes:[g.b,S.e],styles:[".scrollable-menu[_ngcontent-%COMP%]{height:auto;max-height:var(--ds-dropdown-menu-max-height);overflow-x:hidden}.collection-item[_ngcontent-%COMP%]{border-bottom:var(--bs-dropdown-border-width) solid var(--bs-dropdown-border-color)}#collectionControlsDropdownMenu[_ngcontent-%COMP%]{outline:0;left:0!important;-webkit-box-shadow:var(--bs-btn-focus-box-shadow);box-shadow:var(--bs-btn-focus-box-shadow)}"]}),e}()},yAsG:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var i=n("LRne"),o=n("lJxs"),s=n("drGc"),c=n("J3qs"),l=n("8Y7J"),u=n("G0yt"),d=n("8nsN"),p=n("J/vq"),m=n("SVse"),f=n("TSSN");function b(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",9),l["\u0275\u0275text"](1,"Saving..."),l["\u0275\u0275elementEnd"]()),2&e&&l["\u0275\u0275styleProp"]("width","100%")}function v(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",9),l["\u0275\u0275text"](1,"Depositing..."),l["\u0275\u0275elementEnd"]()),2&e&&l["\u0275\u0275styleProp"]("width","100%")}function h(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",6),l["\u0275\u0275text"](1,"\n    "),l["\u0275\u0275elementStart"](2,"div",7),l["\u0275\u0275text"](3,"\n      "),l["\u0275\u0275template"](4,b,2,2,"div",8),l["\u0275\u0275pipe"](5,"async"),l["\u0275\u0275text"](6,"\n      "),l["\u0275\u0275template"](7,v,2,2,"div",8),l["\u0275\u0275pipe"](8,"async"),l["\u0275\u0275text"](9,"\n    "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](10,"\n  "),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngIf",l["\u0275\u0275pipeBind1"](5,2,n.processingSaveStatus)),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",l["\u0275\u0275pipeBind1"](8,4,n.processingDepositStatus))}}function g(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",16),l["\u0275\u0275listener"]("click",(function(e){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"](3).deposit(e)})),l["\u0275\u0275pipe"](1,"async"),l["\u0275\u0275text"](2,"\n      "),l["\u0275\u0275elementStart"](3,"span"),l["\u0275\u0275element"](4,"i",17),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"translate"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](7,"\n    "),l["\u0275\u0275elementEnd"]()}if(2&e){var i=l["\u0275\u0275nextContext"](3);l["\u0275\u0275property"]("disabled",l["\u0275\u0275pipeBind1"](1,2,i.submissionIsInvalid)),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,4,"submission.general.deposit"),"")}}function x(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",18),l["\u0275\u0275listener"]("click",(function(e){l["\u0275\u0275restoreView"](n);var t=l["\u0275\u0275nextContext"](3),i=l["\u0275\u0275reference"](3);return e.preventDefault(),t.confirmDiscard(i)})),l["\u0275\u0275text"](1,"\n      "),l["\u0275\u0275element"](2,"i",19),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"translate"),l["\u0275\u0275elementEnd"]()}2&e&&(l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,1,"submission.general.discard.submit"),"\n    "))}function S(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",10),l["\u0275\u0275text"](1,"\n    "),l["\u0275\u0275elementStart"](2,"button",11),l["\u0275\u0275listener"]("click",(function(e){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"](2).save(e)})),l["\u0275\u0275pipe"](3,"async"),l["\u0275\u0275pipe"](4,"async"),l["\u0275\u0275text"](5,"\n      "),l["\u0275\u0275elementStart"](6,"span"),l["\u0275\u0275element"](7,"i",12),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"translate"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](10,"\n    "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](11,"\n    "),l["\u0275\u0275elementStart"](12,"button",13),l["\u0275\u0275listener"]("click",(function(e){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"](2).saveLater(e)})),l["\u0275\u0275pipe"](13,"async"),l["\u0275\u0275pipe"](14,"async"),l["\u0275\u0275pipe"](15,"async"),l["\u0275\u0275text"](16,"\n      "),l["\u0275\u0275elementStart"](17,"span"),l["\u0275\u0275element"](18,"i",12),l["\u0275\u0275text"](19),l["\u0275\u0275pipe"](20,"translate"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](21,"\n    "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](22,"\n    "),l["\u0275\u0275template"](23,g,8,6,"button",14),l["\u0275\u0275pipe"](24,"async"),l["\u0275\u0275text"](25,"\n    "),l["\u0275\u0275template"](26,x,5,3,"button",15),l["\u0275\u0275pipe"](27,"async"),l["\u0275\u0275text"](28,"\n  "),l["\u0275\u0275elementEnd"]()}if(2&e){var i=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",l["\u0275\u0275pipeBind1"](3,10,i.processingSaveStatus)||!l["\u0275\u0275pipeBind1"](4,12,i.hasUnsavedModification)),l["\u0275\u0275advance"](6),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"submission.general.save"),""),l["\u0275\u0275advance"](4),l["\u0275\u0275classProp"]("btn-primary",!l["\u0275\u0275pipeBind1"](13,16,i.showDepositAndDiscard))("btn-secondary",l["\u0275\u0275pipeBind1"](14,18,i.showDepositAndDiscard)),l["\u0275\u0275property"]("disabled",l["\u0275\u0275pipeBind1"](15,20,i.processingSaveStatus)),l["\u0275\u0275advance"](7),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](20,22,"submission.general.save-later"),""),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngIf",l["\u0275\u0275pipeBind1"](24,24,i.showDepositAndDiscard)),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",l["\u0275\u0275pipeBind1"](27,26,i.showDepositAndDiscard))}}function y(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",2),l["\u0275\u0275text"](1,"\n  "),l["\u0275\u0275elementStart"](2,"div",3),l["\u0275\u0275text"](3,"\n    "),l["\u0275\u0275text"](4,"\n  "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](5,"\n  "),l["\u0275\u0275template"](6,h,11,6,"div",4),l["\u0275\u0275pipe"](7,"async"),l["\u0275\u0275pipe"](8,"async"),l["\u0275\u0275text"](9,"\n  "),l["\u0275\u0275template"](10,S,29,28,"div",5),l["\u0275\u0275pipe"](11,"async"),l["\u0275\u0275pipe"](12,"async"),l["\u0275\u0275text"](13,"\n"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngIf",l["\u0275\u0275pipeBind1"](7,2,n.processingSaveStatus)||l["\u0275\u0275pipeBind1"](8,4,n.processingDepositStatus)),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngIf",!l["\u0275\u0275pipeBind1"](11,6,n.processingSaveStatus)&&!l["\u0275\u0275pipeBind1"](12,8,n.processingDepositStatus))}}function I(e,t){1&e&&(l["\u0275\u0275text"](0,"\n  "),l["\u0275\u0275elementStart"](1,"div",20),l["\u0275\u0275text"](2,"\n    "),l["\u0275\u0275elementStart"](3,"h4",21),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"translate"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](6,"\n    "),l["\u0275\u0275elementStart"](7,"button",22),l["\u0275\u0275listener"]("click",(function(){return(0,t.dismiss)("cancel")})),l["\u0275\u0275text"](8,"\n      "),l["\u0275\u0275elementStart"](9,"span",23),l["\u0275\u0275text"](10,"\xd7"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](11,"\n    "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](12,"\n  "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](13,"\n  "),l["\u0275\u0275elementStart"](14,"div",24),l["\u0275\u0275text"](15,"\n    "),l["\u0275\u0275elementStart"](16,"p"),l["\u0275\u0275text"](17),l["\u0275\u0275pipe"](18,"translate"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](19,"\n  "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](20,"\n  "),l["\u0275\u0275elementStart"](21,"div",25),l["\u0275\u0275text"](22,"\n    "),l["\u0275\u0275elementStart"](23,"button",26),l["\u0275\u0275listener"]("click",(function(){return(0,t.close)("cancel")})),l["\u0275\u0275text"](24),l["\u0275\u0275pipe"](25,"translate"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](26,"\n    "),l["\u0275\u0275elementStart"](27,"button",18),l["\u0275\u0275listener"]("click",(function(){return(0,t.close)("ok")})),l["\u0275\u0275text"](28),l["\u0275\u0275pipe"](29,"translate"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](30,"\n  "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](31,"\n")),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](5,4,"submission.general.discard.confirm.title")),l["\u0275\u0275advance"](13),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](18,6,"submission.general.discard.confirm.info")),l["\u0275\u0275advance"](7),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](25,8,"submission.general.discard.confirm.cancel")),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](29,10,"submission.general.discard.confirm.submit")))}var O=function(){var e=function(){function e(t,n,o){a(this,e),this.modalService=t,this.restService=n,this.submissionService=o,this.submissionIsInvalid=Object(i.a)(!0)}return r(e,[{key:"ngOnChanges",value:function(e){Object(c.e)(this.submissionId)&&(this.submissionIsInvalid=this.submissionService.getSubmissionStatus(this.submissionId).pipe(Object(o.a)((function(e){return!1===e}))),this.processingSaveStatus=this.submissionService.getSubmissionSaveProcessingStatus(this.submissionId),this.processingDepositStatus=this.submissionService.getSubmissionDepositProcessingStatus(this.submissionId),this.showDepositAndDiscard=Object(i.a)(this.submissionService.getSubmissionScope()===s.a.WorkspaceItem),this.hasUnsavedModification=this.submissionService.hasUnsavedModification())}},{key:"save",value:function(e){this.submissionService.dispatchSave(this.submissionId,!0)}},{key:"saveLater",value:function(e){this.submissionService.dispatchSaveForLater(this.submissionId)}},{key:"deposit",value:function(e){this.submissionService.dispatchDeposit(this.submissionId)}},{key:"confirmDiscard",value:function(e){var t=this;this.modalService.open(e).result.then((function(e){"ok"===e&&t.submissionService.dispatchDiscard(t.submissionId)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](u.u),l["\u0275\u0275directiveInject"](d.a),l["\u0275\u0275directiveInject"](p.a))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ds-submission-form-footer"]],inputs:{submissionId:"submissionId"},features:[l["\u0275\u0275NgOnChangesFeature"]],decls:5,vars:1,consts:[["class","row",4,"ngIf"],["content",""],[1,"row"],[1,"col"],["class","col d-flex justify-content-end align-items-center",4,"ngIf"],["class","col text-right",4,"ngIf"],[1,"col","d-flex","justify-content-end","align-items-center"],[1,"progress","w-75"],["class","progress-bar progress-bar-striped progress-bar-animated bg-info","role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",3,"width",4,"ngIf"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-info"],[1,"col","text-right"],["type","button","id","save",1,"btn","btn-secondary",3,"disabled","click"],[1,"fas","fa-save"],["type","button","id","saveForLater",1,"btn",3,"disabled","click"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-plus"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"modal-header"],[1,"modal-title","text-danger"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(e,t){1&e&&(l["\u0275\u0275template"](0,y,14,10,"div",0),l["\u0275\u0275text"](1,"\n\n"),l["\u0275\u0275template"](2,I,32,12,"ng-template",null,1,l["\u0275\u0275templateRefExtractor"]),l["\u0275\u0275text"](4,"\n")),2&e&&l["\u0275\u0275property"]("ngIf",!!t.submissionId)},directives:[m.u],pipes:[m.b,f.e],styles:[""]}),e}()}}])}();
//# sourceMappingURL=3-es5.83b94385e4c0deb9bdef.js.map