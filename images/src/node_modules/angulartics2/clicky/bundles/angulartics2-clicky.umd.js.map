{"version":3,"file":"angulartics2-clicky.umd.js","sources":["../../../../src/lib/providers/clicky/clicky.ts","../../../../src/lib/providers/clicky/angulartics2-clicky.ts"],"names":["Injectable","Angulartics2","Title"],"mappings":";;;;;;;QAUE,4BACU,YAA0B,EAC1B,YAAmB;AAC7B,YAFU,iBAAY,GAAZ,YAAY,CAAc;AAAC,YAC3B,iBAAY,GAAZ,YAAY,CAAO;AAAC,YAE5B,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;AACvC,gBAAM,OAAO,CAAC,IAAI,CAAC,sDAAsD,CAAC,CAAC;AAC3E,aAAK;AACL,SAAG;AACH,QACE,0CAAa,GAAb;AAAc,YAAd,iBAOC;AACH,YAPI,IAAI,CAAC,YAAY,CAAC,SAAS;AAC/B,iBAAO,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,mBAAmB,EAAE,CAAC;AACpD,iBAAO,SAAS,CAAC,UAAC,CAAC,IAAK,OAAA,KAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,GAAA,CAAC,CAAC;AAChD,YAAI,IAAI,CAAC,YAAY,CAAC,UAAU;AAChC,iBAAO,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,mBAAmB,EAAE,CAAC;AACpD,iBAAO,SAAS,CAAC,UAAC,CAAC,IAAK,OAAA,KAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,UAAU,CAAC,GAAA,CAAC,CAAC;AACvE,SAAG;AAEH;AACM;AAEC;AAAW;AAEC;AAAW;AAG5B;AAAY,QADZ,sCAAS,GAAT,UAAU,IAAY;AACxB,YAAI,IAAM,KAAK,GAAW,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;AACvD,YAAI,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,EAAE,UAAU,CAAC,CAAC;AACxC,SAAG;AAEH;AACM;AAEC;AAAW;AACM;AAEC;AAAW;AACM;AAEA;AAAY,QAApD,6CAAgB,GAAhB,UAAiB,MAAc,EAAE,UAAqC;AACxE,YAAI,IAAI,OAAO,UAAU,CAAC,IAAI,KAAK,WAAW,EAAE;AAChD,gBAAM,IAAM,KAAK,GAAW,UAAU,CAAC,KAAK,IAAI,IAAI,CAAC;AACrD,gBAAM,IAAM,IAAI,GAAW,UAAU,CAAC,IAAI,IAAI,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;AAC/F,gBAAM,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;AACtC,aAAK;AAAC,iBAAK;AACX,gBAAM,IAAM,MAAM,GAAW,UAAU,CAAC,IAAI,CAAC;AAC7C,gBAAM,IAAM,OAAO,GAAW,UAAU,CAAC,OAAO,CAAC;AACjD,gBAAM,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO,EAAE,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;AACzD,aAAK;AACL,SAAG;AAEH,QAAU,yCAAY,GAAZ,UAAa,IAAY;AAAI,YACnC,IAAM,SAAS,GAAG,CAAC,UAAU,EAAE,OAAO,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;AACpE,YAAI,OAAO,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,GAAG,UAAU,CAAC;AAC5D,SAAG;;;;;qGACH;AAAC;AACiC;AAAU,gPAzDnC;sDADRA,tDACS;IADC,SAAC,EAAE,UAAU,EAAE,MAAM,jCAGR,gBARfC,eAAY;AAKa,AALT,gBAFhBC,QAAK;AAAG;AAAU;AAAC,ICD5B;AACA;AAEA;AACO;AAAC;AAC2B;AAAC;AAAmE;AAAC;AAAM","sourcesContent":["import { Injectable } from '@angular/core';\nimport { Title } from '@angular/platform-browser';\n\nimport { Angulartics2 } from 'angulartics2';\nimport { ClickyProperties } from './clicky.interfaces';\n\ndeclare var clicky: any;\n\n@Injectable({ providedIn: 'root' })\nexport class Angulartics2Clicky {\n  constructor(\n    private angulartics2: Angulartics2,\n    private titleService: Title,\n  ) {\n    if (typeof clicky === 'undefined') {\n      console.warn('Angulartics 2 Clicky Plugin: clicky global not found');\n    }\n  }\n\n  startTracking(): void {\n    this.angulartics2.pageTrack\n      .pipe(this.angulartics2.filterDeveloperMode())\n      .subscribe((x) => this.pageTrack(x.path));\n    this.angulartics2.eventTrack\n      .pipe(this.angulartics2.filterDeveloperMode())\n      .subscribe((x) => this.eventOrGoalTrack(x.action, x.properties));\n  }\n\n  /**\n   * Track Page in Clicky\n   *\n   * @param path location\n   *\n   * @link https://clicky.com/help/custom/manual#log\n   */\n  pageTrack(path: string) {\n    const title: string = this.titleService.getTitle();\n    clicky.log(path, title, 'pageview');\n  }\n\n  /**\n   * Track Event Or Goal in Clicky\n   *\n   * @param action Action name\n   * @param properties Definition of 'properties.goal' determines goal vs event tracking\n   *\n   * @link https://clicky.com/help/custom/manual#log\n   * @link https://clicky.com/help/custom/manual#goal\n   */\n  eventOrGoalTrack(action: string, properties: Partial<ClickyProperties>) {\n    if (typeof properties.goal === 'undefined') {\n      const title: string = properties.title || null;\n      const type: string = properties.type != null ? this.validateType(properties.type) : null;\n      clicky.log(action, title, type);\n    } else {\n      const goalId: string = properties.goal;\n      const revenue: number = properties.revenue;\n      clicky.goal(goalId, revenue, !!properties.noQueue);\n    }\n  }\n\n  private validateType(type: string): string {\n    const EventType = ['pageview', 'click', 'download', 'outbound'];\n    return EventType.indexOf(type) > -1 ? type : 'pageview';\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './clicky';\n"]}